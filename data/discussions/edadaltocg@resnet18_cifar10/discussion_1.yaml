!!python/object:huggingface_hub.community.DiscussionWithDetails
author: kashif
conflicting_files: null
created_at: 2023-04-16 15:22:52+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1669189789447-629f3b18ee05727ce328ccbe.jpeg?w=200&h=200&f=face
      fullname: Kashif Rasul
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kashif
      type: user
    createdAt: '2023-04-16T16:22:52.000Z'
    data:
      edited: false
      editors:
      - kashif
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1669189789447-629f3b18ee05727ce328ccbe.jpeg?w=200&h=200&f=face
          fullname: Kashif Rasul
          isHf: true
          isPro: false
          name: kashif
          type: user
        html: "<p>When i load this model I get:</p>\n<pre><code>model = timm.create_model(\"\
          hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\n\n---------------------------------------------------------------------------\n\
          RuntimeError                              Traceback (most recent call last)\n\
          &lt;ipython-input-5-1dd767c3077f&gt; in &lt;cell line: 1&gt;()\n----&gt;\
          \ 1 model = timm.create_model(\"hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\n\
          \n5 frames\n/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py\
          \ in load_state_dict(self, state_dict, strict)\n   2039 \n   2040      \
          \   if len(error_msgs) &gt; 0:\n-&gt; 2041             raise RuntimeError('Error(s)\
          \ in loading state_dict for {}:\\n\\t{}'.format(\n   2042              \
          \                  self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\n\
          \   2043         return _IncompatibleKeys(missing_keys, unexpected_keys)\n\
          \nRuntimeError: Error(s) in loading state_dict for ResNet:\n    size mismatch\
          \ for conv1.weight: copying a param with shape torch.Size([64, 3, 3, 3])\
          \ from checkpoint, the shape in current model is torch.Size([64, 3, 7, 7]).\n\
          </code></pre>\n"
        raw: "When i load this model I get:\r\n\r\n```\r\nmodel = timm.create_model(\"\
          hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\r\n\r\n---------------------------------------------------------------------------\r\
          \nRuntimeError                              Traceback (most recent call\
          \ last)\r\n<ipython-input-5-1dd767c3077f> in <cell line: 1>()\r\n----> 1\
          \ model = timm.create_model(\"hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\r\
          \n\r\n5 frames\r\n/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py\
          \ in load_state_dict(self, state_dict, strict)\r\n   2039 \r\n   2040  \
          \       if len(error_msgs) > 0:\r\n-> 2041             raise RuntimeError('Error(s)\
          \ in loading state_dict for {}:\\n\\t{}'.format(\r\n   2042            \
          \                    self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\
          \n   2043         return _IncompatibleKeys(missing_keys, unexpected_keys)\r\
          \n\r\nRuntimeError: Error(s) in loading state_dict for ResNet:\r\n\tsize\
          \ mismatch for conv1.weight: copying a param with shape torch.Size([64,\
          \ 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([64,\
          \ 3, 7, 7]).\r\n```"
        updatedAt: '2023-04-16T16:22:52.165Z'
      numEdits: 0
      reactions: []
    id: 643c20dc26f177a3e41726d1
    type: comment
  author: kashif
  content: "When i load this model I get:\r\n\r\n```\r\nmodel = timm.create_model(\"\
    hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\r\n\r\n---------------------------------------------------------------------------\r\
    \nRuntimeError                              Traceback (most recent call last)\r\
    \n<ipython-input-5-1dd767c3077f> in <cell line: 1>()\r\n----> 1 model = timm.create_model(\"\
    hf-hub:edadaltocg/resnet18_cifar10\", pretrained=True)\r\n\r\n5 frames\r\n/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py\
    \ in load_state_dict(self, state_dict, strict)\r\n   2039 \r\n   2040        \
    \ if len(error_msgs) > 0:\r\n-> 2041             raise RuntimeError('Error(s)\
    \ in loading state_dict for {}:\\n\\t{}'.format(\r\n   2042                  \
    \              self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\n   2043\
    \         return _IncompatibleKeys(missing_keys, unexpected_keys)\r\n\r\nRuntimeError:\
    \ Error(s) in loading state_dict for ResNet:\r\n\tsize mismatch for conv1.weight:\
    \ copying a param with shape torch.Size([64, 3, 3, 3]) from checkpoint, the shape\
    \ in current model is torch.Size([64, 3, 7, 7]).\r\n```"
  created_at: 2023-04-16 15:22:52+00:00
  edited: false
  hidden: false
  id: 643c20dc26f177a3e41726d1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670087621682-638b80f9b0cc3ae137c44899.jpeg?w=200&h=200&f=face
      fullname: Eduardo Dadalto
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: edadaltocg
      type: user
    createdAt: '2023-04-17T10:28:53.000Z'
    data:
      edited: true
      editors:
      - edadaltocg
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670087621682-638b80f9b0cc3ae137c44899.jpeg?w=200&h=200&f=face
          fullname: Eduardo Dadalto
          isHf: false
          isPro: false
          name: edadaltocg
          type: user
        html: "<p>Hello <span data-props=\"{&quot;user&quot;:&quot;kashif&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/kashif\"\
          >@<span class=\"underline\">kashif</span></a></span>\n\n\t</span></span>,</p>\n\
          <p>I'm working on something to solve this.<br>In the meanwhile, I invite\
          \ you to load the model weights in the following manner:</p>\n<pre><code\
          \ class=\"language-python\">model = timm.create_model(<span class=\"hljs-string\"\
          >\"resnet18\"</span>, pretrained=<span class=\"hljs-literal\">False</span>)\n\
          \n<span class=\"hljs-comment\"># override model</span>\nmodel.conv1 = nn.Conv2d(<span\
          \ class=\"hljs-number\">3</span>, <span class=\"hljs-number\">64</span>,\
          \ kernel_size=(<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\"\
          >3</span>), stride=(<span class=\"hljs-number\">1</span>, <span class=\"\
          hljs-number\">1</span>), padding=(<span class=\"hljs-number\">1</span>,\
          \ <span class=\"hljs-number\">1</span>), bias=<span class=\"hljs-literal\"\
          >False</span>)\nmodel.maxpool = nn.Identity()  <span class=\"hljs-comment\"\
          ># type: ignore</span>\nmodel.fc = nn.Linear(<span class=\"hljs-number\"\
          >512</span>,  <span class=\"hljs-number\">10</span>)\n\nmodel.load_state_dict(\n\
          \            torch.hub.load_state_dict_from_url(\n                     \
          \ <span class=\"hljs-string\">\"https://huggingface.co/edadaltocg/resnet18_cifar10/resolve/main/pytorch_model.bin\"\
          </span>,\n                       map_location=<span class=\"hljs-string\"\
          >\"cpu\"</span>, \n                       file_name=<span class=\"hljs-string\"\
          >\"resnet18_cifar10.pth\"</span>,\n             )\n)\n</code></pre>\n<p>EDIT:\
          \ remove <code>features_dim</code> variable and replaced with 512 following\
          \ <span data-props=\"{&quot;user&quot;:&quot;j35t3r&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/j35t3r\">@<span class=\"\
          underline\">j35t3r</span></a></span>\n\n\t</span></span> comment.</p>\n"
        raw: "Hello @kashif,\n\nI'm working on something to solve this. \nIn the meanwhile,\
          \ I invite you to load the model weights in the following manner:\n\n```python\n\
          model = timm.create_model(\"resnet18\", pretrained=False)\n\n# override\
          \ model\nmodel.conv1 = nn.Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1),\
          \ padding=(1, 1), bias=False)\nmodel.maxpool = nn.Identity()  # type: ignore\n\
          model.fc = nn.Linear(512,  10)\n\nmodel.load_state_dict(\n            torch.hub.load_state_dict_from_url(\n\
          \                      \"https://huggingface.co/edadaltocg/resnet18_cifar10/resolve/main/pytorch_model.bin\"\
          ,\n                       map_location=\"cpu\", \n                     \
          \  file_name=\"resnet18_cifar10.pth\",\n             )\n)\n```\n\nEDIT:\
          \ remove `features_dim` variable and replaced with 512 following @j35t3r\
          \ comment."
        updatedAt: '2023-05-08T10:40:05.319Z'
      numEdits: 1
      reactions: []
    id: 643d1f65455be6574c82b093
    type: comment
  author: edadaltocg
  content: "Hello @kashif,\n\nI'm working on something to solve this. \nIn the meanwhile,\
    \ I invite you to load the model weights in the following manner:\n\n```python\n\
    model = timm.create_model(\"resnet18\", pretrained=False)\n\n# override model\n\
    model.conv1 = nn.Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1,\
    \ 1), bias=False)\nmodel.maxpool = nn.Identity()  # type: ignore\nmodel.fc = nn.Linear(512,\
    \  10)\n\nmodel.load_state_dict(\n            torch.hub.load_state_dict_from_url(\n\
    \                      \"https://huggingface.co/edadaltocg/resnet18_cifar10/resolve/main/pytorch_model.bin\"\
    ,\n                       map_location=\"cpu\", \n                       file_name=\"\
    resnet18_cifar10.pth\",\n             )\n)\n```\n\nEDIT: remove `features_dim`\
    \ variable and replaced with 512 following @j35t3r comment."
  created_at: 2023-04-17 09:28:53+00:00
  edited: true
  hidden: false
  id: 643d1f65455be6574c82b093
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1669189789447-629f3b18ee05727ce328ccbe.jpeg?w=200&h=200&f=face
      fullname: Kashif Rasul
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kashif
      type: user
    createdAt: '2023-04-17T10:43:27.000Z'
    data:
      edited: false
      editors:
      - kashif
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1669189789447-629f3b18ee05727ce328ccbe.jpeg?w=200&h=200&f=face
          fullname: Kashif Rasul
          isHf: true
          isPro: false
          name: kashif
          type: user
        html: '<p>ok cool! thanks! looking forward!</p>

          '
        raw: ok cool! thanks! looking forward!
        updatedAt: '2023-04-17T10:43:27.920Z'
      numEdits: 0
      reactions: []
    id: 643d22cf7ede13bc7b55b314
    type: comment
  author: kashif
  content: ok cool! thanks! looking forward!
  created_at: 2023-04-17 09:43:27+00:00
  edited: false
  hidden: false
  id: 643d22cf7ede13bc7b55b314
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4d0b9d0d58ab3cb7097fe714a5377a7d.svg
      fullname: Peter Lorenz
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: j35t3r
      type: user
    createdAt: '2023-05-07T19:50:53.000Z'
    data:
      edited: true
      editors:
      - j35t3r
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4d0b9d0d58ab3cb7097fe714a5377a7d.svg
          fullname: Peter Lorenz
          isHf: false
          isPro: false
          name: j35t3r
          type: user
        html: '<p>the variable features_dim is not defined. I chose 512, which I read
          from the model.</p>

          <p>Or just: add num classes. and delte the line above.<br> model = timm.create_model("resnet18",
          num_classes=10, pretrained=False)</p>

          '
        raw: "the variable features_dim is not defined. I chose 512, which I read\
          \ from the model.\n\nOr just: add num classes. and delte the line above.\n\
          \ model = timm.create_model(\"resnet18\", num_classes=10, pretrained=False)"
        updatedAt: '2023-05-07T19:59:28.110Z'
      numEdits: 2
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - edadaltocg
    id: 6458011d116c6b3c62e2144e
    type: comment
  author: j35t3r
  content: "the variable features_dim is not defined. I chose 512, which I read from\
    \ the model.\n\nOr just: add num classes. and delte the line above.\n model =\
    \ timm.create_model(\"resnet18\", num_classes=10, pretrained=False)"
  created_at: 2023-05-07 18:50:53+00:00
  edited: true
  hidden: false
  id: 6458011d116c6b3c62e2144e
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: edadaltocg/resnet18_cifar10
repo_type: model
status: open
target_branch: null
title: RuntimeError
