!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ibrim
conflicting_files: null
created_at: 2023-06-21 05:48:18+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6ce3bd48dea8f39daa70ad116d092b04.svg
      fullname: ibru
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ibrim
      type: user
    createdAt: '2023-06-21T06:48:18.000Z'
    data:
      edited: false
      editors:
      - ibrim
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7835674285888672
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6ce3bd48dea8f39daa70ad116d092b04.svg
          fullname: ibru
          isHf: false
          isPro: false
          name: ibrim
          type: user
        html: '<p>I''m using a DGX a100 machine with multiple GPUs of 80GB each but
          keep getting the following error:-</p>

          <p>return t.to(device, dtype if t.is_floating_point() or t.is_complex()
          else None, non_blocking)<br>torch.cuda.OutOfMemoryError: CUDA out of memory.
          Tried to allocate 1024.00 MiB (GPU 1; 79.35 GiB total capacity; 75.93 GiB
          already allocated; 1.86 GiB free; 75.93 GiB reserved in total by PyTorch)
          If reserved memory is &gt;&gt; allocated memory try setting max_split_size_mb
          to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF</p>

          <p>I''ve tried reducing batch_size, setting cuda_visible_devices to all
          the gpus and also tried dataparallel but nothing works.</p>

          '
        raw: "I'm using a DGX a100 machine with multiple GPUs of 80GB each but keep\
          \ getting the following error:-\r\n\r\nreturn t.to(device, dtype if t.is_floating_point()\
          \ or t.is_complex() else None, non_blocking)\r\ntorch.cuda.OutOfMemoryError:\
          \ CUDA out of memory. Tried to allocate 1024.00 MiB (GPU 1; 79.35 GiB total\
          \ capacity; 75.93 GiB already allocated; 1.86 GiB free; 75.93 GiB reserved\
          \ in total by PyTorch) If reserved memory is >> allocated memory try setting\
          \ max_split_size_mb to avoid fragmentation.  See documentation for Memory\
          \ Management and PYTORCH_CUDA_ALLOC_CONF\r\n\r\nI've tried reducing batch_size,\
          \ setting cuda_visible_devices to all the gpus and also tried dataparallel\
          \ but nothing works."
        updatedAt: '2023-06-21T06:48:18.988Z'
      numEdits: 0
      reactions: []
    id: 64929d320489aff17d08f2c4
    type: comment
  author: ibrim
  content: "I'm using a DGX a100 machine with multiple GPUs of 80GB each but keep\
    \ getting the following error:-\r\n\r\nreturn t.to(device, dtype if t.is_floating_point()\
    \ or t.is_complex() else None, non_blocking)\r\ntorch.cuda.OutOfMemoryError: CUDA\
    \ out of memory. Tried to allocate 1024.00 MiB (GPU 1; 79.35 GiB total capacity;\
    \ 75.93 GiB already allocated; 1.86 GiB free; 75.93 GiB reserved in total by PyTorch)\
    \ If reserved memory is >> allocated memory try setting max_split_size_mb to avoid\
    \ fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF\r\
    \n\r\nI've tried reducing batch_size, setting cuda_visible_devices to all the\
    \ gpus and also tried dataparallel but nothing works."
  created_at: 2023-06-21 05:48:18+00:00
  edited: false
  hidden: false
  id: 64929d320489aff17d08f2c4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6ce3bd48dea8f39daa70ad116d092b04.svg
      fullname: ibru
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ibrim
      type: user
    createdAt: '2023-06-21T06:49:04.000Z'
    data:
      edited: false
      editors:
      - ibrim
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.37354713678359985
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6ce3bd48dea8f39daa70ad116d092b04.svg
          fullname: ibru
          isHf: false
          isPro: false
          name: ibrim
          type: user
        html: '<p>+-----------------------------------------------------------------------------+<br>|
          NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |<br>|-------------------------------+----------------------+----------------------+<br>|
          GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr.
          ECC |<br>| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute
          M. |<br>|                               |                      |               MIG
          M. |<br>|===============================+======================+======================|<br>|   0  Graphics
          Device     On   | 00000000:01:00.0 Off |                    0 |<br>| N/A   50C    P0    68W
          / 275W |   7095MiB / 81252MiB |      0%      Default |<br>|                               |                      |             Disabled
          |<br>+-------------------------------+----------------------+----------------------+<br>|   1  Graphics
          Device     On   | 00000000:47:00.0 Off |                    0 |<br>| N/A   51C    P0    72W
          / 275W |    535MiB / 81252MiB |      0%      Default |<br>|                               |                      |             Disabled
          |<br>+-------------------------------+----------------------+----------------------+<br>|   2  Graphics
          Device     On   | 00000000:81:00.0 Off |                    0 |<br>| N/A   50C    P0    69W
          / 275W |   2131MiB / 81252MiB |      0%      Default |<br>|                               |                      |             Disabled
          |<br>+-------------------------------+----------------------+----------------------+<br>|   3  DGX
          Display         On   | 00000000:C1:00.0 Off |                  N/A |<br>|
          35%   47C    P8    N/A /  50W |      1MiB /  3911MiB |      0%      Default
          |<br>|                               |                      |                  N/A
          |<br>+-------------------------------+----------------------+----------------------+<br>|   4  Graphics
          Device     On   | 00000000:C2:00.0 Off |                    0 |<br>| N/A   49C    P0    65W
          / 275W |      3MiB / 81252MiB |      0%      Default |<br>|                               |                      |             Disabled
          |<br>+-------------------------------+----------------------+----------------------+</p>

          <p>GPU details</p>

          '
        raw: '+-----------------------------------------------------------------------------+

          | NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |

          |-------------------------------+----------------------+----------------------+

          | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr.
          ECC |

          | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute
          M. |

          |                               |                      |               MIG
          M. |

          |===============================+======================+======================|

          |   0  Graphics Device     On   | 00000000:01:00.0 Off |                    0
          |

          | N/A   50C    P0    68W / 275W |   7095MiB / 81252MiB |      0%      Default
          |

          |                               |                      |             Disabled
          |

          +-------------------------------+----------------------+----------------------+

          |   1  Graphics Device     On   | 00000000:47:00.0 Off |                    0
          |

          | N/A   51C    P0    72W / 275W |    535MiB / 81252MiB |      0%      Default
          |

          |                               |                      |             Disabled
          |

          +-------------------------------+----------------------+----------------------+

          |   2  Graphics Device     On   | 00000000:81:00.0 Off |                    0
          |

          | N/A   50C    P0    69W / 275W |   2131MiB / 81252MiB |      0%      Default
          |

          |                               |                      |             Disabled
          |

          +-------------------------------+----------------------+----------------------+

          |   3  DGX Display         On   | 00000000:C1:00.0 Off |                  N/A
          |

          | 35%   47C    P8    N/A /  50W |      1MiB /  3911MiB |      0%      Default
          |

          |                               |                      |                  N/A
          |

          +-------------------------------+----------------------+----------------------+

          |   4  Graphics Device     On   | 00000000:C2:00.0 Off |                    0
          |

          | N/A   49C    P0    65W / 275W |      3MiB / 81252MiB |      0%      Default
          |

          |                               |                      |             Disabled
          |

          +-------------------------------+----------------------+----------------------+


          GPU details'
        updatedAt: '2023-06-21T06:49:04.563Z'
      numEdits: 0
      reactions: []
    id: 64929d6043ca852213c72424
    type: comment
  author: ibrim
  content: '+-----------------------------------------------------------------------------+

    | NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |

    |-------------------------------+----------------------+----------------------+

    | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC
    |

    | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M.
    |

    |                               |                      |               MIG M.
    |

    |===============================+======================+======================|

    |   0  Graphics Device     On   | 00000000:01:00.0 Off |                    0
    |

    | N/A   50C    P0    68W / 275W |   7095MiB / 81252MiB |      0%      Default
    |

    |                               |                      |             Disabled
    |

    +-------------------------------+----------------------+----------------------+

    |   1  Graphics Device     On   | 00000000:47:00.0 Off |                    0
    |

    | N/A   51C    P0    72W / 275W |    535MiB / 81252MiB |      0%      Default
    |

    |                               |                      |             Disabled
    |

    +-------------------------------+----------------------+----------------------+

    |   2  Graphics Device     On   | 00000000:81:00.0 Off |                    0
    |

    | N/A   50C    P0    69W / 275W |   2131MiB / 81252MiB |      0%      Default
    |

    |                               |                      |             Disabled
    |

    +-------------------------------+----------------------+----------------------+

    |   3  DGX Display         On   | 00000000:C1:00.0 Off |                  N/A
    |

    | 35%   47C    P8    N/A /  50W |      1MiB /  3911MiB |      0%      Default
    |

    |                               |                      |                  N/A
    |

    +-------------------------------+----------------------+----------------------+

    |   4  Graphics Device     On   | 00000000:C2:00.0 Off |                    0
    |

    | N/A   49C    P0    65W / 275W |      3MiB / 81252MiB |      0%      Default
    |

    |                               |                      |             Disabled
    |

    +-------------------------------+----------------------+----------------------+


    GPU details'
  created_at: 2023-06-21 05:49:04+00:00
  edited: false
  hidden: false
  id: 64929d6043ca852213c72424
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6ee14306e6081690907b03c6aabb6d80.svg
      fullname: Mubarak Alketbi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mubarak-alketbi
      type: user
    createdAt: '2023-07-02T08:22:19.000Z'
    data:
      edited: false
      editors:
      - mubarak-alketbi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9093127250671387
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6ee14306e6081690907b03c6aabb6d80.svg
          fullname: Mubarak Alketbi
          isHf: false
          isPro: false
          name: mubarak-alketbi
          type: user
        html: '<p>test with batch size 1<br>make sure your max sequence length is
          2048</p>

          '
        raw: 'test with batch size 1

          make sure your max sequence length is 2048'
        updatedAt: '2023-07-02T08:22:19.987Z'
      numEdits: 0
      reactions: []
    id: 64a133bb4d55bc91b1c068e7
    type: comment
  author: mubarak-alketbi
  content: 'test with batch size 1

    make sure your max sequence length is 2048'
  created_at: 2023-07-02 07:22:19+00:00
  edited: false
  hidden: false
  id: 64a133bb4d55bc91b1c068e7
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 67
repo_id: tiiuae/falcon-40b
repo_type: model
status: open
target_branch: null
title: Cuda out of memory error.
