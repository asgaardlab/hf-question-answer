!!python/object:huggingface_hub.community.DiscussionWithDetails
author: anujn
conflicting_files: null
created_at: 2023-06-29 02:21:04+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/cceab4911ed10b20d233f32783392885.svg
      fullname: Anuj Nayyar
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: anujn
      type: user
    createdAt: '2023-06-29T03:21:04.000Z'
    data:
      edited: false
      editors:
      - anujn
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9061699509620667
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/cceab4911ed10b20d233f32783392885.svg
          fullname: Anuj Nayyar
          isHf: false
          isPro: false
          name: anujn
          type: user
        html: '<p>Hey Michael, first thank you for all your converted models and HF
          hub tool. Both are super super helpful!!</p>

          <p>I have been trying to convert the following model to CT2 for inference
          "ehartford/WizardLM-13B-V1.0-Uncensored"</p>

          <p>I keep hitting vocab size difference errors. I think it may be because
          CT2 is adding an unk token? Not sure very new to CT2! </p>

          <p>Just wondered if you could point me in the right direction or give me
          steps how to convert this particular model to CT2 for inf. </p>

          <p>Thanks again!</p>

          <p>Anuj</p>

          '
        raw: "Hey Michael, first thank you for all your converted models and HF hub\
          \ tool. Both are super super helpful!!\r\n\r\nI have been trying to convert\
          \ the following model to CT2 for inference \"ehartford/WizardLM-13B-V1.0-Uncensored\"\
          \r\n\r\nI keep hitting vocab size difference errors. I think it may be because\
          \ CT2 is adding an unk token? Not sure very new to CT2! \r\n\r\nJust wondered\
          \ if you could point me in the right direction or give me steps how to convert\
          \ this particular model to CT2 for inf. \r\n\r\nThanks again!\r\n\r\nAnuj"
        updatedAt: '2023-06-29T03:21:04.927Z'
      numEdits: 0
      reactions: []
    id: 649cf8a0f9606599958d2808
    type: comment
  author: anujn
  content: "Hey Michael, first thank you for all your converted models and HF hub\
    \ tool. Both are super super helpful!!\r\n\r\nI have been trying to convert the\
    \ following model to CT2 for inference \"ehartford/WizardLM-13B-V1.0-Uncensored\"\
    \r\n\r\nI keep hitting vocab size difference errors. I think it may be because\
    \ CT2 is adding an unk token? Not sure very new to CT2! \r\n\r\nJust wondered\
    \ if you could point me in the right direction or give me steps how to convert\
    \ this particular model to CT2 for inf. \r\n\r\nThanks again!\r\n\r\nAnuj"
  created_at: 2023-06-29 02:21:04+00:00
  edited: false
  hidden: false
  id: 649cf8a0f9606599958d2808
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-30T12:04:36.000Z'
    data:
      edited: true
      editors:
      - michaelfeil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9013975262641907
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
          fullname: Michael
          isHf: false
          isPro: false
          name: michaelfeil
          type: user
        html: "<p>Please open a Issue at CTranslate2 :) <a rel=\"nofollow\" href=\"\
          https://github.com/OpenNMT/CTranslate2/blob/9885fad95f8ce24809d1ab64b418ac9f99c75562/python/ctranslate2/converters/transformers.py#L1182\"\
          >https://github.com/OpenNMT/CTranslate2/blob/9885fad95f8ce24809d1ab64b418ac9f99c75562/python/ctranslate2/converters/transformers.py#L1182</a></p>\n\
          <p>You might be able to add:</p>\n<pre><code class=\"language-python\">\
          \    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\"\
          >get_vocabulary</span>(<span class=\"hljs-params\">self, model, tokenizer</span>):\n\
          \        tokens = <span class=\"hljs-built_in\">super</span>().get_vocabulary(model,\
          \ tokenizer)\n\n        extra_ids = model.config.vocab_size - <span class=\"\
          hljs-built_in\">len</span>(tokens)\n        <span class=\"hljs-keyword\"\
          >for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\"\
          >range</span>(extra_ids):\n            <span class=\"hljs-comment\"># fix\
          \ for additional vocab, see GPTNeoX Converter</span>\n            tokens.append(<span\
          \ class=\"hljs-string\">\"&lt;extra_id_%d&gt;\"</span> % i)\n\n        <span\
          \ class=\"hljs-keyword\">return</span> tokens\n</code></pre>\n"
        raw: "Please open a Issue at CTranslate2 :) https://github.com/OpenNMT/CTranslate2/blob/9885fad95f8ce24809d1ab64b418ac9f99c75562/python/ctranslate2/converters/transformers.py#L1182\n\
          \nYou might be able to add:\n```python\n    def get_vocabulary(self, model,\
          \ tokenizer):\n        tokens = super().get_vocabulary(model, tokenizer)\n\
          \n        extra_ids = model.config.vocab_size - len(tokens)\n        for\
          \ i in range(extra_ids):\n            # fix for additional vocab, see GPTNeoX\
          \ Converter\n            tokens.append(\"<extra_id_%d>\" % i)\n\n      \
          \  return tokens\n```"
        updatedAt: '2023-06-30T12:11:11.544Z'
      numEdits: 2
      reactions: []
      relatedEventId: 649ec4d41b8a453e89a4b4db
    id: 649ec4d41b8a453e89a4b4d9
    type: comment
  author: michaelfeil
  content: "Please open a Issue at CTranslate2 :) https://github.com/OpenNMT/CTranslate2/blob/9885fad95f8ce24809d1ab64b418ac9f99c75562/python/ctranslate2/converters/transformers.py#L1182\n\
    \nYou might be able to add:\n```python\n    def get_vocabulary(self, model, tokenizer):\n\
    \        tokens = super().get_vocabulary(model, tokenizer)\n\n        extra_ids\
    \ = model.config.vocab_size - len(tokens)\n        for i in range(extra_ids):\n\
    \            # fix for additional vocab, see GPTNeoX Converter\n            tokens.append(\"\
    <extra_id_%d>\" % i)\n\n        return tokens\n```"
  created_at: 2023-06-30 11:04:36+00:00
  edited: true
  hidden: false
  id: 649ec4d41b8a453e89a4b4d9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-30T12:04:36.000Z'
    data:
      status: closed
    id: 649ec4d41b8a453e89a4b4db
    type: status-change
  author: michaelfeil
  created_at: 2023-06-30 11:04:36+00:00
  id: 649ec4d41b8a453e89a4b4db
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: michaelfeil/ct2fast-open-llama-13b-open-instruct
repo_type: model
status: closed
target_branch: null
title: How to convert without hitting tokeniser errors?
