!!python/object:huggingface_hub.community.DiscussionWithDetails
author: BwShen
conflicting_files: null
created_at: 2023-08-18 02:27:21+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e9226269e528ccaac191df011161e402.svg
      fullname: Bowen Shen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: BwShen
      type: user
    createdAt: '2023-08-18T03:27:21.000Z'
    data:
      edited: true
      editors:
      - BwShen
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8945064544677734
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e9226269e528ccaac191df011161e402.svg
          fullname: Bowen Shen
          isHf: false
          isPro: false
          name: BwShen
          type: user
        html: '<p>Sometimes I have to use <code>torch.load()</code> to load model
          params without huggingface package. However, the param names are not the
          desired ones, e.g., <code>h.23.mlp.dense_4h_to_h.weight</code> which should
          be <code>transformer.h.23.mlp.dense_4h_to_h.weight</code>, and <code>lm_head.weight</code>
          does not exist.<br>I guess it is related to <a href="/bigscience/bloomz-1b1/discussions/5">#5</a>
          and <a href="/bigscience/bloomz-1b1/discussions/6">#6</a> where the model
          architecture is changed, but the params are still <code>BloomModel</code>
          instead of <code>BloomForCausalLM</code></p>

          '
        raw: 'Sometimes I have to use `torch.load()` to load model params without
          huggingface package. However, the param names are not the desired ones,
          e.g., `h.23.mlp.dense_4h_to_h.weight` which should be `transformer.h.23.mlp.dense_4h_to_h.weight`,
          and `lm_head.weight` does not exist.

          I guess it is related to #5 and #6 where the model architecture is changed,
          but the params are still `BloomModel` instead of `BloomForCausalLM`'
        updatedAt: '2023-08-18T03:28:37.754Z'
      numEdits: 1
      reactions: []
    id: 64dee519931a8e1c2c7e1a9e
    type: comment
  author: BwShen
  content: 'Sometimes I have to use `torch.load()` to load model params without huggingface
    package. However, the param names are not the desired ones, e.g., `h.23.mlp.dense_4h_to_h.weight`
    which should be `transformer.h.23.mlp.dense_4h_to_h.weight`, and `lm_head.weight`
    does not exist.

    I guess it is related to #5 and #6 where the model architecture is changed, but
    the params are still `BloomModel` instead of `BloomForCausalLM`'
  created_at: 2023-08-18 02:27:21+00:00
  edited: true
  hidden: false
  id: 64dee519931a8e1c2c7e1a9e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1659799717718-5f1eb362eec0ad2a071ad6e2.jpeg?w=200&h=200&f=face
      fullname: Niklas Muennighoff
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: Muennighoff
      type: user
    createdAt: '2023-08-18T07:10:23.000Z'
    data:
      edited: false
      editors:
      - Muennighoff
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8412374258041382
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1659799717718-5f1eb362eec0ad2a071ad6e2.jpeg?w=200&h=200&f=face
          fullname: Niklas Muennighoff
          isHf: false
          isPro: false
          name: Muennighoff
          type: user
        html: "<p>Thanks for noting \U0001F9D0 Maybe <span data-props=\"{&quot;user&quot;:&quot;lewtun&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/lewtun\"\
          >@<span class=\"underline\">lewtun</span></a></span>\n\n\t</span></span>\
          \ knows what the problem is? Should we change it back to <code>BloomForCausalLM</code>?</p>\n"
        raw: "Thanks for noting \U0001F9D0 Maybe @lewtun knows what the problem is?\
          \ Should we change it back to `BloomForCausalLM`?"
        updatedAt: '2023-08-18T07:10:23.047Z'
      numEdits: 0
      reactions: []
    id: 64df195f808492ba6e890eb8
    type: comment
  author: Muennighoff
  content: "Thanks for noting \U0001F9D0 Maybe @lewtun knows what the problem is?\
    \ Should we change it back to `BloomForCausalLM`?"
  created_at: 2023-08-18 06:10:23+00:00
  edited: false
  hidden: false
  id: 64df195f808492ba6e890eb8
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 9
repo_id: bigscience/bloomz-1b1
repo_type: model
status: open
target_branch: null
title: wrong param name when using torch.load()
