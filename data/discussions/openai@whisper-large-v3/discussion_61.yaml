!!python/object:huggingface_hub.community.DiscussionWithDetails
author: stvnchnsn
conflicting_files: null
created_at: 2023-12-28 20:09:42+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6444538d3c323e0918f96027/9cDvqJxgvxWCwLVk1_OnG.jpeg?w=200&h=200&f=face
      fullname: Steven Hansen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: stvnchnsn
      type: user
    createdAt: '2023-12-28T20:09:42.000Z'
    data:
      edited: false
      editors:
      - stvnchnsn
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6471744775772095
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6444538d3c323e0918f96027/9cDvqJxgvxWCwLVk1_OnG.jpeg?w=200&h=200&f=face
          fullname: Steven Hansen
          isHf: false
          isPro: false
          name: stvnchnsn
          type: user
        html: "<p>I'm trying to translate audio that is in english to spanish text\
          \ using the code listed below.  No errors occur but the text is in english\
          \ with no translation performed.  Any clues?</p>\n<pre><code>model_id =\
          \ \"openai/whisper-large-v3\"\n\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\n\
          \    model_id, torch_dtype=torch_dtype, low_cpu_mem_usage=True, use_safetensors=True\n\
          )\nmodel.to(device)\n\nprocessor = AutoProcessor.from_pretrained(model_id)\n\
          \ntranslate_pipe = pipeline(\n    \"automatic-speech-recognition\",\n  \
          \  model=model,\n    tokenizer=processor.tokenizer,\n    feature_extractor=processor.feature_extractor,\n\
          \    max_new_tokens=128,\n    chunk_length_s=30,\n    batch_size=1,\n  \
          \  torch_dtype=torch_dtype,\n    device=device,\n    return_timestamps=True,\n\
          \    generate_kwargs={\"language\": \"spanish\", \"task\": \"translate\"\
          }\n)\n</code></pre>\n"
        raw: "I'm trying to translate audio that is in english to spanish text using\
          \ the code listed below.  No errors occur but the text is in english with\
          \ no translation performed.  Any clues?\r\n\r\n```\r\nmodel_id = \"openai/whisper-large-v3\"\
          \r\n\r\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\r\n    model_id,\
          \ torch_dtype=torch_dtype, low_cpu_mem_usage=True, use_safetensors=True\r\
          \n)\r\nmodel.to(device)\r\n\r\nprocessor = AutoProcessor.from_pretrained(model_id)\r\
          \n\r\ntranslate_pipe = pipeline(\r\n    \"automatic-speech-recognition\"\
          ,\r\n    model=model,\r\n    tokenizer=processor.tokenizer,\r\n    feature_extractor=processor.feature_extractor,\r\
          \n    max_new_tokens=128,\r\n    chunk_length_s=30,\r\n    batch_size=1,\r\
          \n    torch_dtype=torch_dtype,\r\n    device=device,\r\n    return_timestamps=True,\r\
          \n    generate_kwargs={\"language\": \"spanish\", \"task\": \"translate\"\
          }\r\n)\r\n```"
        updatedAt: '2023-12-28T20:09:42.168Z'
      numEdits: 0
      reactions: []
    id: 658dd60650d39af7f49386bc
    type: comment
  author: stvnchnsn
  content: "I'm trying to translate audio that is in english to spanish text using\
    \ the code listed below.  No errors occur but the text is in english with no translation\
    \ performed.  Any clues?\r\n\r\n```\r\nmodel_id = \"openai/whisper-large-v3\"\r\
    \n\r\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\r\n    model_id, torch_dtype=torch_dtype,\
    \ low_cpu_mem_usage=True, use_safetensors=True\r\n)\r\nmodel.to(device)\r\n\r\n\
    processor = AutoProcessor.from_pretrained(model_id)\r\n\r\ntranslate_pipe = pipeline(\r\
    \n    \"automatic-speech-recognition\",\r\n    model=model,\r\n    tokenizer=processor.tokenizer,\r\
    \n    feature_extractor=processor.feature_extractor,\r\n    max_new_tokens=128,\r\
    \n    chunk_length_s=30,\r\n    batch_size=1,\r\n    torch_dtype=torch_dtype,\r\
    \n    device=device,\r\n    return_timestamps=True,\r\n    generate_kwargs={\"\
    language\": \"spanish\", \"task\": \"translate\"}\r\n)\r\n```"
  created_at: 2023-12-28 20:09:42+00:00
  edited: false
  hidden: false
  id: 658dd60650d39af7f49386bc
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/abe56176a8cfd3758de283e1206c5e28.svg
      fullname: Mathieu Bsqt
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: MathieuBsqt
      type: user
    createdAt: '2024-01-11T09:10:43.000Z'
    data:
      edited: false
      editors:
      - MathieuBsqt
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6201155185699463
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/abe56176a8cfd3758de283e1206c5e28.svg
          fullname: Mathieu Bsqt
          isHf: false
          isPro: false
          name: MathieuBsqt
          type: user
        html: '<p>"language" parameter is used to indicate the spoken language in
          the audio.<br>The "translate" parameter indicates that the speech must be
          translated into English. </p>

          '
        raw: "\"language\" parameter is used to indicate the spoken language in the\
          \ audio. \nThe \"translate\" parameter indicates that the speech must be\
          \ translated into English. "
        updatedAt: '2024-01-11T09:10:43.123Z'
      numEdits: 0
      reactions: []
    id: 659fb093e06dc8fc0e530881
    type: comment
  author: MathieuBsqt
  content: "\"language\" parameter is used to indicate the spoken language in the\
    \ audio. \nThe \"translate\" parameter indicates that the speech must be translated\
    \ into English. "
  created_at: 2024-01-11 09:10:43+00:00
  edited: false
  hidden: false
  id: 659fb093e06dc8fc0e530881
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2024-01-11T13:45:00.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7877793908119202
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: "<p>Whisper was trained on speech recognition (audio in X -&gt; text\
          \ in X) and speech translation to English (audio in X -&gt; text in En)</p>\n\
          <p>You can also 'trick' it into performing more general speech translation\
          \ (audio in X -&gt; text in Y) with reasonable results, but not as good\
          \ as the trained tasks. You just need to set the language to your target\
          \ language, and the task to <code>\"transcribe\"</code>:</p>\n<pre><code\
          \ class=\"language-python\">model_id = <span class=\"hljs-string\">\"openai/whisper-large-v3\"\
          </span>\n\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\n    model_id,\
          \ torch_dtype=torch_dtype, low_cpu_mem_usage=<span class=\"hljs-literal\"\
          >True</span>, use_safetensors=<span class=\"hljs-literal\">True</span>\n\
          )\nmodel.to(device)\n\nprocessor = AutoProcessor.from_pretrained(model_id)\n\
          \ntranslate_pipe = pipeline(\n    <span class=\"hljs-string\">\"automatic-speech-recognition\"\
          </span>,\n    model=model,\n    tokenizer=processor.tokenizer,\n    feature_extractor=processor.feature_extractor,\n\
          \    max_new_tokens=<span class=\"hljs-number\">128</span>,\n    chunk_length_s=<span\
          \ class=\"hljs-number\">30</span>,\n    batch_size=<span class=\"hljs-number\"\
          >1</span>,\n    torch_dtype=torch_dtype,\n    device=device,\n    return_timestamps=<span\
          \ class=\"hljs-literal\">True</span>,\n    generate_kwargs={<span class=\"\
          hljs-string\">\"language\"</span>: <span class=\"hljs-string\">\"spanish\"\
          </span>, <span class=\"hljs-string\">\"task\"</span>: <span class=\"hljs-string\"\
          >\"transcribe\"</span>}\n)\n</code></pre>\n"
        raw: "Whisper was trained on speech recognition (audio in X -> text in X)\
          \ and speech translation to English (audio in X -> text in En)\n\nYou can\
          \ also 'trick' it into performing more general speech translation (audio\
          \ in X -> text in Y) with reasonable results, but not as good as the trained\
          \ tasks. You just need to set the language to your target language, and\
          \ the task to `\"transcribe\"`:\n\n```python\nmodel_id = \"openai/whisper-large-v3\"\
          \n\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\n    model_id, torch_dtype=torch_dtype,\
          \ low_cpu_mem_usage=True, use_safetensors=True\n)\nmodel.to(device)\n\n\
          processor = AutoProcessor.from_pretrained(model_id)\n\ntranslate_pipe =\
          \ pipeline(\n    \"automatic-speech-recognition\",\n    model=model,\n \
          \   tokenizer=processor.tokenizer,\n    feature_extractor=processor.feature_extractor,\n\
          \    max_new_tokens=128,\n    chunk_length_s=30,\n    batch_size=1,\n  \
          \  torch_dtype=torch_dtype,\n    device=device,\n    return_timestamps=True,\n\
          \    generate_kwargs={\"language\": \"spanish\", \"task\": \"transcribe\"\
          }\n)\n```"
        updatedAt: '2024-01-11T13:45:00.699Z'
      numEdits: 0
      reactions: []
    id: 659ff0dcc11c64921c553b96
    type: comment
  author: sanchit-gandhi
  content: "Whisper was trained on speech recognition (audio in X -> text in X) and\
    \ speech translation to English (audio in X -> text in En)\n\nYou can also 'trick'\
    \ it into performing more general speech translation (audio in X -> text in Y)\
    \ with reasonable results, but not as good as the trained tasks. You just need\
    \ to set the language to your target language, and the task to `\"transcribe\"\
    `:\n\n```python\nmodel_id = \"openai/whisper-large-v3\"\n\nmodel = AutoModelForSpeechSeq2Seq.from_pretrained(\n\
    \    model_id, torch_dtype=torch_dtype, low_cpu_mem_usage=True, use_safetensors=True\n\
    )\nmodel.to(device)\n\nprocessor = AutoProcessor.from_pretrained(model_id)\n\n\
    translate_pipe = pipeline(\n    \"automatic-speech-recognition\",\n    model=model,\n\
    \    tokenizer=processor.tokenizer,\n    feature_extractor=processor.feature_extractor,\n\
    \    max_new_tokens=128,\n    chunk_length_s=30,\n    batch_size=1,\n    torch_dtype=torch_dtype,\n\
    \    device=device,\n    return_timestamps=True,\n    generate_kwargs={\"language\"\
    : \"spanish\", \"task\": \"transcribe\"}\n)\n```"
  created_at: 2024-01-11 13:45:00+00:00
  edited: false
  hidden: false
  id: 659ff0dcc11c64921c553b96
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 61
repo_id: openai/whisper-large-v3
repo_type: model
status: open
target_branch: null
title: Translating English Audio Into Spanish Text
