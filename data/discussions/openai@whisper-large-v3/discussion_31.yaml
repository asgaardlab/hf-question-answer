!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Oscaarjs
conflicting_files: null
created_at: 2023-11-17 14:33:21+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674633436381-62fa62118cd542e895b833f9.png?w=200&h=200&f=face
      fullname: Oscar Johansson
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Oscaarjs
      type: user
    createdAt: '2023-11-17T14:33:21.000Z'
    data:
      edited: false
      editors:
      - Oscaarjs
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.21635061502456665
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674633436381-62fa62118cd542e895b833f9.png?w=200&h=200&f=face
          fullname: Oscar Johansson
          isHf: false
          isPro: false
          name: Oscaarjs
          type: user
        html: "<p>When setting up a whisper pipeline like this;</p>\n<pre><code>pipe\
          \ = pipeline(\n            \"automatic-speech-recognition\",\n         \
          \   model=self.model,\n            tokenizer=self.processor.tokenizer,\n\
          \            feature_extractor=self.processor.feature_extractor,\n     \
          \       torch_dtype=self.torch_dtype,\n            device=self.device,\n\
          \        )\n</code></pre>\n<p>and then calling it like this:</p>\n<pre><code>pipe(\n\
          \            file_path,\n            chunk_length_s=30,\n            batch_size=1\n\
          \            return_timestamps=\"word\",\n            return_language=True,\n\
          \        )\n</code></pre>\n<p>yields the output:</p>\n<pre><code>{'text':\
          \ \"...\", 'chunks': [{'text': ' My', 'timestamp': (0.0, 0.42)}, {'text':\
          \ ' name', 'timestamp': (0.42, 0.56)}, {'text': ' is', 'timestamp': (0.56,\
          \ 0.76)}, {'text': ' Sojdri,', 'timestamp': (0.76, 1.38)}, {'text': \" I'm\"\
          , 'timestamp': (1.38, 1.68)}, {'text': ' 12', 'timestamp': (1.68, 1.9)},\
          \ {'text': ' years', 'timestamp': (1.9, 2.14)}, {'text': ' old,', 'timestamp':\
          \ (2.14, 2.68)}, {'text': ' I', 'timestamp': (2.68, 2.82)}, {'text': ' love',\
          \ 'timestamp': (2.82, 3.04)}, {'text': ' my', 'timestamp': (3.04, 3.3)},\
          \ {'text': ' mom,', 'timestamp': (3.3, 3.8)}, {'text': ' my', 'timestamp':\
          \ (3.8, 3.9)}, {'text': ' dad,', 'timestamp': (3.9, 4.3)}, {'text': ' my',\
          \ 'timestamp': (4.3, 4.32)}, {'text': ' older', 'timestamp': (4.32, 4.6)},\
          \ {'text': ' brother,', 'timestamp': (4.6, 5.12)}, {'text': ' Ryan,', 'timestamp':\
          \ (5.12, 5.44)}, {'text': \" who's\", 'timestamp': (5.44, 5.54)}, {'text':\
          \ ' 16', 'timestamp': (5.54, 5.82)}, {'text': ' years', 'timestamp': (5.82,\
          \ 6.08)}, {'text': ' old.', 'timestamp': (6.08, 6.62)}, {'text': ' My',\
          \ 'timestamp': (6.68, 6.86)}, {'text': ' favorite', 'timestamp': (6.86,\
          \ 7.16)}, {'text': ' subject', 'timestamp': (7.16, 7.66)}, {'text': ' is',\
          \ 'timestamp': (7.66, 8.16)}, {'text': ' history,', 'timestamp': (8.16,\
          \ 9.28)}, {'text': ' and', 'timestamp': (9.28, 9.44)}, {'text': ' my', 'timestamp':\
          \ (9.44, 9.62)}, {'text': ' favorite', 'timestamp': (9.62, 9.82)}, {'text':\
          \ ' sport', 'timestamp': (9.82, 10.3)}, {'text': ' is', 'timestamp': (10.3,\
          \ 10.6)}, {'text': ' hockey.', 'timestamp': (10.6, 12.38)}]}\n</code></pre>\n\
          <p>where language is missing.</p>\n<p>But if I do:</p>\n<pre><code>pipe(\n\
          \            file_path,\n            chunk_length_s=30,\n            batch_size=1,\n\
          \            return_timestamps=True,\n            return_language=True,\n\
          \        )\n</code></pre>\n<p>I get:</p>\n<pre><code>{'text': \"...\", 'chunks':\
          \ [{'language': 'english', 'timestamp': (0.0, 6.48), 'text': \" My name\
          \ is Sojdri, I'm 12 years old, I love my mom, my dad, my older brother,\
          \ Ryan, who's 16 years old.\"}, {'language': 'english', 'timestamp': (6.48,\
          \ 11.52), 'text': ' My favorite subject is history, and my favorite sport\
          \ is hockey.'}]}\n</code></pre>\n<p>In which language is preserved</p>\n\
          <p>Is this a bug, or is it something that prevents both of them from working\
          \ at the same time?</p>\n"
        raw: "When setting up a whisper pipeline like this;\r\n\r\n```\r\npipe = pipeline(\r\
          \n            \"automatic-speech-recognition\",\r\n            model=self.model,\r\
          \n            tokenizer=self.processor.tokenizer,\r\n            feature_extractor=self.processor.feature_extractor,\r\
          \n            torch_dtype=self.torch_dtype,\r\n            device=self.device,\r\
          \n        )\r\n```\r\n\r\nand then calling it like this:\r\n\r\n```\r\n\
          pipe(\r\n            file_path,\r\n            chunk_length_s=30,\r\n  \
          \          batch_size=1\r\n            return_timestamps=\"word\",\r\n \
          \           return_language=True,\r\n        )\r\n```\r\n\r\nyields the\
          \ output:\r\n```\r\n{'text': \"...\", 'chunks': [{'text': ' My', 'timestamp':\
          \ (0.0, 0.42)}, {'text': ' name', 'timestamp': (0.42, 0.56)}, {'text': '\
          \ is', 'timestamp': (0.56, 0.76)}, {'text': ' Sojdri,', 'timestamp': (0.76,\
          \ 1.38)}, {'text': \" I'm\", 'timestamp': (1.38, 1.68)}, {'text': ' 12',\
          \ 'timestamp': (1.68, 1.9)}, {'text': ' years', 'timestamp': (1.9, 2.14)},\
          \ {'text': ' old,', 'timestamp': (2.14, 2.68)}, {'text': ' I', 'timestamp':\
          \ (2.68, 2.82)}, {'text': ' love', 'timestamp': (2.82, 3.04)}, {'text':\
          \ ' my', 'timestamp': (3.04, 3.3)}, {'text': ' mom,', 'timestamp': (3.3,\
          \ 3.8)}, {'text': ' my', 'timestamp': (3.8, 3.9)}, {'text': ' dad,', 'timestamp':\
          \ (3.9, 4.3)}, {'text': ' my', 'timestamp': (4.3, 4.32)}, {'text': ' older',\
          \ 'timestamp': (4.32, 4.6)}, {'text': ' brother,', 'timestamp': (4.6, 5.12)},\
          \ {'text': ' Ryan,', 'timestamp': (5.12, 5.44)}, {'text': \" who's\", 'timestamp':\
          \ (5.44, 5.54)}, {'text': ' 16', 'timestamp': (5.54, 5.82)}, {'text': '\
          \ years', 'timestamp': (5.82, 6.08)}, {'text': ' old.', 'timestamp': (6.08,\
          \ 6.62)}, {'text': ' My', 'timestamp': (6.68, 6.86)}, {'text': ' favorite',\
          \ 'timestamp': (6.86, 7.16)}, {'text': ' subject', 'timestamp': (7.16, 7.66)},\
          \ {'text': ' is', 'timestamp': (7.66, 8.16)}, {'text': ' history,', 'timestamp':\
          \ (8.16, 9.28)}, {'text': ' and', 'timestamp': (9.28, 9.44)}, {'text': '\
          \ my', 'timestamp': (9.44, 9.62)}, {'text': ' favorite', 'timestamp': (9.62,\
          \ 9.82)}, {'text': ' sport', 'timestamp': (9.82, 10.3)}, {'text': ' is',\
          \ 'timestamp': (10.3, 10.6)}, {'text': ' hockey.', 'timestamp': (10.6, 12.38)}]}\r\
          \n```\r\nwhere language is missing.\r\n\r\n\r\nBut if I do:\r\n```\r\npipe(\r\
          \n            file_path,\r\n            chunk_length_s=30,\r\n         \
          \   batch_size=1,\r\n            return_timestamps=True,\r\n           \
          \ return_language=True,\r\n        )\r\n```\r\n\r\nI get:\r\n```\r\n{'text':\
          \ \"...\", 'chunks': [{'language': 'english', 'timestamp': (0.0, 6.48),\
          \ 'text': \" My name is Sojdri, I'm 12 years old, I love my mom, my dad,\
          \ my older brother, Ryan, who's 16 years old.\"}, {'language': 'english',\
          \ 'timestamp': (6.48, 11.52), 'text': ' My favorite subject is history,\
          \ and my favorite sport is hockey.'}]}\r\n```\r\nIn which language is preserved\r\
          \n\r\nIs this a bug, or is it something that prevents both of them from\
          \ working at the same time?"
        updatedAt: '2023-11-17T14:33:21.612Z'
      numEdits: 0
      reactions: []
    id: 655779b1eeced178a68cb755
    type: comment
  author: Oscaarjs
  content: "When setting up a whisper pipeline like this;\r\n\r\n```\r\npipe = pipeline(\r\
    \n            \"automatic-speech-recognition\",\r\n            model=self.model,\r\
    \n            tokenizer=self.processor.tokenizer,\r\n            feature_extractor=self.processor.feature_extractor,\r\
    \n            torch_dtype=self.torch_dtype,\r\n            device=self.device,\r\
    \n        )\r\n```\r\n\r\nand then calling it like this:\r\n\r\n```\r\npipe(\r\
    \n            file_path,\r\n            chunk_length_s=30,\r\n            batch_size=1\r\
    \n            return_timestamps=\"word\",\r\n            return_language=True,\r\
    \n        )\r\n```\r\n\r\nyields the output:\r\n```\r\n{'text': \"...\", 'chunks':\
    \ [{'text': ' My', 'timestamp': (0.0, 0.42)}, {'text': ' name', 'timestamp': (0.42,\
    \ 0.56)}, {'text': ' is', 'timestamp': (0.56, 0.76)}, {'text': ' Sojdri,', 'timestamp':\
    \ (0.76, 1.38)}, {'text': \" I'm\", 'timestamp': (1.38, 1.68)}, {'text': ' 12',\
    \ 'timestamp': (1.68, 1.9)}, {'text': ' years', 'timestamp': (1.9, 2.14)}, {'text':\
    \ ' old,', 'timestamp': (2.14, 2.68)}, {'text': ' I', 'timestamp': (2.68, 2.82)},\
    \ {'text': ' love', 'timestamp': (2.82, 3.04)}, {'text': ' my', 'timestamp': (3.04,\
    \ 3.3)}, {'text': ' mom,', 'timestamp': (3.3, 3.8)}, {'text': ' my', 'timestamp':\
    \ (3.8, 3.9)}, {'text': ' dad,', 'timestamp': (3.9, 4.3)}, {'text': ' my', 'timestamp':\
    \ (4.3, 4.32)}, {'text': ' older', 'timestamp': (4.32, 4.6)}, {'text': ' brother,',\
    \ 'timestamp': (4.6, 5.12)}, {'text': ' Ryan,', 'timestamp': (5.12, 5.44)}, {'text':\
    \ \" who's\", 'timestamp': (5.44, 5.54)}, {'text': ' 16', 'timestamp': (5.54,\
    \ 5.82)}, {'text': ' years', 'timestamp': (5.82, 6.08)}, {'text': ' old.', 'timestamp':\
    \ (6.08, 6.62)}, {'text': ' My', 'timestamp': (6.68, 6.86)}, {'text': ' favorite',\
    \ 'timestamp': (6.86, 7.16)}, {'text': ' subject', 'timestamp': (7.16, 7.66)},\
    \ {'text': ' is', 'timestamp': (7.66, 8.16)}, {'text': ' history,', 'timestamp':\
    \ (8.16, 9.28)}, {'text': ' and', 'timestamp': (9.28, 9.44)}, {'text': ' my',\
    \ 'timestamp': (9.44, 9.62)}, {'text': ' favorite', 'timestamp': (9.62, 9.82)},\
    \ {'text': ' sport', 'timestamp': (9.82, 10.3)}, {'text': ' is', 'timestamp':\
    \ (10.3, 10.6)}, {'text': ' hockey.', 'timestamp': (10.6, 12.38)}]}\r\n```\r\n\
    where language is missing.\r\n\r\n\r\nBut if I do:\r\n```\r\npipe(\r\n       \
    \     file_path,\r\n            chunk_length_s=30,\r\n            batch_size=1,\r\
    \n            return_timestamps=True,\r\n            return_language=True,\r\n\
    \        )\r\n```\r\n\r\nI get:\r\n```\r\n{'text': \"...\", 'chunks': [{'language':\
    \ 'english', 'timestamp': (0.0, 6.48), 'text': \" My name is Sojdri, I'm 12 years\
    \ old, I love my mom, my dad, my older brother, Ryan, who's 16 years old.\"},\
    \ {'language': 'english', 'timestamp': (6.48, 11.52), 'text': ' My favorite subject\
    \ is history, and my favorite sport is hockey.'}]}\r\n```\r\nIn which language\
    \ is preserved\r\n\r\nIs this a bug, or is it something that prevents both of\
    \ them from working at the same time?"
  created_at: 2023-11-17 14:33:21+00:00
  edited: false
  hidden: false
  id: 655779b1eeced178a68cb755
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/bbfe7f8c8e7ce8b50e48a4a2164a3c2e.svg
      fullname: Jawad Mansoor
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: supercharge19
      type: user
    createdAt: '2023-12-15T06:04:55.000Z'
    data:
      edited: false
      editors:
      - supercharge19
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9829245805740356
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/bbfe7f8c8e7ce8b50e48a4a2164a3c2e.svg
          fullname: Jawad Mansoor
          isHf: false
          isPro: false
          name: supercharge19
          type: user
        html: '<p>This is a bug, but don''t know when it gets fixed. Anyway, I am
          impressed that you are just a kid and delving into this. Big hugs [:hugginface]</p>

          '
        raw: This is a bug, but don't know when it gets fixed. Anyway, I am impressed
          that you are just a kid and delving into this. Big hugs [:hugginface]
        updatedAt: '2023-12-15T06:04:55.941Z'
      numEdits: 0
      reactions: []
    id: 657bec872fc59b67788e6b41
    type: comment
  author: supercharge19
  content: This is a bug, but don't know when it gets fixed. Anyway, I am impressed
    that you are just a kid and delving into this. Big hugs [:hugginface]
  created_at: 2023-12-15 06:04:55+00:00
  edited: false
  hidden: false
  id: 657bec872fc59b67788e6b41
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/2779f76624db8fbbc1aa8cb5163c9709.svg
      fullname: James Bond
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: JamesBond007
      type: user
    createdAt: '2023-12-15T20:39:08.000Z'
    data:
      edited: false
      editors:
      - JamesBond007
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9931793212890625
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/2779f76624db8fbbc1aa8cb5163c9709.svg
          fullname: James Bond
          isHf: false
          isPro: false
          name: JamesBond007
          type: user
        html: '<p>well the bug is still there</p>

          '
        raw: well the bug is still there
        updatedAt: '2023-12-15T20:39:08.587Z'
      numEdits: 0
      reactions: []
    id: 657cb96c3480ce8aae506ca2
    type: comment
  author: JamesBond007
  content: well the bug is still there
  created_at: 2023-12-15 20:39:08+00:00
  edited: false
  hidden: false
  id: 657cb96c3480ce8aae506ca2
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 31
repo_id: openai/whisper-large-v3
repo_type: model
status: open
target_branch: null
title: Word timestamps and "return_language" at the same time
