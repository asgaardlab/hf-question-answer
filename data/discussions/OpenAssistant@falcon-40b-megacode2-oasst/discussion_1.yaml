!!python/object:huggingface_hub.community.DiscussionWithDetails
author: prannaykaul
conflicting_files: null
created_at: 2023-08-18 03:43:22+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
      fullname: Prannay Kaul
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: prannaykaul
      type: user
    createdAt: '2023-08-18T04:43:22.000Z'
    data:
      edited: false
      editors:
      - prannaykaul
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9345387816429138
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
          fullname: Prannay Kaul
          isHf: false
          isPro: false
          name: prannaykaul
          type: user
        html: '<p>I might be missing something, but there isn''t a lm_head weight
          in the model_index.json?<br>Is this intentional?</p>

          '
        raw: "I might be missing something, but there isn't a lm_head weight in the\
          \ model_index.json?\r\nIs this intentional?"
        updatedAt: '2023-08-18T04:43:22.261Z'
      numEdits: 0
      reactions: []
    id: 64def6eaf1c0da1d0bbfdd24
    type: comment
  author: prannaykaul
  content: "I might be missing something, but there isn't a lm_head weight in the\
    \ model_index.json?\r\nIs this intentional?"
  created_at: 2023-08-18 03:43:22+00:00
  edited: false
  hidden: false
  id: 64def6eaf1c0da1d0bbfdd24
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
      fullname: "Andreas K\xF6pf"
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: andreaskoepf
      type: user
    createdAt: '2023-08-18T10:47:48.000Z'
    data:
      edited: false
      editors:
      - andreaskoepf
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9578989148139954
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
          fullname: "Andreas K\xF6pf"
          isHf: false
          isPro: false
          name: andreaskoepf
          type: user
        html: '<p>This is due to the fact that safe_serialization (safetensors) were
          used which don''t allow aliasing and the <code>lm_head</code> weights are
          tied to <code>transformer.word_embeddings.weight</code>. Had you any problems
          loading the model? I checked with transformers and TGI and both could load
          the model properly.</p>

          '
        raw: This is due to the fact that safe_serialization (safetensors) were used
          which don't allow aliasing and the `lm_head` weights are tied to `transformer.word_embeddings.weight`.
          Had you any problems loading the model? I checked with transformers and
          TGI and both could load the model properly.
        updatedAt: '2023-08-18T10:47:48.532Z'
      numEdits: 0
      reactions: []
    id: 64df4c544fe3c8613f473e12
    type: comment
  author: andreaskoepf
  content: This is due to the fact that safe_serialization (safetensors) were used
    which don't allow aliasing and the `lm_head` weights are tied to `transformer.word_embeddings.weight`.
    Had you any problems loading the model? I checked with transformers and TGI and
    both could load the model properly.
  created_at: 2023-08-18 09:47:48+00:00
  edited: false
  hidden: false
  id: 64df4c544fe3c8613f473e12
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
      fullname: Prannay Kaul
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: prannaykaul
      type: user
    createdAt: '2023-08-18T19:57:48.000Z'
    data:
      edited: false
      editors:
      - prannaykaul
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5043095946311951
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
          fullname: Prannay Kaul
          isHf: false
          isPro: false
          name: prannaykaul
          type: user
        html: "<pre><code>export model=OpenAssistant/falcon-40b-megacode2-oasst\n\
          export num_shard=8\nexport volume=/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2\
          \ # share a volume with the Docker container to avoid downloading weights\
          \ every run\n\nexport max_input_length=2048\nexport max_total_tokens=2049\n\
          export docker_image_id=ghcr.io/huggingface/text-generation-inference:0.9.4\
          \ # ghcr.io/huggingface/text-generation-inference:0.9.2\nexport falconlite_tgi_port=448\n\
          \ndocker run -d --gpus all \\\n                        --shm-size 1g -p\
          \ $falconlite_tgi_port:80 -v /home:/home $docker_image_id \\\n         \
          \               --model-id $model --num-shard ${num_shard} \\\n        \
          \                --trust-remote-code --dtype bfloat16\n</code></pre>\n<p>This\
          \ is the script I am using to launch the model</p>\n<pre><code>\e[2m2023-08-18T19:54:41.846461Z\e\
          [0m \e[32m INFO\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Args\
          \ { model_id: \"/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2\"\
          , revision: None, validation_workers: 2, sharded: None, num_shard: Some(8),\
          \ quantize: None, dtype: Some(BFloat16), trust_remote_code: true, max_concurrent_requests:\
          \ 128, max_best_of: 2, max_stop_sequences: 4, max_input_length: 1024, max_total_tokens:\
          \ 2048, waiting_served_ratio: 1.2, max_batch_prefill_tokens: 4096, max_batch_total_tokens:\
          \ None, max_waiting_tokens: 20, hostname: \"97f4f178d973\", port: 80, shard_uds_path:\
          \ \"/tmp/text-generation-server\", master_addr: \"localhost\", master_port:\
          \ 29500, huggingface_hub_cache: Some(\"/data\"), weights_cache_override:\
          \ None, disable_custom_kernels: false, cuda_memory_fraction: 1.0, json_output:\
          \ false, otlp_endpoint: None, cors_allow_origin: [], watermark_gamma: None,\
          \ watermark_delta: None, ngrok: false, ngrok_authtoken: None, ngrok_edge:\
          \ None, env: false }\n\e[2m2023-08-18T19:54:41.846495Z\e[0m \e[33m WARN\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m `trust_remote_code` is\
          \ set. Trusting that model `/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2`\
          \ do not contain malicious code.\n\e[2m2023-08-18T19:54:41.846499Z\e[0m\
          \ \e[32m INFO\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Sharding\
          \ model on 8 processes\n\e[2m2023-08-18T19:54:41.846634Z\e[0m \e[32m INFO\e\
          [0m \e[1mdownload\e[0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Starting\
          \ download process.\n\e[2m2023-08-18T19:54:43.393983Z\e[0m \e[32m INFO\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Files are already present\
          \ on the host. Skipping download.\n\n\e[2m2023-08-18T19:54:43.748718Z\e\
          [0m \e[32m INFO\e[0m \e[1mdownload\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Successfully downloaded weights.\n\e[2m2023-08-18T19:54:43.749128Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:43.749863Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:54:43.752334Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e[2m2023-08-18T19:54:43.753078Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:43.753054Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.762085Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m4\e[0m\n\e[2m2023-08-18T19:54:53.763929Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:53.765914Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m1\e[0m\n\e[2m2023-08-18T19:54:53.767026Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.774333Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m5\e[0m\n\e[2m2023-08-18T19:54:53.780372Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:53.786063Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m3\e[0m\n\e[2m2023-08-18T19:54:53.786520Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:00.297334Z\e\
          [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error\
          \ when initializing model\nTraceback (most recent call last):\n  File \"\
          /opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n   \
          \ sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.399462Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.505569Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.508876Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.510836Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.518517Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.560307Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.685230Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in &lt;module&gt;\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          &gt; File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:03.790575Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:55:03.790920Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m5\e[0m\n\e[2m2023-08-18T19:55:03.796426Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:55:03.799873Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m1\e[0m\n\e[2m2023-08-18T19:55:03.802729Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:55:03.804963Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m6\e[0m\n\e[2m2023-08-18T19:55:03.807944Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:55:03.834266Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m2\e[0m\n\e[2m2023-08-18T19:55:13.209919Z\e[0m \e[31mERROR\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard complete standard\
          \ error output:\n\nThe argument `trust_remote_code` is to be used with Auto\
          \ classes. It has no effect here and is ignored.\n[W socket.cpp:601] [c10d]\
          \ The client socket has failed to connect to [localhost]:29500 (errno: 99\
          \ - Cannot assign requested address).\nThe argument `trust_remote_code`\
          \ is to be used with Auto classes. It has no effect here and is ignored.\n\
          You are using a model of type falcon to instantiate a model of type . This\
          \ is not supported for all configurations of models and can yield errors.\n\
          Traceback (most recent call last):\n\n  File \"/opt/conda/bin/text-generation-server\"\
          , line 8, in &lt;module&gt;\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"\
          /opt/conda/lib/python3.9/asyncio/base_events.py\", line 647, in run_until_complete\n\
          \    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n\
          \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:55:13.291609Z\e\
          [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard\
          \ 7 failed to start\n\e[2m2023-08-18T19:55:13.291631Z\e[0m \e[32m INFO\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shutting down shards\n\
          \e[2m2023-08-18T19:55:13.342262Z\e[0m \e[31mERROR\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard complete standard\
          \ error output:\n\nThe argument `trust_remote_code` is to be used with Auto\
          \ classes. It has no effect here and is ignored.\nThe argument `trust_remote_code`\
          \ is to be used with Auto classes. It has no effect here and is ignored.\n\
          You are using a model of type falcon to instantiate a model of type . This\
          \ is not supported for all configurations of models and can yield errors.\n\
          Traceback (most recent call last):\n\n  File \"/opt/conda/bin/text-generation-server\"\
          , line 8, in &lt;module&gt;\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"\
          /opt/conda/lib/python3.9/asyncio/base_events.py\", line 647, in run_until_complete\n\
          \    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n\
          \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:13.381545Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e\
          [2m2023-08-18T19:55:13.498104Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:55:13.615350Z\e[0m \e\
          [32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e\
          [2m2023-08-18T19:55:13.714285Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:55:13.783450Z\e[0m \e\
          [32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e\
          [2m2023-08-18T19:55:13.852918Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m6\e[0m\n</code></pre>\n<p>here we can see a runtime\
          \ error where the launcher cannot find the \"lm_head\" weight.</p>\n"
        raw: "```\nexport model=OpenAssistant/falcon-40b-megacode2-oasst\nexport num_shard=8\n\
          export volume=/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2\
          \ # share a volume with the Docker container to avoid downloading weights\
          \ every run\n\nexport max_input_length=2048\nexport max_total_tokens=2049\n\
          export docker_image_id=ghcr.io/huggingface/text-generation-inference:0.9.4\
          \ # ghcr.io/huggingface/text-generation-inference:0.9.2\nexport falconlite_tgi_port=448\n\
          \ndocker run -d --gpus all \\\n                        --shm-size 1g -p\
          \ $falconlite_tgi_port:80 -v /home:/home $docker_image_id \\\n         \
          \               --model-id $model --num-shard ${num_shard} \\\n        \
          \                --trust-remote-code --dtype bfloat16\n```\n\nThis is the\
          \ script I am using to launch the model\n\n```\n\e[2m2023-08-18T19:54:41.846461Z\e\
          [0m \e[32m INFO\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Args\
          \ { model_id: \"/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2\"\
          , revision: None, validation_workers: 2, sharded: None, num_shard: Some(8),\
          \ quantize: None, dtype: Some(BFloat16), trust_remote_code: true, max_concurrent_requests:\
          \ 128, max_best_of: 2, max_stop_sequences: 4, max_input_length: 1024, max_total_tokens:\
          \ 2048, waiting_served_ratio: 1.2, max_batch_prefill_tokens: 4096, max_batch_total_tokens:\
          \ None, max_waiting_tokens: 20, hostname: \"97f4f178d973\", port: 80, shard_uds_path:\
          \ \"/tmp/text-generation-server\", master_addr: \"localhost\", master_port:\
          \ 29500, huggingface_hub_cache: Some(\"/data\"), weights_cache_override:\
          \ None, disable_custom_kernels: false, cuda_memory_fraction: 1.0, json_output:\
          \ false, otlp_endpoint: None, cors_allow_origin: [], watermark_gamma: None,\
          \ watermark_delta: None, ngrok: false, ngrok_authtoken: None, ngrok_edge:\
          \ None, env: false }\n\e[2m2023-08-18T19:54:41.846495Z\e[0m \e[33m WARN\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m `trust_remote_code` is\
          \ set. Trusting that model `/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2`\
          \ do not contain malicious code.\n\e[2m2023-08-18T19:54:41.846499Z\e[0m\
          \ \e[32m INFO\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Sharding\
          \ model on 8 processes\n\e[2m2023-08-18T19:54:41.846634Z\e[0m \e[32m INFO\e\
          [0m \e[1mdownload\e[0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Starting\
          \ download process.\n\e[2m2023-08-18T19:54:43.393983Z\e[0m \e[32m INFO\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Files are already present\
          \ on the host. Skipping download.\n\n\e[2m2023-08-18T19:54:43.748718Z\e\
          [0m \e[32m INFO\e[0m \e[1mdownload\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Successfully downloaded weights.\n\e[2m2023-08-18T19:54:43.749128Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:43.749863Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:54:43.752334Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e[2m2023-08-18T19:54:43.753078Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:43.753054Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.762085Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m4\e[0m\n\e[2m2023-08-18T19:54:53.763929Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:53.765914Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m1\e[0m\n\e[2m2023-08-18T19:54:53.767026Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.774333Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m5\e[0m\n\e[2m2023-08-18T19:54:53.780372Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:53.786063Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m3\e[0m\n\e[2m2023-08-18T19:54:53.786520Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:00.297334Z\e\
          [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error\
          \ when initializing model\nTraceback (most recent call last):\n  File \"\
          /opt/conda/bin/text-generation-server\", line 8, in <module>\n    sys.exit(app())\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\", line 311,\
          \ in __call__\n    return get_command(self)(*args, **kwargs)\n  File \"\
          /opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
          \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.399462Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.505569Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.508876Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.510836Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.518517Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.560307Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:00.685230Z\e[0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Error when initializing model\nTraceback (most recent call\
          \ last):\n  File \"/opt/conda/bin/text-generation-server\", line 8, in <module>\n\
          \    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130,\
          \ in __call__\n    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
          , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
          , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404,\
          \ in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File\
          \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 760, in\
          \ invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
          , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
          , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
          , line 80, in _run\n    self._context.run(self._callback, *self._args)\n\
          > File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n \
          \ File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\
          \n\e[2m2023-08-18T19:55:03.790575Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:55:03.790920Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m5\e[0m\n\e[2m2023-08-18T19:55:03.796426Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:55:03.799873Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m1\e[0m\n\e[2m2023-08-18T19:55:03.802729Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:55:03.804963Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m6\e[0m\n\e[2m2023-08-18T19:55:03.807944Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to\
          \ be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:55:03.834266Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e\
          [0m2\e[0m\n\e[2m2023-08-18T19:55:13.209919Z\e[0m \e[31mERROR\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard complete standard\
          \ error output:\n\nThe argument `trust_remote_code` is to be used with Auto\
          \ classes. It has no effect here and is ignored.\n[W socket.cpp:601] [c10d]\
          \ The client socket has failed to connect to [localhost]:29500 (errno: 99\
          \ - Cannot assign requested address).\nThe argument `trust_remote_code`\
          \ is to be used with Auto classes. It has no effect here and is ignored.\n\
          You are using a model of type falcon to instantiate a model of type . This\
          \ is not supported for all configurations of models and can yield errors.\n\
          Traceback (most recent call last):\n\n  File \"/opt/conda/bin/text-generation-server\"\
          , line 8, in <module>\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"\
          /opt/conda/lib/python3.9/asyncio/base_events.py\", line 647, in run_until_complete\n\
          \    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n\
          \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:55:13.291609Z\e\
          [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard\
          \ 7 failed to start\n\e[2m2023-08-18T19:55:13.291631Z\e[0m \e[32m INFO\e\
          [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shutting down shards\n\
          \e[2m2023-08-18T19:55:13.342262Z\e[0m \e[31mERROR\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard complete standard\
          \ error output:\n\nThe argument `trust_remote_code` is to be used with Auto\
          \ classes. It has no effect here and is ignored.\nThe argument `trust_remote_code`\
          \ is to be used with Auto classes. It has no effect here and is ignored.\n\
          You are using a model of type falcon to instantiate a model of type . This\
          \ is not supported for all configurations of models and can yield errors.\n\
          Traceback (most recent call last):\n\n  File \"/opt/conda/bin/text-generation-server\"\
          , line 8, in <module>\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
          , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
          , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"\
          /opt/conda/lib/python3.9/asyncio/base_events.py\", line 647, in run_until_complete\n\
          \    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
          , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
          , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n\
          \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\"\
          , dim=0)\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n\
          \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:13.381545Z\e\
          [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e\
          [2m2023-08-18T19:55:13.498104Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:55:13.615350Z\e[0m \e\
          [32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e\
          [2m2023-08-18T19:55:13.714285Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:55:13.783450Z\e[0m \e\
          [32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
          [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e\
          [2m2023-08-18T19:55:13.852918Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
          [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard terminated \e[2m\e\
          [3mrank\e[0m\e[2m=\e[0m6\e[0m\n```\n\nhere we can see a runtime error where\
          \ the launcher cannot find the \"lm_head\" weight."
        updatedAt: '2023-08-18T19:57:48.622Z'
      numEdits: 0
      reactions: []
    id: 64dfcd3cc1691b577825193f
    type: comment
  author: prannaykaul
  content: "```\nexport model=OpenAssistant/falcon-40b-megacode2-oasst\nexport num_shard=8\n\
    export volume=/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2 # share\
    \ a volume with the Docker container to avoid downloading weights every run\n\n\
    export max_input_length=2048\nexport max_total_tokens=2049\nexport docker_image_id=ghcr.io/huggingface/text-generation-inference:0.9.4\
    \ # ghcr.io/huggingface/text-generation-inference:0.9.2\nexport falconlite_tgi_port=448\n\
    \ndocker run -d --gpus all \\\n                        --shm-size 1g -p $falconlite_tgi_port:80\
    \ -v /home:/home $docker_image_id \\\n                        --model-id $model\
    \ --num-shard ${num_shard} \\\n                        --trust-remote-code --dtype\
    \ bfloat16\n```\n\nThis is the script I am using to launch the model\n\n```\n\e\
    [2m2023-08-18T19:54:41.846461Z\e[0m \e[32m INFO\e[0m \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Args { model_id: \"/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2\"\
    , revision: None, validation_workers: 2, sharded: None, num_shard: Some(8), quantize:\
    \ None, dtype: Some(BFloat16), trust_remote_code: true, max_concurrent_requests:\
    \ 128, max_best_of: 2, max_stop_sequences: 4, max_input_length: 1024, max_total_tokens:\
    \ 2048, waiting_served_ratio: 1.2, max_batch_prefill_tokens: 4096, max_batch_total_tokens:\
    \ None, max_waiting_tokens: 20, hostname: \"97f4f178d973\", port: 80, shard_uds_path:\
    \ \"/tmp/text-generation-server\", master_addr: \"localhost\", master_port: 29500,\
    \ huggingface_hub_cache: Some(\"/data\"), weights_cache_override: None, disable_custom_kernels:\
    \ false, cuda_memory_fraction: 1.0, json_output: false, otlp_endpoint: None, cors_allow_origin:\
    \ [], watermark_gamma: None, watermark_delta: None, ngrok: false, ngrok_authtoken:\
    \ None, ngrok_edge: None, env: false }\n\e[2m2023-08-18T19:54:41.846495Z\e[0m\
    \ \e[33m WARN\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m `trust_remote_code`\
    \ is set. Trusting that model `/home/ubuntu/prannay-efs/checkpoints/tgi-FalconOA-megacode2`\
    \ do not contain malicious code.\n\e[2m2023-08-18T19:54:41.846499Z\e[0m \e[32m\
    \ INFO\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Sharding model on 8\
    \ processes\n\e[2m2023-08-18T19:54:41.846634Z\e[0m \e[32m INFO\e[0m \e[1mdownload\e\
    [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Starting download process.\n\
    \e[2m2023-08-18T19:54:43.393983Z\e[0m \e[32m INFO\e[0m \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Files are already present on the host. Skipping download.\n\n\e\
    [2m2023-08-18T19:54:43.748718Z\e[0m \e[32m INFO\e[0m \e[1mdownload\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Successfully downloaded weights.\n\e[2m2023-08-18T19:54:43.749128Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:43.749863Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:54:43.750865Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:54:43.752334Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e[2m2023-08-18T19:54:43.753078Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:43.753054Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Starting shard \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.762085Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e\
    [0m\n\e[2m2023-08-18T19:54:53.763929Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
    [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:54:53.765914Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\
    \e[2m2023-08-18T19:54:53.767026Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:54:53.774333Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\
    \e[2m2023-08-18T19:54:53.780372Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:54:53.786063Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\
    \e[2m2023-08-18T19:54:53.786520Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:00.297334Z\e[0m\
    \ \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when initializing\
    \ model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.399462Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.505569Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.508876Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.510836Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.518517Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.560307Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:00.685230Z\e\
    [0m \e[31mERROR\e[0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Error when\
    \ initializing model\nTraceback (most recent call last):\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 311, in __call__\n    return get_command(self)(*args, **kwargs)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1130, in __call__\n\
    \    return self.main(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 778, in main\n    return _main(\n  File \"/opt/conda/lib/python3.9/site-packages/typer/core.py\"\
    , line 216, in _main\n    rv = self.invoke(ctx)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\", line 1404, in\
    \ invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/opt/conda/lib/python3.9/site-packages/click/core.py\"\
    , line 760, in invoke\n    return __callback(*args, **kwargs)\n  File \"/opt/conda/lib/python3.9/site-packages/typer/main.py\"\
    , line 683, in wrapper\n    return callback(**use_params)  # type: ignore\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\", line\
    \ 78, in serve\n    server.serve(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 634, in run_until_complete\n    self.run_forever()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 601, in run_forever\n    self._run_once()\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 1905, in _run_once\n    handle._run()\n  File \"/opt/conda/lib/python3.9/asyncio/events.py\"\
    , line 80, in _run\n    self._context.run(self._callback, *self._args)\n> File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n  File \"\
    /opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\nRuntimeError: weight lm_head.weight does not exist\n\n\e[2m2023-08-18T19:55:03.790575Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e\
    [0m\n\e[2m2023-08-18T19:55:03.790920Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e\
    [0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e[2m2023-08-18T19:55:03.796426Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\
    \e[2m2023-08-18T19:55:03.799873Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e[2m2023-08-18T19:55:03.802729Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m7\e[0m\n\
    \e[2m2023-08-18T19:55:03.804963Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n\e[2m2023-08-18T19:55:03.807944Z\e[0m\
    \ \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Waiting for shard to be ready... \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\
    \e[2m2023-08-18T19:55:03.834266Z\e[0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m:\
    \ \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Waiting for shard to be ready...\
    \ \e[2m\e[3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:13.209919Z\e[0m\
    \ \e[31mERROR\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e\
    [2m:\e[0m Shard complete standard error output:\n\nThe argument `trust_remote_code`\
    \ is to be used with Auto classes. It has no effect here and is ignored.\n[W socket.cpp:601]\
    \ [c10d] The client socket has failed to connect to [localhost]:29500 (errno:\
    \ 99 - Cannot assign requested address).\nThe argument `trust_remote_code` is\
    \ to be used with Auto classes. It has no effect here and is ignored.\nYou are\
    \ using a model of type falcon to instantiate a model of type . This is not supported\
    \ for all configurations of models and can yield errors.\nTraceback (most recent\
    \ call last):\n\n  File \"/opt/conda/bin/text-generation-server\", line 8, in\
    \ <module>\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
    , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 647, in run_until_complete\n    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n \e[2m\e\
    [3mrank\e[0m\e[2m=\e[0m7\e[0m\n\e[2m2023-08-18T19:55:13.291609Z\e[0m \e[31mERROR\e\
    [0m \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard 7 failed to start\n\e\
    [2m2023-08-18T19:55:13.291631Z\e[0m \e[32m INFO\e[0m \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shutting down shards\n\e[2m2023-08-18T19:55:13.342262Z\e[0m \e\
    [31mERROR\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e\
    [0m Shard complete standard error output:\n\nThe argument `trust_remote_code`\
    \ is to be used with Auto classes. It has no effect here and is ignored.\nThe\
    \ argument `trust_remote_code` is to be used with Auto classes. It has no effect\
    \ here and is ignored.\nYou are using a model of type falcon to instantiate a\
    \ model of type . This is not supported for all configurations of models and can\
    \ yield errors.\nTraceback (most recent call last):\n\n  File \"/opt/conda/bin/text-generation-server\"\
    , line 8, in <module>\n    sys.exit(app())\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/cli.py\"\
    , line 78, in serve\n    server.serve(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 184, in serve\n    asyncio.run(\n\n  File \"/opt/conda/lib/python3.9/asyncio/runners.py\"\
    , line 44, in run\n    return loop.run_until_complete(main)\n\n  File \"/opt/conda/lib/python3.9/asyncio/base_events.py\"\
    , line 647, in run_until_complete\n    return future.result()\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 136, in serve_inner\n    model = get_model(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 208, in get_model\n    return FlashRWSharded(\n\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/flash_rw.py\"\
    , line 64, in __init__\n    model = FlashRWForCausalLM(config, weights)\n\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/flash_rw_modeling.py\"\
    , line 624, in __init__\n    self.lm_head = TensorParallelHead.load(\n\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 199, in load\n    weight = weights.get_sharded(f\"{prefix}.weight\", dim=0)\n\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 101, in get_sharded\n    filename, tensor_name = self.get_filename(tensor_name)\n\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 52, in get_filename\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\n\nRuntimeError: weight lm_head.weight does not exist\n \e[2m\e\
    [3mrank\e[0m\e[2m=\e[0m2\e[0m\n\e[2m2023-08-18T19:55:13.381545Z\e[0m \e[32m INFO\e\
    [0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e[0m\e[2m:\e[0m Shard\
    \ terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m1\e[0m\n\e[2m2023-08-18T19:55:13.498104Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m0\e[0m\n\e[2m2023-08-18T19:55:13.615350Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m4\e[0m\n\e[2m2023-08-18T19:55:13.714285Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m3\e[0m\n\e[2m2023-08-18T19:55:13.783450Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m5\e[0m\n\e[2m2023-08-18T19:55:13.852918Z\e\
    [0m \e[32m INFO\e[0m \e[1mshard-manager\e[0m: \e[2mtext_generation_launcher\e\
    [0m\e[2m:\e[0m Shard terminated \e[2m\e[3mrank\e[0m\e[2m=\e[0m6\e[0m\n```\n\n\
    here we can see a runtime error where the launcher cannot find the \"lm_head\"\
    \ weight."
  created_at: 2023-08-18 18:57:48+00:00
  edited: false
  hidden: false
  id: 64dfcd3cc1691b577825193f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
      fullname: "Andreas K\xF6pf"
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: andreaskoepf
      type: user
    createdAt: '2023-08-18T21:33:36.000Z'
    data:
      edited: false
      editors:
      - andreaskoepf
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8562172055244446
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
          fullname: "Andreas K\xF6pf"
          isHf: false
          isPro: false
          name: andreaskoepf
          type: user
        html: '<p>There should be an alias defined for lm_head.weight in flash_rw.py,
          see <a rel="nofollow" href="https://github.com/huggingface/text-generation-inference/blob/c4422e567811051e40469551c58a8078158a6656/server/text_generation_server/models/flash_rw.py#L57">https://github.com/huggingface/text-generation-inference/blob/c4422e567811051e40469551c58a8078158a6656/server/text_generation_server/models/flash_rw.py#L57</a>
          .. it was added two weeks ago in TGI, probably not part of the officially
          released docker container...</p>

          '
        raw: There should be an alias defined for lm_head.weight in flash_rw.py, see
          https://github.com/huggingface/text-generation-inference/blob/c4422e567811051e40469551c58a8078158a6656/server/text_generation_server/models/flash_rw.py#L57
          .. it was added two weeks ago in TGI, probably not part of the officially
          released docker container...
        updatedAt: '2023-08-18T21:33:36.136Z'
      numEdits: 0
      reactions: []
    id: 64dfe3b0c3310dd6cc1a9817
    type: comment
  author: andreaskoepf
  content: There should be an alias defined for lm_head.weight in flash_rw.py, see
    https://github.com/huggingface/text-generation-inference/blob/c4422e567811051e40469551c58a8078158a6656/server/text_generation_server/models/flash_rw.py#L57
    .. it was added two weeks ago in TGI, probably not part of the officially released
    docker container...
  created_at: 2023-08-18 20:33:36+00:00
  edited: false
  hidden: false
  id: 64dfe3b0c3310dd6cc1a9817
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
      fullname: "Andreas K\xF6pf"
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: andreaskoepf
      type: user
    createdAt: '2023-08-20T10:02:11.000Z'
    data:
      edited: false
      editors:
      - andreaskoepf
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6629251837730408
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/63b888106cf60e8c3d00dc86/lNCiIc424q60PC2D33vxN.jpeg?w=200&h=200&f=face
          fullname: "Andreas K\xF6pf"
          isHf: false
          isPro: false
          name: andreaskoepf
          type: user
        html: '<p>I saved some notes how to build TGI manually in a <a rel="nofollow"
          href="https://gist.github.com/andreaskoepf/4b7f5fd913ecd924e30c3b665f3f1b47">gist</a>.</p>

          '
        raw: I saved some notes how to build TGI manually in a [gist](https://gist.github.com/andreaskoepf/4b7f5fd913ecd924e30c3b665f3f1b47).
        updatedAt: '2023-08-20T10:02:11.701Z'
      numEdits: 0
      reactions: []
    id: 64e1e4a3de27e92beaa26a76
    type: comment
  author: andreaskoepf
  content: I saved some notes how to build TGI manually in a [gist](https://gist.github.com/andreaskoepf/4b7f5fd913ecd924e30c3b665f3f1b47).
  created_at: 2023-08-20 09:02:11+00:00
  edited: false
  hidden: false
  id: 64e1e4a3de27e92beaa26a76
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
      fullname: Prannay Kaul
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: prannaykaul
      type: user
    createdAt: '2023-08-20T20:42:28.000Z'
    data:
      edited: false
      editors:
      - prannaykaul
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9276124835014343
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/119f33d862bdacc9d6e45eed213eb5a7.svg
          fullname: Prannay Kaul
          isHf: false
          isPro: false
          name: prannaykaul
          type: user
        html: '<p>Thanks for your help, I found the edit and made a new docker image.
          Thank you for the TGI build gist, will take a look.</p>

          '
        raw: Thanks for your help, I found the edit and made a new docker image. Thank
          you for the TGI build gist, will take a look.
        updatedAt: '2023-08-20T20:42:28.776Z'
      numEdits: 0
      reactions: []
    id: 64e27ab4c21dd0c666d5a6d9
    type: comment
  author: prannaykaul
  content: Thanks for your help, I found the edit and made a new docker image. Thank
    you for the TGI build gist, will take a look.
  created_at: 2023-08-20 19:42:28+00:00
  edited: false
  hidden: false
  id: 64e27ab4c21dd0c666d5a6d9
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: OpenAssistant/falcon-40b-megacode2-oasst
repo_type: model
status: open
target_branch: null
title: No lm_head weight?
