!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ZhangRC
conflicting_files: null
created_at: 2023-05-25 12:52:16+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
      fullname: Zhang Ruichong
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZhangRC
      type: user
    createdAt: '2023-05-25T13:52:16.000Z'
    data:
      edited: false
      editors:
      - ZhangRC
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
          fullname: Zhang Ruichong
          isHf: false
          isPro: false
          name: ZhangRC
          type: user
        html: "<p>I got this error:</p>\n<pre><code>Traceback (most recent call last):\n\
          \  File \"&lt;redacted path&gt;\\ChatRWKV-main\\v2\\chat.py\", line 117,\
          \ in &lt;module&gt;\n    pipeline = PIPELINE(model, f\"&lt;redacted path&gt;/ChatRWKV-main/tokenizer/rwkv_vocab_v20230424.txt\"\
          )\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"D:\\Program Files\\Python311\\Lib\\site-packages\\rwkv\\utils.py\"\
          , line 29, in __init__\n    self.tokenizer = Tokenizer.from_file(WORD_NAME)\n\
          \                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nException: invalid\
          \ type: integer `1`, expected struct Tokenizer at line 1 column 1\n</code></pre>\n\
          <p>It seems that the tokenizer is not compatible.</p>\n"
        raw: "I got this error:\r\n```\r\nTraceback (most recent call last):\r\n \
          \ File \"<redacted path>\\ChatRWKV-main\\v2\\chat.py\", line 117, in <module>\r\
          \n    pipeline = PIPELINE(model, f\"<redacted path>/ChatRWKV-main/tokenizer/rwkv_vocab_v20230424.txt\"\
          )\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\
          \n  File \"D:\\Program Files\\Python311\\Lib\\site-packages\\rwkv\\utils.py\"\
          , line 29, in __init__\r\n    self.tokenizer = Tokenizer.from_file(WORD_NAME)\r\
          \n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nException: invalid\
          \ type: integer `1`, expected struct Tokenizer at line 1 column 1\r\n```\r\
          \nIt seems that the tokenizer is not compatible."
        updatedAt: '2023-05-25T13:52:16.554Z'
      numEdits: 0
      reactions: []
    id: 646f6810753be77a8e95117c
    type: comment
  author: ZhangRC
  content: "I got this error:\r\n```\r\nTraceback (most recent call last):\r\n  File\
    \ \"<redacted path>\\ChatRWKV-main\\v2\\chat.py\", line 117, in <module>\r\n \
    \   pipeline = PIPELINE(model, f\"<redacted path>/ChatRWKV-main/tokenizer/rwkv_vocab_v20230424.txt\"\
    )\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\
    \n  File \"D:\\Program Files\\Python311\\Lib\\site-packages\\rwkv\\utils.py\"\
    , line 29, in __init__\r\n    self.tokenizer = Tokenizer.from_file(WORD_NAME)\r\
    \n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nException: invalid type:\
    \ integer `1`, expected struct Tokenizer at line 1 column 1\r\n```\r\nIt seems\
    \ that the tokenizer is not compatible."
  created_at: 2023-05-25 12:52:16+00:00
  edited: false
  hidden: false
  id: 646f6810753be77a8e95117c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
      fullname: Zhang Ruichong
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZhangRC
      type: user
    createdAt: '2023-05-25T14:00:01.000Z'
    data:
      edited: false
      editors:
      - ZhangRC
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
          fullname: Zhang Ruichong
          isHf: false
          isPro: false
          name: ZhangRC
          type: user
        html: '<p>Windows 10, Python 3.11, PyTorch 2.0.0, RWKV 0.7.3, Tokenizers 0.13.3,
          CUDA 11.8</p>

          '
        raw: Windows 10, Python 3.11, PyTorch 2.0.0, RWKV 0.7.3, Tokenizers 0.13.3,
          CUDA 11.8
        updatedAt: '2023-05-25T14:00:01.363Z'
      numEdits: 0
      reactions: []
    id: 646f69e1e2a72c647b714f55
    type: comment
  author: ZhangRC
  content: Windows 10, Python 3.11, PyTorch 2.0.0, RWKV 0.7.3, Tokenizers 0.13.3,
    CUDA 11.8
  created_at: 2023-05-25 13:00:01+00:00
  edited: false
  hidden: false
  id: 646f69e1e2a72c647b714f55
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1655953609090-noauth.jpeg?w=200&h=200&f=face
      fullname: BlinkDL
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: BlinkDL
      type: user
    createdAt: '2023-05-25T15:17:01.000Z'
    data:
      edited: true
      editors:
      - BlinkDL
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1655953609090-noauth.jpeg?w=200&h=200&f=face
          fullname: BlinkDL
          isHf: false
          isPro: false
          name: BlinkDL
          type: user
        html: '<p>update RWKV pip package to 0.7.4</p>

          <p>and pipeline = PIPELINE(model, "rwkv_vocab_v20230424")<br>(EXACTLY AS
          WRITTEN HERE. "rwkv_vocab_v20230424" is included in rwkv 0.7.4+)</p>

          '
        raw: 'update RWKV pip package to 0.7.4


          and pipeline = PIPELINE(model, "rwkv_vocab_v20230424")

          (EXACTLY AS WRITTEN HERE. "rwkv_vocab_v20230424" is included in rwkv 0.7.4+)'
        updatedAt: '2023-05-25T15:18:44.537Z'
      numEdits: 1
      reactions: []
    id: 646f7bed150f4cab862dc4a1
    type: comment
  author: BlinkDL
  content: 'update RWKV pip package to 0.7.4


    and pipeline = PIPELINE(model, "rwkv_vocab_v20230424")

    (EXACTLY AS WRITTEN HERE. "rwkv_vocab_v20230424" is included in rwkv 0.7.4+)'
  created_at: 2023-05-25 14:17:01+00:00
  edited: true
  hidden: false
  id: 646f7bed150f4cab862dc4a1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
      fullname: Zhang Ruichong
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZhangRC
      type: user
    createdAt: '2023-05-25T15:49:38.000Z'
    data:
      edited: false
      editors:
      - ZhangRC
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
          fullname: Zhang Ruichong
          isHf: false
          isPro: false
          name: ZhangRC
          type: user
        html: '<p>Bob: Hi<br>Alice:Traceback (most recent call last):<br>  File "\ChatRWKV-main\v2\chat.py",
          line 457, in <br>    on_message(msg)<br>  File "\ChatRWKV-main\v2\chat.py",
          line 359, in on_message<br>    token = pipeline.sample_logits(<br>            ^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "\ChatRWKV-main\v2/../rwkv_pip_package/src\rwkv\utils.py", line 82, in sample_logits<br>    out
          = torch.multinomial(probs, num_samples=1)[0]<br>          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>RuntimeError:
          probability tensor contains either <code>inf</code>, <code>nan</code> or
          element &lt; 0</p>

          '
        raw: "Bob: Hi\nAlice:Traceback (most recent call last):\n  File \"<redacted\
          \ path>\\ChatRWKV-main\\v2\\chat.py\", line 457, in <module>\n    on_message(msg)\n\
          \  File \"<redacted path>\\ChatRWKV-main\\v2\\chat.py\", line 359, in on_message\n\
          \    token = pipeline.sample_logits(\n            ^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"<redacted path>\\ChatRWKV-main\\v2/../rwkv_pip_package/src\\rwkv\\\
          utils.py\", line 82, in sample_logits\n    out = torch.multinomial(probs,\
          \ num_samples=1)[0]\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          RuntimeError: probability tensor contains either `inf`, `nan` or element\
          \ < 0"
        updatedAt: '2023-05-25T15:49:38.971Z'
      numEdits: 0
      reactions: []
    id: 646f83926098ee820fbb78ed
    type: comment
  author: ZhangRC
  content: "Bob: Hi\nAlice:Traceback (most recent call last):\n  File \"<redacted\
    \ path>\\ChatRWKV-main\\v2\\chat.py\", line 457, in <module>\n    on_message(msg)\n\
    \  File \"<redacted path>\\ChatRWKV-main\\v2\\chat.py\", line 359, in on_message\n\
    \    token = pipeline.sample_logits(\n            ^^^^^^^^^^^^^^^^^^^^^^^\n  File\
    \ \"<redacted path>\\ChatRWKV-main\\v2/../rwkv_pip_package/src\\rwkv\\utils.py\"\
    , line 82, in sample_logits\n    out = torch.multinomial(probs, num_samples=1)[0]\n\
    \          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: probability\
    \ tensor contains either `inf`, `nan` or element < 0"
  created_at: 2023-05-25 14:49:38+00:00
  edited: false
  hidden: false
  id: 646f83926098ee820fbb78ed
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
      fullname: Zhang Ruichong
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZhangRC
      type: user
    createdAt: '2023-05-25T15:55:43.000Z'
    data:
      edited: false
      editors:
      - ZhangRC
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1679319546731-noauth.png?w=200&h=200&f=face
          fullname: Zhang Ruichong
          isHf: false
          isPro: false
          name: ZhangRC
          type: user
        html: '<p>Changing device from ''cuda'' to ''cpu'' solves it. Might be a bug?</p>

          '
        raw: Changing device from 'cuda' to 'cpu' solves it. Might be a bug?
        updatedAt: '2023-05-25T15:55:43.401Z'
      numEdits: 0
      reactions: []
    id: 646f84ff6098ee820fbb9449
    type: comment
  author: ZhangRC
  content: Changing device from 'cuda' to 'cpu' solves it. Might be a bug?
  created_at: 2023-05-25 14:55:43+00:00
  edited: false
  hidden: false
  id: 646f84ff6098ee820fbb9449
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1655953609090-noauth.jpeg?w=200&h=200&f=face
      fullname: BlinkDL
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: BlinkDL
      type: user
    createdAt: '2023-05-25T16:10:08.000Z'
    data:
      edited: false
      editors:
      - BlinkDL
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1655953609090-noauth.jpeg?w=200&h=200&f=face
          fullname: BlinkDL
          isHf: false
          isPro: false
          name: BlinkDL
          type: user
        html: '<p>okay i forget to mention you need fp32 too, because here k will
          overflow in fp16 (fixable in future)</p>

          '
        raw: okay i forget to mention you need fp32 too, because here k will overflow
          in fp16 (fixable in future)
        updatedAt: '2023-05-25T16:10:08.674Z'
      numEdits: 0
      reactions: []
    id: 646f8860bc42f4b002302b25
    type: comment
  author: BlinkDL
  content: okay i forget to mention you need fp32 too, because here k will overflow
    in fp16 (fixable in future)
  created_at: 2023-05-25 15:10:08+00:00
  edited: false
  hidden: false
  id: 646f8860bc42f4b002302b25
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: BlinkDL/rwkv-4-world
repo_type: model
status: open
target_branch: null
title: Unable to load tokenizer
