!!python/object:huggingface_hub.community.DiscussionWithDetails
author: peacemaker
conflicting_files: null
created_at: 2023-12-24 02:37:37+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/43e6c64463192792d2994f09bf31c82e.svg
      fullname: peacemaker_tsp
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: peacemaker
      type: user
    createdAt: '2023-12-24T02:37:37.000Z'
    data:
      edited: false
      editors:
      - peacemaker
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5226674675941467
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/43e6c64463192792d2994f09bf31c82e.svg
          fullname: peacemaker_tsp
          isHf: false
          isPro: false
          name: peacemaker
          type: user
        html: "<p>Warning: please make sure that you are using the latest codes and\
          \ checkpoints, especially if you used Qwen-7B before 09.25.2023.\u8BF7\u4F7F\
          \u7528\u6700\u65B0\u6A21\u578B\u548C\u4EE3\u7801\uFF0C\u5C24\u5176\u5982\
          \u679C\u4F60\u57289\u670825\u65E5\u524D\u5DF2\u7ECF\u5F00\u59CB\u4F7F\u7528\
          Qwen-7B\uFF0C\u5343\u4E07\u6CE8\u610F\u4E0D\u8981\u4F7F\u7528\u9519\u8BEF\
          \u4EE3\u7801\u548C\u6A21\u578B\u3002<br>/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py:738:\
          \ UserWarning: \u4F7F\u7528YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6E\
          config.use_logn_attn = False\uFF0Cconfig.use_dynamic_ntk = True<br>  warnings.warn(\"\
          \u4F7F\u7528YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6Econfig.use_logn_attn\
          \ = False\uFF0Cconfig.use_dynamic_ntk = True\")</p>\n<p>Loading checkpoint\
          \ shards:   0%|          | 0/6 [00:00&lt;?, ?it/s]<br>Loading checkpoint\
          \ shards:  17%|\u2588\u258B        | 1/6 [00:12&lt;01:01, 12.35s/it]<br>Loading\
          \ checkpoint shards:  33%|\u2588\u2588\u2588\u258E      | 2/6 [00:21&lt;00:42,\
          \ 10.69s/it]<br>Loading checkpoint shards:  50%|\u2588\u2588\u2588\u2588\
          \u2588     | 3/6 [00:30&lt;00:28,  9.59s/it]<br>Loading checkpoint shards:\
          \  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258B   | 4/6 [00:38&lt;00:17,\
          \  8.93s/it]<br>Loading checkpoint shards:  83%|\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u258E | 5/6 [00:47&lt;00:09,  9.22s/it]<br>Loading\
          \ checkpoint shards: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588| 6/6 [00:53&lt;00:00,  7.97s/it]<br>Loading checkpoint shards:\
          \ 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6/6\
          \ [00:53&lt;00:00,  8.89s/it]<br>INFO:     Started server process [2764225]<br>INFO:\
          \     Waiting for application startup.<br>INFO:     Application startup\
          \ complete.<br>INFO:     Uvicorn running on <a rel=\"nofollow\" href=\"\
          http://0.0.0.0:18001\">http://0.0.0.0:18001</a> (Press CTRL+C to quit)<br>INFO:\
          \     34.124.237.188:44718 - \"POST /v1/chat/completions HTTP/1.1\" 200\
          \ OK<br>ERROR:    Exception in ASGI application<br>Traceback (most recent\
          \ call last):<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py\"\
          , line 408, in run_asgi<br>    result = await app(  # type: ignore[func-returns-value]<br>\
          \             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File \"\
          /home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\"\
          , line 84, in <strong>call</strong><br>    return await self.app(scope,\
          \ receive, send)<br>           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>\
          \  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/applications.py\"\
          , line 1106, in <strong>call</strong><br>    await super().<strong>call</strong>(scope,\
          \ receive, send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/applications.py\"\
          , line 122, in <strong>call</strong><br>    await self.middleware_stack(scope,\
          \ receive, send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
          , line 184, in <strong>call</strong><br>    raise exc<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
          , line 162, in <strong>call</strong><br>    await self.app(scope, receive,\
          \ _send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/cors.py\"\
          , line 83, in <strong>call</strong><br>    await self.app(scope, receive,\
          \ send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
          , line 79, in <strong>call</strong><br>    raise exc<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
          , line 68, in <strong>call</strong><br>    await self.app(scope, receive,\
          \ sender)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
          , line 20, in <strong>call</strong><br>    raise e<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
          , line 17, in <strong>call</strong><br>    await self.app(scope, receive,\
          \ send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 718, in <strong>call</strong><br>    await route.handle(scope, receive,\
          \ send)<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 276, in handle<br>    await self.app(scope, receive, send)<br>  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 69, in app<br>    await response(scope, receive, send)<br>  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 255, in <strong>call</strong><br>    async with anyio.create_task_group()\
          \ as task_group:<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\"\
          , line 597, in <strong>aexit</strong><br>    raise exceptions[0]<br>  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 258, in wrap<br>    await func()<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 245, in stream_response<br>    async for data in self.body_iterator:<br>\
          \  File \"/data/tangsipeng/mycode/Qwen/openai_api_14b_yarn_32k.py\", line\
          \ 449, in predict<br>    for new_response in response_generator:<br>  File\
          \ \"/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py\"\
          , line 1291, in stream_generator<br>    for token in self.generate_stream(<br>\
          \  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
          , line 56, in generator_context<br>    response = gen.send(request)<br>\
          \               ^^^^^^^^^^^^^^^^^<br>  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/transformers_stream_generator/main.py\"\
          , line 969, in sample_stream<br>    next_tokens = torch.multinomial(probs,\
          \ num_samples=1).squeeze(1)<br>                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>RuntimeError:\
          \ probability tensor contains either <code>inf</code>, <code>nan</code>\
          \ or element &lt; 0</p>\n"
        raw: "Warning: please make sure that you are using the latest codes and checkpoints,\
          \ especially if you used Qwen-7B before 09.25.2023.\u8BF7\u4F7F\u7528\u6700\
          \u65B0\u6A21\u578B\u548C\u4EE3\u7801\uFF0C\u5C24\u5176\u5982\u679C\u4F60\
          \u57289\u670825\u65E5\u524D\u5DF2\u7ECF\u5F00\u59CB\u4F7F\u7528Qwen-7B\uFF0C\
          \u5343\u4E07\u6CE8\u610F\u4E0D\u8981\u4F7F\u7528\u9519\u8BEF\u4EE3\u7801\
          \u548C\u6A21\u578B\u3002\r\n/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py:738:\
          \ UserWarning: \u4F7F\u7528YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6E\
          config.use_logn_attn = False\uFF0Cconfig.use_dynamic_ntk = True\r\n  warnings.warn(\"\
          \u4F7F\u7528YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6Econfig.use_logn_attn\
          \ = False\uFF0Cconfig.use_dynamic_ntk = True\")\r\n\r\nLoading checkpoint\
          \ shards:   0%|          | 0/6 [00:00<?, ?it/s]\r\nLoading checkpoint shards:\
          \  17%|\u2588\u258B        | 1/6 [00:12<01:01, 12.35s/it]\r\nLoading checkpoint\
          \ shards:  33%|\u2588\u2588\u2588\u258E      | 2/6 [00:21<00:42, 10.69s/it]\r\
          \nLoading checkpoint shards:  50%|\u2588\u2588\u2588\u2588\u2588     | 3/6\
          \ [00:30<00:28,  9.59s/it]\r\nLoading checkpoint shards:  67%|\u2588\u2588\
          \u2588\u2588\u2588\u2588\u258B   | 4/6 [00:38<00:17,  8.93s/it]\r\nLoading\
          \ checkpoint shards:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u258E | 5/6 [00:47<00:09,  9.22s/it]\r\nLoading checkpoint shards: 100%|\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6/6 [00:53<00:00,\
          \  7.97s/it]\r\nLoading checkpoint shards: 100%|\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588| 6/6 [00:53<00:00,  8.89s/it]\r\nINFO:\
          \     Started server process [2764225]\r\nINFO:     Waiting for application\
          \ startup.\r\nINFO:     Application startup complete.\r\nINFO:     Uvicorn\
          \ running on http://0.0.0.0:18001 (Press CTRL+C to quit)\r\nINFO:     34.124.237.188:44718\
          \ - \"POST /v1/chat/completions HTTP/1.1\" 200 OK\r\nERROR:    Exception\
          \ in ASGI application\r\nTraceback (most recent call last):\r\n  File \"\
          /home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py\"\
          , line 408, in run_asgi\r\n    result = await app(  # type: ignore[func-returns-value]\r\
          \n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\"\
          , line 84, in __call__\r\n    return await self.app(scope, receive, send)\r\
          \n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/applications.py\"\
          , line 1106, in __call__\r\n    await super().__call__(scope, receive, send)\r\
          \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/applications.py\"\
          , line 122, in __call__\r\n    await self.middleware_stack(scope, receive,\
          \ send)\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
          , line 184, in __call__\r\n    raise exc\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
          , line 162, in __call__\r\n    await self.app(scope, receive, _send)\r\n\
          \  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/cors.py\"\
          , line 83, in __call__\r\n    await self.app(scope, receive, send)\r\n \
          \ File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
          , line 79, in __call__\r\n    raise exc\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
          , line 68, in __call__\r\n    await self.app(scope, receive, sender)\r\n\
          \  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
          , line 20, in __call__\r\n    raise e\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
          , line 17, in __call__\r\n    await self.app(scope, receive, send)\r\n \
          \ File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 718, in __call__\r\n    await route.handle(scope, receive, send)\r\
          \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 276, in handle\r\n    await self.app(scope, receive, send)\r\n  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
          , line 69, in app\r\n    await response(scope, receive, send)\r\n  File\
          \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 255, in __call__\r\n    async with anyio.create_task_group() as task_group:\r\
          \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\"\
          , line 597, in __aexit__\r\n    raise exceptions[0]\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 258, in wrap\r\n    await func()\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
          , line 245, in stream_response\r\n    async for data in self.body_iterator:\r\
          \n  File \"/data/tangsipeng/mycode/Qwen/openai_api_14b_yarn_32k.py\", line\
          \ 449, in predict\r\n    for new_response in response_generator:\r\n  File\
          \ \"/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py\"\
          , line 1291, in stream_generator\r\n    for token in self.generate_stream(\r\
          \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
          , line 56, in generator_context\r\n    response = gen.send(request)\r\n\
          \               ^^^^^^^^^^^^^^^^^\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/transformers_stream_generator/main.py\"\
          , line 969, in sample_stream\r\n    next_tokens = torch.multinomial(probs,\
          \ num_samples=1).squeeze(1)\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\
          \nRuntimeError: probability tensor contains either `inf`, `nan` or element\
          \ < 0"
        updatedAt: '2023-12-24T02:37:37.067Z'
      numEdits: 0
      reactions: []
    id: 658799717959448ef5f215a0
    type: comment
  author: peacemaker
  content: "Warning: please make sure that you are using the latest codes and checkpoints,\
    \ especially if you used Qwen-7B before 09.25.2023.\u8BF7\u4F7F\u7528\u6700\u65B0\
    \u6A21\u578B\u548C\u4EE3\u7801\uFF0C\u5C24\u5176\u5982\u679C\u4F60\u57289\u6708\
    25\u65E5\u524D\u5DF2\u7ECF\u5F00\u59CB\u4F7F\u7528Qwen-7B\uFF0C\u5343\u4E07\u6CE8\
    \u610F\u4E0D\u8981\u4F7F\u7528\u9519\u8BEF\u4EE3\u7801\u548C\u6A21\u578B\u3002\
    \r\n/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py:738:\
    \ UserWarning: \u4F7F\u7528YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6Econfig.use_logn_attn\
    \ = False\uFF0Cconfig.use_dynamic_ntk = True\r\n  warnings.warn(\"\u4F7F\u7528\
    YarnRotaryEmbedding\uFF0C\u5F3A\u5236\u8BBE\u7F6Econfig.use_logn_attn = False\uFF0C\
    config.use_dynamic_ntk = True\")\r\n\r\nLoading checkpoint shards:   0%|     \
    \     | 0/6 [00:00<?, ?it/s]\r\nLoading checkpoint shards:  17%|\u2588\u258B \
    \       | 1/6 [00:12<01:01, 12.35s/it]\r\nLoading checkpoint shards:  33%|\u2588\
    \u2588\u2588\u258E      | 2/6 [00:21<00:42, 10.69s/it]\r\nLoading checkpoint shards:\
    \  50%|\u2588\u2588\u2588\u2588\u2588     | 3/6 [00:30<00:28,  9.59s/it]\r\nLoading\
    \ checkpoint shards:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258B   | 4/6 [00:38<00:17,\
    \  8.93s/it]\r\nLoading checkpoint shards:  83%|\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u258E | 5/6 [00:47<00:09,  9.22s/it]\r\nLoading checkpoint\
    \ shards: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6/6\
    \ [00:53<00:00,  7.97s/it]\r\nLoading checkpoint shards: 100%|\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6/6 [00:53<00:00,  8.89s/it]\r\nINFO:\
    \     Started server process [2764225]\r\nINFO:     Waiting for application startup.\r\
    \nINFO:     Application startup complete.\r\nINFO:     Uvicorn running on http://0.0.0.0:18001\
    \ (Press CTRL+C to quit)\r\nINFO:     34.124.237.188:44718 - \"POST /v1/chat/completions\
    \ HTTP/1.1\" 200 OK\r\nERROR:    Exception in ASGI application\r\nTraceback (most\
    \ recent call last):\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py\"\
    , line 408, in run_asgi\r\n    result = await app(  # type: ignore[func-returns-value]\r\
    \n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\"\
    , line 84, in __call__\r\n    return await self.app(scope, receive, send)\r\n\
    \           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/applications.py\"\
    , line 1106, in __call__\r\n    await super().__call__(scope, receive, send)\r\
    \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/applications.py\"\
    , line 122, in __call__\r\n    await self.middleware_stack(scope, receive, send)\r\
    \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
    , line 184, in __call__\r\n    raise exc\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/errors.py\"\
    , line 162, in __call__\r\n    await self.app(scope, receive, _send)\r\n  File\
    \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/cors.py\"\
    , line 83, in __call__\r\n    await self.app(scope, receive, send)\r\n  File \"\
    /home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
    , line 79, in __call__\r\n    raise exc\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/middleware/exceptions.py\"\
    , line 68, in __call__\r\n    await self.app(scope, receive, sender)\r\n  File\
    \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
    , line 20, in __call__\r\n    raise e\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\"\
    , line 17, in __call__\r\n    await self.app(scope, receive, send)\r\n  File \"\
    /home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
    , line 718, in __call__\r\n    await route.handle(scope, receive, send)\r\n  File\
    \ \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
    , line 276, in handle\r\n    await self.app(scope, receive, send)\r\n  File \"\
    /home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/starlette/routing.py\"\
    , line 69, in app\r\n    await response(scope, receive, send)\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
    , line 255, in __call__\r\n    async with anyio.create_task_group() as task_group:\r\
    \n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\"\
    , line 597, in __aexit__\r\n    raise exceptions[0]\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
    , line 258, in wrap\r\n    await func()\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/sse_starlette/sse.py\"\
    , line 245, in stream_response\r\n    async for data in self.body_iterator:\r\n\
    \  File \"/data/tangsipeng/mycode/Qwen/openai_api_14b_yarn_32k.py\", line 449,\
    \ in predict\r\n    for new_response in response_generator:\r\n  File \"/home/user/.cache/huggingface/modules/transformers_modules/Qwen-14b-chat-yarn-32k/modeling_qwen_yarn.py\"\
    , line 1291, in stream_generator\r\n    for token in self.generate_stream(\r\n\
    \  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
    , line 56, in generator_context\r\n    response = gen.send(request)\r\n      \
    \         ^^^^^^^^^^^^^^^^^\r\n  File \"/home/user/miniconda3/envs/qwen/lib/python3.11/site-packages/transformers_stream_generator/main.py\"\
    , line 969, in sample_stream\r\n    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)\r\
    \n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nRuntimeError: probability\
    \ tensor contains either `inf`, `nan` or element < 0"
  created_at: 2023-12-24 02:37:37+00:00
  edited: false
  hidden: false
  id: 658799717959448ef5f215a0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/43e6c64463192792d2994f09bf31c82e.svg
      fullname: peacemaker_tsp
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: peacemaker
      type: user
    createdAt: '2023-12-24T03:03:39.000Z'
    data:
      edited: false
      editors:
      - peacemaker
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.47504955530166626
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/43e6c64463192792d2994f09bf31c82e.svg
          fullname: peacemaker_tsp
          isHf: false
          isPro: false
          name: peacemaker
          type: user
        html: "<p>\u67E5\u4E86\u4E00\u4E9B\u8D44\u6599\uFF0C\u5C06temp \u63D0\u5347\
          \u52300.5\u53EF\u4EE5\u907F\u514D\u51FA\u73B0\u8FD9\u4E2A\u95EE\u9898</p>\n\
          <p><a rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/630ebcf6d38de32fd043f161/xtyuCt63w7EnjfbV_vJZ_.png\"\
          ><img alt=\"image.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/630ebcf6d38de32fd043f161/xtyuCt63w7EnjfbV_vJZ_.png\"\
          ></a></p>\n"
        raw: "\u67E5\u4E86\u4E00\u4E9B\u8D44\u6599\uFF0C\u5C06temp \u63D0\u5347\u5230\
          0.5\u53EF\u4EE5\u907F\u514D\u51FA\u73B0\u8FD9\u4E2A\u95EE\u9898\n\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/630ebcf6d38de32fd043f161/xtyuCt63w7EnjfbV_vJZ_.png)\n"
        updatedAt: '2023-12-24T03:03:39.733Z'
      numEdits: 0
      reactions: []
    id: 65879f8bd861072dc5eab851
    type: comment
  author: peacemaker
  content: "\u67E5\u4E86\u4E00\u4E9B\u8D44\u6599\uFF0C\u5C06temp \u63D0\u5347\u5230\
    0.5\u53EF\u4EE5\u907F\u514D\u51FA\u73B0\u8FD9\u4E2A\u95EE\u9898\n\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/630ebcf6d38de32fd043f161/xtyuCt63w7EnjfbV_vJZ_.png)\n"
  created_at: 2023-12-24 03:03:39+00:00
  edited: false
  hidden: false
  id: 65879f8bd861072dc5eab851
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6374c494958cd71fa7ea0a9d/2YCKv6tXCZXtsIOFIIXjs.png?w=200&h=200&f=face
      fullname: yuyijiong
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: yuyijiong
      type: user
    createdAt: '2023-12-25T04:38:21.000Z'
    data:
      status: closed
    id: 6589073db2177de396a47c40
    type: status-change
  author: yuyijiong
  created_at: 2023-12-25 04:38:21+00:00
  id: 6589073db2177de396a47c40
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: yuyijiong/Qwen-14b-chat-yarn-32k
repo_type: model
status: closed
target_branch: null
title: "\u5C06\u6A21\u578B\u90E8\u7F72\u5230qwen\u5B98\u7F51\u63D0\u4F9B\u7684openai_api.py\
  \ \uFF0C\u6D41\u5F0F\u8F93\u51FA\u62A5\u9519"
