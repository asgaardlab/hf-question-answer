!!python/object:huggingface_hub.community.DiscussionWithDetails
author: charry2000
conflicting_files: null
created_at: 2023-12-26 02:52:12+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6027ab83c3637c8252da98888d0c90b3.svg
      fullname: charryshi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: charry2000
      type: user
    createdAt: '2023-12-26T02:52:12.000Z'
    data:
      edited: false
      editors:
      - charry2000
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.639223039150238
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6027ab83c3637c8252da98888d0c90b3.svg
          fullname: charryshi
          isHf: false
          isPro: false
          name: charry2000
          type: user
        html: "<p>\u4F5C\u8005\u60A8\u597D\uFF0C\u4F7F\u7528LLaMA-Factory\u9879\u76EE\
          \u5BF9\u6A21\u578B\u505Asft\u548Cevaluate\u9047\u5230\u95EE\u9898</p>\n\
          <p>sft\u65F6\u62A5\u9519<br>\"modeling_qwen_yarn.py\", line 651, in forward<br>\
          \    layernorm_input = attn_output + residual<br>                      ~~~~~~~~~~~~^~~~~~~~~~<br>RuntimeError:\
          \ The size of tensor a (1006) must match the size of tensor b (1008)<br>\
          \ at non-singleton dimension 1<br>  0%|                                \
          \                  | 0/1624 [00:16&lt;?, ?it/s]<br>[E ProcessGroupNCCL.cpp:916]\
          \ [Rank 0] NCCL watchdog thread terminated with exception: CUDA error: device-side\
          \ assert triggered<br>CUDA kernel errors might be asynchronously reported\
          \ at some other API call, so the stacktrace below might be incorrect.</p>\n\
          <p>evaluate\u65F6\u62A5\u9519<br>\"modeling_qwen_yarn.py\", line 176, in\
          \ pad_input<br>    output[indices] = hidden_states<br>    ~~~~~~^^^^^^^^^<br>RuntimeError:\
          \ shape mismatch: value tensor of shape [2768, 40, 128] cannot be broadcast\
          \ to indexing result of shape [2679, 40, 128]</p>\n"
        raw: "\u4F5C\u8005\u60A8\u597D\uFF0C\u4F7F\u7528LLaMA-Factory\u9879\u76EE\u5BF9\
          \u6A21\u578B\u505Asft\u548Cevaluate\u9047\u5230\u95EE\u9898\r\n\r\nsft\u65F6\
          \u62A5\u9519\r\n\"modeling_qwen_yarn.py\", line 651, in forward\r\n    layernorm_input\
          \ = attn_output + residual  \r\n                      ~~~~~~~~~~~~^~~~~~~~~~\
          \  \r\nRuntimeError: The size of tensor a (1006) must match the size of\
          \ tensor b (1008)\r\n at non-singleton dimension 1\r\n  0%|            \
          \                                      | 0/1624 [00:16<?, ?it/s]\r\n[E ProcessGroupNCCL.cpp:916]\
          \ [Rank 0] NCCL watchdog thread terminated with exception: CUDA error: device-side\
          \ assert triggered\r\nCUDA kernel errors might be asynchronously reported\
          \ at some other API call, so the stacktrace below might be incorrect.\r\n\
          \r\nevaluate\u65F6\u62A5\u9519\r\n\"modeling_qwen_yarn.py\", line 176, in\
          \ pad_input\r\n    output[indices] = hidden_states\r\n    ~~~~~~^^^^^^^^^\r\
          \nRuntimeError: shape mismatch: value tensor of shape [2768, 40, 128] cannot\
          \ be broadcast to indexing result of shape [2679, 40, 128]"
        updatedAt: '2023-12-26T02:52:12.074Z'
      numEdits: 0
      reactions: []
    id: 658a3fdc991d8e7fb25197f0
    type: comment
  author: charry2000
  content: "\u4F5C\u8005\u60A8\u597D\uFF0C\u4F7F\u7528LLaMA-Factory\u9879\u76EE\u5BF9\
    \u6A21\u578B\u505Asft\u548Cevaluate\u9047\u5230\u95EE\u9898\r\n\r\nsft\u65F6\u62A5\
    \u9519\r\n\"modeling_qwen_yarn.py\", line 651, in forward\r\n    layernorm_input\
    \ = attn_output + residual  \r\n                      ~~~~~~~~~~~~^~~~~~~~~~ \
    \ \r\nRuntimeError: The size of tensor a (1006) must match the size of tensor\
    \ b (1008)\r\n at non-singleton dimension 1\r\n  0%|                         \
    \                         | 0/1624 [00:16<?, ?it/s]\r\n[E ProcessGroupNCCL.cpp:916]\
    \ [Rank 0] NCCL watchdog thread terminated with exception: CUDA error: device-side\
    \ assert triggered\r\nCUDA kernel errors might be asynchronously reported at some\
    \ other API call, so the stacktrace below might be incorrect.\r\n\r\nevaluate\u65F6\
    \u62A5\u9519\r\n\"modeling_qwen_yarn.py\", line 176, in pad_input\r\n    output[indices]\
    \ = hidden_states\r\n    ~~~~~~^^^^^^^^^\r\nRuntimeError: shape mismatch: value\
    \ tensor of shape [2768, 40, 128] cannot be broadcast to indexing result of shape\
    \ [2679, 40, 128]"
  created_at: 2023-12-26 02:52:12+00:00
  edited: false
  hidden: false
  id: 658a3fdc991d8e7fb25197f0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6374c494958cd71fa7ea0a9d/2YCKv6tXCZXtsIOFIIXjs.png?w=200&h=200&f=face
      fullname: yuyijiong
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: yuyijiong
      type: user
    createdAt: '2023-12-26T03:14:44.000Z'
    data:
      edited: false
      editors:
      - yuyijiong
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.6019667387008667
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6374c494958cd71fa7ea0a9d/2YCKv6tXCZXtsIOFIIXjs.png?w=200&h=200&f=face
          fullname: yuyijiong
          isHf: false
          isPro: false
          name: yuyijiong
          type: user
        html: "<p>\u8BF7\u52FFpadding\u5230max_length\u3002\u53EA\u80FDpadding\u5230\
          \u5F53\u524Dbatch\u6700\u957Fsample\u7684\u957F\u5EA6\u3002</p>\n"
        raw: "\u8BF7\u52FFpadding\u5230max_length\u3002\u53EA\u80FDpadding\u5230\u5F53\
          \u524Dbatch\u6700\u957Fsample\u7684\u957F\u5EA6\u3002"
        updatedAt: '2023-12-26T03:14:44.711Z'
      numEdits: 0
      reactions: []
    id: 658a452461f2dd8f66b247b4
    type: comment
  author: yuyijiong
  content: "\u8BF7\u52FFpadding\u5230max_length\u3002\u53EA\u80FDpadding\u5230\u5F53\
    \u524Dbatch\u6700\u957Fsample\u7684\u957F\u5EA6\u3002"
  created_at: 2023-12-26 03:14:44+00:00
  edited: false
  hidden: false
  id: 658a452461f2dd8f66b247b4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6027ab83c3637c8252da98888d0c90b3.svg
      fullname: charryshi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: charry2000
      type: user
    createdAt: '2023-12-28T06:47:27.000Z'
    data:
      edited: false
      editors:
      - charry2000
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.6047646403312683
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6027ab83c3637c8252da98888d0c90b3.svg
          fullname: charryshi
          isHf: false
          isPro: false
          name: charry2000
          type: user
        html: "<p>\u53D1\u73B0\u662Fpadding\u7684\u95EE\u9898<br>LLaMA-Factory\u6709\
          padding\u52308\u7684\u500D\u6570Token<br>evaluate\u65F6batch_size \u8BBE\
          \u7F6E\u62101\u5C31OK</p>\n"
        raw: "\u53D1\u73B0\u662Fpadding\u7684\u95EE\u9898\nLLaMA-Factory\u6709padding\u5230\
          8\u7684\u500D\u6570Token\nevaluate\u65F6batch_size \u8BBE\u7F6E\u62101\u5C31\
          OK"
        updatedAt: '2023-12-28T06:47:27.381Z'
      numEdits: 0
      reactions: []
      relatedEventId: 658d19ff3823e3d1e5f842e8
    id: 658d19ff3823e3d1e5f842e3
    type: comment
  author: charry2000
  content: "\u53D1\u73B0\u662Fpadding\u7684\u95EE\u9898\nLLaMA-Factory\u6709padding\u5230\
    8\u7684\u500D\u6570Token\nevaluate\u65F6batch_size \u8BBE\u7F6E\u62101\u5C31OK"
  created_at: 2023-12-28 06:47:27+00:00
  edited: false
  hidden: false
  id: 658d19ff3823e3d1e5f842e3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/6027ab83c3637c8252da98888d0c90b3.svg
      fullname: charryshi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: charry2000
      type: user
    createdAt: '2023-12-28T06:47:27.000Z'
    data:
      status: closed
    id: 658d19ff3823e3d1e5f842e8
    type: status-change
  author: charry2000
  created_at: 2023-12-28 06:47:27+00:00
  id: 658d19ff3823e3d1e5f842e8
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: yuyijiong/Qwen-14b-chat-yarn-32k
repo_type: model
status: closed
target_branch: null
title: "\u7528LLaMA-Factory\u9879\u76EE\u505Asft\u548Cevaluate\u65F6\u62A5\u9519"
