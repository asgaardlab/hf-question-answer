!!python/object:huggingface_hub.community.DiscussionWithDetails
author: filipfranek
conflicting_files: null
created_at: 2023-08-02 04:35:49+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0277040ad06c2415114b9c6128609dd1.svg
      fullname: Filip Franek
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: filipfranek
      type: user
    createdAt: '2023-08-02T05:35:49.000Z'
    data:
      edited: false
      editors:
      - filipfranek
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4846966862678528
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0277040ad06c2415114b9c6128609dd1.svg
          fullname: Filip Franek
          isHf: false
          isPro: false
          name: filipfranek
          type: user
        html: "<pre><code class=\"language-bash\">root@d5f815dce7a8:/src<span class=\"\
          hljs-comment\"># python3 inference.py -i inputs/audio_example.wav -o outputs\
          \ -t other --ckpt-path saved_models/other/other.ckpt</span>\nTraceback (most\
          \ recent call last):\n  File <span class=\"hljs-string\">\"/src/inference.py\"\
          </span>, line 111, <span class=\"hljs-keyword\">in</span> &lt;module&gt;\n\
          \    main(args)\n  File <span class=\"hljs-string\">\"/src/inference.py\"\
          </span>, line 64, <span class=\"hljs-keyword\">in</span> main\n    program\
          \ = InferenceProgram(**args)\n  File <span class=\"hljs-string\">\"/src/inference.py\"\
          </span>, line 45, <span class=\"hljs-keyword\">in</span> __init__\n    self.sep\
          \ = Separator(self.cfg, self.ckpt_path)\n  File <span class=\"hljs-string\"\
          >\"/src/separator.py\"</span>, line 25, <span class=\"hljs-keyword\">in</span>\
          \ __init__\n    self.model = self.initialize_modules()\n  File <span class=\"\
          hljs-string\">\"/src/separator.py\"</span>, line 55, <span class=\"hljs-keyword\"\
          >in</span> initialize_modules\n    state_dict = load_pl_state_dict(self.ckpt_path,\
          \ device=<span class=\"hljs-string\">'cpu'</span>)\n  File <span class=\"\
          hljs-string\">\"/src/utils/utils_inference.py\"</span>, line 14, <span class=\"\
          hljs-keyword\">in</span> load_pl_state_dict\n    sd = torch.load(path, map_location=device)\n\
          \  File <span class=\"hljs-string\">\"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          </span>, line 789, <span class=\"hljs-keyword\">in</span> load\n    <span\
          \ class=\"hljs-built_in\">return</span> _load(opened_zipfile, map_location,\
          \ pickle_module, **pickle_load_args)\n  File <span class=\"hljs-string\"\
          >\"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"</span>,\
          \ line 1131, <span class=\"hljs-keyword\">in</span> _load\n    result =\
          \ unpickler.load()\n  File <span class=\"hljs-string\">\"/usr/local/lib/python3.10/pickle.py\"\
          </span>, line 1213, <span class=\"hljs-keyword\">in</span> load\n    dispatch[key[0]](self)\n\
          \  File <span class=\"hljs-string\">\"/usr/local/lib/python3.10/pickle.py\"\
          </span>, line 1254, <span class=\"hljs-keyword\">in</span> load_binpersid\n\
          \    self.append(self.persistent_load(pid))\n  File <span class=\"hljs-string\"\
          >\"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"</span>,\
          \ line 1101, <span class=\"hljs-keyword\">in</span> persistent_load\n  \
          \  load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))\n  File\
          \ <span class=\"hljs-string\">\"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          </span>, line 1079, <span class=\"hljs-keyword\">in</span> load_tensor\n\
          \    storage = zip_file.get_storage_from_record(name, numel, torch.UntypedStorage).storage().untyped()\n\
          RuntimeError: PytorchStreamReader failed reading file data/78: invalid header\
          \ or archive is corrupted\n</code></pre>\n"
        raw: "```bash\r\nroot@d5f815dce7a8:/src# python3 inference.py -i inputs/audio_example.wav\
          \ -o outputs -t other --ckpt-path saved_models/other/other.ckpt\r\nTraceback\
          \ (most recent call last):\r\n  File \"/src/inference.py\", line 111, in\
          \ <module>\r\n    main(args)\r\n  File \"/src/inference.py\", line 64, in\
          \ main\r\n    program = InferenceProgram(**args)\r\n  File \"/src/inference.py\"\
          , line 45, in __init__\r\n    self.sep = Separator(self.cfg, self.ckpt_path)\r\
          \n  File \"/src/separator.py\", line 25, in __init__\r\n    self.model =\
          \ self.initialize_modules()\r\n  File \"/src/separator.py\", line 55, in\
          \ initialize_modules\r\n    state_dict = load_pl_state_dict(self.ckpt_path,\
          \ device='cpu')\r\n  File \"/src/utils/utils_inference.py\", line 14, in\
          \ load_pl_state_dict\r\n    sd = torch.load(path, map_location=device)\r\
          \n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          , line 789, in load\r\n    return _load(opened_zipfile, map_location, pickle_module,\
          \ **pickle_load_args)\r\n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          , line 1131, in _load\r\n    result = unpickler.load()\r\n  File \"/usr/local/lib/python3.10/pickle.py\"\
          , line 1213, in load\r\n    dispatch[key[0]](self)\r\n  File \"/usr/local/lib/python3.10/pickle.py\"\
          , line 1254, in load_binpersid\r\n    self.append(self.persistent_load(pid))\r\
          \n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          , line 1101, in persistent_load\r\n    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))\r\
          \n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
          , line 1079, in load_tensor\r\n    storage = zip_file.get_storage_from_record(name,\
          \ numel, torch.UntypedStorage).storage().untyped()\r\nRuntimeError: PytorchStreamReader\
          \ failed reading file data/78: invalid header or archive is corrupted\r\n\
          ```"
        updatedAt: '2023-08-02T05:35:49.519Z'
      numEdits: 0
      reactions: []
    id: 64c9eb3529d2f65419fd7072
    type: comment
  author: filipfranek
  content: "```bash\r\nroot@d5f815dce7a8:/src# python3 inference.py -i inputs/audio_example.wav\
    \ -o outputs -t other --ckpt-path saved_models/other/other.ckpt\r\nTraceback (most\
    \ recent call last):\r\n  File \"/src/inference.py\", line 111, in <module>\r\n\
    \    main(args)\r\n  File \"/src/inference.py\", line 64, in main\r\n    program\
    \ = InferenceProgram(**args)\r\n  File \"/src/inference.py\", line 45, in __init__\r\
    \n    self.sep = Separator(self.cfg, self.ckpt_path)\r\n  File \"/src/separator.py\"\
    , line 25, in __init__\r\n    self.model = self.initialize_modules()\r\n  File\
    \ \"/src/separator.py\", line 55, in initialize_modules\r\n    state_dict = load_pl_state_dict(self.ckpt_path,\
    \ device='cpu')\r\n  File \"/src/utils/utils_inference.py\", line 14, in load_pl_state_dict\r\
    \n    sd = torch.load(path, map_location=device)\r\n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
    , line 789, in load\r\n    return _load(opened_zipfile, map_location, pickle_module,\
    \ **pickle_load_args)\r\n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\"\
    , line 1131, in _load\r\n    result = unpickler.load()\r\n  File \"/usr/local/lib/python3.10/pickle.py\"\
    , line 1213, in load\r\n    dispatch[key[0]](self)\r\n  File \"/usr/local/lib/python3.10/pickle.py\"\
    , line 1254, in load_binpersid\r\n    self.append(self.persistent_load(pid))\r\
    \n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\", line\
    \ 1101, in persistent_load\r\n    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))\r\
    \n  File \"/usr/local/lib/python3.10/site-packages/torch/serialization.py\", line\
    \ 1079, in load_tensor\r\n    storage = zip_file.get_storage_from_record(name,\
    \ numel, torch.UntypedStorage).storage().untyped()\r\nRuntimeError: PytorchStreamReader\
    \ failed reading file data/78: invalid header or archive is corrupted\r\n```"
  created_at: 2023-08-02 04:35:49+00:00
  edited: false
  hidden: false
  id: 64c9eb3529d2f65419fd7072
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d1eab88f77d22509ae1e06612d3b6bbc.svg
      fullname: Amir Amitai
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: minizero
      type: user
    createdAt: '2023-12-20T16:56:23.000Z'
    data:
      edited: false
      editors:
      - minizero
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6361656785011292
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d1eab88f77d22509ae1e06612d3b6bbc.svg
          fullname: Amir Amitai
          isHf: false
          isPro: false
          name: minizero
          type: user
        html: "<p>I'm getting this with the drums ckpt as well.<br>python inference.py\
          \ -i sample.mp3 -o outputs -t drums --ckpt-path saved_models/drums/drums.ckpt\
          \                                                                      \
          \            \u2500\u256F<br>Traceback (most recent call last):<br>  File\
          \ \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 111, in <br>    main(args)<br>  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 64, in main<br>    program = InferenceProgram(**args)<br>  File \"\
          /Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 45, in <strong>init</strong><br>    self.sep = Separator(self.cfg,\
          \ self.ckpt_path)<br>  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\"\
          , line 25, in <strong>init</strong><br>    self.model = self.initialize_modules()<br>\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\"\
          , line 55, in initialize_modules<br>    state_dict = load_pl_state_dict(self.ckpt_path,\
          \ device='cpu')<br>  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/utils/utils_inference.py\"\
          , line 14, in load_pl_state_dict<br>    sd = torch.load(path, map_location=device)<br>\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 789, in load<br>    return _load(opened_zipfile, map_location, pickle_module,\
          \ **pickle_load_args)<br>  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1131, in _load<br>    result = unpickler.load()<br>  File \"/usr/local/Cellar/<a\
          \ rel=\"nofollow\" href=\"mailto:python@3.9\">python@3.9</a>/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
          , line 1212, in load<br>    dispatch<a rel=\"nofollow\" href=\"self\">key[0]</a><br>\
          \  File \"/usr/local/Cellar/<a rel=\"nofollow\" href=\"mailto:python@3.9\"\
          >python@3.9</a>/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
          , line 1253, in load_binpersid<br>    self.append(self.persistent_load(pid))<br>\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1101, in persistent_load<br>    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))<br>\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1079, in load_tensor<br>    storage = zip_file.get_storage_from_record(name,\
          \ numel, torch.UntypedStorage).storage().untyped()<br>RuntimeError: PytorchStreamReader\
          \ failed reading file data/76: invalid header or archive is corrupted</p>\n"
        raw: "I'm getting this with the drums ckpt as well.\npython inference.py -i\
          \ sample.mp3 -o outputs -t drums --ckpt-path saved_models/drums/drums.ckpt\
          \                                                                      \
          \            \u2500\u256F\nTraceback (most recent call last):\n  File \"\
          /Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 111, in <module>\n    main(args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 64, in main\n    program = InferenceProgram(**args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
          , line 45, in __init__\n    self.sep = Separator(self.cfg, self.ckpt_path)\n\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\"\
          , line 25, in __init__\n    self.model = self.initialize_modules()\n  File\
          \ \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\"\
          , line 55, in initialize_modules\n    state_dict = load_pl_state_dict(self.ckpt_path,\
          \ device='cpu')\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/utils/utils_inference.py\"\
          , line 14, in load_pl_state_dict\n    sd = torch.load(path, map_location=device)\n\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 789, in load\n    return _load(opened_zipfile, map_location, pickle_module,\
          \ **pickle_load_args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1131, in _load\n    result = unpickler.load()\n  File \"/usr/local/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
          , line 1212, in load\n    dispatch[key[0]](self)\n  File \"/usr/local/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
          , line 1253, in load_binpersid\n    self.append(self.persistent_load(pid))\n\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1101, in persistent_load\n    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))\n\
          \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 1079, in load_tensor\n    storage = zip_file.get_storage_from_record(name,\
          \ numel, torch.UntypedStorage).storage().untyped()\nRuntimeError: PytorchStreamReader\
          \ failed reading file data/76: invalid header or archive is corrupted"
        updatedAt: '2023-12-20T16:56:23.129Z'
      numEdits: 0
      reactions: []
    id: 65831cb7cf92e8f35cc35bf0
    type: comment
  author: minizero
  content: "I'm getting this with the drums ckpt as well.\npython inference.py -i\
    \ sample.mp3 -o outputs -t drums --ckpt-path saved_models/drums/drums.ckpt   \
    \                                                                            \
    \   \u2500\u256F\nTraceback (most recent call last):\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
    , line 111, in <module>\n    main(args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
    , line 64, in main\n    program = InferenceProgram(**args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/inference.py\"\
    , line 45, in __init__\n    self.sep = Separator(self.cfg, self.ckpt_path)\n \
    \ File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\"\
    , line 25, in __init__\n    self.model = self.initialize_modules()\n  File \"\
    /Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/separator.py\", line\
    \ 55, in initialize_modules\n    state_dict = load_pl_state_dict(self.ckpt_path,\
    \ device='cpu')\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/src/utils/utils_inference.py\"\
    , line 14, in load_pl_state_dict\n    sd = torch.load(path, map_location=device)\n\
    \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
    , line 789, in load\n    return _load(opened_zipfile, map_location, pickle_module,\
    \ **pickle_load_args)\n  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
    , line 1131, in _load\n    result = unpickler.load()\n  File \"/usr/local/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
    , line 1212, in load\n    dispatch[key[0]](self)\n  File \"/usr/local/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py\"\
    , line 1253, in load_binpersid\n    self.append(self.persistent_load(pid))\n \
    \ File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
    , line 1101, in persistent_load\n    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))\n\
    \  File \"/Users/amir/Projects/Music-Demixing-with-Band-Split-RNN/.env/lib/python3.9/site-packages/torch/serialization.py\"\
    , line 1079, in load_tensor\n    storage = zip_file.get_storage_from_record(name,\
    \ numel, torch.UntypedStorage).storage().untyped()\nRuntimeError: PytorchStreamReader\
    \ failed reading file data/76: invalid header or archive is corrupted"
  created_at: 2023-12-20 16:56:23+00:00
  edited: false
  hidden: false
  id: 65831cb7cf92e8f35cc35bf0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/6o4QjnxhJ0gLS4lnn06pi.jpeg?w=200&h=200&f=face
      fullname: Chris Landschoot
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: crlandsc
      type: user
    createdAt: '2024-01-05T02:09:08.000Z'
    data:
      edited: false
      editors:
      - crlandsc
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9662032723426819
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/6o4QjnxhJ0gLS4lnn06pi.jpeg?w=200&h=200&f=face
          fullname: Chris Landschoot
          isHf: false
          isPro: false
          name: crlandsc
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;filipfranek&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/filipfranek\"\
          >@<span class=\"underline\">filipfranek</span></a></span>\n\n\t</span></span>\
          \ <span data-props=\"{&quot;user&quot;:&quot;minizero&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/minizero\">@<span class=\"\
          underline\">minizero</span></a></span>\n\n\t</span></span> Sorry for the\
          \ delayed response. I am not sure what happened with those checkpoints,\
          \ but they also gave me the same errors when I downloaded and tried them.\
          \ I re-uploaded fixed checkpoints for both <code>drums</code> and <code>other</code>.\
          \ The existing <code>vocals</code> and <code>bass</code> checkpoints did\
          \ not appear corrupted. So I believe that all models should work now, but\
          \ let me know if you run into more issues. Cheers!</p>\n"
        raw: '@filipfranek @minizero Sorry for the delayed response. I am not sure
          what happened with those checkpoints, but they also gave me the same errors
          when I downloaded and tried them. I re-uploaded fixed checkpoints for both
          `drums` and `other`. The existing `vocals` and `bass` checkpoints did not
          appear corrupted. So I believe that all models should work now, but let
          me know if you run into more issues. Cheers!'
        updatedAt: '2024-01-05T02:09:08.278Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - filipfranek
    id: 659764c4092b4516b8735706
    type: comment
  author: crlandsc
  content: '@filipfranek @minizero Sorry for the delayed response. I am not sure what
    happened with those checkpoints, but they also gave me the same errors when I
    downloaded and tried them. I re-uploaded fixed checkpoints for both `drums` and
    `other`. The existing `vocals` and `bass` checkpoints did not appear corrupted.
    So I believe that all models should work now, but let me know if you run into
    more issues. Cheers!'
  created_at: 2024-01-05 02:09:08+00:00
  edited: false
  hidden: false
  id: 659764c4092b4516b8735706
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: crlandsc/bsrnn-drums
repo_type: model
status: open
target_branch: null
title: Is this model corrupted?
