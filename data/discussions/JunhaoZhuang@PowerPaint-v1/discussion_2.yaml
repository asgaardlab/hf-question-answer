!!python/object:huggingface_hub.community.DiscussionWithDetails
author: fromnovelai
conflicting_files: null
created_at: 2023-12-12 16:52:54+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/956d5f32e36abbd05b6f85ed9f4de9d6.svg
      fullname: noelram
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: fromnovelai
      type: user
    createdAt: '2023-12-12T16:52:54.000Z'
    data:
      edited: false
      editors:
      - fromnovelai
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8062363862991333
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/956d5f32e36abbd05b6f85ed9f4de9d6.svg
          fullname: noelram
          isHf: false
          isPro: false
          name: fromnovelai
          type: user
        html: '<p>When I run <code>python gradio_PowerPaint.py</code>, it looks for
          a .bin file in models/unet folder. But the model is a .safetensors file,
          changing the extension to .bin causes a pickle error. Any workaround?</p>

          '
        raw: When I run `python gradio_PowerPaint.py`, it looks for a .bin file in
          models/unet folder. But the model is a .safetensors file, changing the extension
          to .bin causes a pickle error. Any workaround?
        updatedAt: '2023-12-12T16:52:54.774Z'
      numEdits: 0
      reactions: []
    id: 65788fe658d7a2cc894f58cb
    type: comment
  author: fromnovelai
  content: When I run `python gradio_PowerPaint.py`, it looks for a .bin file in models/unet
    folder. But the model is a .safetensors file, changing the extension to .bin causes
    a pickle error. Any workaround?
  created_at: 2023-12-12 16:52:54+00:00
  edited: false
  hidden: false
  id: 65788fe658d7a2cc894f58cb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/be0a0c3902553e9f6904dd0c90724a1e.svg
      fullname: Jack Wooldridge
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jwooldridge
      type: user
    createdAt: '2023-12-12T16:57:21.000Z'
    data:
      edited: true
      editors:
      - jwooldridge
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9984961748123169
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/be0a0c3902553e9f6904dd0c90724a1e.svg
          fullname: Jack Wooldridge
          isHf: false
          isPro: false
          name: jwooldridge
          type: user
        html: '<p>Yeah, I''m seeing this too. Looks like there was a .bin but it was
          deleted. Changing the code to reference a .safetensors file also seems to
          cause a pickle error.</p>

          '
        raw: 'Yeah, I''m seeing this too. Looks like there was a .bin but it was deleted.
          Changing the code to reference a .safetensors file also seems to cause a
          pickle error.

          '
        updatedAt: '2023-12-12T16:58:03.335Z'
      numEdits: 1
      reactions: []
    id: 657890f1dea7e2122d15730e
    type: comment
  author: jwooldridge
  content: 'Yeah, I''m seeing this too. Looks like there was a .bin but it was deleted.
    Changing the code to reference a .safetensors file also seems to cause a pickle
    error.

    '
  created_at: 2023-12-12 16:57:21+00:00
  edited: true
  hidden: false
  id: 657890f1dea7e2122d15730e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/da4a1cc64ee87269b96a6b13812267a5.svg
      fullname: Stefan Ripperger
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: objected
      type: user
    createdAt: '2023-12-13T00:21:42.000Z'
    data:
      edited: true
      editors:
      - objected
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.868725597858429
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/da4a1cc64ee87269b96a6b13812267a5.svg
          fullname: Stefan Ripperger
          isHf: false
          isPro: false
          name: objected
          type: user
        html: '<p>fix (open) was provided (<a rel="nofollow" href="https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46">https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46</a>
          ) but cannot get it to work (see error) despite the safetensors being in
          the right models/unet folder..<br>Get FileNotFoundError for safetensors
          file</p>

          '
        raw: 'fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46
          ) but cannot get it to work (see error) despite the safetensors being in
          the right models/unet folder..

          Get FileNotFoundError for safetensors file'
        updatedAt: '2023-12-13T00:22:35.510Z'
      numEdits: 2
      reactions: []
    id: 6578f916c17736d75f77d9ab
    type: comment
  author: objected
  content: 'fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46
    ) but cannot get it to work (see error) despite the safetensors being in the right
    models/unet folder..

    Get FileNotFoundError for safetensors file'
  created_at: 2023-12-13 00:21:42+00:00
  edited: true
  hidden: false
  id: 6578f916c17736d75f77d9ab
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62a6256c438d5e5378ab2898/CqwZE1C7rBa0bOVKH04j4.jpeg?w=200&h=200&f=face
      fullname: Marc
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: cibernicola
      type: user
    createdAt: '2023-12-13T10:15:20.000Z'
    data:
      edited: false
      editors:
      - cibernicola
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3808140456676483
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62a6256c438d5e5378ab2898/CqwZE1C7rBa0bOVKH04j4.jpeg?w=200&h=200&f=face
          fullname: Marc
          isHf: false
          isPro: false
          name: cibernicola
          type: user
        html: '<p>After "fixing" .bin model load error, I''m getting this:<br>Traceback
          (most recent call last):<br>  File "****\mmagic\projects\powerpaint\gradio_PowerPaint.py",
          line 37, in <br>    torch.load(''./models/unet/diffusion_pytorch_model.safetensors''),
          strict=False)<br>  File "****\mmagic\projects\powerpaint\PowerPaint\lib\site-packages\torch\serialization.py",
          line 1028, in load<br>    return _legacy_load(opened_file, map_location,
          pickle_module, **pickle_load_args)<br>  File "****\mmagic\projects\powerpaint\PowerPaint\lib\site-packages\torch\serialization.py",
          line 1246, in _legacy_load<br>    magic_number = pickle_module.load(f, **pickle_load_args)<br>_pickle.UnpicklingError:
          invalid load key, ''\xe8''.</p>

          '
        raw: "After \"fixing\" .bin model load error, I'm getting this:\nTraceback\
          \ (most recent call last):\n  File \"****\\mmagic\\projects\\powerpaint\\\
          gradio_PowerPaint.py\", line 37, in <module>\n    torch.load('./models/unet/diffusion_pytorch_model.safetensors'),\
          \ strict=False)\n  File \"****\\mmagic\\projects\\powerpaint\\PowerPaint\\\
          lib\\site-packages\\torch\\serialization.py\", line 1028, in load\n    return\
          \ _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\n\
          \  File \"****\\mmagic\\projects\\powerpaint\\PowerPaint\\lib\\site-packages\\\
          torch\\serialization.py\", line 1246, in _legacy_load\n    magic_number\
          \ = pickle_module.load(f, **pickle_load_args)\n_pickle.UnpicklingError:\
          \ invalid load key, '\\xe8'."
        updatedAt: '2023-12-13T10:15:20.301Z'
      numEdits: 0
      reactions: []
    id: 65798438fdec4d43c1b48424
    type: comment
  author: cibernicola
  content: "After \"fixing\" .bin model load error, I'm getting this:\nTraceback (most\
    \ recent call last):\n  File \"****\\mmagic\\projects\\powerpaint\\gradio_PowerPaint.py\"\
    , line 37, in <module>\n    torch.load('./models/unet/diffusion_pytorch_model.safetensors'),\
    \ strict=False)\n  File \"****\\mmagic\\projects\\powerpaint\\PowerPaint\\lib\\\
    site-packages\\torch\\serialization.py\", line 1028, in load\n    return _legacy_load(opened_file,\
    \ map_location, pickle_module, **pickle_load_args)\n  File \"****\\mmagic\\projects\\\
    powerpaint\\PowerPaint\\lib\\site-packages\\torch\\serialization.py\", line 1246,\
    \ in _legacy_load\n    magic_number = pickle_module.load(f, **pickle_load_args)\n\
    _pickle.UnpicklingError: invalid load key, '\\xe8'."
  created_at: 2023-12-13 10:15:20+00:00
  edited: false
  hidden: false
  id: 65798438fdec4d43c1b48424
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/52e9c60b8f35302c4db18c69b7d16702.svg
      fullname: Alexey
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alexbespik
      type: user
    createdAt: '2023-12-13T22:07:05.000Z'
    data:
      edited: false
      editors:
      - alexbespik
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.415718138217926
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/52e9c60b8f35302c4db18c69b7d16702.svg
          fullname: Alexey
          isHf: false
          isPro: false
          name: alexbespik
          type: user
        html: '<blockquote>

          <p>fix (open) was provided (<a rel="nofollow" href="https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46">https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46</a>
          ) but cannot get it to work (see error) despite the safetensors being in
          the right models/unet folder..<br>Get FileNotFoundError for safetensors
          file</p>

          </blockquote>

          <p>I have same problem :<br>When i use fix - Traceback (most recent call
          last):<br>  File "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py",
          line 38, in <br>    load_file(''./models/unet/diffusion_pytorch_model.safetensors'',
          device=''cuda''), strict=False)<br>    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py",
          line 308, in load_file<br>    with safe_open(filename, framework="pt", device=device)
          as f:</p>

          <pre><code>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

          </code></pre>

          <p>safetensors_rust.SafetensorError: Error while deserializing header: HeaderTooLarge</p>

          '
        raw: "> fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
          \ ) but cannot get it to work (see error) despite the safetensors being\
          \ in the right models/unet folder..\n> Get FileNotFoundError for safetensors\
          \ file\n\nI have same problem :\nWhen i use fix - Traceback (most recent\
          \ call last):\n  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
          , line 38, in <module>\n    load_file('./models/unet/diffusion_pytorch_model.safetensors',\
          \ device='cuda'), strict=False)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py\"\
          , line 308, in load_file\n    with safe_open(filename, framework=\"pt\"\
          , device=device) as f:\n\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          safetensors_rust.SafetensorError: Error while deserializing header: HeaderTooLarge"
        updatedAt: '2023-12-13T22:07:05.584Z'
      numEdits: 0
      reactions: []
    id: 657a2b09c6240db29fe36457
    type: comment
  author: alexbespik
  content: "> fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
    \ ) but cannot get it to work (see error) despite the safetensors being in the\
    \ right models/unet folder..\n> Get FileNotFoundError for safetensors file\n\n\
    I have same problem :\nWhen i use fix - Traceback (most recent call last):\n \
    \ File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
    , line 38, in <module>\n    load_file('./models/unet/diffusion_pytorch_model.safetensors',\
    \ device='cuda'), strict=False)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py\"\
    , line 308, in load_file\n    with safe_open(filename, framework=\"pt\", device=device)\
    \ as f:\n\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsafetensors_rust.SafetensorError:\
    \ Error while deserializing header: HeaderTooLarge"
  created_at: 2023-12-13 22:07:05+00:00
  edited: false
  hidden: false
  id: 657a2b09c6240db29fe36457
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/52e9c60b8f35302c4db18c69b7d16702.svg
      fullname: Alexey
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alexbespik
      type: user
    createdAt: '2023-12-13T22:20:20.000Z'
    data:
      edited: false
      editors:
      - alexbespik
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.2932467460632324
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/52e9c60b8f35302c4db18c69b7d16702.svg
          fullname: Alexey
          isHf: false
          isPro: false
          name: alexbespik
          type: user
        html: '<blockquote>

          <blockquote>

          <p>fix (open) was provided (<a rel="nofollow" href="https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46">https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46</a>
          ) but cannot get it to work (see error) despite the safetensors being in
          the right models/unet folder..<br>Get FileNotFoundError for safetensors
          file</p>

          </blockquote>

          <p>I have same problem :<br>When i use fix - Traceback (most recent call
          last):<br>  File "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py",
          line 38, in <br>    load_file(''./models/unet/diffusion_pytorch_model.safetensors'',
          device=''cuda''), strict=False)<br>    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py",
          line 308, in load_file<br>    with safe_open(filename, framework="pt", device=device)
          as f:</p>

          <pre><code>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

          </code></pre>

          <p>safetensors_rust.SafetensorError: Error while deserializing header: HeaderTooLarge</p>

          </blockquote>

          <p>if i download .bin file - Traceback (most recent call last):<br>  File
          "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py",
          line 39, in <br>    torch.load(''./models/text_encoder/pytorch_model.bin''),
          strict=False)<br>    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py",
          line 1028, in load<br>    return _legacy_load(opened_file, map_location,
          pickle_module, **pickle_load_args)<br>           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py",
          line 1246, in _legacy_load<br>    magic_number = pickle_module.load(f, **pickle_load_args)<br>                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>_pickle.UnpicklingError:
          invalid load key, ''v''.</p>

          '
        raw: "> > fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
          \ ) but cannot get it to work (see error) despite the safetensors being\
          \ in the right models/unet folder..\n> > Get FileNotFoundError for safetensors\
          \ file\n> \n> I have same problem :\n> When i use fix - Traceback (most\
          \ recent call last):\n>   File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
          , line 38, in <module>\n>     load_file('./models/unet/diffusion_pytorch_model.safetensors',\
          \ device='cuda'), strict=False)\n>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          >   File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py\"\
          , line 308, in load_file\n>     with safe_open(filename, framework=\"pt\"\
          , device=device) as f:\n> \n>          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          > safetensors_rust.SafetensorError: Error while deserializing header: HeaderTooLarge\n\
          \nif i download .bin file - Traceback (most recent call last):\n  File \"\
          /run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
          , line 39, in <module>\n    torch.load('./models/text_encoder/pytorch_model.bin'),\
          \ strict=False)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py\"\
          , line 1028, in load\n    return _legacy_load(opened_file, map_location,\
          \ pickle_module, **pickle_load_args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py\"\
          , line 1246, in _legacy_load\n    magic_number = pickle_module.load(f, **pickle_load_args)\n\
          \                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_pickle.UnpicklingError:\
          \ invalid load key, 'v'.\n\n"
        updatedAt: '2023-12-13T22:20:20.114Z'
      numEdits: 0
      reactions: []
    id: 657a2e24f55b7314c3cb88cf
    type: comment
  author: alexbespik
  content: "> > fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
    \ ) but cannot get it to work (see error) despite the safetensors being in the\
    \ right models/unet folder..\n> > Get FileNotFoundError for safetensors file\n\
    > \n> I have same problem :\n> When i use fix - Traceback (most recent call last):\n\
    >   File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
    , line 38, in <module>\n>     load_file('./models/unet/diffusion_pytorch_model.safetensors',\
    \ device='cuda'), strict=False)\n>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    >   File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/safetensors/torch.py\"\
    , line 308, in load_file\n>     with safe_open(filename, framework=\"pt\", device=device)\
    \ as f:\n> \n>          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>\
    \ safetensors_rust.SafetensorError: Error while deserializing header: HeaderTooLarge\n\
    \nif i download .bin file - Traceback (most recent call last):\n  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/gradio_PowerPaint.py\"\
    , line 39, in <module>\n    torch.load('./models/text_encoder/pytorch_model.bin'),\
    \ strict=False)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \
    \ File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py\"\
    , line 1028, in load\n    return _legacy_load(opened_file, map_location, pickle_module,\
    \ **pickle_load_args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/run/media/alexbespik/e8df4068-7043-49ee-928b-ecb0cf9e68fb/mmagic/projects/powerpaint/power/lib/python3.11/site-packages/torch/serialization.py\"\
    , line 1246, in _legacy_load\n    magic_number = pickle_module.load(f, **pickle_load_args)\n\
    \                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_pickle.UnpicklingError:\
    \ invalid load key, 'v'.\n\n"
  created_at: 2023-12-13 22:20:20+00:00
  edited: false
  hidden: false
  id: 657a2e24f55b7314c3cb88cf
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/956d5f32e36abbd05b6f85ed9f4de9d6.svg
      fullname: noelram
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: fromnovelai
      type: user
    createdAt: '2023-12-14T13:59:23.000Z'
    data:
      edited: false
      editors:
      - fromnovelai
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9896214604377747
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/956d5f32e36abbd05b6f85ed9f4de9d6.svg
          fullname: noelram
          isHf: false
          isPro: false
          name: fromnovelai
          type: user
        html: '<p>That fix is not reviewed or merged yet</p>

          '
        raw: That fix is not reviewed or merged yet
        updatedAt: '2023-12-14T13:59:23.234Z'
      numEdits: 0
      reactions: []
    id: 657b0a3b7e310c3702f37772
    type: comment
  author: fromnovelai
  content: That fix is not reviewed or merged yet
  created_at: 2023-12-14 13:59:23+00:00
  edited: false
  hidden: false
  id: 657b0a3b7e310c3702f37772
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/aac0a4757aa49c483f20b3e6c56affd1.svg
      fullname: EE
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: vlorxpax
      type: user
    createdAt: '2023-12-15T22:42:12.000Z'
    data:
      edited: false
      editors:
      - vlorxpax
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6943029761314392
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/aac0a4757aa49c483f20b3e6c56affd1.svg
          fullname: EE
          isHf: false
          isPro: false
          name: vlorxpax
          type: user
        html: '<blockquote>

          <p>fix (open) was provided (<a rel="nofollow" href="https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46">https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46</a>
          ) but cannot get it to work (see error) despite the safetensors being in
          the right models/unet folder..<br>Get FileNotFoundError for safetensors
          file</p>

          </blockquote>

          <p>When I run this .py, this is the error I get:</p>

          <p>(base) PS D:\AI\mmagic\projects\powerpaint&gt; python gradio_PowerPaint.py<br>Traceback
          (most recent call last):<br>  File "D:\AI\mmagic\projects\powerpaint\gradio_PowerPaint.py",
          line 3, in <br>    import cv2<br>ModuleNotFoundError: No module named ''cv2''</p>

          '
        raw: "> fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
          \ ) but cannot get it to work (see error) despite the safetensors being\
          \ in the right models/unet folder..\n> Get FileNotFoundError for safetensors\
          \ file\n\nWhen I run this .py, this is the error I get:\n\n(base) PS D:\\\
          AI\\mmagic\\projects\\powerpaint> python gradio_PowerPaint.py\nTraceback\
          \ (most recent call last):\n  File \"D:\\AI\\mmagic\\projects\\powerpaint\\\
          gradio_PowerPaint.py\", line 3, in <module>\n    import cv2\nModuleNotFoundError:\
          \ No module named 'cv2'"
        updatedAt: '2023-12-15T22:42:12.932Z'
      numEdits: 0
      reactions: []
    id: 657cd64456c9c676055c318a
    type: comment
  author: vlorxpax
  content: "> fix (open) was provided (https://github.com/open-mmlab/mmagic/pull/2088/commits/52b59c343443a2533c9724170f26bb653a817b46\
    \ ) but cannot get it to work (see error) despite the safetensors being in the\
    \ right models/unet folder..\n> Get FileNotFoundError for safetensors file\n\n\
    When I run this .py, this is the error I get:\n\n(base) PS D:\\AI\\mmagic\\projects\\\
    powerpaint> python gradio_PowerPaint.py\nTraceback (most recent call last):\n\
    \  File \"D:\\AI\\mmagic\\projects\\powerpaint\\gradio_PowerPaint.py\", line 3,\
    \ in <module>\n    import cv2\nModuleNotFoundError: No module named 'cv2'"
  created_at: 2023-12-15 22:42:12+00:00
  edited: false
  hidden: false
  id: 657cd64456c9c676055c318a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5a38239341f6993497c3cb5bd92e9ec6.svg
      fullname: Frank Salerno
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: a13ph
      type: user
    createdAt: '2024-01-05T08:00:17.000Z'
    data:
      edited: false
      editors:
      - a13ph
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5133277773857117
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5a38239341f6993497c3cb5bd92e9ec6.svg
          fullname: Frank Salerno
          isHf: false
          isPro: false
          name: a13ph
          type: user
        html: '<p>ENV: Win10 Python 3.10 Torch 2.1.0+cu118</p>

          <p>Using the code from  <a rel="nofollow" href="https://github.com/zhuang2002/PowerPaint">https://github.com/zhuang2002/PowerPaint</a>
          gradio_PowerPaint.py<br>And changing line 38 from /models/unet/ to /models/text_encoder/,
          so that lines 37 and 38 are now:</p>

          <p>| load_model(pipe.unet, "./models/unet/unet.safetensors")<br>| load_model(pipe.text_encoder,
          "./models/text_encoder/text_encoder.safetensors")</p>

          <p>7 pipeline components load without trouble, but then I receive the error:</p>

          <p>| RuntimeError: Error(s) in loading state_dict for CLIPTextModel:<br>|   Unexpected
          key(s) in state_dict: "text_model.embeddings.position_ids"</p>

          '
        raw: 'ENV: Win10 Python 3.10 Torch 2.1.0+cu118


          Using the code from  https://github.com/zhuang2002/PowerPaint gradio_PowerPaint.py

          And changing line 38 from /models/unet/ to /models/text_encoder/, so that
          lines 37 and 38 are now:


          | load_model(pipe.unet, "./models/unet/unet.safetensors")

          | load_model(pipe.text_encoder, "./models/text_encoder/text_encoder.safetensors")


          7 pipeline components load without trouble, but then I receive the error:


          | RuntimeError: Error(s) in loading state_dict for CLIPTextModel:

          |   Unexpected key(s) in state_dict: "text_model.embeddings.position_ids"'
        updatedAt: '2024-01-05T08:00:17.675Z'
      numEdits: 0
      reactions: []
    id: 6597b711ce6e887177f4b926
    type: comment
  author: a13ph
  content: 'ENV: Win10 Python 3.10 Torch 2.1.0+cu118


    Using the code from  https://github.com/zhuang2002/PowerPaint gradio_PowerPaint.py

    And changing line 38 from /models/unet/ to /models/text_encoder/, so that lines
    37 and 38 are now:


    | load_model(pipe.unet, "./models/unet/unet.safetensors")

    | load_model(pipe.text_encoder, "./models/text_encoder/text_encoder.safetensors")


    7 pipeline components load without trouble, but then I receive the error:


    | RuntimeError: Error(s) in loading state_dict for CLIPTextModel:

    |   Unexpected key(s) in state_dict: "text_model.embeddings.position_ids"'
  created_at: 2024-01-05 08:00:17+00:00
  edited: false
  hidden: false
  id: 6597b711ce6e887177f4b926
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6e9ace9a7c2fe1f666707252886ee664.svg
      fullname: Algi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AlgiAlgi
      type: user
    createdAt: '2024-01-17T08:21:30.000Z'
    data:
      edited: false
      editors:
      - AlgiAlgi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.416349321603775
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6e9ace9a7c2fe1f666707252886ee664.svg
          fullname: Algi
          isHf: false
          isPro: false
          name: AlgiAlgi
          type: user
        html: "<p>any fix for this? When I follow the steps I'm getting:</p>\n<p>vae\\\
          diffusion_pytorch_model.safetensors not found<br>Loading pipeline components...:\
          \   0%|                                                            | 0/7\
          \ [00:00&lt;?, ?it/s]<code>text_config_dict</code> is provided which will\
          \ be used to initialize <code>CLIPTextConfig</code>. The value <code>text_config[\"\
          id2label\"]</code> will be overriden.<br><code>text_config_dict</code> is\
          \ provided which will be used to initialize <code>CLIPTextConfig</code>.\
          \ The value <code>text_config[\"bos_token_id\"]</code> will be overriden.<br><code>text_config_dict</code>\
          \ is provided which will be used to initialize <code>CLIPTextConfig</code>.\
          \ The value <code>text_config[\"eos_token_id\"]</code> will be overriden.<br>Loading\
          \ pipeline components...: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 7/7 [00:06&lt;00:00,\
          \  1.12it/s]<br>01/17 09:20:05 - mmengine - INFO - Successfully add external\
          \ embeddings: P_ctxt, P_shape, P_obj.<br>01/17 09:20:05 - mmengine - INFO\
          \ - Successfully add trainable external embeddings: P_ctxt, P_shape, P_obj<br>Traceback\
          \ (most recent call last):<br>  File \"D:\\SDXL\\mmagic\\projects\\powerpaint\\\
          gradio_PowerPaint.py\", line 36, in <br>    load_model(pipe.unet, './models/unet/diffusion_pytorch_model.safetensors')<br>\
          \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
          safetensors\\torch.py\", line 197, in load_model<br>    state_dict = load_file(filename)<br>\
          \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
          safetensors\\torch.py\", line 308, in load_file<br>    with safe_open(filename,\
          \ framework=\"pt\", device=device) as f:<br>FileNotFoundError: No such file\
          \ or directory: \"./models/unet/diffusion_pytorch_model.safetensors\"</p>\n"
        raw: "any fix for this? When I follow the steps I'm getting:\n\nvae\\diffusion_pytorch_model.safetensors\
          \ not found\nLoading pipeline components...:   0%|                     \
          \                                       | 0/7 [00:00<?, ?it/s]`text_config_dict`\
          \ is provided which will be used to initialize `CLIPTextConfig`. The value\
          \ `text_config[\"id2label\"]` will be overriden.\n`text_config_dict` is\
          \ provided which will be used to initialize `CLIPTextConfig`. The value\
          \ `text_config[\"bos_token_id\"]` will be overriden.\n`text_config_dict`\
          \ is provided which will be used to initialize `CLIPTextConfig`. The value\
          \ `text_config[\"eos_token_id\"]` will be overriden.\nLoading pipeline components...:\
          \ 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588| 7/7 [00:06<00:00,  1.12it/s]\n01/17 09:20:05\
          \ - mmengine - INFO - Successfully add external embeddings: P_ctxt, P_shape,\
          \ P_obj.\n01/17 09:20:05 - mmengine - INFO - Successfully add trainable\
          \ external embeddings: P_ctxt, P_shape, P_obj\nTraceback (most recent call\
          \ last):\n  File \"D:\\SDXL\\mmagic\\projects\\powerpaint\\gradio_PowerPaint.py\"\
          , line 36, in <module>\n    load_model(pipe.unet, './models/unet/diffusion_pytorch_model.safetensors')\n\
          \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
          safetensors\\torch.py\", line 197, in load_model\n    state_dict = load_file(filename)\n\
          \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
          safetensors\\torch.py\", line 308, in load_file\n    with safe_open(filename,\
          \ framework=\"pt\", device=device) as f:\nFileNotFoundError: No such file\
          \ or directory: \"./models/unet/diffusion_pytorch_model.safetensors\""
        updatedAt: '2024-01-17T08:21:30.402Z'
      numEdits: 0
      reactions: []
    id: 65a78e0a5fe641336046d0f3
    type: comment
  author: AlgiAlgi
  content: "any fix for this? When I follow the steps I'm getting:\n\nvae\\diffusion_pytorch_model.safetensors\
    \ not found\nLoading pipeline components...:   0%|                           \
    \                                 | 0/7 [00:00<?, ?it/s]`text_config_dict` is\
    \ provided which will be used to initialize `CLIPTextConfig`. The value `text_config[\"\
    id2label\"]` will be overriden.\n`text_config_dict` is provided which will be\
    \ used to initialize `CLIPTextConfig`. The value `text_config[\"bos_token_id\"\
    ]` will be overriden.\n`text_config_dict` is provided which will be used to initialize\
    \ `CLIPTextConfig`. The value `text_config[\"eos_token_id\"]` will be overriden.\n\
    Loading pipeline components...: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588| 7/7 [00:06<00:00,  1.12it/s]\n01/17 09:20:05\
    \ - mmengine - INFO - Successfully add external embeddings: P_ctxt, P_shape, P_obj.\n\
    01/17 09:20:05 - mmengine - INFO - Successfully add trainable external embeddings:\
    \ P_ctxt, P_shape, P_obj\nTraceback (most recent call last):\n  File \"D:\\SDXL\\\
    mmagic\\projects\\powerpaint\\gradio_PowerPaint.py\", line 36, in <module>\n \
    \   load_model(pipe.unet, './models/unet/diffusion_pytorch_model.safetensors')\n\
    \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
    safetensors\\torch.py\", line 197, in load_model\n    state_dict = load_file(filename)\n\
    \  File \"C:\\Users\\alexg\\miniconda3\\envs\\PowerPaint\\lib\\site-packages\\\
    safetensors\\torch.py\", line 308, in load_file\n    with safe_open(filename,\
    \ framework=\"pt\", device=device) as f:\nFileNotFoundError: No such file or directory:\
    \ \"./models/unet/diffusion_pytorch_model.safetensors\""
  created_at: 2024-01-17 08:21:30+00:00
  edited: false
  hidden: false
  id: 65a78e0a5fe641336046d0f3
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: JunhaoZhuang/PowerPaint-v1
repo_type: model
status: open
target_branch: null
title: Code is looking for .bin file
