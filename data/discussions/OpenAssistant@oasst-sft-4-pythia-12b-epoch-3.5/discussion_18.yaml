!!python/object:huggingface_hub.community.DiscussionWithDetails
author: rociomcomin
conflicting_files: null
created_at: 2023-05-30 10:02:21+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3cd725f3f27d93ae83a4fd7705c58b92.svg
      fullname: 'Rocio Martinez '
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: rociomcomin
      type: user
    createdAt: '2023-05-30T11:02:21.000Z'
    data:
      edited: false
      editors:
      - rociomcomin
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3cd725f3f27d93ae83a4fd7705c58b92.svg
          fullname: 'Rocio Martinez '
          isHf: false
          isPro: false
          name: rociomcomin
          type: user
        html: '<p>I am trying to make inference with this code:</p>

          <p><code>from transformers import GPTNeoXForCausalLM, AutoTokenizer</code><br><code>tokenizer
          = AutoTokenizer.from_pretrained("OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5")</code><br><code>model
          = GPTNeoXForCausalLM.from_pretrained("OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",device_map="auto",
          load_in_8bit=True)</code><br><code>message = "&lt;|prompter|&gt;What is
          a meme, and what''s the history behind this word?&lt;|endoftext|&gt;&lt;|assistant|&gt;"</code><br><code>inputs
          = tokenizer(message, return_tensors="pt").to(model.device)</code><br><code>tokens
          = model.generate(**inputs,  max_new_tokens=1000, do_sample=True, temperature=0.8)</code><br><code>tokenizer.decode(tokens[0])</code></p>

          <p>and it''s returning this error all the time:<br><code>RuntimeError: probability
          tensor contains either inf, nan or element &lt; 0</code><br>Does anyone
          know how to solve it, my tensors have no ''nan'' values or ''inf''  I have
          checked them.</p>

          '
        raw: "I am trying to make inference with this code:\r\n\r\n`from transformers\
          \ import GPTNeoXForCausalLM, AutoTokenizer`\r\n`tokenizer = AutoTokenizer.from_pretrained(\"\
          OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5\")`\r\n`model = GPTNeoXForCausalLM.from_pretrained(\"\
          OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5\",device_map=\"auto\", load_in_8bit=True)`\r\
          \n`message = \"<|prompter|>What is a meme, and what's the history behind\
          \ this word?<|endoftext|><|assistant|>\"`\r\n`inputs = tokenizer(message,\
          \ return_tensors=\"pt\").to(model.device)`\r\n`tokens = model.generate(**inputs,\
          \  max_new_tokens=1000, do_sample=True, temperature=0.8)`\r\n`tokenizer.decode(tokens[0])`\r\
          \n\r\nand it's returning this error all the time:\r\n`RuntimeError: probability\
          \ tensor contains either inf, nan or element < 0`\r\nDoes anyone know how\
          \ to solve it, my tensors have no 'nan' values or 'inf'  I have checked\
          \ them."
        updatedAt: '2023-05-30T11:02:21.412Z'
      numEdits: 0
      reactions: []
    id: 6475d7bd9dd2b801b7789a43
    type: comment
  author: rociomcomin
  content: "I am trying to make inference with this code:\r\n\r\n`from transformers\
    \ import GPTNeoXForCausalLM, AutoTokenizer`\r\n`tokenizer = AutoTokenizer.from_pretrained(\"\
    OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5\")`\r\n`model = GPTNeoXForCausalLM.from_pretrained(\"\
    OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5\",device_map=\"auto\", load_in_8bit=True)`\r\
    \n`message = \"<|prompter|>What is a meme, and what's the history behind this\
    \ word?<|endoftext|><|assistant|>\"`\r\n`inputs = tokenizer(message, return_tensors=\"\
    pt\").to(model.device)`\r\n`tokens = model.generate(**inputs,  max_new_tokens=1000,\
    \ do_sample=True, temperature=0.8)`\r\n`tokenizer.decode(tokens[0])`\r\n\r\nand\
    \ it's returning this error all the time:\r\n`RuntimeError: probability tensor\
    \ contains either inf, nan or element < 0`\r\nDoes anyone know how to solve it,\
    \ my tensors have no 'nan' values or 'inf'  I have checked them."
  created_at: 2023-05-30 10:02:21+00:00
  edited: false
  hidden: false
  id: 6475d7bd9dd2b801b7789a43
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4ca53474fb81568feb200b069a2907f0.svg
      fullname: Rob Smith
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: robsmith155
      type: user
    createdAt: '2023-06-05T10:54:46.000Z'
    data:
      edited: false
      editors:
      - robsmith155
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9877830743789673
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4ca53474fb81568feb200b069a2907f0.svg
          fullname: Rob Smith
          isHf: false
          isPro: false
          name: robsmith155
          type: user
        html: '<p>I was also having this issue.  I found that if I set do_sample=False
          it would run, but do_sample=True would give the error you''re getting. I
          need to investigate more to see what happened (not sure if I changed something
          else in the code or if one of the libraries was updated) as ideally, I want
          to have the option of using do_sample.</p>

          '
        raw: I was also having this issue.  I found that if I set do_sample=False
          it would run, but do_sample=True would give the error you're getting. I
          need to investigate more to see what happened (not sure if I changed something
          else in the code or if one of the libraries was updated) as ideally, I want
          to have the option of using do_sample.
        updatedAt: '2023-06-05T10:54:46.012Z'
      numEdits: 0
      reactions: []
    id: 647dbef632c471a7fa858627
    type: comment
  author: robsmith155
  content: I was also having this issue.  I found that if I set do_sample=False it
    would run, but do_sample=True would give the error you're getting. I need to investigate
    more to see what happened (not sure if I changed something else in the code or
    if one of the libraries was updated) as ideally, I want to have the option of
    using do_sample.
  created_at: 2023-06-05 09:54:46+00:00
  edited: false
  hidden: false
  id: 647dbef632c471a7fa858627
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 18
repo_id: OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5
repo_type: model
status: open
target_branch: null
title: Probability tensor contains either `inf`, `nan` or element < 0
