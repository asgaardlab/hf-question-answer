!!python/object:huggingface_hub.community.DiscussionWithDetails
author: bhperry
conflicting_files: null
created_at: 2023-09-19 21:40:56+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c9f54e1831230262c08636ee3ec8bba3.svg
      fullname: Ben Perry
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: bhperry
      type: user
    createdAt: '2023-09-19T22:40:56.000Z'
    data:
      edited: false
      editors:
      - bhperry
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9279504418373108
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c9f54e1831230262c08636ee3ec8bba3.svg
          fullname: Ben Perry
          isHf: false
          isPro: false
          name: bhperry
          type: user
        html: '<p>In the model card it says the expected format is <code>[INST]\n&lt;text&gt;\n[/INST]\n\n</code>
          however after looking at the <a href="https://huggingface.co/datasets/togethercomputer/llama-instruct">dataset</a>
          and the <a rel="nofollow" href="https://github.com/togethercomputer/Llama-2-7B-32K-Instruct/blob/4a9c161b2fa17f30f743d12cd047422136fe0fb0/scripts/distill.py#L60">code</a>  it
          appears that the actual format it was trained on was <code> [INST]  &lt;text&gt;  [/INST]
          </code></p>

          <p>Is the model card incorrect or is there something I''m missing? It seems
          like it was never trained on the <code>\n</code> version of the prompt.
          Sort of works with the <code>\n</code> variant, but I seem to be getting
          better consistency and instruction following with the variant found in code/dataset.</p>

          '
        raw: "In the model card it says the expected format is `[INST]\\n<text>\\\
          n[/INST]\\n\\n` however after looking at the [dataset](https://huggingface.co/datasets/togethercomputer/llama-instruct)\
          \ and the [code](https://github.com/togethercomputer/Llama-2-7B-32K-Instruct/blob/4a9c161b2fa17f30f743d12cd047422136fe0fb0/scripts/distill.py#L60)\
          \  it appears that the actual format it was trained on was `  [INST]  <text>\
          \  [/INST]  `\r\n\r\nIs the model card incorrect or is there something I'm\
          \ missing? It seems like it was never trained on the `\\n` version of the\
          \ prompt. Sort of works with the `\\n` variant, but I seem to be getting\
          \ better consistency and instruction following with the variant found in\
          \ code/dataset."
        updatedAt: '2023-09-19T22:40:56.515Z'
      numEdits: 0
      reactions: []
    id: 650a2378623330a3a539a6c9
    type: comment
  author: bhperry
  content: "In the model card it says the expected format is `[INST]\\n<text>\\n[/INST]\\\
    n\\n` however after looking at the [dataset](https://huggingface.co/datasets/togethercomputer/llama-instruct)\
    \ and the [code](https://github.com/togethercomputer/Llama-2-7B-32K-Instruct/blob/4a9c161b2fa17f30f743d12cd047422136fe0fb0/scripts/distill.py#L60)\
    \  it appears that the actual format it was trained on was `  [INST]  <text> \
    \ [/INST]  `\r\n\r\nIs the model card incorrect or is there something I'm missing?\
    \ It seems like it was never trained on the `\\n` version of the prompt. Sort\
    \ of works with the `\\n` variant, but I seem to be getting better consistency\
    \ and instruction following with the variant found in code/dataset."
  created_at: 2023-09-19 21:40:56+00:00
  edited: false
  hidden: false
  id: 650a2378623330a3a539a6c9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/eacc95a482e4119caa8f3455278b74dc.svg
      fullname: Barnett
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zeekeez
      type: user
    createdAt: '2023-09-22T08:55:15.000Z'
    data:
      edited: false
      editors:
      - zeekeez
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4782567620277405
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/eacc95a482e4119caa8f3455278b74dc.svg
          fullname: Barnett
          isHf: false
          isPro: false
          name: zeekeez
          type: user
        html: '<p>bump</p>

          '
        raw: bump
        updatedAt: '2023-09-22T08:55:15.365Z'
      numEdits: 0
      reactions: []
    id: 650d5673c705442b28162dac
    type: comment
  author: zeekeez
  content: bump
  created_at: 2023-09-22 07:55:15+00:00
  edited: false
  hidden: false
  id: 650d5673c705442b28162dac
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6329ee3dab49d487dd1439ec/vxGvdBK0XMZaCpc5dGOIa.jpeg?w=200&h=200&f=face
      fullname: Maurice Weber
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: mauriceweber
      type: user
    createdAt: '2023-09-26T18:09:13.000Z'
    data:
      edited: false
      editors:
      - mauriceweber
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8983743786811829
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6329ee3dab49d487dd1439ec/vxGvdBK0XMZaCpc5dGOIa.jpeg?w=200&h=200&f=face
          fullname: Maurice Weber
          isHf: false
          isPro: false
          name: mauriceweber
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;bhperry&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/bhperry\">@<span class=\"\
          underline\">bhperry</span></a></span>\n\n\t</span></span> , great catch!\
          \ You are right, during training we used <code>[INST] &lt;text&gt; [/INST]</code>,\
          \ but we found that adding two newline characters during inference works\
          \ best. If in your case however, omitting the newlines works best, then\
          \ you can safely use the template without the newline characters.</p>\n"
        raw: Hi @bhperry , great catch! You are right, during training we used `[INST]
          <text> [/INST]`, but we found that adding two newline characters during
          inference works best. If in your case however, omitting the newlines works
          best, then you can safely use the template without the newline characters.
        updatedAt: '2023-09-26T18:09:13.805Z'
      numEdits: 0
      reactions: []
    id: 65131e490d463b73dcf5d5e3
    type: comment
  author: mauriceweber
  content: Hi @bhperry , great catch! You are right, during training we used `[INST]
    <text> [/INST]`, but we found that adding two newline characters during inference
    works best. If in your case however, omitting the newlines works best, then you
    can safely use the template without the newline characters.
  created_at: 2023-09-26 17:09:13+00:00
  edited: false
  hidden: false
  id: 65131e490d463b73dcf5d5e3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c9f54e1831230262c08636ee3ec8bba3.svg
      fullname: Ben Perry
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: bhperry
      type: user
    createdAt: '2023-09-26T22:28:00.000Z'
    data:
      edited: true
      editors:
      - bhperry
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8813198208808899
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c9f54e1831230262c08636ee3ec8bba3.svg
          fullname: Ben Perry
          isHf: false
          isPro: false
          name: bhperry
          type: user
        html: '<p>Interesting... thanks! After more experimentation, I seem to be
          getting the best results with a mix of the two formats. <code>[INST]  &lt;text&gt;  [/INST]\n\n</code></p>

          '
        raw: Interesting... thanks! After more experimentation, I seem to be getting
          the best results with a mix of the two formats. `[INST]  <text>  [/INST]\n\n`
        updatedAt: '2023-09-26T22:30:15.106Z'
      numEdits: 1
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - mauriceweber
    id: 65135af0739b1a50b292131e
    type: comment
  author: bhperry
  content: Interesting... thanks! After more experimentation, I seem to be getting
    the best results with a mix of the two formats. `[INST]  <text>  [/INST]\n\n`
  created_at: 2023-09-26 21:28:00+00:00
  edited: true
  hidden: false
  id: 65135af0739b1a50b292131e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/c9f54e1831230262c08636ee3ec8bba3.svg
      fullname: Ben Perry
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: bhperry
      type: user
    createdAt: '2023-09-27T15:45:42.000Z'
    data:
      status: closed
    id: 65144e260cf3d43ede4fb42e
    type: status-change
  author: bhperry
  created_at: 2023-09-27 14:45:42+00:00
  id: 65144e260cf3d43ede4fb42e
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 11
repo_id: togethercomputer/Llama-2-7B-32K-Instruct
repo_type: model
status: closed
target_branch: null
title: Prompt format different in dataset compared to model card
