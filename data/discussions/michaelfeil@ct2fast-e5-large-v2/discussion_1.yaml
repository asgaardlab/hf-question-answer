!!python/object:huggingface_hub.community.DiscussionWithDetails
author: limcheekin
conflicting_files: null
created_at: 2023-06-18 04:05:01+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/24a8c63c897efdd980ef9d4805cbff7b.svg
      fullname: Lim Chee Kin
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: limcheekin
      type: user
    createdAt: '2023-06-18T05:05:01.000Z'
    data:
      edited: true
      editors:
      - limcheekin
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8091992735862732
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/24a8c63c897efdd980ef9d4805cbff7b.svg
          fullname: Lim Chee Kin
          isHf: false
          isPro: false
          name: limcheekin
          type: user
        html: '<p>Thanks for sharing the model and sample code.</p>

          <p>I tested the model with the following parameters:</p>

          <pre><code class="language-python">device=<span class="hljs-string">''cpu''</span>,
          compute_type=<span class="hljs-string">''int8''</span>

          </code></pre>

          <p>and all combinations of the value of the <code>convert_to_numpy</code>
          and <code>normalize_embeddings</code> parameters:</p>

          <pre><code class="language-python">convert_to_numpy=<span class="hljs-literal">True</span>,   normalize_embeddings=<span
          class="hljs-literal">True</span>

          convert_to_numpy=<span class="hljs-literal">False</span>,  normalize_embeddings=<span
          class="hljs-literal">True</span>

          convert_to_numpy=<span class="hljs-literal">True</span>,   normalize_embeddings=<span
          class="hljs-literal">False</span>

          convert_to_numpy=<span class="hljs-literal">False</span>,  normalize_embeddings=<span
          class="hljs-literal">False</span>

          </code></pre>

          <p>The output of the information retrieval for open question answering is
          far from satisfactory compare to the embeddings created by the original
          <code>e5-large-v2</code> model. Is this known issue or I missed something?</p>

          <p>Please advise. Thank you.</p>

          '
        raw: 'Thanks for sharing the model and sample code.


          I tested the model with the following parameters:

          ```python

          device=''cpu'', compute_type=''int8''

          ```


          and all combinations of the value of the `convert_to_numpy` and `normalize_embeddings`
          parameters:

          ```python

          convert_to_numpy=True,   normalize_embeddings=True

          convert_to_numpy=False,  normalize_embeddings=True

          convert_to_numpy=True,   normalize_embeddings=False

          convert_to_numpy=False,  normalize_embeddings=False

          ```


          The output of the information retrieval for open question answering is far
          from satisfactory compare to the embeddings created by the original `e5-large-v2`
          model. Is this known issue or I missed something?


          Please advise. Thank you.'
        updatedAt: '2023-06-18T05:06:40.088Z'
      numEdits: 2
      reactions: []
    id: 648e907d245696cb734fc960
    type: comment
  author: limcheekin
  content: 'Thanks for sharing the model and sample code.


    I tested the model with the following parameters:

    ```python

    device=''cpu'', compute_type=''int8''

    ```


    and all combinations of the value of the `convert_to_numpy` and `normalize_embeddings`
    parameters:

    ```python

    convert_to_numpy=True,   normalize_embeddings=True

    convert_to_numpy=False,  normalize_embeddings=True

    convert_to_numpy=True,   normalize_embeddings=False

    convert_to_numpy=False,  normalize_embeddings=False

    ```


    The output of the information retrieval for open question answering is far from
    satisfactory compare to the embeddings created by the original `e5-large-v2` model.
    Is this known issue or I missed something?


    Please advise. Thank you.'
  created_at: 2023-06-18 04:05:01+00:00
  edited: true
  hidden: false
  id: 648e907d245696cb734fc960
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-18T13:15:54.000Z'
    data:
      edited: false
      editors:
      - michaelfeil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9082375168800354
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
          fullname: Michael
          isHf: false
          isPro: false
          name: michaelfeil
          type: user
        html: '<p>True, issue is in the package. I''ll patch and update hf-hub-ctranslate2
          soon (WIP)</p>

          '
        raw: True, issue is in the package. I'll patch and update hf-hub-ctranslate2
          soon (WIP)
        updatedAt: '2023-06-18T13:15:54.718Z'
      numEdits: 0
      reactions: []
    id: 648f038aef352f79d8b42432
    type: comment
  author: michaelfeil
  content: True, issue is in the package. I'll patch and update hf-hub-ctranslate2
    soon (WIP)
  created_at: 2023-06-18 12:15:54+00:00
  edited: false
  hidden: false
  id: 648f038aef352f79d8b42432
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-18T13:17:31.000Z'
    data:
      edited: false
      editors:
      - michaelfeil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.905325710773468
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
          fullname: Michael
          isHf: false
          isPro: false
          name: michaelfeil
          type: user
        html: '<p>Thanks for your detailed description, appreciate it. </p>

          <p>Issues is used the <code>pooled_outputs</code> in the Encoder. You may
          be able to download it and run it with Ctranslate2 directly.<br>Best option,
          you could use this feature branch from me: <a rel="nofollow" href="https://github.com/UKPLab/sentence-transformers/pull/2237">https://github.com/UKPLab/sentence-transformers/pull/2237</a></p>

          '
        raw: "Thanks for your detailed description, appreciate it. \n\nIssues is used\
          \ the `pooled_outputs` in the Encoder. You may be able to download it and\
          \ run it with Ctranslate2 directly.\nBest option, you could use this feature\
          \ branch from me: https://github.com/UKPLab/sentence-transformers/pull/2237"
        updatedAt: '2023-06-18T13:17:31.068Z'
      numEdits: 0
      reactions: []
      relatedEventId: 648f03eb7fd64c00e210c453
    id: 648f03eb7fd64c00e210c451
    type: comment
  author: michaelfeil
  content: "Thanks for your detailed description, appreciate it. \n\nIssues is used\
    \ the `pooled_outputs` in the Encoder. You may be able to download it and run\
    \ it with Ctranslate2 directly.\nBest option, you could use this feature branch\
    \ from me: https://github.com/UKPLab/sentence-transformers/pull/2237"
  created_at: 2023-06-18 12:17:31+00:00
  edited: false
  hidden: false
  id: 648f03eb7fd64c00e210c451
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-18T13:17:31.000Z'
    data:
      status: closed
    id: 648f03eb7fd64c00e210c453
    type: status-change
  author: michaelfeil
  created_at: 2023-06-18 12:17:31+00:00
  id: 648f03eb7fd64c00e210c453
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/24a8c63c897efdd980ef9d4805cbff7b.svg
      fullname: Lim Chee Kin
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: limcheekin
      type: user
    createdAt: '2023-06-19T09:28:13.000Z'
    data:
      edited: false
      editors:
      - limcheekin
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8060947060585022
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/24a8c63c897efdd980ef9d4805cbff7b.svg
          fullname: Lim Chee Kin
          isHf: false
          isPro: false
          name: limcheekin
          type: user
        html: '<p>Thanks for quick responses and fixes.</p>

          <p>I tested the <code>CT2SentenceTransformer</code> class using <code>device=''cpu'',
          compute_type=''int8''</code> with the original model. It works!</p>

          <p>By the way, why can''t I use the <code>EncoderCT2fromHfHub</code> class
          for end-to-end Sentence embeddings generation?</p>

          '
        raw: 'Thanks for quick responses and fixes.


          I tested the `CT2SentenceTransformer` class using `device=''cpu'', compute_type=''int8''`
          with the original model. It works!


          By the way, why can''t I use the `EncoderCT2fromHfHub` class for end-to-end
          Sentence embeddings generation?'
        updatedAt: '2023-06-19T09:28:13.505Z'
      numEdits: 0
      reactions: []
    id: 64901fadc0ce9caf745f317e
    type: comment
  author: limcheekin
  content: 'Thanks for quick responses and fixes.


    I tested the `CT2SentenceTransformer` class using `device=''cpu'', compute_type=''int8''`
    with the original model. It works!


    By the way, why can''t I use the `EncoderCT2fromHfHub` class for end-to-end Sentence
    embeddings generation?'
  created_at: 2023-06-19 08:28:13+00:00
  edited: false
  hidden: false
  id: 64901fadc0ce9caf745f317e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-19T10:54:43.000Z'
    data:
      edited: false
      editors:
      - michaelfeil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9195531606674194
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
          fullname: Michael
          isHf: false
          isPro: false
          name: michaelfeil
          type: user
        html: '<p>There is many ways how to create sentence embeddings (mean pooling)
          from last_hidden_state.<br>SentenceTransformer made some nice boilerplate
          code to match them all.</p>

          '
        raw: "There is many ways how to create sentence embeddings (mean pooling)\
          \ from last_hidden_state. \nSentenceTransformer made some nice boilerplate\
          \ code to match them all."
        updatedAt: '2023-06-19T10:54:43.533Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - limcheekin
    id: 649033f33862eda3a8712fe2
    type: comment
  author: michaelfeil
  content: "There is many ways how to create sentence embeddings (mean pooling) from\
    \ last_hidden_state. \nSentenceTransformer made some nice boilerplate code to\
    \ match them all."
  created_at: 2023-06-19 09:54:43+00:00
  edited: false
  hidden: false
  id: 649033f33862eda3a8712fe2
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: michaelfeil/ct2fast-e5-large-v2
repo_type: model
status: closed
target_branch: null
title: Low quality in information retrieval for embeddings created by the model?
