!!python/object:huggingface_hub.community.DiscussionWithDetails
author: AMITA94
conflicting_files: null
created_at: 2023-09-13 07:20:30+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1a1de874b43f1f71468679ff6cc3d12c.svg
      fullname: yoon suhwan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AMITA94
      type: user
    createdAt: '2023-09-13T08:20:30.000Z'
    data:
      edited: false
      editors:
      - AMITA94
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3025291860103607
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1a1de874b43f1f71468679ff6cc3d12c.svg
          fullname: yoon suhwan
          isHf: false
          isPro: false
          name: AMITA94
          type: user
        html: "<p>\uC774 \uBAA8\uB378\uC744 \uB85C\uCEEC\uC5D0\uC11C \uC2E4\uD5D8\uD574\
          \uBCF4\uACE0 \uC2F6\uC5B4\uC11C quantization coonfigure\uB9CC CPU\uB85C\
          \ \uB3D9\uC791\uD560 \uC218 \uC788\uB3C4\uB85D load_in_8bit\uC5D0\uC11C\
          \ load_in_8bit_fp32_cpu_offload=True\uB85C \uBCC0\uACBD\uD558\uC600\uC2B5\
          \uB2C8\uB2E4.</p>\n<p>\uC774\uD6C4 \uBAA8\uB378\uC744 \uB85C\uB4DC\uD558\
          \uB294 \uB3C4\uC911 \uB2E4\uC74C\uACFC \uAC19\uC740 \uC5D0\uB7EC\uAC00 \uBC1C\
          \uC0DD\uD558\uB294\uB370 \uD574\uACB0 \uBC29\uBC95\uC774 \uC788\uC744\uAE4C\
          \uC694?</p>\n<p><code>Traceback (most recent call last):   File \"inference.py\"\
          , line 14, in &lt;module&gt;     model = AutoModelForCausalLM.from_pretrained(\
          \   File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py\"\
          , line 467, in from_pretrained     return model_class.from_pretrained( \
          \  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 2777, in from_pretrained     ) = cls._load_pretrained_model(   File\
          \ \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 3118, in _load_pretrained_model     new_error_msgs, offload_index,\
          \ state_dict_index = _load_state_dict_into_meta_model(   File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 702, in _load_state_dict_into_meta_model     set_module_tensor_to_device(model,\
          \ param_name, param_device, **set_module_kwargs)   File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/accelerate/utils/modeling.py\"\
          , line 281, in set_module_tensor_to_device     raise ValueError( ValueError:\
          \ Trying to set a tensor of shape torch.Size([1024, 8192]) in \"weight\"\
          \ (which has shape torch.Size([8192, 8192])), this look incorrect.</code>\
          \                                                                      \
          \                                 </p>\n"
        raw: "\uC774 \uBAA8\uB378\uC744 \uB85C\uCEEC\uC5D0\uC11C \uC2E4\uD5D8\uD574\
          \uBCF4\uACE0 \uC2F6\uC5B4\uC11C quantization coonfigure\uB9CC CPU\uB85C\
          \ \uB3D9\uC791\uD560 \uC218 \uC788\uB3C4\uB85D load_in_8bit\uC5D0\uC11C\
          \ load_in_8bit_fp32_cpu_offload=True\uB85C \uBCC0\uACBD\uD558\uC600\uC2B5\
          \uB2C8\uB2E4.\r\n\r\n\uC774\uD6C4 \uBAA8\uB378\uC744 \uB85C\uB4DC\uD558\uB294\
          \ \uB3C4\uC911 \uB2E4\uC74C\uACFC \uAC19\uC740 \uC5D0\uB7EC\uAC00 \uBC1C\
          \uC0DD\uD558\uB294\uB370 \uD574\uACB0 \uBC29\uBC95\uC774 \uC788\uC744\uAE4C\
          \uC694?\r\n\r\n```Traceback (most recent call last):\r\n  File \"inference.py\"\
          , line 14, in <module>\r\n    model = AutoModelForCausalLM.from_pretrained(\r\
          \n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py\"\
          , line 467, in from_pretrained\r\n    return model_class.from_pretrained(\r\
          \n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 2777, in from_pretrained\r\n    ) = cls._load_pretrained_model(\r\
          \n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 3118, in _load_pretrained_model\r\n    new_error_msgs, offload_index,\
          \ state_dict_index = _load_state_dict_into_meta_model(\r\n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 702, in _load_state_dict_into_meta_model\r\n    set_module_tensor_to_device(model,\
          \ param_name, param_device, **set_module_kwargs)\r\n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/accelerate/utils/modeling.py\"\
          , line 281, in set_module_tensor_to_device\r\n    raise ValueError(\r\n\
          ValueError: Trying to set a tensor of shape torch.Size([1024, 8192]) in\
          \ \"weight\" (which has shape torch.Size([8192, 8192])), this look incorrect.```\
          \                                                                      \
          \                                 "
        updatedAt: '2023-09-13T08:20:30.640Z'
      numEdits: 0
      reactions: []
    id: 650170ce69219ce3e4c27e54
    type: comment
  author: AMITA94
  content: "\uC774 \uBAA8\uB378\uC744 \uB85C\uCEEC\uC5D0\uC11C \uC2E4\uD5D8\uD574\uBCF4\
    \uACE0 \uC2F6\uC5B4\uC11C quantization coonfigure\uB9CC CPU\uB85C \uB3D9\uC791\
    \uD560 \uC218 \uC788\uB3C4\uB85D load_in_8bit\uC5D0\uC11C load_in_8bit_fp32_cpu_offload=True\uB85C\
    \ \uBCC0\uACBD\uD558\uC600\uC2B5\uB2C8\uB2E4.\r\n\r\n\uC774\uD6C4 \uBAA8\uB378\
    \uC744 \uB85C\uB4DC\uD558\uB294 \uB3C4\uC911 \uB2E4\uC74C\uACFC \uAC19\uC740 \uC5D0\
    \uB7EC\uAC00 \uBC1C\uC0DD\uD558\uB294\uB370 \uD574\uACB0 \uBC29\uBC95\uC774 \uC788\
    \uC744\uAE4C\uC694?\r\n\r\n```Traceback (most recent call last):\r\n  File \"\
    inference.py\", line 14, in <module>\r\n    model = AutoModelForCausalLM.from_pretrained(\r\
    \n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py\"\
    , line 467, in from_pretrained\r\n    return model_class.from_pretrained(\r\n\
    \  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 2777, in from_pretrained\r\n    ) = cls._load_pretrained_model(\r\n  File\
    \ \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 3118, in _load_pretrained_model\r\n    new_error_msgs, offload_index, state_dict_index\
    \ = _load_state_dict_into_meta_model(\r\n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 702, in _load_state_dict_into_meta_model\r\n    set_module_tensor_to_device(model,\
    \ param_name, param_device, **set_module_kwargs)\r\n  File \"/home/waiker/shyoon/venv/solar_translate/lib/python3.8/site-packages/accelerate/utils/modeling.py\"\
    , line 281, in set_module_tensor_to_device\r\n    raise ValueError(\r\nValueError:\
    \ Trying to set a tensor of shape torch.Size([1024, 8192]) in \"weight\" (which\
    \ has shape torch.Size([8192, 8192])), this look incorrect.```               \
    \                                                                            \
    \            "
  created_at: 2023-09-13 07:20:30+00:00
  edited: false
  hidden: false
  id: 650170ce69219ce3e4c27e54
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: upstage/SOLAR-0-70b-8bit
repo_type: model
status: open
target_branch: null
title: "\uBAA8\uB378 CPU\uB85C\uB4DC\uC2DC \uB098\uD0C0\uB098\uB294 TensorSize mismatch"
