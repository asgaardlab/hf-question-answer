!!python/object:huggingface_hub.community.DiscussionWithDetails
author: jersonal
conflicting_files: null
created_at: 2023-09-11 00:24:45+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/53dc0361b4c45587842b50730df18370.svg
      fullname: xinjunwei
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jersonal
      type: user
    createdAt: '2023-09-11T01:24:45.000Z'
    data:
      edited: false
      editors:
      - jersonal
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9269253015518188
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/53dc0361b4c45587842b50730df18370.svg
          fullname: xinjunwei
          isHf: false
          isPro: false
          name: jersonal
          type: user
        html: "<p>\u5982\u9898\uFF1A\u5982\u4F55\u8FDB\u884C\u591Agpu\u52A0\u8F7D\
          ,\u5355\u4E2Agpu\u663E\u5B58\u4E0D\u8DB3\u3002</p>\n"
        raw: "\u5982\u9898\uFF1A\u5982\u4F55\u8FDB\u884C\u591Agpu\u52A0\u8F7D,\u5355\
          \u4E2Agpu\u663E\u5B58\u4E0D\u8DB3\u3002"
        updatedAt: '2023-09-11T01:24:45.644Z'
      numEdits: 0
      reactions: []
    id: 64fe6c5d20366846c3ed1c56
    type: comment
  author: jersonal
  content: "\u5982\u9898\uFF1A\u5982\u4F55\u8FDB\u884C\u591Agpu\u52A0\u8F7D,\u5355\
    \u4E2Agpu\u663E\u5B58\u4E0D\u8DB3\u3002"
  created_at: 2023-09-11 00:24:45+00:00
  edited: false
  hidden: false
  id: 64fe6c5d20366846c3ed1c56
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/cca57044c5bddeb590ba1ac96f176310.svg
      fullname: Zhiqiang Yin
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: HNYZQ
      type: user
    createdAt: '2023-09-15T03:47:23.000Z'
    data:
      edited: false
      editors:
      - HNYZQ
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.3715663552284241
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/cca57044c5bddeb590ba1ac96f176310.svg
          fullname: Zhiqiang Yin
          isHf: false
          isPro: false
          name: HNYZQ
          type: user
        html: "<p>\u6211\u4E5F\u6709\u6B64\u7C7B\u95EE\u9898\u3002</p>\n<p>\u95EE\u9898\
          \uFF1A</p>\n<p>\u542F\u52A8chatglm2-6b-32\u6A21\u578B\uFF0C\u4F7F\u7528\
          load_model_on_gpus\u52A0\u8F7D\u4E86\u4E09\u5F20\u5361\u3002\u5728\u63A8\
          \u7406\u65F6\u51FA\u73B0\u4E86\u9519\u8BEF\uFF1A</p>\n<p>File \"/home/nmnormal1/.cache/huggingface/modules/transformers_modules/chatglm2-6b-32k/modeling_chatglm.py\"\
          , line 655, in forward<br>presents = torch.cat((presents, kv_cache), dim=0)<br>RuntimeError:\
          \ Expected all tensors to be on the same device, but found at least two\
          \ devices, cuda:0 and cuda:1! (when checking argument for argument tensors\
          \ in method wrapper_CUDA_cat)</p>\n<p>\u81EA\u5DF1\u80FD\u64CD\u4F5C\u7684\
          \u4EE3\u7801\u51FA\u9519\u4F4D\u7F6E\u662F\uFF1A<br>for response, history,\
          \ past_key_values in model.stream_chat(tokenizer, query, history=history,<br>past_key_values=past_key_values,<br>return_past_key_values=True):</p>\n\
          <p>\u89E3\u51B3\uFF1A</p>\n<p>\u628A6b-32k\u7684\u6A21\u578B\u6362\u6210\
          chatglm2-6b\u6A21\u578B\u540E\uFF0C\u540C\u6837\u7684\u4EE3\u7801\u4E0D\u51FA\
          \u9519\u3002\u56E0\u6B64\u6000\u7591\u662F32k\u7684modeling_chatglm.py\u6587\
          \u4EF6\u6709\u95EE\u9898\uFF0C\u53EFtrust_remote_code\u7684\u5B58\u5728\u6211\
          \u4E5F\u6539\u4E0D\u4E86diamagnetic\uFF0C\u7279\u6765\u6C42\u52A9\uFF01\uFF01\
          \uFF01</p>\n"
        raw: "\u6211\u4E5F\u6709\u6B64\u7C7B\u95EE\u9898\u3002\n\n\u95EE\u9898\uFF1A\
          \n\n\u542F\u52A8chatglm2-6b-32\u6A21\u578B\uFF0C\u4F7F\u7528load_model_on_gpus\u52A0\
          \u8F7D\u4E86\u4E09\u5F20\u5361\u3002\u5728\u63A8\u7406\u65F6\u51FA\u73B0\
          \u4E86\u9519\u8BEF\uFF1A\n\nFile \"/home/nmnormal1/.cache/huggingface/modules/transformers_modules/chatglm2-6b-32k/modeling_chatglm.py\"\
          , line 655, in forward\npresents = torch.cat((presents, kv_cache), dim=0)\n\
          RuntimeError: Expected all tensors to be on the same device, but found at\
          \ least two devices, cuda:0 and cuda:1! (when checking argument for argument\
          \ tensors in method wrapper_CUDA_cat)\n\n\u81EA\u5DF1\u80FD\u64CD\u4F5C\u7684\
          \u4EE3\u7801\u51FA\u9519\u4F4D\u7F6E\u662F\uFF1A\nfor response, history,\
          \ past_key_values in model.stream_chat(tokenizer, query, history=history,\n\
          past_key_values=past_key_values,\nreturn_past_key_values=True):\n\n\u89E3\
          \u51B3\uFF1A\n\n\u628A6b-32k\u7684\u6A21\u578B\u6362\u6210chatglm2-6b\u6A21\
          \u578B\u540E\uFF0C\u540C\u6837\u7684\u4EE3\u7801\u4E0D\u51FA\u9519\u3002\
          \u56E0\u6B64\u6000\u7591\u662F32k\u7684modeling_chatglm.py\u6587\u4EF6\u6709\
          \u95EE\u9898\uFF0C\u53EFtrust_remote_code\u7684\u5B58\u5728\u6211\u4E5F\u6539\
          \u4E0D\u4E86diamagnetic\uFF0C\u7279\u6765\u6C42\u52A9\uFF01\uFF01\uFF01"
        updatedAt: '2023-09-15T03:47:23.687Z'
      numEdits: 0
      reactions: []
    id: 6503d3cb93574a897180b2ec
    type: comment
  author: HNYZQ
  content: "\u6211\u4E5F\u6709\u6B64\u7C7B\u95EE\u9898\u3002\n\n\u95EE\u9898\uFF1A\
    \n\n\u542F\u52A8chatglm2-6b-32\u6A21\u578B\uFF0C\u4F7F\u7528load_model_on_gpus\u52A0\
    \u8F7D\u4E86\u4E09\u5F20\u5361\u3002\u5728\u63A8\u7406\u65F6\u51FA\u73B0\u4E86\
    \u9519\u8BEF\uFF1A\n\nFile \"/home/nmnormal1/.cache/huggingface/modules/transformers_modules/chatglm2-6b-32k/modeling_chatglm.py\"\
    , line 655, in forward\npresents = torch.cat((presents, kv_cache), dim=0)\nRuntimeError:\
    \ Expected all tensors to be on the same device, but found at least two devices,\
    \ cuda:0 and cuda:1! (when checking argument for argument tensors in method wrapper_CUDA_cat)\n\
    \n\u81EA\u5DF1\u80FD\u64CD\u4F5C\u7684\u4EE3\u7801\u51FA\u9519\u4F4D\u7F6E\u662F\
    \uFF1A\nfor response, history, past_key_values in model.stream_chat(tokenizer,\
    \ query, history=history,\npast_key_values=past_key_values,\nreturn_past_key_values=True):\n\
    \n\u89E3\u51B3\uFF1A\n\n\u628A6b-32k\u7684\u6A21\u578B\u6362\u6210chatglm2-6b\u6A21\
    \u578B\u540E\uFF0C\u540C\u6837\u7684\u4EE3\u7801\u4E0D\u51FA\u9519\u3002\u56E0\
    \u6B64\u6000\u7591\u662F32k\u7684modeling_chatglm.py\u6587\u4EF6\u6709\u95EE\u9898\
    \uFF0C\u53EFtrust_remote_code\u7684\u5B58\u5728\u6211\u4E5F\u6539\u4E0D\u4E86\
    diamagnetic\uFF0C\u7279\u6765\u6C42\u52A9\uFF01\uFF01\uFF01"
  created_at: 2023-09-15 02:47:23+00:00
  edited: false
  hidden: false
  id: 6503d3cb93574a897180b2ec
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 5
repo_id: THUDM/chatglm2-6b-32k
repo_type: model
status: open
target_branch: null
title: "\u5982\u4F55\u8FDB\u884C\u591Agpu\u52A0\u8F7D,\u5355\u4E2Agpu\u663E\u5B58\u4E0D\
  \u8DB3\u3002"
