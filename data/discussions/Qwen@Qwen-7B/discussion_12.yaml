!!python/object:huggingface_hub.community.DiscussionWithDetails
author: rationalspark
conflicting_files: null
created_at: 2023-08-28 02:08:15+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f882d4afdea62bd38b89ea84bc8cb223.svg
      fullname: cys
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: rationalspark
      type: user
    createdAt: '2023-08-28T03:08:15.000Z'
    data:
      edited: false
      editors:
      - rationalspark
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.2910603880882263
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f882d4afdea62bd38b89ea84bc8cb223.svg
          fullname: cys
          isHf: false
          isPro: false
          name: rationalspark
          type: user
        html: "<p>\u5411\u5404\u4F4D\u5927\u725B\u6C42\u52A9\uFF0C\u4E07\u5206\u611F\
          \u8C22<br>\uFF08\u4F30\u8BA1\u4E2D\u56FD\u4EBA\u624D\u7528\u8FD9\u4E2A\u6A21\
          \u578B\uFF0C\u5C31\u4E0D\u7FFB\u8BD1\u6210\u82F1\u8BED\u4E86\uFF09<br>max_new_tokens\u8BBE\
          \u7F6E\u65E0\u6548\uFF0C\u8F93\u51FA\u4ECD\u7136\u5F88\u957F\u3002\u76F4\
          \u63A5\u628Amax_new_tokens\u4F5C\u4E3A\u53C2\u6570\u4F20\u7ED9model.generate\u4E5F\
          \u6CA1\u6709\u7528\uFF1B\u5199\u5728generation_config.json\u91CC\u9762\u4E5F\
          \u6CA1\u6709\u7528\u3002<br>\u4EE3\u7801\u5982\u4E0B\uFF08\u9700\u6CE8\u610F\
          str_in\u662F\u4E00\u6BB5\u957F\u6587\u672C\uFF0C\u4E0D\u662F\u4EE3\u7801\
          \u4E2D\u7684\uFF09</p>\n<p>'''<br>import torch<br>import time<br>import\
          \ numpy as np<br>import os<br>from modelscope import AutoModelForCausalLM,\
          \ AutoTokenizer<br>from modelscope import GenerationConfig<br>from torch.utils.data\
          \ import IterableDataset, DataLoader<br>#\u8F7D\u5165\u6A21\u578B<br>str_mod_pth=\"\
          qwen/Qwen-7B\"<br>tokenizer = AutoTokenizer.from_pretrained(<br>    str_mod_pth,\
          \ trust_remote_code=True)<br>model = AutoModelForCausalLM.from_pretrained(<br>\
          \    str_mod_pth, device_map=\"auto\",<br>    trust_remote_code=True, bf16=True).eval()<br>model.generation_config\
          \ = GenerationConfig.from_pretrained(str_mod_pth,trust_remote_code=True)<br>#\u8C03\
          \u7528\u6A21\u578B\u751F\u6210<br>str_in=\"\u8FD9\u91CC\u4EC5\u662F\u610F\
          \u601D\u4E00\u4E0B\uFF0C\u5B9E\u9645\u662F\u4E00\u6BB51000\u591A\u5B57\u7684\
          \u957F\u6587\u672C\"<br>inputs = tokenizer(str_in, return_tensors='pt')<br>print('Inputs\
          \ shape',inputs['input_ids'].shape)<br>inputs = inputs.to('cuda:0')<br>gen_cfg=GenerationConfig(max_new_tokens=256)<br>pred\
          \ = model.generate(**inputs, generation_config=gen_cfg)<br>str_out=tokenizer.decode(pred.cpu()[0],\
          \ skip_special_tokens=True)<br>print(str_out)<br>'''</p>\n"
        raw: "\u5411\u5404\u4F4D\u5927\u725B\u6C42\u52A9\uFF0C\u4E07\u5206\u611F\u8C22\
          \r\n\uFF08\u4F30\u8BA1\u4E2D\u56FD\u4EBA\u624D\u7528\u8FD9\u4E2A\u6A21\u578B\
          \uFF0C\u5C31\u4E0D\u7FFB\u8BD1\u6210\u82F1\u8BED\u4E86\uFF09\r\nmax_new_tokens\u8BBE\
          \u7F6E\u65E0\u6548\uFF0C\u8F93\u51FA\u4ECD\u7136\u5F88\u957F\u3002\u76F4\
          \u63A5\u628Amax_new_tokens\u4F5C\u4E3A\u53C2\u6570\u4F20\u7ED9model.generate\u4E5F\
          \u6CA1\u6709\u7528\uFF1B\u5199\u5728generation_config.json\u91CC\u9762\u4E5F\
          \u6CA1\u6709\u7528\u3002\r\n\u4EE3\u7801\u5982\u4E0B\uFF08\u9700\u6CE8\u610F\
          str_in\u662F\u4E00\u6BB5\u957F\u6587\u672C\uFF0C\u4E0D\u662F\u4EE3\u7801\
          \u4E2D\u7684\uFF09\r\n\r\n'''\r\nimport torch\r\nimport time\r\nimport numpy\
          \ as np\r\nimport os\r\nfrom modelscope import AutoModelForCausalLM, AutoTokenizer\r\
          \nfrom modelscope import GenerationConfig\r\nfrom torch.utils.data import\
          \ IterableDataset, DataLoader\r\n#\u8F7D\u5165\u6A21\u578B\r\nstr_mod_pth=\"\
          qwen/Qwen-7B\"\r\ntokenizer = AutoTokenizer.from_pretrained(\r\n    str_mod_pth,\
          \ trust_remote_code=True)\r\nmodel = AutoModelForCausalLM.from_pretrained(\r\
          \n    str_mod_pth, device_map=\"auto\", \r\n    trust_remote_code=True,\
          \ bf16=True).eval()\r\nmodel.generation_config = GenerationConfig.from_pretrained(str_mod_pth,trust_remote_code=True)\r\
          \n#\u8C03\u7528\u6A21\u578B\u751F\u6210\r\nstr_in=\"\u8FD9\u91CC\u4EC5\u662F\
          \u610F\u601D\u4E00\u4E0B\uFF0C\u5B9E\u9645\u662F\u4E00\u6BB51000\u591A\u5B57\
          \u7684\u957F\u6587\u672C\"\r\ninputs = tokenizer(str_in, return_tensors='pt')\r\
          \nprint('Inputs shape',inputs['input_ids'].shape)\r\ninputs = inputs.to('cuda:0')\r\
          \ngen_cfg=GenerationConfig(max_new_tokens=256)\r\npred = model.generate(**inputs,\
          \ generation_config=gen_cfg) \r\nstr_out=tokenizer.decode(pred.cpu()[0],\
          \ skip_special_tokens=True)\r\nprint(str_out)\r\n'''"
        updatedAt: '2023-08-28T03:08:15.778Z'
      numEdits: 0
      reactions: []
    id: 64ec0f9fc68ddc867b8a35ff
    type: comment
  author: rationalspark
  content: "\u5411\u5404\u4F4D\u5927\u725B\u6C42\u52A9\uFF0C\u4E07\u5206\u611F\u8C22\
    \r\n\uFF08\u4F30\u8BA1\u4E2D\u56FD\u4EBA\u624D\u7528\u8FD9\u4E2A\u6A21\u578B\uFF0C\
    \u5C31\u4E0D\u7FFB\u8BD1\u6210\u82F1\u8BED\u4E86\uFF09\r\nmax_new_tokens\u8BBE\
    \u7F6E\u65E0\u6548\uFF0C\u8F93\u51FA\u4ECD\u7136\u5F88\u957F\u3002\u76F4\u63A5\
    \u628Amax_new_tokens\u4F5C\u4E3A\u53C2\u6570\u4F20\u7ED9model.generate\u4E5F\u6CA1\
    \u6709\u7528\uFF1B\u5199\u5728generation_config.json\u91CC\u9762\u4E5F\u6CA1\u6709\
    \u7528\u3002\r\n\u4EE3\u7801\u5982\u4E0B\uFF08\u9700\u6CE8\u610Fstr_in\u662F\u4E00\
    \u6BB5\u957F\u6587\u672C\uFF0C\u4E0D\u662F\u4EE3\u7801\u4E2D\u7684\uFF09\r\n\r\
    \n'''\r\nimport torch\r\nimport time\r\nimport numpy as np\r\nimport os\r\nfrom\
    \ modelscope import AutoModelForCausalLM, AutoTokenizer\r\nfrom modelscope import\
    \ GenerationConfig\r\nfrom torch.utils.data import IterableDataset, DataLoader\r\
    \n#\u8F7D\u5165\u6A21\u578B\r\nstr_mod_pth=\"qwen/Qwen-7B\"\r\ntokenizer = AutoTokenizer.from_pretrained(\r\
    \n    str_mod_pth, trust_remote_code=True)\r\nmodel = AutoModelForCausalLM.from_pretrained(\r\
    \n    str_mod_pth, device_map=\"auto\", \r\n    trust_remote_code=True, bf16=True).eval()\r\
    \nmodel.generation_config = GenerationConfig.from_pretrained(str_mod_pth,trust_remote_code=True)\r\
    \n#\u8C03\u7528\u6A21\u578B\u751F\u6210\r\nstr_in=\"\u8FD9\u91CC\u4EC5\u662F\u610F\
    \u601D\u4E00\u4E0B\uFF0C\u5B9E\u9645\u662F\u4E00\u6BB51000\u591A\u5B57\u7684\u957F\
    \u6587\u672C\"\r\ninputs = tokenizer(str_in, return_tensors='pt')\r\nprint('Inputs\
    \ shape',inputs['input_ids'].shape)\r\ninputs = inputs.to('cuda:0')\r\ngen_cfg=GenerationConfig(max_new_tokens=256)\r\
    \npred = model.generate(**inputs, generation_config=gen_cfg) \r\nstr_out=tokenizer.decode(pred.cpu()[0],\
    \ skip_special_tokens=True)\r\nprint(str_out)\r\n'''"
  created_at: 2023-08-28 02:08:15+00:00
  edited: false
  hidden: false
  id: 64ec0f9fc68ddc867b8a35ff
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/637702749a45fcf31e900bcc/3LRAZDhP1WaS_1grMLoCl.jpeg?w=200&h=200&f=face
      fullname: stevenfung
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: steven88
      type: user
    createdAt: '2023-09-05T05:48:02.000Z'
    data:
      edited: true
      editors:
      - steven88
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9832334518432617
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/637702749a45fcf31e900bcc/3LRAZDhP1WaS_1grMLoCl.jpeg?w=200&h=200&f=face
          fullname: stevenfung
          isHf: false
          isPro: false
          name: steven88
          type: user
        html: ''
        raw: ' '
        updatedAt: '2023-09-05T05:49:17.920Z'
      numEdits: 1
      reactions: []
    id: 64f6c112702a397961822d87
    type: comment
  author: steven88
  content: ' '
  created_at: 2023-09-05 04:48:02+00:00
  edited: true
  hidden: false
  id: 64f6c112702a397961822d87
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f882d4afdea62bd38b89ea84bc8cb223.svg
      fullname: cys
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: rationalspark
      type: user
    createdAt: '2023-09-05T06:38:53.000Z'
    data:
      edited: false
      editors:
      - rationalspark
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9839959144592285
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f882d4afdea62bd38b89ea84bc8cb223.svg
          fullname: cys
          isHf: false
          isPro: false
          name: rationalspark
          type: user
        html: "<p>\u803D\u8BEF\u5927\u5BB6\u65F6\u95F4\u4E86\uFF0C\u7ECF\u8FDB\u4E00\
          \u6B65\u68C0\u67E5\uFF0C\u8BBE\u7F6E\u957F\u5EA6\u662F\u6709\u6548\u7684\
          \uFF0C\u53EA\u662F\u8F93\u5165\u9ED8\u8BA4\u9644\u52A0\u5728\u8F93\u51FA\
          \u524D\u9762</p>\n"
        raw: "\u803D\u8BEF\u5927\u5BB6\u65F6\u95F4\u4E86\uFF0C\u7ECF\u8FDB\u4E00\u6B65\
          \u68C0\u67E5\uFF0C\u8BBE\u7F6E\u957F\u5EA6\u662F\u6709\u6548\u7684\uFF0C\
          \u53EA\u662F\u8F93\u5165\u9ED8\u8BA4\u9644\u52A0\u5728\u8F93\u51FA\u524D\
          \u9762"
        updatedAt: '2023-09-05T06:38:53.427Z'
      numEdits: 0
      reactions: []
    id: 64f6ccfd6927100d8a3a92d9
    type: comment
  author: rationalspark
  content: "\u803D\u8BEF\u5927\u5BB6\u65F6\u95F4\u4E86\uFF0C\u7ECF\u8FDB\u4E00\u6B65\
    \u68C0\u67E5\uFF0C\u8BBE\u7F6E\u957F\u5EA6\u662F\u6709\u6548\u7684\uFF0C\u53EA\
    \u662F\u8F93\u5165\u9ED8\u8BA4\u9644\u52A0\u5728\u8F93\u51FA\u524D\u9762"
  created_at: 2023-09-05 05:38:53+00:00
  edited: false
  hidden: false
  id: 64f6ccfd6927100d8a3a92d9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9921ca8568f9d53c919681d8960ad802.svg
      fullname: jklj077
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: jklj077
      type: user
    createdAt: '2023-10-09T11:44:22.000Z'
    data:
      edited: false
      editors:
      - jklj077
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.991925835609436
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9921ca8568f9d53c919681d8960ad802.svg
          fullname: jklj077
          isHf: false
          isPro: false
          name: jklj077
          type: user
        html: "<p>\u55EF\uFF0C\u611F\u8C22\u652F\u6301\uFF01</p>\n"
        raw: "\u55EF\uFF0C\u611F\u8C22\u652F\u6301\uFF01"
        updatedAt: '2023-10-09T11:44:22.820Z'
      numEdits: 0
      reactions: []
      relatedEventId: 6523e796f172523dc3cf00a0
    id: 6523e796f172523dc3cf009d
    type: comment
  author: jklj077
  content: "\u55EF\uFF0C\u611F\u8C22\u652F\u6301\uFF01"
  created_at: 2023-10-09 10:44:22+00:00
  edited: false
  hidden: false
  id: 6523e796f172523dc3cf009d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/9921ca8568f9d53c919681d8960ad802.svg
      fullname: jklj077
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: jklj077
      type: user
    createdAt: '2023-10-09T11:44:22.000Z'
    data:
      status: closed
    id: 6523e796f172523dc3cf00a0
    type: status-change
  author: jklj077
  created_at: 2023-10-09 10:44:22+00:00
  id: 6523e796f172523dc3cf00a0
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 12
repo_id: Qwen/Qwen-7B
repo_type: model
status: closed
target_branch: null
title: "Qwen-7b\u9884\u8BAD\u7EC3\u6A21\u578B\u8F93\u51FA\u957F\u5EA6\u8BBE\u7F6E\u65E0\
  \u6548"
