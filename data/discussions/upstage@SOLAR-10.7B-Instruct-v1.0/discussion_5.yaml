!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Manmax31
conflicting_files: null
created_at: 2023-12-13 23:45:36+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8cd8535acd2718c3e94efb64c73f9275.svg
      fullname: Manab Chetia
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Manmax31
      type: user
    createdAt: '2023-12-13T23:45:36.000Z'
    data:
      edited: false
      editors:
      - Manmax31
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.43349578976631165
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8cd8535acd2718c3e94efb64c73f9275.svg
          fullname: Manab Chetia
          isHf: false
          isPro: false
          name: Manmax31
          type: user
        html: '<p>I get the error RuntimeError: cutlassF: no kernel found to launch!</p>

          <p>Here is my code:<br>`base_model_id = "upstage/SOLAR-10.7B-Instruct-v1.0"</p>

          <p>tokenizer = AutoTokenizer.from_pretrained(base_model_id, trust_remote_code=True)<br>tokenizer.pad_token
          = tokenizer.eos_token</p>

          <p>model = AutoModelForCausalLM.from_pretrained(<br>    base_model_id,<br>    load_in_8bit=True,<br>    device_map="auto",<br>    trust_remote_code=True,<br>    torch_dtype=torch.bfloat16,<br>)</p>

          <p>pipe = pipeline("text-generation", model=model, tokenizer=tokenizer)</p>

          <p>output = pipe(<br>    prompt,<br>    max_new_tokens=1000,<br>    do_sample=True,<br>    temperature=0.1,<br>    top_k=50,<br>    top_p=0.95,<br>    return_full_text=False,<br>)<br>text
          = output[0]["generated_text"]<br>print(text )`</p>

          <p>Any suggestions?<br>I have 4 Tesla V100 GPUs</p>

          '
        raw: "I get the error RuntimeError: cutlassF: no kernel found to launch!\r\
          \n\r\nHere is my code:\r\n`base_model_id = \"upstage/SOLAR-10.7B-Instruct-v1.0\"\
          \r\n\r\ntokenizer = AutoTokenizer.from_pretrained(base_model_id, trust_remote_code=True)\r\
          \ntokenizer.pad_token = tokenizer.eos_token\r\n\r\nmodel = AutoModelForCausalLM.from_pretrained(\r\
          \n    base_model_id,\r\n    load_in_8bit=True,\r\n    device_map=\"auto\"\
          ,\r\n    trust_remote_code=True,\r\n    torch_dtype=torch.bfloat16,\r\n\
          )\r\n\r\npipe = pipeline(\"text-generation\", model=model, tokenizer=tokenizer)\r\
          \n\r\noutput = pipe(\r\n    prompt,\r\n    max_new_tokens=1000,\r\n    do_sample=True,\r\
          \n    temperature=0.1,\r\n    top_k=50,\r\n    top_p=0.95,\r\n    return_full_text=False,\r\
          \n)\r\ntext = output[0][\"generated_text\"]\r\nprint(text )`\r\n\r\nAny\
          \ suggestions?\r\nI have 4 Tesla V100 GPUs"
        updatedAt: '2023-12-13T23:45:36.144Z'
      numEdits: 0
      reactions: []
    id: 657a4220afbb0117ba0cf0e5
    type: comment
  author: Manmax31
  content: "I get the error RuntimeError: cutlassF: no kernel found to launch!\r\n\
    \r\nHere is my code:\r\n`base_model_id = \"upstage/SOLAR-10.7B-Instruct-v1.0\"\
    \r\n\r\ntokenizer = AutoTokenizer.from_pretrained(base_model_id, trust_remote_code=True)\r\
    \ntokenizer.pad_token = tokenizer.eos_token\r\n\r\nmodel = AutoModelForCausalLM.from_pretrained(\r\
    \n    base_model_id,\r\n    load_in_8bit=True,\r\n    device_map=\"auto\",\r\n\
    \    trust_remote_code=True,\r\n    torch_dtype=torch.bfloat16,\r\n)\r\n\r\npipe\
    \ = pipeline(\"text-generation\", model=model, tokenizer=tokenizer)\r\n\r\noutput\
    \ = pipe(\r\n    prompt,\r\n    max_new_tokens=1000,\r\n    do_sample=True,\r\n\
    \    temperature=0.1,\r\n    top_k=50,\r\n    top_p=0.95,\r\n    return_full_text=False,\r\
    \n)\r\ntext = output[0][\"generated_text\"]\r\nprint(text )`\r\n\r\nAny suggestions?\r\
    \nI have 4 Tesla V100 GPUs"
  created_at: 2023-12-13 23:45:36+00:00
  edited: false
  hidden: false
  id: 657a4220afbb0117ba0cf0e5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/603c29094a944b99e81476fd/LaSNcrKmCEUBEBZZCce3k.png?w=200&h=200&f=face
      fullname: Sung Kim
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: hunkim
      type: user
    createdAt: '2023-12-15T06:48:05.000Z'
    data:
      edited: false
      editors:
      - hunkim
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9769536852836609
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/603c29094a944b99e81476fd/LaSNcrKmCEUBEBZZCce3k.png?w=200&h=200&f=face
          fullname: Sung Kim
          isHf: false
          isPro: false
          name: hunkim
          type: user
        html: '<p>Hmm, it seems we cannot reproduce this error. Do you still have
          the problem?</p>

          '
        raw: Hmm, it seems we cannot reproduce this error. Do you still have the problem?
        updatedAt: '2023-12-15T06:48:05.608Z'
      numEdits: 0
      reactions: []
    id: 657bf6a52fc59b67788fe796
    type: comment
  author: hunkim
  content: Hmm, it seems we cannot reproduce this error. Do you still have the problem?
  created_at: 2023-12-15 06:48:05+00:00
  edited: false
  hidden: false
  id: 657bf6a52fc59b67788fe796
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/603c29094a944b99e81476fd/LaSNcrKmCEUBEBZZCce3k.png?w=200&h=200&f=face
      fullname: Sung Kim
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: hunkim
      type: user
    createdAt: '2023-12-15T06:49:28.000Z'
    data:
      status: closed
    id: 657bf6f8504b90a3c5a3650a
    type: status-change
  author: hunkim
  created_at: 2023-12-15 06:49:28+00:00
  id: 657bf6f8504b90a3c5a3650a
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 5
repo_id: upstage/SOLAR-10.7B-Instruct-v1.0
repo_type: model
status: closed
target_branch: null
title: 'RuntimeError: cutlassF: no kernel found to launch!'
