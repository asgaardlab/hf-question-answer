!!python/object:huggingface_hub.community.DiscussionWithDetails
author: neke-leo
conflicting_files: null
created_at: 2023-08-21 07:03:07+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/dda6977af251f55b3b8d6d0f6f873019.svg
      fullname: Leonid T
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: neke-leo
      type: user
    createdAt: '2023-08-21T08:03:07.000Z'
    data:
      edited: false
      editors:
      - neke-leo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6431586742401123
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/dda6977af251f55b3b8d6d0f6f873019.svg
          fullname: Leonid T
          isHf: false
          isPro: false
          name: neke-leo
          type: user
        html: '<p>I tried to deploy the model to SageMaker with the example code provided,
          but I get an error. I think it might be some version mismatch, but I''m
          not sure how to fix it, given that the packages installed depend on the
          hugging face image and not on anything I use in my Sagemaker notebook(sagemaker-2.178.0).</p>

          <blockquote>

          <p>File "/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py",
          line 142, in serve_inner<br>    model = get_model(<br>  File "/opt/conda/lib/python3.9/site-packages/text_generation_server/models/<strong>init</strong>.py",
          line 145, in get_model<br>    return BLOOMSharded(<br>  File "/opt/conda/lib/python3.9/site-packages/text_generation_server/models/bloom.py",
          line 80, in <strong>init</strong><br>    model = BloomForCausalLM(config,
          weights)<br>  File "/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py",
          line 818, in <strong>init</strong><br>    self.transformer = BloomModel(config,
          weights)<br>  File "/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py",
          line 609, in <strong>init</strong><br>    self.word_embeddings = TensorParallelEmbedding(<br>  File
          "/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py",
          line 293, in <strong>init</strong><br>    weight = weights.get_partial_sharded(f"{prefix}.weight",
          dim=0)<br>  File "/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py",
          line 73, in get_partial_sharded<br>    filename, tensor_name = self.get_filename(tensor_name)<br>  File
          "/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py",
          line 49, in get_filename<br>    raise RuntimeError(f"weight {tensor_name}
          does not exist")<br>RuntimeError: weight word_embeddings.weight does not
          exist</p>

          </blockquote>

          '
        raw: "I tried to deploy the model to SageMaker with the example code provided,\
          \ but I get an error. I think it might be some version mismatch, but I'm\
          \ not sure how to fix it, given that the packages installed depend on the\
          \ hugging face image and not on anything I use in my Sagemaker notebook(sagemaker-2.178.0).\r\
          \n\r\n> File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
          , line 142, in serve_inner\r\n    model = get_model(\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
          , line 145, in get_model\r\n    return BLOOMSharded(\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/bloom.py\"\
          , line 80, in __init__\r\n    model = BloomForCausalLM(config, weights)\r\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py\"\
          , line 818, in __init__\r\n    self.transformer = BloomModel(config, weights)\r\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py\"\
          , line 609, in __init__\r\n    self.word_embeddings = TensorParallelEmbedding(\r\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
          , line 293, in __init__\r\n    weight = weights.get_partial_sharded(f\"\
          {prefix}.weight\", dim=0)\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 73, in get_partial_sharded\r\n    filename, tensor_name = self.get_filename(tensor_name)\r\
          \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
          , line 49, in get_filename\r\n    raise RuntimeError(f\"weight {tensor_name}\
          \ does not exist\")\r\nRuntimeError: weight word_embeddings.weight does\
          \ not exist"
        updatedAt: '2023-08-21T08:03:07.813Z'
      numEdits: 0
      reactions: []
    id: 64e31a3bf2c90b2e143f145e
    type: comment
  author: neke-leo
  content: "I tried to deploy the model to SageMaker with the example code provided,\
    \ but I get an error. I think it might be some version mismatch, but I'm not sure\
    \ how to fix it, given that the packages installed depend on the hugging face\
    \ image and not on anything I use in my Sagemaker notebook(sagemaker-2.178.0).\r\
    \n\r\n> File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/server.py\"\
    , line 142, in serve_inner\r\n    model = get_model(\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/__init__.py\"\
    , line 145, in get_model\r\n    return BLOOMSharded(\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/bloom.py\"\
    , line 80, in __init__\r\n    model = BloomForCausalLM(config, weights)\r\n  File\
    \ \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py\"\
    , line 818, in __init__\r\n    self.transformer = BloomModel(config, weights)\r\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/models/custom_modeling/bloom_modeling.py\"\
    , line 609, in __init__\r\n    self.word_embeddings = TensorParallelEmbedding(\r\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/layers.py\"\
    , line 293, in __init__\r\n    weight = weights.get_partial_sharded(f\"{prefix}.weight\"\
    , dim=0)\r\n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 73, in get_partial_sharded\r\n    filename, tensor_name = self.get_filename(tensor_name)\r\
    \n  File \"/opt/conda/lib/python3.9/site-packages/text_generation_server/utils/weights.py\"\
    , line 49, in get_filename\r\n    raise RuntimeError(f\"weight {tensor_name} does\
    \ not exist\")\r\nRuntimeError: weight word_embeddings.weight does not exist"
  created_at: 2023-08-21 07:03:07+00:00
  edited: false
  hidden: false
  id: 64e31a3bf2c90b2e143f145e
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 5
repo_id: philschmid/instruct-igel-001
repo_type: model
status: open
target_branch: null
title: Error deploying to Sagemaker
