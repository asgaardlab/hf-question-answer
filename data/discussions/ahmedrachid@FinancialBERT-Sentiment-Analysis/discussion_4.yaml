!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ewmiao
conflicting_files: null
created_at: 2023-09-26 23:18:45+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/dcbca188f73ddea2f9dbd7c3f5f38bb8.svg
      fullname: Evan Miao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ewmiao
      type: user
    createdAt: '2023-09-27T00:18:45.000Z'
    data:
      edited: false
      editors:
      - ewmiao
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7174497246742249
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/dcbca188f73ddea2f9dbd7c3f5f38bb8.svg
          fullname: Evan Miao
          isHf: false
          isPro: false
          name: ewmiao
          type: user
        html: '<p>Thank you for the excellent work!! Is there a way to set num_labels
          = 2? I tried to modify the codes here<br><a href="https://huggingface.co/ahmedrachid/FinancialBERT-Sentiment-Analysis">https://huggingface.co/ahmedrachid/FinancialBERT-Sentiment-Analysis</a><br>in
          order to accommodate 2 labels  (positive, negative) rather than 3  (positive,
          neutral, negative) as follows:<br> "model = BertForSequenceClassification.from_pretrained("ahmedrachid/FinancialBERT-Sentiment-Analysis",num_labels=2)"
          but I got an error message.  </p>

          '
        raw: "Thank you for the excellent work!! Is there a way to set num_labels\
          \ = 2? I tried to modify the codes here \r\nhttps://huggingface.co/ahmedrachid/FinancialBERT-Sentiment-Analysis\
          \ \r\nin order to accommodate 2 labels  (positive, negative) rather than\
          \ 3  (positive, neutral, negative) as follows: \r\n \"model = BertForSequenceClassification.from_pretrained(\"\
          ahmedrachid/FinancialBERT-Sentiment-Analysis\",num_labels=2)\" but I got\
          \ an error message.  "
        updatedAt: '2023-09-27T00:18:45.141Z'
      numEdits: 0
      reactions: []
    id: 651374e593bb9e1720879103
    type: comment
  author: ewmiao
  content: "Thank you for the excellent work!! Is there a way to set num_labels =\
    \ 2? I tried to modify the codes here \r\nhttps://huggingface.co/ahmedrachid/FinancialBERT-Sentiment-Analysis\
    \ \r\nin order to accommodate 2 labels  (positive, negative) rather than 3  (positive,\
    \ neutral, negative) as follows: \r\n \"model = BertForSequenceClassification.from_pretrained(\"\
    ahmedrachid/FinancialBERT-Sentiment-Analysis\",num_labels=2)\" but I got an error\
    \ message.  "
  created_at: 2023-09-26 23:18:45+00:00
  edited: false
  hidden: false
  id: 651374e593bb9e1720879103
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1639485063650-noauth.jpeg?w=200&h=200&f=face
      fullname: Ahmed Rachid Hazourli
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ahmedrachid
      type: user
    createdAt: '2023-11-17T13:07:07.000Z'
    data:
      edited: false
      editors:
      - ahmedrachid
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6594693660736084
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1639485063650-noauth.jpeg?w=200&h=200&f=face
          fullname: Ahmed Rachid Hazourli
          isHf: false
          isPro: false
          name: ahmedrachid
          type: user
        html: "<p>Hello <span data-props=\"{&quot;user&quot;:&quot;ewmiao&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/ewmiao\"\
          >@<span class=\"underline\">ewmiao</span></a></span>\n\n\t</span></span>\
          \ , sorry for the late response.. just noticed your comment. It's possible\
          \ for sure ! You need to fine-tune the model for your needs if you have\
          \ num_labels = 2, you can do transfer learning and freeze all layers before\
          \ last Dense layer</p>\n<h1 id=\"load-the-pre-trained-financialbert-model\"\
          >Load the pre-trained FinancialBERT model</h1>\n<p>model = BertForSequenceClassification.from_pretrained(\"\
          ahmedrachid/FinancialBERT-Sentiment-Analysis\", num_labels=3)</p>\n<h1 id=\"\
          adjusting-the-model-for-binary-classification-positive-negative\">Adjusting\
          \ the model for binary classification (positive, negative)</h1>\n<p>model.classifier\
          \ = torch.nn.Linear(model.classifier.in_features, 2)</p>\n<h1 id=\"training-setup\"\
          >Training setup</h1>\n<p>trainer = Trainer(<br>    model=model,<br>    args=training_args,<br>\
          \    train_dataset=train_dataset,<br>    eval_dataset=val_dataset,<br>)</p>\n\
          <h1 id=\"train-the-model\">Train the model</h1>\n<p>trainer.train()</p>\n"
        raw: "Hello @ewmiao , sorry for the late response.. just noticed your comment.\
          \ It's possible for sure ! You need to fine-tune the model for your needs\
          \ if you have num_labels = 2, you can do transfer learning and freeze all\
          \ layers before last Dense layer\n\n# Load the pre-trained FinancialBERT\
          \ model\nmodel = BertForSequenceClassification.from_pretrained(\"ahmedrachid/FinancialBERT-Sentiment-Analysis\"\
          , num_labels=3)\n\n# Adjusting the model for binary classification (positive,\
          \ negative)\nmodel.classifier = torch.nn.Linear(model.classifier.in_features,\
          \ 2)\n\n# Training setup\ntrainer = Trainer(\n    model=model,\n    args=training_args,\n\
          \    train_dataset=train_dataset,\n    eval_dataset=val_dataset,\n)\n\n\
          # Train the model\ntrainer.train()"
        updatedAt: '2023-11-17T13:07:07.549Z'
      numEdits: 0
      reactions: []
    id: 6557657b0438e0854fb8a926
    type: comment
  author: ahmedrachid
  content: "Hello @ewmiao , sorry for the late response.. just noticed your comment.\
    \ It's possible for sure ! You need to fine-tune the model for your needs if you\
    \ have num_labels = 2, you can do transfer learning and freeze all layers before\
    \ last Dense layer\n\n# Load the pre-trained FinancialBERT model\nmodel = BertForSequenceClassification.from_pretrained(\"\
    ahmedrachid/FinancialBERT-Sentiment-Analysis\", num_labels=3)\n\n# Adjusting the\
    \ model for binary classification (positive, negative)\nmodel.classifier = torch.nn.Linear(model.classifier.in_features,\
    \ 2)\n\n# Training setup\ntrainer = Trainer(\n    model=model,\n    args=training_args,\n\
    \    train_dataset=train_dataset,\n    eval_dataset=val_dataset,\n)\n\n# Train\
    \ the model\ntrainer.train()"
  created_at: 2023-11-17 13:07:07+00:00
  edited: false
  hidden: false
  id: 6557657b0438e0854fb8a926
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: ahmedrachid/FinancialBERT-Sentiment-Analysis
repo_type: model
status: open
target_branch: null
title: 'Does the program support num_labels = 2? '
