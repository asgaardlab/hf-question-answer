!!python/object:huggingface_hub.community.DiscussionWithDetails
author: CharlieHan
conflicting_files: null
created_at: 2024-01-10 16:01:14+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/25dfcbca6017845737136ac02ba05c92.svg
      fullname: Changli Han
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: CharlieHan
      type: user
    createdAt: '2024-01-10T16:01:14.000Z'
    data:
      edited: true
      editors:
      - CharlieHan
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.44403380155563354
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/25dfcbca6017845737136ac02ba05c92.svg
          fullname: Changli Han
          isHf: false
          isPro: false
          name: CharlieHan
          type: user
        html: "<pre><code>from diffusers import AutoPipelineForText2Image\nimport\
          \ torch\n        \npipeline = AutoPipelineForText2Image.from_pretrained('dataautogpt3/OpenDalleV1.1',\
          \ torch_dtype=torch.float16).to('mps')        \nimage = pipeline('black\
          \ fluffy gorgeous dangerous cat animal creature, large orange eyes, big\
          \ fluffy ears, piercing gaze, full moon, dark ambiance, best quality, extremely\
          \ detailed').images[0]\n</code></pre>\n<p>changed cuda to mps, and get the\
          \ error below</p>\n<pre><code>Traceback (most recent call last):\n  File\
          \ \"/private/tmp/opendallev1.1/launch_opendallev1.1.py\", line 8, in &lt;module&gt;\n\
          \    image = pipeline(t).images[0]\n            ^^^^^^^^^^^\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
          , line 115, in decorate_context\n    return func(*args, **kwargs)\n    \
          \       ^^^^^^^^^^^^^^^^^^^^^\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
          , line 1113, in __call__\n    timesteps, num_inference_steps = retrieve_timesteps(self.scheduler,\
          \ num_inference_steps, device, timesteps)\n                            \
          \         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
          , line 144, in retrieve_timesteps\n    scheduler.set_timesteps(num_inference_steps,\
          \ device=device, **kwargs)\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/schedulers/scheduling_k_dpm_2_ancestral_discrete.py\"\
          , line 280, in set_timesteps\n    timesteps = torch.from_numpy(timesteps).to(device)\n\
          \                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: Cannot\
          \ convert a MPS Tensor to float64 dtype as the MPS framework doesn't support\
          \ float64. Please use float32 instead.\n</code></pre>\n<pre><code>Package\
          \            Version\n------------------ ----------\naccelerate        \
          \ 0.25.0\ndiffusers          0.25.0\ntorch              2.1.2\ntransformers\
          \       4.36.2\n</code></pre>\n"
        raw: "\n```\nfrom diffusers import AutoPipelineForText2Image\nimport torch\n\
          \        \npipeline = AutoPipelineForText2Image.from_pretrained('dataautogpt3/OpenDalleV1.1',\
          \ torch_dtype=torch.float16).to('mps')        \nimage = pipeline('black\
          \ fluffy gorgeous dangerous cat animal creature, large orange eyes, big\
          \ fluffy ears, piercing gaze, full moon, dark ambiance, best quality, extremely\
          \ detailed').images[0]\n\n```\nchanged cuda to mps, and get the error below\n\
          ```\nTraceback (most recent call last):\n  File \"/private/tmp/opendallev1.1/launch_opendallev1.1.py\"\
          , line 8, in <module>\n    image = pipeline(t).images[0]\n            ^^^^^^^^^^^\n\
          \  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
          , line 115, in decorate_context\n    return func(*args, **kwargs)\n    \
          \       ^^^^^^^^^^^^^^^^^^^^^\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
          , line 1113, in __call__\n    timesteps, num_inference_steps = retrieve_timesteps(self.scheduler,\
          \ num_inference_steps, device, timesteps)\n                            \
          \         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
          \  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
          , line 144, in retrieve_timesteps\n    scheduler.set_timesteps(num_inference_steps,\
          \ device=device, **kwargs)\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/schedulers/scheduling_k_dpm_2_ancestral_discrete.py\"\
          , line 280, in set_timesteps\n    timesteps = torch.from_numpy(timesteps).to(device)\n\
          \                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: Cannot\
          \ convert a MPS Tensor to float64 dtype as the MPS framework doesn't support\
          \ float64. Please use float32 instead.\n``` \n\n```\nPackage           \
          \ Version\n------------------ ----------\naccelerate         0.25.0\ndiffusers\
          \          0.25.0\ntorch              2.1.2\ntransformers       4.36.2\n\
          ```"
        updatedAt: '2024-01-10T16:06:55.761Z'
      numEdits: 1
      reactions: []
    id: 659ebf4a5d14d30589bf2b9b
    type: comment
  author: CharlieHan
  content: "\n```\nfrom diffusers import AutoPipelineForText2Image\nimport torch\n\
    \        \npipeline = AutoPipelineForText2Image.from_pretrained('dataautogpt3/OpenDalleV1.1',\
    \ torch_dtype=torch.float16).to('mps')        \nimage = pipeline('black fluffy\
    \ gorgeous dangerous cat animal creature, large orange eyes, big fluffy ears,\
    \ piercing gaze, full moon, dark ambiance, best quality, extremely detailed').images[0]\n\
    \n```\nchanged cuda to mps, and get the error below\n```\nTraceback (most recent\
    \ call last):\n  File \"/private/tmp/opendallev1.1/launch_opendallev1.1.py\",\
    \ line 8, in <module>\n    image = pipeline(t).images[0]\n            ^^^^^^^^^^^\n\
    \  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
    , line 115, in decorate_context\n    return func(*args, **kwargs)\n          \
    \ ^^^^^^^^^^^^^^^^^^^^^\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
    , line 1113, in __call__\n    timesteps, num_inference_steps = retrieve_timesteps(self.scheduler,\
    \ num_inference_steps, device, timesteps)\n                                  \
    \   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/pipelines/stable_diffusion_xl/pipeline_stable_diffusion_xl.py\"\
    , line 144, in retrieve_timesteps\n    scheduler.set_timesteps(num_inference_steps,\
    \ device=device, **kwargs)\n  File \"/private/tmp/opendallev1.1/venv/lib/python3.11/site-packages/diffusers/schedulers/scheduling_k_dpm_2_ancestral_discrete.py\"\
    , line 280, in set_timesteps\n    timesteps = torch.from_numpy(timesteps).to(device)\n\
    \                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: Cannot convert\
    \ a MPS Tensor to float64 dtype as the MPS framework doesn't support float64.\
    \ Please use float32 instead.\n``` \n\n```\nPackage            Version\n------------------\
    \ ----------\naccelerate         0.25.0\ndiffusers          0.25.0\ntorch    \
    \          2.1.2\ntransformers       4.36.2\n```"
  created_at: 2024-01-10 16:01:14+00:00
  edited: true
  hidden: false
  id: 659ebf4a5d14d30589bf2b9b
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 29
repo_id: dataautogpt3/OpenDalleV1.1
repo_type: model
status: open
target_branch: null
title: has anyone tried it on M1 Mac?
