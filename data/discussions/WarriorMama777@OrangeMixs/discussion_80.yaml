!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Enferlain
conflicting_files: null
created_at: 2023-03-17 16:51:40+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
      fullname: Hoshino Imi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Enferlain
      type: user
    createdAt: '2023-03-17T17:51:40.000Z'
    data:
      edited: false
      editors:
      - Enferlain
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
          fullname: Hoshino Imi
          isHf: false
          isPro: false
          name: Enferlain
          type: user
        html: '<p>I thought all along that it was normal, but SD Upscale and inpainting
          for example (not sure about normal img2img, maybe?) results in washed out
          colors, or in case of upscale an entirely washed out image. Does anyone
          know how to fix this? When I want to force it to use the orangemix vae in
          the settings, I get nans exception errors.</p>

          <p>It looks really bad and makes editing almost impossible when the vae
          is not loaded on top of inpainted pictures or upscaled ones.</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1679075451342-634575c6d54fb141ded9c931.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1679075451342-634575c6d54fb141ded9c931.png"></a></p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1679075431916-634575c6d54fb141ded9c931.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1679075431916-634575c6d54fb141ded9c931.png"></a></p>

          <p>Other instances of ppl talking about the same issue for more examples</p>

          <p><a rel="nofollow" href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5217">https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5217</a></p>

          <p><a rel="nofollow" href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5098">https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5098</a></p>

          '
        raw: "I thought all along that it was normal, but SD Upscale and inpainting\
          \ for example (not sure about normal img2img, maybe?) results in washed\
          \ out colors, or in case of upscale an entirely washed out image. Does anyone\
          \ know how to fix this? When I want to force it to use the orangemix vae\
          \ in the settings, I get nans exception errors.\r\n\r\nIt looks really bad\
          \ and makes editing almost impossible when the vae is not loaded on top\
          \ of inpainted pictures or upscaled ones.\r\n\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679075451342-634575c6d54fb141ded9c931.png)\r\
          \n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679075431916-634575c6d54fb141ded9c931.png)\r\
          \n\r\nOther instances of ppl talking about the same issue for more examples\r\
          \n\r\nhttps://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5217\r\
          \n\r\nhttps://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5098"
        updatedAt: '2023-03-17T17:51:40.272Z'
      numEdits: 0
      reactions: []
    id: 6414a8aceb36945ab9d63936
    type: comment
  author: Enferlain
  content: "I thought all along that it was normal, but SD Upscale and inpainting\
    \ for example (not sure about normal img2img, maybe?) results in washed out colors,\
    \ or in case of upscale an entirely washed out image. Does anyone know how to\
    \ fix this? When I want to force it to use the orangemix vae in the settings,\
    \ I get nans exception errors.\r\n\r\nIt looks really bad and makes editing almost\
    \ impossible when the vae is not loaded on top of inpainted pictures or upscaled\
    \ ones.\r\n\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679075451342-634575c6d54fb141ded9c931.png)\r\
    \n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679075431916-634575c6d54fb141ded9c931.png)\r\
    \n\r\nOther instances of ppl talking about the same issue for more examples\r\n\
    \r\nhttps://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5217\r\n\r\n\
    https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/5098"
  created_at: 2023-03-17 16:51:40+00:00
  edited: false
  hidden: false
  id: 6414a8aceb36945ab9d63936
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
      fullname: Hoshino Imi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Enferlain
      type: user
    createdAt: '2023-03-17T18:12:34.000Z'
    data:
      edited: false
      editors:
      - Enferlain
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
          fullname: Hoshino Imi
          isHf: false
          isPro: false
          name: Enferlain
          type: user
        html: "<p>Ok so if you launch with --no-half-vae orangemix vae will work in\
          \ img2img as well.</p>\n<p><a rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/1679076693831-634575c6d54fb141ded9c931.png\"\
          ><img alt=\"image.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/1679076693831-634575c6d54fb141ded9c931.png\"\
          ></a></p>\n<p><span data-props=\"{&quot;user&quot;:&quot;WarriorMama777&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/WarriorMama777\"\
          >@<span class=\"underline\">WarriorMama777</span></a></span>\n\n\t</span></span>\
          \ Hi could you fix this somehow so you don't need to use no half vae for\
          \ it to work properly or something? You can replicate the issue by going\
          \ to img2img in A3 and inpainting over a picture or using sd upscale.</p>\n"
        raw: 'Ok so if you launch with --no-half-vae orangemix vae will work in img2img
          as well.


          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679076693831-634575c6d54fb141ded9c931.png)


          @WarriorMama777 Hi could you fix this somehow so you don''t need to use
          no half vae for it to work properly or something? You can replicate the
          issue by going to img2img in A3 and inpainting over a picture or using sd
          upscale.'
        updatedAt: '2023-03-17T18:12:34.190Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - AMIAUTHOR
    id: 6414ad928bcf710bb22b24f9
    type: comment
  author: Enferlain
  content: 'Ok so if you launch with --no-half-vae orangemix vae will work in img2img
    as well.


    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679076693831-634575c6d54fb141ded9c931.png)


    @WarriorMama777 Hi could you fix this somehow so you don''t need to use no half
    vae for it to work properly or something? You can replicate the issue by going
    to img2img in A3 and inpainting over a picture or using sd upscale.'
  created_at: 2023-03-17 17:12:34+00:00
  edited: false
  hidden: false
  id: 6414ad928bcf710bb22b24f9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
      fullname: Hoshino Imi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Enferlain
      type: user
    createdAt: '2023-03-17T23:13:24.000Z'
    data:
      edited: false
      editors:
      - Enferlain
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
          fullname: Hoshino Imi
          isHf: false
          isPro: false
          name: Enferlain
          type: user
        html: '<p>Was also breaking normal img2img, not only inpainting and sd upscale
          btw</p>

          <p>Comparison</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1679094787469-634575c6d54fb141ded9c931.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1679094787469-634575c6d54fb141ded9c931.png"></a></p>

          '
        raw: 'Was also breaking normal img2img, not only inpainting and sd upscale
          btw


          Comparison


          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679094787469-634575c6d54fb141ded9c931.png)'
        updatedAt: '2023-03-17T23:13:24.749Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - AMIAUTHOR
    id: 6414f414ac9be91e99723af9
    type: comment
  author: Enferlain
  content: 'Was also breaking normal img2img, not only inpainting and sd upscale btw


    Comparison


    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679094787469-634575c6d54fb141ded9c931.png)'
  created_at: 2023-03-17 22:13:24+00:00
  edited: false
  hidden: false
  id: 6414f414ac9be91e99723af9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670285391547-6303e8e45c70c21d0eabbce4.png?w=200&h=200&f=face
      fullname: AIA
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AMIAUTHOR
      type: user
    createdAt: '2023-03-18T23:58:36.000Z'
    data:
      edited: false
      editors:
      - AMIAUTHOR
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670285391547-6303e8e45c70c21d0eabbce4.png?w=200&h=200&f=face
          fullname: AIA
          isHf: false
          isPro: false
          name: AMIAUTHOR
          type: user
        html: '<p>probably not related directly with the .vae but more with the inpainting
          data in a checkpoint.</p>

          <p>aom2/aom3<br>aom2/aom3 inpainting</p>

          <p>whole picture + -- no half vae </p>

          <ol>

          <li>abyss inpainting + automatic vae = no absorption + desaturated</li>

          <li>abyss inpainting + orange mix vae = no absorption  + desaturated</li>

          <li>abyss + automatic vae =desaturated</li>

          <li>abyss + orange mix vae =oversaturated</li>

          <li>abyss + anything 3.0 vae =oversaturated<br>= tested 20 vaes, all inconsistent.</li>

          </ol>

          <p>whole picture without args</p>

          <ol>

          <li><p>abyss inpainting + automatic vae = oversaturated halo </p>

          </li>

          <li><p>abyss inpainting + orange mix vae = oversaturated halo </p>

          </li>

          <li><p>abyss + automatic vae = really desaturated</p>

          </li>

          <li><p>abyss + orange mix vae =oversaturated</p>

          </li>

          <li><p>abyss + anything 3.0 vae =oversaturated </p>

          </li>

          <li><p>abyss inpainting + vae-ft-mse-84000 = light halo, this one kinda
          succeded.</p>

          </li>

          <li><p>abyss inpainting + automatic vae  = strong halo.</p>

          </li>

          <li><p>abyss inpainting + none  vae  = medium halo.</p>

          </li>

          <li><p>abyss inpainting + orangemix vae  = light halo.</p>

          </li>

          <li><p>abyss inpainting + anything vae  = medium halo.</p>

          </li>

          </ol>

          <p>Apply color correction to img2img results to match original colors =
          color burn most of cases and vaes but:</p>

          <p>abyss inpainting + vae-ft-mse-84000 + Apply color correction to img2img
          results to match original colors =  partially succeded with a very thin
          halo that can be fixed inpainting over it, but still not the way</p>

          <p>a full 512- inpainting ema .ckpt  + vae-ft-mse-84000 + Apply color correction
          to img2img results to match original colors<br>only masked + fill = no artficats,
          halos, saturations, washed out colors,<br>only masked + original  = no artficats,
          halos, saturations, washed out colors,<br>whole picture + original =  no
          artficats, halos, saturations, washed out colors,<br>whole picture + fill
          = strong halo.<br>whole picture + latent noise str 1:  = smooth + strong
          halo<br>whole picture + latent nothing  str 1:  =  smooth + strong halo</p>

          <p>sometimes increasing the mask blur 4 ,6,8,10,12,14 can fix the halos,
          but blur 4 is like the safe zone.</p>

          '
        raw: "probably not related directly with the .vae but more with the inpainting\
          \ data in a checkpoint.\n\naom2/aom3\naom2/aom3 inpainting\n\nwhole picture\
          \ + -- no half vae \n1. abyss inpainting + automatic vae = no absorption\
          \ + desaturated\n2. abyss inpainting + orange mix vae = no absorption  +\
          \ desaturated\n3. abyss + automatic vae =desaturated\n4. abyss + orange\
          \ mix vae =oversaturated\n5. abyss + anything 3.0 vae =oversaturated \n\
          = tested 20 vaes, all inconsistent.\n\nwhole picture without args\n1. abyss\
          \ inpainting + automatic vae = oversaturated halo \n2. abyss inpainting\
          \ + orange mix vae = oversaturated halo \n3. abyss + automatic vae = really\
          \ desaturated\n4. abyss + orange mix vae =oversaturated\n5. abyss + anything\
          \ 3.0 vae =oversaturated \n\n\n6. abyss inpainting + vae-ft-mse-84000 =\
          \ light halo, this one kinda succeded.\n7. abyss inpainting + automatic\
          \ vae  = strong halo.\n8. abyss inpainting + none  vae  = medium halo.\n\
          9. abyss inpainting + orangemix vae  = light halo.\n10.  abyss inpainting\
          \ + anything vae  = medium halo.\n\nApply color correction to img2img results\
          \ to match original colors = color burn most of cases and vaes but:\n\n\
          abyss inpainting + vae-ft-mse-84000 + Apply color correction to img2img\
          \ results to match original colors =  partially succeded with a very thin\
          \ halo that can be fixed inpainting over it, but still not the way\n\na\
          \ full 512- inpainting ema .ckpt  + vae-ft-mse-84000 + Apply color correction\
          \ to img2img results to match original colors \nonly masked + fill = no\
          \ artficats, halos, saturations, washed out colors,\nonly masked + original\
          \  = no artficats, halos, saturations, washed out colors,\nwhole picture\
          \ + original =  no artficats, halos, saturations, washed out colors,\nwhole\
          \ picture + fill = strong halo.\nwhole picture + latent noise str 1:  =\
          \ smooth + strong halo\nwhole picture + latent nothing  str 1:  =  smooth\
          \ + strong halo\n\nsometimes increasing the mask blur 4 ,6,8,10,12,14 can\
          \ fix the halos, but blur 4 is like the safe zone."
        updatedAt: '2023-03-18T23:58:36.903Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - Enferlain
    id: 6416502cb558cd39f15550fe
    type: comment
  author: AMIAUTHOR
  content: "probably not related directly with the .vae but more with the inpainting\
    \ data in a checkpoint.\n\naom2/aom3\naom2/aom3 inpainting\n\nwhole picture +\
    \ -- no half vae \n1. abyss inpainting + automatic vae = no absorption + desaturated\n\
    2. abyss inpainting + orange mix vae = no absorption  + desaturated\n3. abyss\
    \ + automatic vae =desaturated\n4. abyss + orange mix vae =oversaturated\n5. abyss\
    \ + anything 3.0 vae =oversaturated \n= tested 20 vaes, all inconsistent.\n\n\
    whole picture without args\n1. abyss inpainting + automatic vae = oversaturated\
    \ halo \n2. abyss inpainting + orange mix vae = oversaturated halo \n3. abyss\
    \ + automatic vae = really desaturated\n4. abyss + orange mix vae =oversaturated\n\
    5. abyss + anything 3.0 vae =oversaturated \n\n\n6. abyss inpainting + vae-ft-mse-84000\
    \ = light halo, this one kinda succeded.\n7. abyss inpainting + automatic vae\
    \  = strong halo.\n8. abyss inpainting + none  vae  = medium halo.\n9. abyss inpainting\
    \ + orangemix vae  = light halo.\n10.  abyss inpainting + anything vae  = medium\
    \ halo.\n\nApply color correction to img2img results to match original colors\
    \ = color burn most of cases and vaes but:\n\nabyss inpainting + vae-ft-mse-84000\
    \ + Apply color correction to img2img results to match original colors =  partially\
    \ succeded with a very thin halo that can be fixed inpainting over it, but still\
    \ not the way\n\na full 512- inpainting ema .ckpt  + vae-ft-mse-84000 + Apply\
    \ color correction to img2img results to match original colors \nonly masked +\
    \ fill = no artficats, halos, saturations, washed out colors,\nonly masked + original\
    \  = no artficats, halos, saturations, washed out colors,\nwhole picture + original\
    \ =  no artficats, halos, saturations, washed out colors,\nwhole picture + fill\
    \ = strong halo.\nwhole picture + latent noise str 1:  = smooth + strong halo\n\
    whole picture + latent nothing  str 1:  =  smooth + strong halo\n\nsometimes increasing\
    \ the mask blur 4 ,6,8,10,12,14 can fix the halos, but blur 4 is like the safe\
    \ zone."
  created_at: 2023-03-18 22:58:36+00:00
  edited: false
  hidden: false
  id: 6416502cb558cd39f15550fe
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
      fullname: Hoshino Imi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Enferlain
      type: user
    createdAt: '2023-03-19T01:11:20.000Z'
    data:
      edited: true
      editors:
      - Enferlain
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/634575c6d54fb141ded9c931/rqQTf4ewWbUR8NfuuUyS4.png?w=200&h=200&f=face
          fullname: Hoshino Imi
          isHf: false
          isPro: false
          name: Enferlain
          type: user
        html: '<p>Thanks for the info.</p>

          <p>I''ve only tried the 2 setups that I wrote about above, and a few other
          vaes. In my experience, the default settings (sd vae on auto, no changes)
          img2img, inpainting, and upscale would all be desaturated, and img2img would
          regularly produce purple artifacts on the images, especially upscaling.
          After using --no-half-vae and switching to orangemix vae, the saturation
          seems fine, and I haven''t encountered purple artifacts so far, but I only
          found out about this today so more testing needed.</p>

          <p>It''s not perfect, but this is the maximum desaturation I''m getting<br><a
          rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1679188200404-634575c6d54fb141ded9c931.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1679188200404-634575c6d54fb141ded9c931.png"></a></p>

          <p>compared to the default<br><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1679188259712-634575c6d54fb141ded9c931.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1679188259712-634575c6d54fb141ded9c931.png"></a></p>

          <p>I will try ticking color correction and see how it does, and check the
          other methods you mentioned.</p>

          '
        raw: 'Thanks for the info.


          I''ve only tried the 2 setups that I wrote about above, and a few other
          vaes. In my experience, the default settings (sd vae on auto, no changes)
          img2img, inpainting, and upscale would all be desaturated, and img2img would
          regularly produce purple artifacts on the images, especially upscaling.
          After using --no-half-vae and switching to orangemix vae, the saturation
          seems fine, and I haven''t encountered purple artifacts so far, but I only
          found out about this today so more testing needed.


          It''s not perfect, but this is the maximum desaturation I''m getting

          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679188200404-634575c6d54fb141ded9c931.png)


          compared to the default

          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679188259712-634575c6d54fb141ded9c931.png)


          I will try ticking color correction and see how it does, and check the other
          methods you mentioned.'
        updatedAt: '2023-03-19T01:12:41.956Z'
      numEdits: 1
      reactions: []
    id: 6416613806eb91d9c44ae454
    type: comment
  author: Enferlain
  content: 'Thanks for the info.


    I''ve only tried the 2 setups that I wrote about above, and a few other vaes.
    In my experience, the default settings (sd vae on auto, no changes) img2img, inpainting,
    and upscale would all be desaturated, and img2img would regularly produce purple
    artifacts on the images, especially upscaling. After using --no-half-vae and switching
    to orangemix vae, the saturation seems fine, and I haven''t encountered purple
    artifacts so far, but I only found out about this today so more testing needed.


    It''s not perfect, but this is the maximum desaturation I''m getting

    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679188200404-634575c6d54fb141ded9c931.png)


    compared to the default

    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1679188259712-634575c6d54fb141ded9c931.png)


    I will try ticking color correction and see how it does, and check the other methods
    you mentioned.'
  created_at: 2023-03-19 00:11:20+00:00
  edited: true
  hidden: false
  id: 6416613806eb91d9c44ae454
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 80
repo_id: WarriorMama777/OrangeMixs
repo_type: model
status: open
target_branch: null
title: Orangemix vae completely broken for img2img?
