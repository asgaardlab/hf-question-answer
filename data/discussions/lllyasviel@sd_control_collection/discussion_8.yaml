!!python/object:huggingface_hub.community.DiscussionWithDetails
author: AIClaudioAI
conflicting_files: null
created_at: 2023-09-16 06:27:02+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f3ca4b4666fc81882f4ffb8820f449da.svg
      fullname: AI
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AIClaudioAI
      type: user
    createdAt: '2023-09-16T07:27:02.000Z'
    data:
      edited: false
      editors:
      - AIClaudioAI
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.432496577501297
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f3ca4b4666fc81882f4ffb8820f449da.svg
          fullname: AI
          isHf: false
          isPro: false
          name: AIClaudioAI
          type: user
        html: "<p>Hi all,</p>\n<p>How can I update my Google collab? I guess that\
          \ I was not using the last control net version: </p>\n<p>The default colab\
          \ of <a rel=\"nofollow\" href=\"https://github.com/TheLastBen/fast-stable-diffusion\"\
          >https://github.com/TheLastBen/fast-stable-diffusion</a> is not updated:</p>\n\
          <p>#@markdown # ControlNet<br>from torch.hub import download_url_to_file<br>from\
          \ urllib.parse import urlparse<br>import re<br>from subprocess import run</p>\n\
          <p>Model = \"All (21GB)\" #@param [ \"None\", \"All (21GB)\", \"Canny\"\
          , \"Depth\", \"Lineart\", \"MLSD\", \"Normal\", \"OpenPose\", \"Scribble\"\
          , \"Seg\", \"ip2p\", \"Shuffle\", \"Inpaint\", \"Softedge\", \"Lineart_Anime\"\
          , \"Tile\", \"T2iadapter_Models\"]</p>\n<p>v2_Model = \"All\" #@param [\
          \ \"None\", \"All\", \"Canny\", \"Depth\", \"HED\", \"OpenPose\", \"Scribble\"\
          ]</p>\n<p>#@markdown - Download/update ControlNet extension and its models</p>\n\
          <p>def download(url, model_dir):</p>\n<pre><code>filename = os.path.basename(urlparse(url).path)\n\
          pth = os.path.abspath(os.path.join(model_dir, filename))\nif not os.path.exists(pth):\n\
          \    print('Downloading: '+os.path.basename(url))\n    download_url_to_file(url,\
          \ pth, hash_prefix=None, progress=True)\nelse:\n  print(f\"\e[1;32mThe model\
          \ {filename} already exists\e[0m\")\n</code></pre>\n<p>Canny='<a href=\"\
          https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_canny.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_canny.pth'</a><br>Depth='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1p_sd15_depth.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1p_sd15_depth.pth'</a><br>Lineart='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_lineart.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_lineart.pth'</a><br>MLSD='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_mlsd.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_mlsd.pth'</a><br>Normal='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_normalbae.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_normalbae.pth'</a><br>OpenPose='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_openpose.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_openpose.pth'</a><br>Scribble='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_scribble.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_scribble.pth'</a><br>Seg='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_seg.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_seg.pth'</a><br>ip2p='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_ip2p.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_ip2p.pth'</a><br>Shuffle='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_shuffle.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_shuffle.pth'</a><br>Inpaint='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_inpaint.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_inpaint.pth'</a><br>Softedge='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_softedge.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_softedge.pth'</a><br>Lineart_Anime='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15s2_lineart_anime.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15s2_lineart_anime.pth'</a><br>Tile='<a\
          \ href=\"https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1e_sd15_tile.pth'\"\
          >https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1e_sd15_tile.pth'</a></p>\n\
          <p>with capture.capture_output() as cap:<br>  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions<br>\
          \  if not os.path.exists(\"sd-webui-controlnet\"):<br>    !git clone <a\
          \ rel=\"nofollow\" href=\"https://github.com/Mikubill/sd-w$blasphemy-controlnet.git\"\
          >https://github.com/Mikubill/sd-w$blasphemy-controlnet.git</a><br>    %cd\
          \ /content<br>  else:<br>    %cd sd-w$blasphemy-controlnet<br>    !git reset\
          \ --hard<br>    !git pull<br>    %cd /content</p>\n<p>mdldir='/content/gdrive/'+mainpth+'/sd/stable-diffusion-w'+blasphemy+'/extensions/sd-w'+blasphemy+'-controlnet/models'<br>for\
          \ filename in os.listdir(mdldir):<br>  if \"_sd14v1\" in filename:<br> \
          \   renamed = re.sub(\"_sd14v1\", \"-fp16\", filename)<br>    os.rename(os.path.join(mdldir,\
          \ filename), os.path.join(mdldir, renamed))</p>\n<p>!wget -q -O CN_models.txt\
          \ <a rel=\"nofollow\" href=\"https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models.txt\"\
          >https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models.txt</a><br>!wget\
          \ -q -O CN_models_v2.txt <a rel=\"nofollow\" href=\"https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models_v2.txt\"\
          >https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models_v2.txt</a></p>\n\
          <p>with open(\"CN_models.txt\", 'r') as f:<br>  mdllnk = f.read().splitlines()<br>with\
          \ open(\"CN_models_v2.txt\", 'r') as d:<br>  mdllnk_v2 = d.read().splitlines()</p>\n\
          <p>!rm CN_models.txt CN_models_v2.txt</p>\n<p>with capture.capture_output()\
          \ as cap:<br>  cfgnames=[os.path.basename(url).split('.')[0]+'.yaml' for\
          \ url in mdllnk_v2]<br>  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions/sd-w$blasphemy-controlnet/models<br>\
          \  for name in cfgnames:<br>      run(['cp', 'cldm_v21.yaml', name])<br>\
          \  %cd /content</p>\n<p>if Model == \"All (21GB)\":<br>  for lnk in mdllnk:<br>\
          \      download(lnk, mdldir)<br>  clear_output()</p>\n<p>elif Model == \"\
          T2iadapter_Models\":<br>  mdllnk=list(filter(lambda x: 't2i' in x, mdllnk))<br>\
          \  for lnk in mdllnk:<br>      download(lnk, mdldir)<br>  clear_output()</p>\n\
          <p>elif Model == \"None\":<br>    pass<br>    clear_output()</p>\n<p>else:<br>\
          \  download(globals()[Model], mdldir)<br>  clear_output()</p>\n<p>Canny='<a\
          \ href=\"https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_canny.safetensors'\"\
          >https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_canny.safetensors'</a><br>Depth='<a\
          \ href=\"https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_depth.safetensors'\"\
          >https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_depth.safetensors'</a><br>HED='<a\
          \ href=\"https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_hed.safetensors'\"\
          >https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_hed.safetensors'</a><br>OpenPose='<a\
          \ href=\"https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_openposev2.safetensors'\"\
          >https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_openposev2.safetensors'</a><br>Scribble='<a\
          \ href=\"https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_scribble.safetensors'\"\
          >https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_scribble.safetensors'</a></p>\n\
          <p>if v2_Model == \"All\":<br>  for lnk_v2 in mdllnk_v2:<br>      download(lnk_v2,\
          \ mdldir)<br>  clear_output()<br>  inf('\\u2714 Done','success', '50px')</p>\n\
          <p>elif v2_Model == \"None\":<br>    pass<br>    clear_output()<br>    inf('\\\
          u2714 Done','success', '50px')</p>\n<p>else:<br>  download(globals()[v2_Model],\
          \ mdldir)<br>  clear_output()<br>  inf('\\u2714 Done','success', '50px')</p>\n\
          <p>  #@markdown ---</p>\n"
        raw: "Hi all,\r\n\r\nHow can I update my Google collab? I guess that I was\
          \ not using the last control net version: \r\n\r\n\r\nThe default colab\
          \ of https://github.com/TheLastBen/fast-stable-diffusion is not updated:\r\
          \n\r\n#@markdown # ControlNet\r\nfrom torch.hub import download_url_to_file\r\
          \nfrom urllib.parse import urlparse\r\nimport re\r\nfrom subprocess import\
          \ run\r\n\r\nModel = \"All (21GB)\" #@param [ \"None\", \"All (21GB)\",\
          \ \"Canny\", \"Depth\", \"Lineart\", \"MLSD\", \"Normal\", \"OpenPose\"\
          , \"Scribble\", \"Seg\", \"ip2p\", \"Shuffle\", \"Inpaint\", \"Softedge\"\
          , \"Lineart_Anime\", \"Tile\", \"T2iadapter_Models\"]\r\n\r\nv2_Model =\
          \ \"All\" #@param [ \"None\", \"All\", \"Canny\", \"Depth\", \"HED\", \"\
          OpenPose\", \"Scribble\"]\r\n\r\n#@markdown - Download/update ControlNet\
          \ extension and its models\r\n\r\ndef download(url, model_dir):\r\n\r\n\
          \    filename = os.path.basename(urlparse(url).path)\r\n    pth = os.path.abspath(os.path.join(model_dir,\
          \ filename))\r\n    if not os.path.exists(pth):\r\n        print('Downloading:\
          \ '+os.path.basename(url))\r\n        download_url_to_file(url, pth, hash_prefix=None,\
          \ progress=True)\r\n    else:\r\n      print(f\"\e[1;32mThe model {filename}\
          \ already exists\e[0m\")\r\n\r\nCanny='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_canny.pth'\r\
          \nDepth='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1p_sd15_depth.pth'\r\
          \nLineart='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_lineart.pth'\r\
          \nMLSD='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_mlsd.pth'\r\
          \nNormal='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_normalbae.pth'\r\
          \nOpenPose='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_openpose.pth'\r\
          \nScribble='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_scribble.pth'\r\
          \nSeg='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_seg.pth'\r\
          \nip2p='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_ip2p.pth'\r\
          \nShuffle='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_shuffle.pth'\r\
          \nInpaint='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_inpaint.pth'\r\
          \nSoftedge='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_softedge.pth'\r\
          \nLineart_Anime='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15s2_lineart_anime.pth'\r\
          \nTile='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1e_sd15_tile.pth'\r\
          \n\r\nwith capture.capture_output() as cap:\r\n  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions\r\
          \n  if not os.path.exists(\"sd-webui-controlnet\"):\r\n    !git clone https://github.com/Mikubill/sd-w$blasphemy-controlnet.git\r\
          \n    %cd /content\r\n  else:\r\n    %cd sd-w$blasphemy-controlnet\r\n \
          \   !git reset --hard\r\n    !git pull\r\n    %cd /content\r\n\r\nmdldir='/content/gdrive/'+mainpth+'/sd/stable-diffusion-w'+blasphemy+'/extensions/sd-w'+blasphemy+'-controlnet/models'\r\
          \nfor filename in os.listdir(mdldir):\r\n  if \"_sd14v1\" in filename:\r\
          \n    renamed = re.sub(\"_sd14v1\", \"-fp16\", filename)\r\n    os.rename(os.path.join(mdldir,\
          \ filename), os.path.join(mdldir, renamed))\r\n\r\n!wget -q -O CN_models.txt\
          \ https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models.txt\r\
          \n!wget -q -O CN_models_v2.txt https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models_v2.txt\r\
          \n\r\nwith open(\"CN_models.txt\", 'r') as f:\r\n  mdllnk = f.read().splitlines()\r\
          \nwith open(\"CN_models_v2.txt\", 'r') as d:\r\n  mdllnk_v2 = d.read().splitlines()\r\
          \n\r\n!rm CN_models.txt CN_models_v2.txt\r\n\r\nwith capture.capture_output()\
          \ as cap:\r\n  cfgnames=[os.path.basename(url).split('.')[0]+'.yaml' for\
          \ url in mdllnk_v2]\r\n  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions/sd-w$blasphemy-controlnet/models\r\
          \n  for name in cfgnames:\r\n      run(['cp', 'cldm_v21.yaml', name])\r\n\
          \  %cd /content\r\n\r\nif Model == \"All (21GB)\":\r\n  for lnk in mdllnk:\r\
          \n      download(lnk, mdldir)\r\n  clear_output()\r\n\r\nelif Model == \"\
          T2iadapter_Models\":\r\n  mdllnk=list(filter(lambda x: 't2i' in x, mdllnk))\r\
          \n  for lnk in mdllnk:\r\n      download(lnk, mdldir)\r\n  clear_output()\r\
          \n\r\nelif Model == \"None\":\r\n    pass\r\n    clear_output()\r\n\r\n\
          else:\r\n  download(globals()[Model], mdldir)\r\n  clear_output()\r\n\r\n\
          Canny='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_canny.safetensors'\r\
          \nDepth='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_depth.safetensors'\r\
          \nHED='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_hed.safetensors'\r\
          \nOpenPose='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_openposev2.safetensors'\r\
          \nScribble='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_scribble.safetensors'\r\
          \n\r\nif v2_Model == \"All\":\r\n  for lnk_v2 in mdllnk_v2:\r\n      download(lnk_v2,\
          \ mdldir)\r\n  clear_output()\r\n  inf('\\u2714 Done','success', '50px')\r\
          \n\r\nelif v2_Model == \"None\":\r\n    pass\r\n    clear_output()\r\n \
          \   inf('\\u2714 Done','success', '50px')\r\n\r\nelse:\r\n  download(globals()[v2_Model],\
          \ mdldir)\r\n  clear_output()\r\n  inf('\\u2714 Done','success', '50px')\r\
          \n\r\n  #@markdown ---\r\n\r\n"
        updatedAt: '2023-09-16T07:27:02.049Z'
      numEdits: 0
      reactions: []
    id: 650558c6a61b2c010ed70080
    type: comment
  author: AIClaudioAI
  content: "Hi all,\r\n\r\nHow can I update my Google collab? I guess that I was not\
    \ using the last control net version: \r\n\r\n\r\nThe default colab of https://github.com/TheLastBen/fast-stable-diffusion\
    \ is not updated:\r\n\r\n#@markdown # ControlNet\r\nfrom torch.hub import download_url_to_file\r\
    \nfrom urllib.parse import urlparse\r\nimport re\r\nfrom subprocess import run\r\
    \n\r\nModel = \"All (21GB)\" #@param [ \"None\", \"All (21GB)\", \"Canny\", \"\
    Depth\", \"Lineart\", \"MLSD\", \"Normal\", \"OpenPose\", \"Scribble\", \"Seg\"\
    , \"ip2p\", \"Shuffle\", \"Inpaint\", \"Softedge\", \"Lineart_Anime\", \"Tile\"\
    , \"T2iadapter_Models\"]\r\n\r\nv2_Model = \"All\" #@param [ \"None\", \"All\"\
    , \"Canny\", \"Depth\", \"HED\", \"OpenPose\", \"Scribble\"]\r\n\r\n#@markdown\
    \ - Download/update ControlNet extension and its models\r\n\r\ndef download(url,\
    \ model_dir):\r\n\r\n    filename = os.path.basename(urlparse(url).path)\r\n \
    \   pth = os.path.abspath(os.path.join(model_dir, filename))\r\n    if not os.path.exists(pth):\r\
    \n        print('Downloading: '+os.path.basename(url))\r\n        download_url_to_file(url,\
    \ pth, hash_prefix=None, progress=True)\r\n    else:\r\n      print(f\"\e[1;32mThe\
    \ model {filename} already exists\e[0m\")\r\n\r\nCanny='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_canny.pth'\r\
    \nDepth='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1p_sd15_depth.pth'\r\
    \nLineart='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_lineart.pth'\r\
    \nMLSD='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_mlsd.pth'\r\
    \nNormal='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_normalbae.pth'\r\
    \nOpenPose='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_openpose.pth'\r\
    \nScribble='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_scribble.pth'\r\
    \nSeg='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_seg.pth'\r\
    \nip2p='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_ip2p.pth'\r\
    \nShuffle='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11e_sd15_shuffle.pth'\r\
    \nInpaint='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_inpaint.pth'\r\
    \nSoftedge='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_softedge.pth'\r\
    \nLineart_Anime='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15s2_lineart_anime.pth'\r\
    \nTile='https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1e_sd15_tile.pth'\r\
    \n\r\nwith capture.capture_output() as cap:\r\n  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions\r\
    \n  if not os.path.exists(\"sd-webui-controlnet\"):\r\n    !git clone https://github.com/Mikubill/sd-w$blasphemy-controlnet.git\r\
    \n    %cd /content\r\n  else:\r\n    %cd sd-w$blasphemy-controlnet\r\n    !git\
    \ reset --hard\r\n    !git pull\r\n    %cd /content\r\n\r\nmdldir='/content/gdrive/'+mainpth+'/sd/stable-diffusion-w'+blasphemy+'/extensions/sd-w'+blasphemy+'-controlnet/models'\r\
    \nfor filename in os.listdir(mdldir):\r\n  if \"_sd14v1\" in filename:\r\n   \
    \ renamed = re.sub(\"_sd14v1\", \"-fp16\", filename)\r\n    os.rename(os.path.join(mdldir,\
    \ filename), os.path.join(mdldir, renamed))\r\n\r\n!wget -q -O CN_models.txt https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models.txt\r\
    \n!wget -q -O CN_models_v2.txt https://github.com/TheLastBen/fast-stable-diffusion/raw/main/AUTOMATIC1111_files/CN_models_v2.txt\r\
    \n\r\nwith open(\"CN_models.txt\", 'r') as f:\r\n  mdllnk = f.read().splitlines()\r\
    \nwith open(\"CN_models_v2.txt\", 'r') as d:\r\n  mdllnk_v2 = d.read().splitlines()\r\
    \n\r\n!rm CN_models.txt CN_models_v2.txt\r\n\r\nwith capture.capture_output()\
    \ as cap:\r\n  cfgnames=[os.path.basename(url).split('.')[0]+'.yaml' for url in\
    \ mdllnk_v2]\r\n  %cd /content/gdrive/$mainpth/sd/stable-diffusion-w$blasphemy/extensions/sd-w$blasphemy-controlnet/models\r\
    \n  for name in cfgnames:\r\n      run(['cp', 'cldm_v21.yaml', name])\r\n  %cd\
    \ /content\r\n\r\nif Model == \"All (21GB)\":\r\n  for lnk in mdllnk:\r\n    \
    \  download(lnk, mdldir)\r\n  clear_output()\r\n\r\nelif Model == \"T2iadapter_Models\"\
    :\r\n  mdllnk=list(filter(lambda x: 't2i' in x, mdllnk))\r\n  for lnk in mdllnk:\r\
    \n      download(lnk, mdldir)\r\n  clear_output()\r\n\r\nelif Model == \"None\"\
    :\r\n    pass\r\n    clear_output()\r\n\r\nelse:\r\n  download(globals()[Model],\
    \ mdldir)\r\n  clear_output()\r\n\r\nCanny='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_canny.safetensors'\r\
    \nDepth='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_depth.safetensors'\r\
    \nHED='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_hed.safetensors'\r\
    \nOpenPose='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_openposev2.safetensors'\r\
    \nScribble='https://huggingface.co/thibaud/controlnet-sd21/resolve/main/control_v11p_sd21_scribble.safetensors'\r\
    \n\r\nif v2_Model == \"All\":\r\n  for lnk_v2 in mdllnk_v2:\r\n      download(lnk_v2,\
    \ mdldir)\r\n  clear_output()\r\n  inf('\\u2714 Done','success', '50px')\r\n\r\
    \nelif v2_Model == \"None\":\r\n    pass\r\n    clear_output()\r\n    inf('\\\
    u2714 Done','success', '50px')\r\n\r\nelse:\r\n  download(globals()[v2_Model],\
    \ mdldir)\r\n  clear_output()\r\n  inf('\\u2714 Done','success', '50px')\r\n\r\
    \n  #@markdown ---\r\n\r\n"
  created_at: 2023-09-16 06:27:02+00:00
  edited: false
  hidden: false
  id: 650558c6a61b2c010ed70080
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 8
repo_id: lllyasviel/sd_control_collection
repo_type: model
status: open
target_branch: null
title: Question - ControlNet - update
