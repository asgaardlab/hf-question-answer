!!python/object:huggingface_hub.community.DiscussionWithDetails
author: wuyuh
conflicting_files: null
created_at: 2023-03-13 13:37:15+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9099f733e4e2ff6e4dbb0f06faa6f2fb.svg
      fullname: "\u5434\u5B87\u73E9"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: wuyuh
      type: user
    createdAt: '2023-03-13T14:37:15.000Z'
    data:
      edited: true
      editors:
      - wuyuh
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9099f733e4e2ff6e4dbb0f06faa6f2fb.svg
          fullname: "\u5434\u5B87\u73E9"
          isHf: false
          isPro: false
          name: wuyuh
          type: user
        html: '<p>What is the cause of this problem</p>

          '
        raw: What is the cause of this problem
        updatedAt: '2023-03-13T14:37:34.137Z'
      numEdits: 1
      reactions: []
    id: 640f351ba92fedb0e8503db8
    type: comment
  author: wuyuh
  content: What is the cause of this problem
  created_at: 2023-03-13 13:37:15+00:00
  edited: true
  hidden: false
  id: 640f351ba92fedb0e8503db8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/37efe53031a0f755becc3b1aad363bb5.svg
      fullname: Jonas Krug
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: krugjo
      type: user
    createdAt: '2023-03-14T13:36:27.000Z'
    data:
      edited: false
      editors:
      - krugjo
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/37efe53031a0f755becc3b1aad363bb5.svg
          fullname: Jonas Krug
          isHf: false
          isPro: false
          name: krugjo
          type: user
        html: '<p>I have the same Problem and I dont know how to solve it. It seams
          like most wav2vec models that are fine-tuned for emotion speech recognition
          have a similar structure of code, so I dont know how to avoid the predict()
          function. </p>

          <p>It seams like that there is a problem of the input tensor being passed
          to the convulutional layer of the neural network. The input Tensor has a
          shape of [1, 1, 2, 476544], which is a 4 Dimensional input tensor. However
          the convolutional layer expects a 2D or 3D input tensor.</p>

          <p>It is possible that the ''speech_file_to_array_fn()'' function is not
          returning the expected shape of the audio data, which could cause issues
          downstream in the prediction process. </p>

          <p>But again I dont really know how to solve this issue:/</p>

          '
        raw: "I have the same Problem and I dont know how to solve it. It seams like\
          \ most wav2vec models that are fine-tuned for emotion speech recognition\
          \ have a similar structure of code, so I dont know how to avoid the predict()\
          \ function. \n\nIt seams like that there is a problem of the input tensor\
          \ being passed to the convulutional layer of the neural network. The input\
          \ Tensor has a shape of [1, 1, 2, 476544], which is a 4 Dimensional input\
          \ tensor. However the convolutional layer expects a 2D or 3D input tensor.\n\
          \nIt is possible that the 'speech_file_to_array_fn()' function is not returning\
          \ the expected shape of the audio data, which could cause issues downstream\
          \ in the prediction process. \n\nBut again I dont really know how to solve\
          \ this issue:/"
        updatedAt: '2023-03-14T13:36:27.078Z'
      numEdits: 0
      reactions: []
    id: 6410785b22ef6fe49621184f
    type: comment
  author: krugjo
  content: "I have the same Problem and I dont know how to solve it. It seams like\
    \ most wav2vec models that are fine-tuned for emotion speech recognition have\
    \ a similar structure of code, so I dont know how to avoid the predict() function.\
    \ \n\nIt seams like that there is a problem of the input tensor being passed to\
    \ the convulutional layer of the neural network. The input Tensor has a shape\
    \ of [1, 1, 2, 476544], which is a 4 Dimensional input tensor. However the convolutional\
    \ layer expects a 2D or 3D input tensor.\n\nIt is possible that the 'speech_file_to_array_fn()'\
    \ function is not returning the expected shape of the audio data, which could\
    \ cause issues downstream in the prediction process. \n\nBut again I dont really\
    \ know how to solve this issue:/"
  created_at: 2023-03-14 12:36:27+00:00
  edited: false
  hidden: false
  id: 6410785b22ef6fe49621184f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/30367c93f7acbc881ff6005d6b4bb693.svg
      fullname: Peter Durham
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: pdurham18
      type: user
    createdAt: '2023-03-16T20:14:20.000Z'
    data:
      edited: false
      editors:
      - pdurham18
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/30367c93f7acbc881ff6005d6b4bb693.svg
          fullname: Peter Durham
          isHf: false
          isPro: false
          name: pdurham18
          type: user
        html: "<p>I think the issue is in <code>speach_file_to_array_fn</code>. It\
          \ looks like <code>torchaudio.load</code> returns the waveform and time\
          \ (based on channels_first arg: <a rel=\"nofollow\" href=\"https://pytorch.org/audio/0.8.0/backend.html#torchaudio.backend.sox_io_backend.load\"\
          >https://pytorch.org/audio/0.8.0/backend.html#torchaudio.backend.sox_io_backend.load</a>).\
          \ I selected just the second element of speach_array and then the predict\
          \ function worked for me.</p>\n<pre><code>def speech_file_to_array_fn(path,\
          \ sampling_rate):\n    speech_array, _sampling_rate = torchaudio.load(path,format=\"\
          mp3\")\n    resampler = torchaudio.transforms.Resample(_sampling_rate)\n\
          \    speech = resampler(speech_array[1]).squeeze().numpy()\n    return speech\n\
          </code></pre>\n"
        raw: "I think the issue is in `speach_file_to_array_fn`. It looks like `torchaudio.load`\
          \ returns the waveform and time (based on channels_first arg: https://pytorch.org/audio/0.8.0/backend.html#torchaudio.backend.sox_io_backend.load).\
          \ I selected just the second element of speach_array and then the predict\
          \ function worked for me.\n```\ndef speech_file_to_array_fn(path, sampling_rate):\n\
          \    speech_array, _sampling_rate = torchaudio.load(path,format=\"mp3\"\
          )\n    resampler = torchaudio.transforms.Resample(_sampling_rate)\n    speech\
          \ = resampler(speech_array[1]).squeeze().numpy()\n    return speech\n```"
        updatedAt: '2023-03-16T20:14:20.018Z'
      numEdits: 0
      reactions:
      - count: 7
        reaction: "\u2764\uFE0F"
        users:
        - dmcrun
        - Horasan
        - IbrahimSalah
        - cashwin10
        - VonSquiggles
        - danzz06
        - MOK2023
    id: 6413789c964f3409c4576c5b
    type: comment
  author: pdurham18
  content: "I think the issue is in `speach_file_to_array_fn`. It looks like `torchaudio.load`\
    \ returns the waveform and time (based on channels_first arg: https://pytorch.org/audio/0.8.0/backend.html#torchaudio.backend.sox_io_backend.load).\
    \ I selected just the second element of speach_array and then the predict function\
    \ worked for me.\n```\ndef speech_file_to_array_fn(path, sampling_rate):\n   \
    \ speech_array, _sampling_rate = torchaudio.load(path,format=\"mp3\")\n    resampler\
    \ = torchaudio.transforms.Resample(_sampling_rate)\n    speech = resampler(speech_array[1]).squeeze().numpy()\n\
    \    return speech\n```"
  created_at: 2023-03-16 19:14:20+00:00
  edited: false
  hidden: false
  id: 6413789c964f3409c4576c5b
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: harshit345/xlsr-wav2vec-speech-emotion-recognition
repo_type: model
status: open
target_branch: null
title: 'RuntimeError: Expected 2D (unbatched) or 3D (batched) input to conv1d, but
  got input of size: [1, 1, 2, 476544]'
