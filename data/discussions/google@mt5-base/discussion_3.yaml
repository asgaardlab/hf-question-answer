!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Kaedin
conflicting_files: null
created_at: 2022-11-09 14:48:54+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3566d367b7a7b496c5502d6e9830fe5e.svg
      fullname: Kaedin Lian
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Kaedin
      type: user
    createdAt: '2022-11-09T14:48:54.000Z'
    data:
      edited: false
      editors:
      - Kaedin
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3566d367b7a7b496c5502d6e9830fe5e.svg
          fullname: Kaedin Lian
          isHf: false
          isPro: false
          name: Kaedin
          type: user
        html: '<p>Appreciate your time.<br>     I downloaded mt5-small and finetune
          it. But model returns  no matter what input is.So I trid some input like
          text in the image (or chinese et al.) on mt5-base and mt5-small by the website
          inference API.<br>     I would be grateful for your advices on how to avoid
          this phenomenon.<br><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1668004661001-636bbad7ecd380d10a90ad65.jpeg"><img
          alt="6e982739-b398-4d91-950a-776e10480075.jpeg" src="https://cdn-uploads.huggingface.co/production/uploads/1668004661001-636bbad7ecd380d10a90ad65.jpeg"></a></p>

          '
        raw: "Appreciate your time.\r\n     I downloaded mt5-small and finetune it.\
          \ But model returns <extra_id_0> no matter what input is.So I trid some\
          \ input like text in the image (or chinese et al.) on mt5-base and mt5-small\
          \ by the website inference API. \r\n     I would be grateful for your advices\
          \ on how to avoid this phenomenon.\r\n![6e982739-b398-4d91-950a-776e10480075.jpeg](https://cdn-uploads.huggingface.co/production/uploads/1668004661001-636bbad7ecd380d10a90ad65.jpeg)\r\
          \n\r\n"
        updatedAt: '2022-11-09T14:48:54.239Z'
      numEdits: 0
      reactions: []
    id: 636bbdd629668f04eaf771f0
    type: comment
  author: Kaedin
  content: "Appreciate your time.\r\n     I downloaded mt5-small and finetune it.\
    \ But model returns <extra_id_0> no matter what input is.So I trid some input\
    \ like text in the image (or chinese et al.) on mt5-base and mt5-small by the\
    \ website inference API. \r\n     I would be grateful for your advices on how\
    \ to avoid this phenomenon.\r\n![6e982739-b398-4d91-950a-776e10480075.jpeg](https://cdn-uploads.huggingface.co/production/uploads/1668004661001-636bbad7ecd380d10a90ad65.jpeg)\r\
    \n\r\n"
  created_at: 2022-11-09 14:48:54+00:00
  edited: false
  hidden: false
  id: 636bbdd629668f04eaf771f0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3566d367b7a7b496c5502d6e9830fe5e.svg
      fullname: Kaedin Lian
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Kaedin
      type: user
    createdAt: '2022-11-09T14:53:06.000Z'
    data:
      edited: false
      editors:
      - Kaedin
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3566d367b7a7b496c5502d6e9830fe5e.svg
          fullname: Kaedin Lian
          isHf: false
          isPro: false
          name: Kaedin
          type: user
        html: '<p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1668005583225-636bbad7ecd380d10a90ad65.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1668005583225-636bbad7ecd380d10a90ad65.png"></a></p>

          '
        raw: '![image.png](https://cdn-uploads.huggingface.co/production/uploads/1668005583225-636bbad7ecd380d10a90ad65.png)'
        updatedAt: '2022-11-09T14:53:06.730Z'
      numEdits: 0
      reactions: []
    id: 636bbed24942b4f89ae1c004
    type: comment
  author: Kaedin
  content: '![image.png](https://cdn-uploads.huggingface.co/production/uploads/1668005583225-636bbad7ecd380d10a90ad65.png)'
  created_at: 2022-11-09 14:53:06+00:00
  edited: false
  hidden: false
  id: 636bbed24942b4f89ae1c004
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/3566d367b7a7b496c5502d6e9830fe5e.svg
      fullname: Kaedin Lian
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Kaedin
      type: user
    createdAt: '2022-11-10T04:38:34.000Z'
    data:
      status: closed
    id: 636c804acfb49b46821c2639
    type: status-change
  author: Kaedin
  created_at: 2022-11-10 04:38:34+00:00
  id: 636c804acfb49b46821c2639
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
      fullname: ZeroneBo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZeroneBo
      type: user
    createdAt: '2023-12-14T15:29:48.000Z'
    data:
      edited: false
      editors:
      - ZeroneBo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.45529577136039734
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
          fullname: ZeroneBo
          isHf: false
          isPro: false
          name: ZeroneBo
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Kaedin&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Kaedin\">@<span class=\"\
          underline\">Kaedin</span></a></span>\n\n\t</span></span> Hi, I encountered\
          \ the same problem. I'm curious how you solved it.<br>In my case, I downloaded\
          \ mt5-base, and didn't finetune it, it returns the following answer (all\
          \ of them are extra_id):</p>\n<p>case1:</p>\n<pre><code class=\"language-python\"\
          >ipt = tokenizer([<span class=\"hljs-string\">\"translate English to German:\
          \ That is good.\"</span>], return_tensors=<span class=\"hljs-string\">'pt'</span>)\n\
          ipt[<span class=\"hljs-string\">'input_ids'</span>] = ipt[<span class=\"\
          hljs-string\">'input_ids'</span>].cuda()\nipt[<span class=\"hljs-string\"\
          >'attention_mask'</span>] = ipt[<span class=\"hljs-string\">'attention_mask'</span>].cuda()\n\
          opt = mt5.generate(**ipt, max_new_tokens=<span class=\"hljs-number\">128</span>,\
          \ num_beams=<span class=\"hljs-number\">1</span>)\nmt5_tokenizer.batch_decode(opt)\n\
          </code></pre>\n<p>output:</p>\n<pre><code>['&lt;pad&gt; &lt;extra_id_0&gt;\
          \ &lt;extra_id_1&gt;  &lt;extra_id_2&gt;,............  &lt;extra_id_3&gt;.............\
          \  &lt;extra_id_4&gt;.........  &lt;extra_id_5&gt;.......  &lt;extra_id_6&gt;......\
          \  &lt;extra_id_7&gt;.......  &lt;extra_id_8&gt;.']\n</code></pre>\n<p>case2:</p>\n\
          <pre><code class=\"language-python\">ipt = tokenizer([<span class=\"hljs-string\"\
          >\"translate English to Chinese: That is good.\"</span>], return_tensors=<span\
          \ class=\"hljs-string\">'pt'</span>)\nipt[<span class=\"hljs-string\">'input_ids'</span>]\
          \ = ipt[<span class=\"hljs-string\">'input_ids'</span>].cuda()\nipt[<span\
          \ class=\"hljs-string\">'attention_mask'</span>] = ipt[<span class=\"hljs-string\"\
          >'attention_mask'</span>].cuda()\nopt = mt5.generate(**ipt, max_new_tokens=<span\
          \ class=\"hljs-number\">128</span>, num_beams=<span class=\"hljs-number\"\
          >1</span>)\nmt5_tokenizer.batch_decode(opt)\n</code></pre>\n<p>output:</p>\n\
          <pre><code>['&lt;pad&gt; &lt;extra_id_0&gt;&lt;/s&gt;']\n</code></pre>\n"
        raw: '@Kaedin Hi, I encountered the same problem. I''m curious how you solved
          it.

          In my case, I downloaded mt5-base, and didn''t finetune it, it returns the
          following answer (all of them are extra_id):


          case1:

          ```python

          ipt = tokenizer(["translate English to German: That is good."], return_tensors=''pt'')

          ipt[''input_ids''] = ipt[''input_ids''].cuda()

          ipt[''attention_mask''] = ipt[''attention_mask''].cuda()

          opt = mt5.generate(**ipt, max_new_tokens=128, num_beams=1)

          mt5_tokenizer.batch_decode(opt)

          ```

          output:

          ```

          [''<pad> <extra_id_0> <extra_id_1>  <extra_id_2>,............  <extra_id_3>.............  <extra_id_4>.........  <extra_id_5>.......  <extra_id_6>......  <extra_id_7>.......  <extra_id_8>.'']

          ```


          case2:

          ```python

          ipt = tokenizer(["translate English to Chinese: That is good."], return_tensors=''pt'')

          ipt[''input_ids''] = ipt[''input_ids''].cuda()

          ipt[''attention_mask''] = ipt[''attention_mask''].cuda()

          opt = mt5.generate(**ipt, max_new_tokens=128, num_beams=1)

          mt5_tokenizer.batch_decode(opt)

          ```

          output:

          ```

          [''<pad> <extra_id_0></s>'']

          ```'
        updatedAt: '2023-12-14T15:29:48.158Z'
      numEdits: 0
      reactions: []
    id: 657b1f6c69a46ce96bd2c607
    type: comment
  author: ZeroneBo
  content: '@Kaedin Hi, I encountered the same problem. I''m curious how you solved
    it.

    In my case, I downloaded mt5-base, and didn''t finetune it, it returns the following
    answer (all of them are extra_id):


    case1:

    ```python

    ipt = tokenizer(["translate English to German: That is good."], return_tensors=''pt'')

    ipt[''input_ids''] = ipt[''input_ids''].cuda()

    ipt[''attention_mask''] = ipt[''attention_mask''].cuda()

    opt = mt5.generate(**ipt, max_new_tokens=128, num_beams=1)

    mt5_tokenizer.batch_decode(opt)

    ```

    output:

    ```

    [''<pad> <extra_id_0> <extra_id_1>  <extra_id_2>,............  <extra_id_3>.............  <extra_id_4>.........  <extra_id_5>.......  <extra_id_6>......  <extra_id_7>.......  <extra_id_8>.'']

    ```


    case2:

    ```python

    ipt = tokenizer(["translate English to Chinese: That is good."], return_tensors=''pt'')

    ipt[''input_ids''] = ipt[''input_ids''].cuda()

    ipt[''attention_mask''] = ipt[''attention_mask''].cuda()

    opt = mt5.generate(**ipt, max_new_tokens=128, num_beams=1)

    mt5_tokenizer.batch_decode(opt)

    ```

    output:

    ```

    [''<pad> <extra_id_0></s>'']

    ```'
  created_at: 2023-12-14 15:29:48+00:00
  edited: false
  hidden: false
  id: 657b1f6c69a46ce96bd2c607
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2023-12-19T07:04:26.000Z'
    data:
      edited: false
      editors:
      - ArthurZ
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9541646242141724
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
          fullname: Arthur Zucker
          isHf: true
          isPro: false
          name: ArthurZ
          type: user
        html: '<p>The base model is not gonna be good at generation! As the model
          card says: </p>

          <blockquote>

          <p>Note: mT5 was only pre-trained on mC4 excluding any supervised training.
          Therefore, this model has to be fine-tuned before it is useable on a downstream
          task.</p>

          </blockquote>

          '
        raw: "The base model is not gonna be good at generation! As the model card\
          \ says: \n> Note: mT5 was only pre-trained on mC4 excluding any supervised\
          \ training. Therefore, this model has to be fine-tuned before it is useable\
          \ on a downstream task.\n"
        updatedAt: '2023-12-19T07:04:26.959Z'
      numEdits: 0
      reactions: []
    id: 6581407af31091100fc1c86e
    type: comment
  author: ArthurZ
  content: "The base model is not gonna be good at generation! As the model card says:\
    \ \n> Note: mT5 was only pre-trained on mC4 excluding any supervised training.\
    \ Therefore, this model has to be fine-tuned before it is useable on a downstream\
    \ task.\n"
  created_at: 2023-12-19 07:04:26+00:00
  edited: false
  hidden: false
  id: 6581407af31091100fc1c86e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
      fullname: ZeroneBo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZeroneBo
      type: user
    createdAt: '2023-12-19T12:01:51.000Z'
    data:
      edited: false
      editors:
      - ZeroneBo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9519297480583191
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
          fullname: ZeroneBo
          isHf: false
          isPro: false
          name: ZeroneBo
          type: user
        html: "<p>My problem have solved, and thank you <span data-props=\"{&quot;user&quot;:&quot;ArthurZ&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/ArthurZ\"\
          >@<span class=\"underline\">ArthurZ</span></a></span>\n\n\t</span></span>\
          \  :)</p>\n"
        raw: My problem have solved, and thank you @ArthurZ  :)
        updatedAt: '2023-12-19T12:01:51.218Z'
      numEdits: 0
      reactions: []
    id: 6581862fca21d74c21473d8a
    type: comment
  author: ZeroneBo
  content: My problem have solved, and thank you @ArthurZ  :)
  created_at: 2023-12-19 12:01:51+00:00
  edited: false
  hidden: false
  id: 6581862fca21d74c21473d8a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2023-12-19T13:30:42.000Z'
    data:
      edited: false
      editors:
      - ArthurZ
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9874529838562012
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
          fullname: Arthur Zucker
          isHf: true
          isPro: false
          name: ArthurZ
          type: user
        html: "<p>Could you share how you solved it? \U0001F917</p>\n"
        raw: "Could you share how you solved it? \U0001F917"
        updatedAt: '2023-12-19T13:30:42.351Z'
      numEdits: 0
      reactions: []
    id: 65819b02faea80032f25d519
    type: comment
  author: ArthurZ
  content: "Could you share how you solved it? \U0001F917"
  created_at: 2023-12-19 13:30:42+00:00
  edited: false
  hidden: false
  id: 65819b02faea80032f25d519
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
      fullname: ZeroneBo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ZeroneBo
      type: user
    createdAt: '2023-12-19T13:52:20.000Z'
    data:
      edited: true
      editors:
      - ZeroneBo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9344678521156311
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e1f13940319dc25d3face90a5e6a2b99.svg
          fullname: ZeroneBo
          isHf: false
          isPro: false
          name: ZeroneBo
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;ArthurZ&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/ArthurZ\">@<span class=\"\
          underline\">ArthurZ</span></a></span>\n\n\t</span></span>  Actually, I realized\
          \ that mt5 is different from t5. t5 can be used out of the box, while the\
          \ pre-trained mt5 can only predict sentinel tokens which is &lt;extra_id_0&gt;\
          \ in my case. In fact it is a normal phenomenon but I mistakenly took it\
          \ as an illegal token. After finetuning, the output can be normal.</p>\n"
        raw: '@ArthurZ  Actually, I realized that mt5 is different from t5. t5 can
          be used out of the box, while the pre-trained mt5 can only predict sentinel
          tokens which is \<extra_id_0\> in my case. In fact it is a normal phenomenon
          but I mistakenly took it as an illegal token. After finetuning, the output
          can be normal.'
        updatedAt: '2023-12-19T13:53:13.099Z'
      numEdits: 1
      reactions: []
    id: 6581a014e4ffdc06980591df
    type: comment
  author: ZeroneBo
  content: '@ArthurZ  Actually, I realized that mt5 is different from t5. t5 can be
    used out of the box, while the pre-trained mt5 can only predict sentinel tokens
    which is \<extra_id_0\> in my case. In fact it is a normal phenomenon but I mistakenly
    took it as an illegal token. After finetuning, the output can be normal.'
  created_at: 2023-12-19 13:52:20+00:00
  edited: true
  hidden: false
  id: 6581a014e4ffdc06980591df
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: google/mt5-base
repo_type: model
status: closed
target_branch: null
title: model returns <extra_id_0> only.
