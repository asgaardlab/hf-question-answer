!!python/object:huggingface_hub.community.DiscussionWithDetails
author: diegoAgher
conflicting_files: null
created_at: 2023-06-02 16:46:28+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/86a109943a94c9847d5c82b3498c1f9d.svg
      fullname: Diego Aguado
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: diegoAgher
      type: user
    createdAt: '2023-06-02T17:46:28.000Z'
    data:
      edited: false
      editors:
      - diegoAgher
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/86a109943a94c9847d5c82b3498c1f9d.svg
          fullname: Diego Aguado
          isHf: false
          isPro: false
          name: diegoAgher
          type: user
        html: '<p>I am using the following code, provided in this space, to try to
          load falcon-40b-instruct on google colab:</p>

          <p>```from transformers import AutoTokenizer, AutoModelForCausalLM<br>import
          transformers<br>import torch</p>

          <p>model = "tiiuae/falcon-40b-instruct"</p>

          <p>tokenizer = AutoTokenizer.from_pretrained(model)<br>pipeline = transformers.pipeline(<br>    "text-generation",<br>    model=model,<br>    tokenizer=tokenizer,<br>    torch_dtype=torch.bfloat16,<br>    trust_remote_code=True,<br>    device_map="auto",<br>)<br>sequences
          = pipeline(<br>   "Girafatron is obsessed with giraffes, the most glorious
          animal on the face of this Earth. Giraftron believes all other animals are
          irrelevant when compared to the glorious majesty of the giraffe.\nDaniel:
          Hello, Girafatron!\nGirafatron:",<br>    max_length=200,<br>    do_sample=True,<br>    top_k=10,<br>    num_return_sequences=1,<br>    eos_token_id=tokenizer.eos_token_id,<br>)<br>for
          seq in sequences:<br>    print(f"Result: {seq[''generated_text'']}")```<br>
          but get the following error:<br>ValueError: Could not load model tiiuae/falcon-40b-instruct
          with any of the following classes: (&lt;class<br>''transformers.models.auto.modeling_auto.AutoModelForCausalLM''&gt;,
          &lt;class<br>''transformers.models.auto.modeling_tf_auto.TFAutoModelForCausalLM''&gt;).</p>

          <p>Previously I was also getting this error:<br>NameError: name ''init_empty_weights''
          is not defined<br>(something must have changed when restarting the kernel)</p>

          <p>On Colab, I have the following versions:<br>torch 2.0.1+cu118<br>transformers
          4.29.2</p>

          '
        raw: "I am using the following code, provided in this space, to try to load\
          \ falcon-40b-instruct on google colab:\r\n\r\n```from transformers import\
          \ AutoTokenizer, AutoModelForCausalLM\r\nimport transformers\r\nimport torch\r\
          \n\r\nmodel = \"tiiuae/falcon-40b-instruct\"\r\n\r\ntokenizer = AutoTokenizer.from_pretrained(model)\r\
          \npipeline = transformers.pipeline(\r\n    \"text-generation\",\r\n    model=model,\r\
          \n    tokenizer=tokenizer,\r\n    torch_dtype=torch.bfloat16,\r\n    trust_remote_code=True,\r\
          \n    device_map=\"auto\",\r\n)\r\nsequences = pipeline(\r\n   \"Girafatron\
          \ is obsessed with giraffes, the most glorious animal on the face of this\
          \ Earth. Giraftron believes all other animals are irrelevant when compared\
          \ to the glorious majesty of the giraffe.\\nDaniel: Hello, Girafatron!\\\
          nGirafatron:\",\r\n    max_length=200,\r\n    do_sample=True,\r\n    top_k=10,\r\
          \n    num_return_sequences=1,\r\n    eos_token_id=tokenizer.eos_token_id,\r\
          \n)\r\nfor seq in sequences:\r\n    print(f\"Result: {seq['generated_text']}\"\
          )```\r\n but get the following error:\r\nValueError: Could not load model\
          \ tiiuae/falcon-40b-instruct with any of the following classes: (<class\
          \ \r\n'transformers.models.auto.modeling_auto.AutoModelForCausalLM'>, <class\
          \ \r\n'transformers.models.auto.modeling_tf_auto.TFAutoModelForCausalLM'>).\r\
          \n\r\nPreviously I was also getting this error:\r\nNameError: name 'init_empty_weights'\
          \ is not defined\r\n(something must have changed when restarting the kernel)\r\
          \n\r\nOn Colab, I have the following versions:\r\ntorch 2.0.1+cu118\r\n\
          transformers 4.29.2"
        updatedAt: '2023-06-02T17:46:28.123Z'
      numEdits: 0
      reactions: []
    id: 647a2af4be933f0eb73e1dab
    type: comment
  author: diegoAgher
  content: "I am using the following code, provided in this space, to try to load\
    \ falcon-40b-instruct on google colab:\r\n\r\n```from transformers import AutoTokenizer,\
    \ AutoModelForCausalLM\r\nimport transformers\r\nimport torch\r\n\r\nmodel = \"\
    tiiuae/falcon-40b-instruct\"\r\n\r\ntokenizer = AutoTokenizer.from_pretrained(model)\r\
    \npipeline = transformers.pipeline(\r\n    \"text-generation\",\r\n    model=model,\r\
    \n    tokenizer=tokenizer,\r\n    torch_dtype=torch.bfloat16,\r\n    trust_remote_code=True,\r\
    \n    device_map=\"auto\",\r\n)\r\nsequences = pipeline(\r\n   \"Girafatron is\
    \ obsessed with giraffes, the most glorious animal on the face of this Earth.\
    \ Giraftron believes all other animals are irrelevant when compared to the glorious\
    \ majesty of the giraffe.\\nDaniel: Hello, Girafatron!\\nGirafatron:\",\r\n  \
    \  max_length=200,\r\n    do_sample=True,\r\n    top_k=10,\r\n    num_return_sequences=1,\r\
    \n    eos_token_id=tokenizer.eos_token_id,\r\n)\r\nfor seq in sequences:\r\n \
    \   print(f\"Result: {seq['generated_text']}\")```\r\n but get the following error:\r\
    \nValueError: Could not load model tiiuae/falcon-40b-instruct with any of the\
    \ following classes: (<class \r\n'transformers.models.auto.modeling_auto.AutoModelForCausalLM'>,\
    \ <class \r\n'transformers.models.auto.modeling_tf_auto.TFAutoModelForCausalLM'>).\r\
    \n\r\nPreviously I was also getting this error:\r\nNameError: name 'init_empty_weights'\
    \ is not defined\r\n(something must have changed when restarting the kernel)\r\
    \n\r\nOn Colab, I have the following versions:\r\ntorch 2.0.1+cu118\r\ntransformers\
    \ 4.29.2"
  created_at: 2023-06-02 16:46:28+00:00
  edited: false
  hidden: false
  id: 647a2af4be933f0eb73e1dab
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/901eeb9809801ab7e4246d036e29109b.svg
      fullname: tradunsky
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: tradunsky
      type: user
    createdAt: '2023-06-02T21:38:06.000Z'
    data:
      edited: false
      editors:
      - tradunsky
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5269324779510498
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/901eeb9809801ab7e4246d036e29109b.svg
          fullname: tradunsky
          isHf: false
          isPro: false
          name: tradunsky
          type: user
        html: '<p>Try to install accelerate, it does contain this function - <code>from
          accelerate import init_empty_weights</code></p>

          <p><code>pip install accelerate</code></p>

          '
        raw: 'Try to install accelerate, it does contain this function - `from accelerate
          import init_empty_weights`


          `pip install accelerate`'
        updatedAt: '2023-06-02T21:38:06.134Z'
      numEdits: 0
      reactions: []
    id: 647a613e822b7e8ccbd859ad
    type: comment
  author: tradunsky
  content: 'Try to install accelerate, it does contain this function - `from accelerate
    import init_empty_weights`


    `pip install accelerate`'
  created_at: 2023-06-02 20:38:06+00:00
  edited: false
  hidden: false
  id: 647a613e822b7e8ccbd859ad
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/86a109943a94c9847d5c82b3498c1f9d.svg
      fullname: Diego Aguado
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: diegoAgher
      type: user
    createdAt: '2023-06-03T00:03:23.000Z'
    data:
      edited: false
      editors:
      - diegoAgher
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7320128679275513
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/86a109943a94c9847d5c82b3498c1f9d.svg
          fullname: Diego Aguado
          isHf: false
          isPro: false
          name: diegoAgher
          type: user
        html: '<p>I did install these :</p>

          <p>!pip install transformers<br>!pip install einops<br>!pip install accelerate</p>

          '
        raw: 'I did install these :


          !pip install transformers

          !pip install einops

          !pip install accelerate'
        updatedAt: '2023-06-03T00:03:23.325Z'
      numEdits: 0
      reactions: []
    id: 647a834b822b7e8ccbdc7a86
    type: comment
  author: diegoAgher
  content: 'I did install these :


    !pip install transformers

    !pip install einops

    !pip install accelerate'
  created_at: 2023-06-02 23:03:23+00:00
  edited: false
  hidden: false
  id: 647a834b822b7e8ccbdc7a86
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/91cce0b4a6b9ffaca5b2bcdd51787b73.svg
      fullname: Bernd Brassel
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: captain-fim
      type: user
    createdAt: '2023-06-04T08:54:57.000Z'
    data:
      edited: false
      editors:
      - captain-fim
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8408863544464111
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/91cce0b4a6b9ffaca5b2bcdd51787b73.svg
          fullname: Bernd Brassel
          isHf: false
          isPro: false
          name: captain-fim
          type: user
        html: '<p><a href="https://huggingface.co/tiiuae/falcon-40b-instruct/discussions/2">This
          discussion</a> on the same community thread here might give the information
          that you need.</p>

          '
        raw: '[This discussion](https://huggingface.co/tiiuae/falcon-40b-instruct/discussions/2)
          on the same community thread here might give the information that you need.'
        updatedAt: '2023-06-04T08:54:57.177Z'
      numEdits: 0
      reactions: []
    id: 647c516183c62f324912c3f5
    type: comment
  author: captain-fim
  content: '[This discussion](https://huggingface.co/tiiuae/falcon-40b-instruct/discussions/2)
    on the same community thread here might give the information that you need.'
  created_at: 2023-06-04 07:54:57+00:00
  edited: false
  hidden: false
  id: 647c516183c62f324912c3f5
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 22
repo_id: tiiuae/falcon-40b-instruct
repo_type: model
status: open
target_branch: null
title: Error on basic tutorial script provided
