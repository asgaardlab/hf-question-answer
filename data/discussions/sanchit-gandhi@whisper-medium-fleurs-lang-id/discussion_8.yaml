!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Anujgr8
conflicting_files: null
created_at: 2024-01-12 15:31:27+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/kEPkiwjXQ540r5_FQsi48.png?w=200&h=200&f=face
      fullname: Anuj Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Anujgr8
      type: user
    createdAt: '2024-01-12T15:31:27.000Z'
    data:
      edited: false
      editors:
      - Anujgr8
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5264925956726074
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/kEPkiwjXQ540r5_FQsi48.png?w=200&h=200&f=face
          fullname: Anuj Mishra
          isHf: false
          isPro: false
          name: Anujgr8
          type: user
        html: '<p>Can you please help me to fix the following error i am trying to
          run this on the data i have<br>refer the code</p>

          <hr>

          <p>df_train = df[:400]<br>df_test = df[400:]<br>df_train[''Audio_id''] =
          df_train[''Audio_id''].map(lambda x: prefix_path + x)<br>df_test[''Audio_id'']
          = df_test[''Audio_id''].map(lambda x: prefix_path + x)<br>Data = DatasetDict()<br>Data[''train'']
          = Dataset.from_dict({''audio'' : df_train[''Audio_id''], ''transcripts'':df_train[''input_text'']}).cast_column("audio",
          Audio())<br>Data[''test''] = Dataset.from_dict({''audio'' : df_test[''Audio_id''],
          ''transcripts'':df_test[''input_text'']}).cast_column("audio", Audio())</p>

          <hr>

          <p>These are the training arguments</p>

          <hr>

          <p>from transformers import Seq2SeqTrainingArguments</p>

          <p>training_args = Seq2SeqTrainingArguments(<br>    output_dir="./whisper-small-hi",  #
          change to a repo name of your choice<br>    per_device_train_batch_size=8,<br>    gradient_accumulation_steps=1,  #
          increase by 2x for every 2x decrease in batch size<br>    learning_rate=1e-5,<br>    warmup_steps=25,<br>    num_train_epochs=5,<br>    max_steps=50,<br>    gradient_checkpointing=True,<br>    evaluation_strategy="steps",<br>    per_device_eval_batch_size=4,<br>    predict_with_generate=True,<br>    generation_max_length=225,<br>    save_steps=400,<br>    eval_steps=400,<br>    logging_steps=5,<br>    report_to=["tensorboard"],<br>    load_best_model_at_end=True,<br>    metric_for_best_model="wer",<br>    greater_is_better=False,<br>)</p>

          <hr>

          <p>Now i am getting this error</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/KIdR-RmiZ-AZ6dDDicEUt.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/KIdR-RmiZ-AZ6dDDicEUt.png"></a></p>

          <p>Please help me</p>

          '
        raw: "Can you please help me to fix the following error i am trying to run\
          \ this on the data i have\r\nrefer the code\r\n---\r\ndf_train = df[:400]\r\
          \ndf_test = df[400:]\r\ndf_train['Audio_id'] = df_train['Audio_id'].map(lambda\
          \ x: prefix_path + x)\r\ndf_test['Audio_id'] = df_test['Audio_id'].map(lambda\
          \ x: prefix_path + x)\r\nData = DatasetDict()\r\nData['train'] = Dataset.from_dict({'audio'\
          \ : df_train['Audio_id'], 'transcripts':df_train['input_text']}).cast_column(\"\
          audio\", Audio())\r\nData['test'] = Dataset.from_dict({'audio' : df_test['Audio_id'],\
          \ 'transcripts':df_test['input_text']}).cast_column(\"audio\", Audio())\r\
          \n---\r\nThese are the training arguments\r\n\r\n----\r\nfrom transformers\
          \ import Seq2SeqTrainingArguments\r\n\r\ntraining_args = Seq2SeqTrainingArguments(\r\
          \n    output_dir=\"./whisper-small-hi\",  # change to a repo name of your\
          \ choice\r\n    per_device_train_batch_size=8,\r\n    gradient_accumulation_steps=1,\
          \  # increase by 2x for every 2x decrease in batch size\r\n    learning_rate=1e-5,\r\
          \n    warmup_steps=25,\r\n    num_train_epochs=5,\r\n    max_steps=50,\r\
          \n    gradient_checkpointing=True,\r\n    evaluation_strategy=\"steps\"\
          ,\r\n    per_device_eval_batch_size=4,\r\n    predict_with_generate=True,\r\
          \n    generation_max_length=225,\r\n    save_steps=400,\r\n    eval_steps=400,\r\
          \n    logging_steps=5,\r\n    report_to=[\"tensorboard\"],\r\n    load_best_model_at_end=True,\r\
          \n    metric_for_best_model=\"wer\",\r\n    greater_is_better=False,\r\n\
          )\r\n---\r\nNow i am getting this error\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/KIdR-RmiZ-AZ6dDDicEUt.png)\r\
          \n\r\nPlease help me"
        updatedAt: '2024-01-12T15:31:27.022Z'
      numEdits: 0
      reactions: []
    id: 65a15b4f0251d2c6bfd91282
    type: comment
  author: Anujgr8
  content: "Can you please help me to fix the following error i am trying to run this\
    \ on the data i have\r\nrefer the code\r\n---\r\ndf_train = df[:400]\r\ndf_test\
    \ = df[400:]\r\ndf_train['Audio_id'] = df_train['Audio_id'].map(lambda x: prefix_path\
    \ + x)\r\ndf_test['Audio_id'] = df_test['Audio_id'].map(lambda x: prefix_path\
    \ + x)\r\nData = DatasetDict()\r\nData['train'] = Dataset.from_dict({'audio' :\
    \ df_train['Audio_id'], 'transcripts':df_train['input_text']}).cast_column(\"\
    audio\", Audio())\r\nData['test'] = Dataset.from_dict({'audio' : df_test['Audio_id'],\
    \ 'transcripts':df_test['input_text']}).cast_column(\"audio\", Audio())\r\n---\r\
    \nThese are the training arguments\r\n\r\n----\r\nfrom transformers import Seq2SeqTrainingArguments\r\
    \n\r\ntraining_args = Seq2SeqTrainingArguments(\r\n    output_dir=\"./whisper-small-hi\"\
    ,  # change to a repo name of your choice\r\n    per_device_train_batch_size=8,\r\
    \n    gradient_accumulation_steps=1,  # increase by 2x for every 2x decrease in\
    \ batch size\r\n    learning_rate=1e-5,\r\n    warmup_steps=25,\r\n    num_train_epochs=5,\r\
    \n    max_steps=50,\r\n    gradient_checkpointing=True,\r\n    evaluation_strategy=\"\
    steps\",\r\n    per_device_eval_batch_size=4,\r\n    predict_with_generate=True,\r\
    \n    generation_max_length=225,\r\n    save_steps=400,\r\n    eval_steps=400,\r\
    \n    logging_steps=5,\r\n    report_to=[\"tensorboard\"],\r\n    load_best_model_at_end=True,\r\
    \n    metric_for_best_model=\"wer\",\r\n    greater_is_better=False,\r\n)\r\n\
    ---\r\nNow i am getting this error\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/64ccb6a3a257a3212c2368e5/KIdR-RmiZ-AZ6dDDicEUt.png)\r\
    \n\r\nPlease help me"
  created_at: 2024-01-12 15:31:27+00:00
  edited: false
  hidden: false
  id: 65a15b4f0251d2c6bfd91282
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 8
repo_id: sanchit-gandhi/whisper-medium-fleurs-lang-id
repo_type: model
status: open
target_branch: null
title: Getting error in finetuning the whisper model
