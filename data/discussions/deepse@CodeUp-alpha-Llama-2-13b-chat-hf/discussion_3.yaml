!!python/object:huggingface_hub.community.DiscussionWithDetails
author: qgai
conflicting_files: null
created_at: 2023-08-19 13:36:49+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/6DssRFeidT3qYjIdPiAfv.jpeg?w=200&h=200&f=face
      fullname: qq
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: qgai
      type: user
    createdAt: '2023-08-19T14:36:49.000Z'
    data:
      edited: false
      editors:
      - qgai
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6136891841888428
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/6DssRFeidT3qYjIdPiAfv.jpeg?w=200&h=200&f=face
          fullname: qq
          isHf: false
          isPro: false
          name: qgai
          type: user
        html: '<p>Loading checkpoint shards:   0%|                                                                                                |
          0/3 [00:00&lt;?, ?it/s]<br>Traceback (most recent call last):<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py",
          line 442, in load_state_dict<br>    return torch.load(checkpoint_file, map_location="cpu")<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py",
          line 797, in load<br>    with _open_zipfile_reader(opened_file) as opened_zipfile:<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py",
          line 283, in <strong>init</strong><br>    super().<strong>init</strong>(torch._C.PyTorchFileReader(name_or_buffer))<br>RuntimeError:
          PytorchStreamReader failed reading zip archive: failed finding central directory</p>

          <p>During handling of the above exception, another exception occurred:</p>

          <p>Traceback (most recent call last):<br>  File "/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py",
          line 446, in load_state_dict<br>    if f.read(7) == "version":<br>  File
          "/usr/lib/python3.8/codecs.py", line 322, in decode<br>    (result, consumed)
          = self._buffer_decode(data, self.errors, final)<br>UnicodeDecodeError: ''utf-8''
          codec can''t decode byte 0x80 in position 128: invalid start byte</p>

          <p>During handling of the above exception, another exception occurred:</p>

          <p>Traceback (most recent call last):<br>  File "build.py", line 376, in
          <br>    build(0, args)<br>  File "build.py", line 342, in build<br>    engine
          = build_or_refit_rank_engine(builder, builder_config,<br>  File "build.py",
          line 239, in build_or_refit_rank_engine<br>    hf_llama = LlamaForCausalLM.from_pretrained(<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py",
          line 2795, in from_pretrained<br>    ) = cls._load_pretrained_model(<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py",
          line 3109, in _load_pretrained_model<br>    state_dict = load_state_dict(shard_file)<br>  File
          "/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py",
          line 458, in load_state_dict<br>    raise OSError(<br>OSError: Unable to
          load weights from pytorch checkpoint file for ''/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin''
          at ''/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin''.
          If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set
          from_tf=True.</p>

          '
        raw: "Loading checkpoint shards:   0%|                                   \
          \                                                             | 0/3 [00:00<?,\
          \ ?it/s]\r\nTraceback (most recent call last):\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 442, in load_state_dict\r\n    return torch.load(checkpoint_file,\
          \ map_location=\"cpu\")\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py\"\
          , line 797, in load\r\n    with _open_zipfile_reader(opened_file) as opened_zipfile:\r\
          \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py\"\
          , line 283, in __init__\r\n    super().__init__(torch._C.PyTorchFileReader(name_or_buffer))\r\
          \nRuntimeError: PytorchStreamReader failed reading zip archive: failed finding\
          \ central directory\r\n\r\nDuring handling of the above exception, another\
          \ exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File\
          \ \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 446, in load_state_dict\r\n    if f.read(7) == \"version\":\r\n \
          \ File \"/usr/lib/python3.8/codecs.py\", line 322, in decode\r\n    (result,\
          \ consumed) = self._buffer_decode(data, self.errors, final)\r\nUnicodeDecodeError:\
          \ 'utf-8' codec can't decode byte 0x80 in position 128: invalid start byte\r\
          \n\r\nDuring handling of the above exception, another exception occurred:\r\
          \n\r\nTraceback (most recent call last):\r\n  File \"build.py\", line 376,\
          \ in <module>\r\n    build(0, args)\r\n  File \"build.py\", line 342, in\
          \ build\r\n    engine = build_or_refit_rank_engine(builder, builder_config,\r\
          \n  File \"build.py\", line 239, in build_or_refit_rank_engine\r\n    hf_llama\
          \ = LlamaForCausalLM.from_pretrained(\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 2795, in from_pretrained\r\n    ) = cls._load_pretrained_model(\r\
          \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 3109, in _load_pretrained_model\r\n    state_dict = load_state_dict(shard_file)\r\
          \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
          , line 458, in load_state_dict\r\n    raise OSError(\r\nOSError: Unable\
          \ to load weights from pytorch checkpoint file for '/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin'\
          \ at '/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin'.\
          \ If you tried to load a PyTorch model from a TF 2.0 checkpoint, please\
          \ set from_tf=True."
        updatedAt: '2023-08-19T14:36:49.757Z'
      numEdits: 0
      reactions: []
    id: 64e0d381b5cc372803c9947e
    type: comment
  author: qgai
  content: "Loading checkpoint shards:   0%|                                     \
    \                                                           | 0/3 [00:00<?, ?it/s]\r\
    \nTraceback (most recent call last):\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 442, in load_state_dict\r\n    return torch.load(checkpoint_file, map_location=\"\
    cpu\")\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py\"\
    , line 797, in load\r\n    with _open_zipfile_reader(opened_file) as opened_zipfile:\r\
    \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/torch/serialization.py\"\
    , line 283, in __init__\r\n    super().__init__(torch._C.PyTorchFileReader(name_or_buffer))\r\
    \nRuntimeError: PytorchStreamReader failed reading zip archive: failed finding\
    \ central directory\r\n\r\nDuring handling of the above exception, another exception\
    \ occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 446, in load_state_dict\r\n    if f.read(7) == \"version\":\r\n  File \"\
    /usr/lib/python3.8/codecs.py\", line 322, in decode\r\n    (result, consumed)\
    \ = self._buffer_decode(data, self.errors, final)\r\nUnicodeDecodeError: 'utf-8'\
    \ codec can't decode byte 0x80 in position 128: invalid start byte\r\n\r\nDuring\
    \ handling of the above exception, another exception occurred:\r\n\r\nTraceback\
    \ (most recent call last):\r\n  File \"build.py\", line 376, in <module>\r\n \
    \   build(0, args)\r\n  File \"build.py\", line 342, in build\r\n    engine =\
    \ build_or_refit_rank_engine(builder, builder_config,\r\n  File \"build.py\",\
    \ line 239, in build_or_refit_rank_engine\r\n    hf_llama = LlamaForCausalLM.from_pretrained(\r\
    \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 2795, in from_pretrained\r\n    ) = cls._load_pretrained_model(\r\n  File\
    \ \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 3109, in _load_pretrained_model\r\n    state_dict = load_state_dict(shard_file)\r\
    \n  File \"/home/nvcntse/.local/lib/python3.8/site-packages/transformers/modeling_utils.py\"\
    , line 458, in load_state_dict\r\n    raise OSError(\r\nOSError: Unable to load\
    \ weights from pytorch checkpoint file for '/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin'\
    \ at '/home/nvcntse/qgai/p4_home_qgai/llama/CodeUp-alpha-Llama-2-13b-chat-hf/pytorch_model-00001-of-00003.bin'.\
    \ If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set from_tf=True."
  created_at: 2023-08-19 13:36:49+00:00
  edited: false
  hidden: false
  id: 64e0d381b5cc372803c9947e
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: deepse/CodeUp-alpha-Llama-2-13b-chat-hf
repo_type: model
status: open
target_branch: null
title: load failed
