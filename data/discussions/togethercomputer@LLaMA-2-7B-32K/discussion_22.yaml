!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ajash
conflicting_files: null
created_at: 2023-08-28 03:47:48+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-28T04:47:48.000Z'
    data:
      edited: false
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6971797347068787
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: '<p>I am very new to pytorch so this maybe a dumb question...<br>I am
          trying to finetune the 32k context model with LoRA on a single A100 gpu.
          Model has been configured to bf16:<br>model = AutoModelForCausalLM.from_pretrained(MODEL_ID,
          device_map=''auto'', trust_remote_code=True, torch_dtype=torch.bfloat16)</p>

          <p>I have configured my tokenizer to return 8192 tokens.<br>return TOKENIZER(<br>      text_to_tok,<br>      truncation=True,<br>      max_length=4096*2,
          # Long context<br>      padding="max_length",<br>)<br>Optimizer: optimizer
          = torch.optim.AdamW(params=model.parameters(), lr=2e-6)<br>My batch size
          is set to 2. After 1 step of gradient decent I get this error: shape ''[2,
          8192, 4096]'' is invalid for input of size 51109888<br>I have separately
          run a loop through my data to check if input shape is unequal to 8192, but
          that passes.</p>

          '
        raw: "I am very new to pytorch so this maybe a dumb question...\r\nI am trying\
          \ to finetune the 32k context model with LoRA on a single A100 gpu. Model\
          \ has been configured to bf16:\r\nmodel = AutoModelForCausalLM.from_pretrained(MODEL_ID,\
          \ device_map='auto', trust_remote_code=True, torch_dtype=torch.bfloat16)\r\
          \n\r\nI have configured my tokenizer to return 8192 tokens.\r\nreturn TOKENIZER(\r\
          \n      text_to_tok,\r\n      truncation=True,\r\n      max_length=4096*2,\
          \ # Long context\r\n      padding=\"max_length\",\r\n)\r\nOptimizer: optimizer\
          \ = torch.optim.AdamW(params=model.parameters(), lr=2e-6)\r\nMy batch size\
          \ is set to 2. After 1 step of gradient decent I get this error: shape '[2,\
          \ 8192, 4096]' is invalid for input of size 51109888\r\nI have separately\
          \ run a loop through my data to check if input shape is unequal to 8192,\
          \ but that passes."
        updatedAt: '2023-08-28T04:47:48.510Z'
      numEdits: 0
      reactions: []
    id: 64ec26f4345cf9d8c4df5db5
    type: comment
  author: ajash
  content: "I am very new to pytorch so this maybe a dumb question...\r\nI am trying\
    \ to finetune the 32k context model with LoRA on a single A100 gpu. Model has\
    \ been configured to bf16:\r\nmodel = AutoModelForCausalLM.from_pretrained(MODEL_ID,\
    \ device_map='auto', trust_remote_code=True, torch_dtype=torch.bfloat16)\r\n\r\
    \nI have configured my tokenizer to return 8192 tokens.\r\nreturn TOKENIZER(\r\
    \n      text_to_tok,\r\n      truncation=True,\r\n      max_length=4096*2, # Long\
    \ context\r\n      padding=\"max_length\",\r\n)\r\nOptimizer: optimizer = torch.optim.AdamW(params=model.parameters(),\
    \ lr=2e-6)\r\nMy batch size is set to 2. After 1 step of gradient decent I get\
    \ this error: shape '[2, 8192, 4096]' is invalid for input of size 51109888\r\n\
    I have separately run a loop through my data to check if input shape is unequal\
    \ to 8192, but that passes."
  created_at: 2023-08-28 03:47:48+00:00
  edited: false
  hidden: false
  id: 64ec26f4345cf9d8c4df5db5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4f2e3e239bb19c1597463f2d5010fb7d.svg
      fullname: Yanan Xie
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: orby-yanan
      type: user
    createdAt: '2023-08-28T21:25:47.000Z'
    data:
      edited: false
      editors:
      - orby-yanan
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.47956565022468567
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4f2e3e239bb19c1597463f2d5010fb7d.svg
          fullname: Yanan Xie
          isHf: false
          isPro: false
          name: orby-yanan
          type: user
        html: '<p>check refs/pr/17</p>

          '
        raw: check refs/pr/17
        updatedAt: '2023-08-28T21:25:47.103Z'
      numEdits: 0
      reactions: []
    id: 64ed10db76a07046864aa788
    type: comment
  author: orby-yanan
  content: check refs/pr/17
  created_at: 2023-08-28 20:25:47+00:00
  edited: false
  hidden: false
  id: 64ed10db76a07046864aa788
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-29T00:22:52.000Z'
    data:
      edited: false
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9714916348457336
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: '<p>I am not sure I know how to do that. I am super new to huggingface.
          Can you give me a link.</p>

          '
        raw: I am not sure I know how to do that. I am super new to huggingface. Can
          you give me a link.
        updatedAt: '2023-08-29T00:22:52.361Z'
      numEdits: 0
      reactions: []
    id: 64ed3a5c5554408940125dac
    type: comment
  author: ajash
  content: I am not sure I know how to do that. I am super new to huggingface. Can
    you give me a link.
  created_at: 2023-08-28 23:22:52+00:00
  edited: false
  hidden: false
  id: 64ed3a5c5554408940125dac
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-29T03:09:49.000Z'
    data:
      edited: true
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.995110809803009
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: '<p>that was a dumb request.... sorry about that.<br>When can I expect
          the branch to get merged?</p>

          '
        raw: 'that was a dumb request.... sorry about that.

          When can I expect the branch to get merged?'
        updatedAt: '2023-08-29T03:10:07.207Z'
      numEdits: 1
      reactions: []
    id: 64ed617da7f7ab0efe1fff68
    type: comment
  author: ajash
  content: 'that was a dumb request.... sorry about that.

    When can I expect the branch to get merged?'
  created_at: 2023-08-29 02:09:49+00:00
  edited: true
  hidden: false
  id: 64ed617da7f7ab0efe1fff68
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-29T23:53:37.000Z'
    data:
      edited: false
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9003926515579224
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: '<p>noob question...<br>how do i use refs/pr/17 while I wait for the
          branch to get merged?</p>

          '
        raw: 'noob question...

          how do i use refs/pr/17 while I wait for the branch to get merged?'
        updatedAt: '2023-08-29T23:53:37.419Z'
      numEdits: 0
      reactions: []
    id: 64ee85012b333a702c6a2e89
    type: comment
  author: ajash
  content: 'noob question...

    how do i use refs/pr/17 while I wait for the branch to get merged?'
  created_at: 2023-08-29 22:53:37+00:00
  edited: false
  hidden: false
  id: 64ee85012b333a702c6a2e89
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4f2e3e239bb19c1597463f2d5010fb7d.svg
      fullname: Yanan Xie
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: orby-yanan
      type: user
    createdAt: '2023-08-30T00:11:04.000Z'
    data:
      edited: false
      editors:
      - orby-yanan
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.34631288051605225
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4f2e3e239bb19c1597463f2d5010fb7d.svg
          fullname: Yanan Xie
          isHf: false
          isPro: false
          name: orby-yanan
          type: user
        html: '<p>from_pretrained("togethercomputer/LLaMA-2-7B-32K", revision="refs/pr/17")</p>

          '
        raw: from_pretrained("togethercomputer/LLaMA-2-7B-32K", revision="refs/pr/17")
        updatedAt: '2023-08-30T00:11:04.064Z'
      numEdits: 0
      reactions: []
    id: 64ee89186851345dc0d39d26
    type: comment
  author: orby-yanan
  content: from_pretrained("togethercomputer/LLaMA-2-7B-32K", revision="refs/pr/17")
  created_at: 2023-08-29 23:11:04+00:00
  edited: false
  hidden: false
  id: 64ee89186851345dc0d39d26
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-30T00:29:53.000Z'
    data:
      edited: false
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9724780321121216
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: '<p>thank you so much</p>

          '
        raw: thank you so much
        updatedAt: '2023-08-30T00:29:53.874Z'
      numEdits: 0
      reactions: []
    id: 64ee8d81a88024d55f50cec0
    type: comment
  author: ajash
  content: thank you so much
  created_at: 2023-08-29 23:29:53+00:00
  edited: false
  hidden: false
  id: 64ee8d81a88024d55f50cec0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-30T01:22:56.000Z'
    data:
      edited: false
      editors:
      - ajash
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9126148223876953
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
          fullname: Ambarish Jash
          isHf: false
          isPro: false
          name: ajash
          type: user
        html: "<p>thanks <span data-props=\"{&quot;user&quot;:&quot;orby-yanan&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/orby-yanan\"\
          >@<span class=\"underline\">orby-yanan</span></a></span>\n\n\t</span></span>\
          \ ... refs/pr/17 solved my issue.</p>\n"
        raw: thanks @orby-yanan ... refs/pr/17 solved my issue.
        updatedAt: '2023-08-30T01:22:56.530Z'
      numEdits: 0
      reactions: []
      relatedEventId: 64ee99f0fa2867a18a44d8d1
    id: 64ee99f0fa2867a18a44d8ce
    type: comment
  author: ajash
  content: thanks @orby-yanan ... refs/pr/17 solved my issue.
  created_at: 2023-08-30 00:22:56+00:00
  edited: false
  hidden: false
  id: 64ee99f0fa2867a18a44d8ce
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/70fd92770ae9008fcb03a15739ed44f4.svg
      fullname: Ambarish Jash
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ajash
      type: user
    createdAt: '2023-08-30T01:22:56.000Z'
    data:
      status: closed
    id: 64ee99f0fa2867a18a44d8d1
    type: status-change
  author: ajash
  created_at: 2023-08-30 00:22:56+00:00
  id: 64ee99f0fa2867a18a44d8d1
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 22
repo_id: togethercomputer/LLaMA-2-7B-32K
repo_type: model
status: closed
target_branch: null
title: Fine tune togethercomputer/LLaMA-2-7B-32K with LoRA
