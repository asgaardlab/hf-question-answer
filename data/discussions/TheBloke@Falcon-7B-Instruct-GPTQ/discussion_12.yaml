!!python/object:huggingface_hub.community.DiscussionWithDetails
author: mpronesti
conflicting_files: null
created_at: 2023-07-03 08:35:29+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/03f11933874161bd1d9fcb05e8b22e7f.svg
      fullname: Massimiliano Pronesti
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mpronesti
      type: user
    createdAt: '2023-07-03T09:35:29.000Z'
    data:
      edited: true
      editors:
      - mpronesti
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.527707576751709
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/03f11933874161bd1d9fcb05e8b22e7f.svg
          fullname: Massimiliano Pronesti
          isHf: false
          isPro: false
          name: mpronesti
          type: user
        html: "<p>Hi there!<br>I'm trying to use this model with text-generation-inference.\
          \ Here's the script</p>\n<pre><code class=\"language-shell\">volume=$PWD/data\
          \ # share a volume with the Docker container to avoid downloading weights\
          \ every run\n\ndocker run --gpus all --shm-size 2g -p 8080:80 -v $volume:/data\
          \ \\\nghcr.io/huggingface/text-generation-inference:latest \\\n--model-id\
          \ TheBloke/falcon-7b-instruct-gptq \\\n--sharded false \\\n--quantize \"\
          gptq\" \\\n--max-total-tokens 2048 \\\n--trust-remote-code \n</code></pre>\n\
          <p>However, I get this error</p>\n<pre><code class=\"language-py\">RuntimeError:\
          \ weight transformer.h<span class=\"hljs-number\">.0</span>.self_attention.query_key_value.weight\
          \ does <span class=\"hljs-keyword\">not</span> exist\n</code></pre>\n"
        raw: "Hi there!\nI'm trying to use this model with text-generation-inference.\
          \ Here's the script\n\n```shell\nvolume=$PWD/data # share a volume with\
          \ the Docker container to avoid downloading weights every run\n\ndocker\
          \ run --gpus all --shm-size 2g -p 8080:80 -v $volume:/data \\\nghcr.io/huggingface/text-generation-inference:latest\
          \ \\\n--model-id TheBloke/falcon-7b-instruct-gptq \\\n--sharded false \\\
          \n--quantize \"gptq\" \\\n--max-total-tokens 2048 \\\n--trust-remote-code\
          \ \n```\n\nHowever, I get this error\n\n```py\nRuntimeError: weight transformer.h.0.self_attention.query_key_value.weight\
          \ does not exist\n```"
        updatedAt: '2023-07-03T09:36:16.443Z'
      numEdits: 1
      reactions: []
    id: 64a29661da855010c6a01bd4
    type: comment
  author: mpronesti
  content: "Hi there!\nI'm trying to use this model with text-generation-inference.\
    \ Here's the script\n\n```shell\nvolume=$PWD/data # share a volume with the Docker\
    \ container to avoid downloading weights every run\n\ndocker run --gpus all --shm-size\
    \ 2g -p 8080:80 -v $volume:/data \\\nghcr.io/huggingface/text-generation-inference:latest\
    \ \\\n--model-id TheBloke/falcon-7b-instruct-gptq \\\n--sharded false \\\n--quantize\
    \ \"gptq\" \\\n--max-total-tokens 2048 \\\n--trust-remote-code \n```\n\nHowever,\
    \ I get this error\n\n```py\nRuntimeError: weight transformer.h.0.self_attention.query_key_value.weight\
    \ does not exist\n```"
  created_at: 2023-07-03 08:35:29+00:00
  edited: true
  hidden: false
  id: 64a29661da855010c6a01bd4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-07-08T09:34:19.000Z'
    data:
      edited: false
      editors:
      - TheBloke
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9777905941009521
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
          fullname: Tom Jobbins
          isHf: false
          isPro: true
          name: TheBloke
          type: user
        html: '<p>Unfortunately Text Generation Inference have included a version
          of GPTQ that doesn''t support most of the GPTQs currently on Hugging Face.</p>

          <p>I hope to be able to release new GPTQs in future that will be compatible,
          but for now you''ll need to see if there''s another GPTQ that works with
          TGI, or make your own.</p>

          '
        raw: 'Unfortunately Text Generation Inference have included a version of GPTQ
          that doesn''t support most of the GPTQs currently on Hugging Face.


          I hope to be able to release new GPTQs in future that will be compatible,
          but for now you''ll need to see if there''s another GPTQ that works with
          TGI, or make your own.'
        updatedAt: '2023-07-08T09:34:19.423Z'
      numEdits: 0
      reactions: []
    id: 64a92d9be368492ab8d566fe
    type: comment
  author: TheBloke
  content: 'Unfortunately Text Generation Inference have included a version of GPTQ
    that doesn''t support most of the GPTQs currently on Hugging Face.


    I hope to be able to release new GPTQs in future that will be compatible, but
    for now you''ll need to see if there''s another GPTQ that works with TGI, or make
    your own.'
  created_at: 2023-07-08 08:34:19+00:00
  edited: false
  hidden: false
  id: 64a92d9be368492ab8d566fe
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 12
repo_id: TheBloke/Falcon-7B-Instruct-GPTQ
repo_type: model
status: open
target_branch: null
title: 'Can''t use with tgi. Getting `RuntimeError: weight transformer.h.0.self_attention.query_key_value.weight
  does not exist`'
