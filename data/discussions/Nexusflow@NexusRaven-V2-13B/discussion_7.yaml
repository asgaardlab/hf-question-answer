!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ValentinEthon
conflicting_files: null
created_at: 2023-12-13 10:47:18+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/a192475cc5979527c556bc4e88344412.svg
      fullname: Valentin Bieri
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ValentinEthon
      type: user
    createdAt: '2023-12-13T10:47:18.000Z'
    data:
      edited: true
      editors:
      - ValentinEthon
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.49805739521980286
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/a192475cc5979527c556bc4e88344412.svg
          fullname: Valentin Bieri
          isHf: false
          isPro: false
          name: ValentinEthon
          type: user
        html: "<p>Hey there!</p>\n<p>First of all: Congrats on your new model! Your\
          \ results sound amazing, great job!</p>\n<p>Trying to deploy the model on\
          \ AWS (GPU \xB7 Nvidia Tesla T4 \xB7 4x GPU \xB7 64 GB), the following error\
          \ occurs:</p>\n<pre><code>2023/12/12 14:45:51 ~ Error: DownloadError\n2023/12/12\
          \ 14:45:51 ~ {\"timestamp\":\"2023-12-12T13:45:51.232043Z\",\"level\":\"\
          ERROR\",\"fields\":{\"message\":\"Download encountered an error: Traceback\
          \ (most recent call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"\
          /opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
          \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are\
          \ forbidden, '-' and '.' cannot start or end the name, max length is 96:\
          \ '/repository'.\\n\\n\\nDuring handling of the above exception, another\
          \ exception occurred:\\n\\n\\nTraceback (most recent call last):\\n\\n File\
          \ \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
          \", line 16, in download_and_unload_peft\\n model = AutoPeftModelForCausalLM.from_pretrained(\\\
          n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\",\
          \ line 69, in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
          \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find\
          \ 'adapter_config.json' at '/repository'\\n\\n\\nDuring handling of the\
          \ above exception, another exception occurred:\\n\\n\\nTraceback (most recent\
          \ call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"\
          /opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
          \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are\
          \ forbidden, '-' and '.' cannot start or end the name, max length is 96:\
          \ '/repository'.\\n\\n\\nDuring handling of the above exception, another\
          \ exception occurred:\\n\\n\\nTraceback (most recent call last):\\n\\n File\
          \ \\\"/opt/conda/bin/text-generation-server\\\", line 8, in &lt;module&gt;\\\
          n sys.exit(app())\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/cli.py\\\
          \", line 204, in download_weights\\n utils.download_and_unload_peft(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
          \", line 24, in download_and_unload_peft\\n model = AutoPeftModelForSeq2SeqLM.from_pretrained(\\\
          n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\",\
          \ line 69, in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
          \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find\
          \ 'adapter_config.json' at '/repository'\\n\\n\"},\"target\":\"text_generation_launcher\"\
          ,\"span\":{\"name\":\"download\"},\"spans\":[{\"name\":\"download\"}]}\n\
          </code></pre>\n<p>Especially the \"Repo id must use alphanumeric chars or\
          \ '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or\
          \ end the name, max length is 96\" part confuses me. It seems to fail to\
          \ download some PEFT config file.<br>Has anyone else had this issue?</p>\n\
          <p>Thanks in advance</p>\n"
        raw: "Hey there!\n\nFirst of all: Congrats on your new model! Your results\
          \ sound amazing, great job!\n\nTrying to deploy the model on AWS (GPU \xB7\
          \ Nvidia Tesla T4 \xB7 4x GPU \xB7 64 GB), the following error occurs:\n\
          \n```\n2023/12/12 14:45:51 ~ Error: DownloadError\n2023/12/12 14:45:51 ~\
          \ {\"timestamp\":\"2023-12-12T13:45:51.232043Z\",\"level\":\"ERROR\",\"\
          fields\":{\"message\":\"Download encountered an error: Traceback (most recent\
          \ call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"\
          /opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
          \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are\
          \ forbidden, '-' and '.' cannot start or end the name, max length is 96:\
          \ '/repository'.\\n\\n\\nDuring handling of the above exception, another\
          \ exception occurred:\\n\\n\\nTraceback (most recent call last):\\n\\n File\
          \ \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
          \", line 16, in download_and_unload_peft\\n model = AutoPeftModelForCausalLM.from_pretrained(\\\
          n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\",\
          \ line 69, in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
          \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find\
          \ 'adapter_config.json' at '/repository'\\n\\n\\nDuring handling of the\
          \ above exception, another exception occurred:\\n\\n\\nTraceback (most recent\
          \ call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"\
          /opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
          \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
          \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are\
          \ forbidden, '-' and '.' cannot start or end the name, max length is 96:\
          \ '/repository'.\\n\\n\\nDuring handling of the above exception, another\
          \ exception occurred:\\n\\n\\nTraceback (most recent call last):\\n\\n File\
          \ \\\"/opt/conda/bin/text-generation-server\\\", line 8, in <module>\\n\
          \ sys.exit(app())\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/cli.py\\\
          \", line 204, in download_weights\\n utils.download_and_unload_peft(\\n\\\
          n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
          \", line 24, in download_and_unload_peft\\n model = AutoPeftModelForSeq2SeqLM.from_pretrained(\\\
          n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\",\
          \ line 69, in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
          \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
          \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find\
          \ 'adapter_config.json' at '/repository'\\n\\n\"},\"target\":\"text_generation_launcher\"\
          ,\"span\":{\"name\":\"download\"},\"spans\":[{\"name\":\"download\"}]}\n\
          ```\n\nEspecially the \"Repo id must use alphanumeric chars or '-', '_',\
          \ '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the\
          \ name, max length is 96\" part confuses me. It seems to fail to download\
          \ some PEFT config file.\nHas anyone else had this issue?\n\nThanks in advance"
        updatedAt: '2023-12-13T13:39:54.012Z'
      numEdits: 1
      reactions: []
    id: 65798bb6aace0258711e761d
    type: comment
  author: ValentinEthon
  content: "Hey there!\n\nFirst of all: Congrats on your new model! Your results sound\
    \ amazing, great job!\n\nTrying to deploy the model on AWS (GPU \xB7 Nvidia Tesla\
    \ T4 \xB7 4x GPU \xB7 64 GB), the following error occurs:\n\n```\n2023/12/12 14:45:51\
    \ ~ Error: DownloadError\n2023/12/12 14:45:51 ~ {\"timestamp\":\"2023-12-12T13:45:51.232043Z\"\
    ,\"level\":\"ERROR\",\"fields\":{\"message\":\"Download encountered an error:\
    \ Traceback (most recent call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
    \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\n File\
    \ \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
    \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
    \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
    \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden,\
    \ '-' and '.' cannot start or end the name, max length is 96: '/repository'.\\\
    n\\n\\nDuring handling of the above exception, another exception occurred:\\n\\\
    n\\nTraceback (most recent call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
    \", line 16, in download_and_unload_peft\\n model = AutoPeftModelForCausalLM.from_pretrained(\\\
    n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\", line 69,\
    \ in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
    \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
    \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
    \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find 'adapter_config.json'\
    \ at '/repository'\\n\\n\\nDuring handling of the above exception, another exception\
    \ occurred:\\n\\n\\nTraceback (most recent call last):\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
    \", line 117, in from_pretrained\\n config_file = hf_hub_download(\\n\\n File\
    \ \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
    \", line 110, in _inner_fn\\n validate_repo_id(arg_value)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\
    \", line 164, in validate_repo_id\\n raise HFValidationError(\\n\\nhuggingface_hub.utils._validators.HFValidationError:\
    \ Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden,\
    \ '-' and '.' cannot start or end the name, max length is 96: '/repository'.\\\
    n\\n\\nDuring handling of the above exception, another exception occurred:\\n\\\
    n\\nTraceback (most recent call last):\\n\\n File \\\"/opt/conda/bin/text-generation-server\\\
    \", line 8, in <module>\\n sys.exit(app())\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/cli.py\\\
    \", line 204, in download_weights\\n utils.download_and_unload_peft(\\n\\n File\
    \ \\\"/opt/conda/lib/python3.10/site-packages/text_generation_server/utils/peft.py\\\
    \", line 24, in download_and_unload_peft\\n model = AutoPeftModelForSeq2SeqLM.from_pretrained(\\\
    n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/auto.py\\\", line 69,\
    \ in from_pretrained\\n peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path,\
    \ **kwargs)\\n\\n File \\\"/opt/conda/lib/python3.10/site-packages/peft/utils/config.py\\\
    \", line 121, in from_pretrained\\n raise ValueError(f\\\"Can't find '{CONFIG_NAME}'\
    \ at '{pretrained_model_name_or_path}'\\\")\\n\\nValueError: Can't find 'adapter_config.json'\
    \ at '/repository'\\n\\n\"},\"target\":\"text_generation_launcher\",\"span\":{\"\
    name\":\"download\"},\"spans\":[{\"name\":\"download\"}]}\n```\n\nEspecially the\
    \ \"Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden,\
    \ '-' and '.' cannot start or end the name, max length is 96\" part confuses me.\
    \ It seems to fail to download some PEFT config file.\nHas anyone else had this\
    \ issue?\n\nThanks in advance"
  created_at: 2023-12-13 10:47:18+00:00
  edited: true
  hidden: false
  id: 65798bb6aace0258711e761d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d2aa2af71b8dd66f7633776ef8ebc212.svg
      fullname: Venkat Srinivasan
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: venkat-srinivasan-nexusflow
      type: user
    createdAt: '2023-12-13T18:02:31.000Z'
    data:
      edited: false
      editors:
      - venkat-srinivasan-nexusflow
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9603961110115051
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d2aa2af71b8dd66f7633776ef8ebc212.svg
          fullname: Venkat Srinivasan
          isHf: false
          isPro: false
          name: venkat-srinivasan-nexusflow
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;ValentinEthon&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/ValentinEthon\"\
          >@<span class=\"underline\">ValentinEthon</span></a></span>\n\n\t</span></span>!\
          \ </p>\n<p>We took a deeper look here, and it looks like it could be a TGI\
          \ issue. Here is a related comment: <a rel=\"nofollow\" href=\"https://github.com/huggingface/text-generation-inference/issues/1283#issuecomment-1841488787\"\
          >https://github.com/huggingface/text-generation-inference/issues/1283#issuecomment-1841488787</a>.\
          \ </p>\n<p>It appears to be due to a recent commit, perhaps you can try\
          \ downgrading your TGI docker SHA and trying?</p>\n"
        raw: "Hi @ValentinEthon! \n\nWe took a deeper look here, and it looks like\
          \ it could be a TGI issue. Here is a related comment: https://github.com/huggingface/text-generation-inference/issues/1283#issuecomment-1841488787.\
          \ \n\nIt appears to be due to a recent commit, perhaps you can try downgrading\
          \ your TGI docker SHA and trying?\n"
        updatedAt: '2023-12-13T18:02:31.254Z'
      numEdits: 0
      reactions: []
    id: 6579f1b73db8c022afe388b6
    type: comment
  author: venkat-srinivasan-nexusflow
  content: "Hi @ValentinEthon! \n\nWe took a deeper look here, and it looks like it\
    \ could be a TGI issue. Here is a related comment: https://github.com/huggingface/text-generation-inference/issues/1283#issuecomment-1841488787.\
    \ \n\nIt appears to be due to a recent commit, perhaps you can try downgrading\
    \ your TGI docker SHA and trying?\n"
  created_at: 2023-12-13 18:02:31+00:00
  edited: false
  hidden: false
  id: 6579f1b73db8c022afe388b6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d2aa2af71b8dd66f7633776ef8ebc212.svg
      fullname: Venkat Srinivasan
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: venkat-srinivasan-nexusflow
      type: user
    createdAt: '2023-12-13T18:14:27.000Z'
    data:
      edited: false
      editors:
      - venkat-srinivasan-nexusflow
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.968226969242096
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d2aa2af71b8dd66f7633776ef8ebc212.svg
          fullname: Venkat Srinivasan
          isHf: false
          isPro: false
          name: venkat-srinivasan-nexusflow
          type: user
        html: '<p>I tried an earlier SHA (ghcr.io/huggingface/text-generation-inference:sha-96a982a),
          and it seems to work better. Could you see if that solves your issue as
          well?</p>

          '
        raw: I tried an earlier SHA (ghcr.io/huggingface/text-generation-inference:sha-96a982a),
          and it seems to work better. Could you see if that solves your issue as
          well?
        updatedAt: '2023-12-13T18:14:27.708Z'
      numEdits: 0
      reactions: []
    id: 6579f4836cbe92a65d4f131a
    type: comment
  author: venkat-srinivasan-nexusflow
  content: I tried an earlier SHA (ghcr.io/huggingface/text-generation-inference:sha-96a982a),
    and it seems to work better. Could you see if that solves your issue as well?
  created_at: 2023-12-13 18:14:27+00:00
  edited: false
  hidden: false
  id: 6579f4836cbe92a65d4f131a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/a192475cc5979527c556bc4e88344412.svg
      fullname: Valentin Bieri
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ValentinEthon
      type: user
    createdAt: '2023-12-14T08:39:08.000Z'
    data:
      edited: false
      editors:
      - ValentinEthon
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8770663738250732
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/a192475cc5979527c556bc4e88344412.svg
          fullname: Valentin Bieri
          isHf: false
          isPro: false
          name: ValentinEthon
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;venkat-srinivasan-nexusflow&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/venkat-srinivasan-nexusflow\"\
          >@<span class=\"underline\">venkat-srinivasan-nexusflow</span></a></span>\n\
          \n\t</span></span> </p>\n<p>Thanks for the quick response: Apologies, I\
          \ was unclear in my post. I'm trying to quickly test it on AWS via the <em>Hugging\
          \ Face Hosted Inference Endpoints</em>, i.e. the 'deploy' button on this\
          \ page.<br>As far as I can tell, I'm able to specify the revision of NexusRaven,\
          \ but not the one of TGI. </p>\n"
        raw: "Hi @venkat-srinivasan-nexusflow \n\nThanks for the quick response: Apologies,\
          \ I was unclear in my post. I'm trying to quickly test it on AWS via the\
          \ *Hugging Face Hosted Inference Endpoints*, i.e. the 'deploy' button on\
          \ this page. \nAs far as I can tell, I'm able to specify the revision of\
          \ NexusRaven, but not the one of TGI. "
        updatedAt: '2023-12-14T08:39:08.883Z'
      numEdits: 0
      reactions: []
    id: 657abf2c80141bab5de5e1b9
    type: comment
  author: ValentinEthon
  content: "Hi @venkat-srinivasan-nexusflow \n\nThanks for the quick response: Apologies,\
    \ I was unclear in my post. I'm trying to quickly test it on AWS via the *Hugging\
    \ Face Hosted Inference Endpoints*, i.e. the 'deploy' button on this page. \n\
    As far as I can tell, I'm able to specify the revision of NexusRaven, but not\
    \ the one of TGI. "
  created_at: 2023-12-14 08:39:08+00:00
  edited: false
  hidden: false
  id: 657abf2c80141bab5de5e1b9
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 7
repo_id: Nexusflow/NexusRaven-V2-13B
repo_type: model
status: open
target_branch: null
title: Error during HF Inference Endpoint Deployment
