!!python/object:huggingface_hub.community.DiscussionWithDetails
author: loretoparisi
conflicting_files: null
created_at: 2023-10-23 16:31:18+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1642412329881-5e6b7a61d4cd9779932a7601.png?w=200&h=200&f=face
      fullname: Loreto Parisi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: loretoparisi
      type: user
    createdAt: '2023-10-23T17:31:18.000Z'
    data:
      edited: true
      editors:
      - loretoparisi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5658115744590759
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1642412329881-5e6b7a61d4cd9779932a7601.png?w=200&h=200&f=face
          fullname: Loreto Parisi
          isHf: false
          isPro: false
          name: loretoparisi
          type: user
        html: "<p>This error happens with all the following:</p>\n<pre><code class=\"\
          language-Dockerfile\"><span class=\"hljs-keyword\">FROM</span> python:<span\
          \ class=\"hljs-number\">3.9</span>.<span class=\"hljs-number\">7</span>-slim-bullseye\n\
          <span class=\"hljs-keyword\">FROM</span> python:<span class=\"hljs-number\"\
          >3.10</span>.<span class=\"hljs-number\">13</span>-bullseye\n<span class=\"\
          hljs-keyword\">FROM</span> python:<span class=\"hljs-number\">3.8</span>-slim-buster\n\
          </code></pre>\n<p>and</p>\n<pre><code class=\"language-shell\">root@0ac58308616e:/app#\
          \ python -c \"import torch; print(torch.__version__);\"\n2.1.0\nroot@0ac58308616e:/app#\
          \ python -c \"import transformers; print(transformers.__version__);\"\n\
          4.34.1\nroot@0ac58308616e:/app# python -c \"import sentence_transformers;\
          \ print(sentence_transformers.__version__);\"\n2.2.2\n</code></pre>\n<p>Stacktrace:</p>\n\
          <pre><code class=\"language-shell\">Segmentation fault\nroot@0ac58308616e:/app#\
          \ /usr/local/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning:\
          \ resource_tracker: There appear to be 1 leaked semaphore objects to clean\
          \ up at shutdown\n  warnings.warn('resource_tracker: There appear to be\
          \ %d '\n</code></pre>\n<p>Code:</p>\n<pre><code class=\"language-python\"\
          ><span class=\"hljs-keyword\">from</span> sentence_transformers <span class=\"\
          hljs-keyword\">import</span> SentenceTransformer\nsentences = [<span class=\"\
          hljs-string\">\"This is an example sentence\"</span>, <span class=\"hljs-string\"\
          >\"Each sentence is converted\"</span>]\n\nmodel = SentenceTransformer(<span\
          \ class=\"hljs-string\">'sentence-transformers/all-MiniLM-L6-v2'</span>)\n\
          embeddings = model.encode(sentences)\n<span class=\"hljs-built_in\">print</span>(embeddings)\n\
          </code></pre>\n<p>or the example via <code>transformers</code>.</p>\n<p>My\
          \ <code>requirements.txt</code> is</p>\n<pre><code class=\"language-text\"\
          >typing-extensions\nnumpy\ndiskcache\nvoyager\ntorch\ntransformers\nsentence-transformers\n\
          optimum\nonnx\nonnxruntime\n</code></pre>\n<p>In the Dockerfile I'm installing</p>\n\
          <pre><code class=\"language-Dockerfile\"><span class=\"hljs-keyword\">RUN</span><span\
          \ class=\"language-bash\"> apt-get update &amp;&amp; apt-get install -y\
          \ \\</span>\n<span class=\"language-bash\">    software-properties-common\
          \ \\</span>\n<span class=\"language-bash\">    build-essential \\</span>\n\
          <span class=\"language-bash\">    pkg-config \\</span>\n<span class=\"language-bash\"\
          >    ninja-build \\</span>\n<span class=\"language-bash\">    libopenblas-dev\
          \ \\</span>\n<span class=\"language-bash\">    python3-pip \\</span>\n<span\
          \ class=\"language-bash\">    curl</span>\n</code></pre>\n"
        raw: "This error happens with all the following:\n\n```Dockerfile\nFROM python:3.9.7-slim-bullseye\n\
          FROM python:3.10.13-bullseye\nFROM python:3.8-slim-buster\n```\n\nand\n\n\
          ```shell\nroot@0ac58308616e:/app# python -c \"import torch; print(torch.__version__);\"\
          \n2.1.0\nroot@0ac58308616e:/app# python -c \"import transformers; print(transformers.__version__);\"\
          \n4.34.1\nroot@0ac58308616e:/app# python -c \"import sentence_transformers;\
          \ print(sentence_transformers.__version__);\"\n2.2.2\n```\n\nStacktrace:\n\
          ```shell\nSegmentation fault\nroot@0ac58308616e:/app# /usr/local/lib/python3.10/multiprocessing/resource_tracker.py:224:\
          \ UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects\
          \ to clean up at shutdown\n  warnings.warn('resource_tracker: There appear\
          \ to be %d '\n```\n\nCode:\n```python\nfrom sentence_transformers import\
          \ SentenceTransformer\nsentences = [\"This is an example sentence\", \"\
          Each sentence is converted\"]\n\nmodel = SentenceTransformer('sentence-transformers/all-MiniLM-L6-v2')\n\
          embeddings = model.encode(sentences)\nprint(embeddings)\n```\n\nor the example\
          \ via `transformers`.\n\nMy `requirements.txt` is\n\n```text\ntyping-extensions\n\
          numpy\ndiskcache\nvoyager\ntorch\ntransformers\nsentence-transformers\n\
          optimum\nonnx\nonnxruntime\n```\n\nIn the Dockerfile I'm installing\n\n\
          ```Dockerfile\nRUN apt-get update && apt-get install -y \\\n    software-properties-common\
          \ \\\n    build-essential \\\n    pkg-config \\\n    ninja-build \\\n  \
          \  libopenblas-dev \\\n    python3-pip \\\n    curl\n```"
        updatedAt: '2023-10-23T17:41:28.884Z'
      numEdits: 2
      reactions:
      - count: 3
        reaction: "\U0001F44D"
        users:
        - andywinxp
        - simonaesse
        - paulthemagno
    id: 6536ade675990e188be43ac6
    type: comment
  author: loretoparisi
  content: "This error happens with all the following:\n\n```Dockerfile\nFROM python:3.9.7-slim-bullseye\n\
    FROM python:3.10.13-bullseye\nFROM python:3.8-slim-buster\n```\n\nand\n\n```shell\n\
    root@0ac58308616e:/app# python -c \"import torch; print(torch.__version__);\"\n\
    2.1.0\nroot@0ac58308616e:/app# python -c \"import transformers; print(transformers.__version__);\"\
    \n4.34.1\nroot@0ac58308616e:/app# python -c \"import sentence_transformers; print(sentence_transformers.__version__);\"\
    \n2.2.2\n```\n\nStacktrace:\n```shell\nSegmentation fault\nroot@0ac58308616e:/app#\
    \ /usr/local/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning:\
    \ resource_tracker: There appear to be 1 leaked semaphore objects to clean up\
    \ at shutdown\n  warnings.warn('resource_tracker: There appear to be %d '\n```\n\
    \nCode:\n```python\nfrom sentence_transformers import SentenceTransformer\nsentences\
    \ = [\"This is an example sentence\", \"Each sentence is converted\"]\n\nmodel\
    \ = SentenceTransformer('sentence-transformers/all-MiniLM-L6-v2')\nembeddings\
    \ = model.encode(sentences)\nprint(embeddings)\n```\n\nor the example via `transformers`.\n\
    \nMy `requirements.txt` is\n\n```text\ntyping-extensions\nnumpy\ndiskcache\nvoyager\n\
    torch\ntransformers\nsentence-transformers\noptimum\nonnx\nonnxruntime\n```\n\n\
    In the Dockerfile I'm installing\n\n```Dockerfile\nRUN apt-get update && apt-get\
    \ install -y \\\n    software-properties-common \\\n    build-essential \\\n \
    \   pkg-config \\\n    ninja-build \\\n    libopenblas-dev \\\n    python3-pip\
    \ \\\n    curl\n```"
  created_at: 2023-10-23 16:31:18+00:00
  edited: true
  hidden: false
  id: 6536ade675990e188be43ac6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1642412329881-5e6b7a61d4cd9779932a7601.png?w=200&h=200&f=face
      fullname: Loreto Parisi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: loretoparisi
      type: user
    createdAt: '2023-10-23T18:46:09.000Z'
    data:
      edited: false
      editors:
      - loretoparisi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5947022438049316
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1642412329881-5e6b7a61d4cd9779932a7601.png?w=200&h=200&f=face
          fullname: Loreto Parisi
          isHf: false
          isPro: false
          name: loretoparisi
          type: user
        html: '<p>Submitted this issue here <a rel="nofollow" href="https://stackoverflow.com/questions/77347618/sentence-transformers-segmentation-fault">https://stackoverflow.com/questions/77347618/sentence-transformers-segmentation-fault</a></p>

          '
        raw: Submitted this issue here https://stackoverflow.com/questions/77347618/sentence-transformers-segmentation-fault
        updatedAt: '2023-10-23T18:46:09.926Z'
      numEdits: 0
      reactions: []
    id: 6536bf71019de94263a129d6
    type: comment
  author: loretoparisi
  content: Submitted this issue here https://stackoverflow.com/questions/77347618/sentence-transformers-segmentation-fault
  created_at: 2023-10-23 17:46:09+00:00
  edited: false
  hidden: false
  id: 6536bf71019de94263a129d6
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 35
repo_id: sentence-transformers/all-MiniLM-L6-v2
repo_type: model
status: open
target_branch: null
title: Segmentation Fault
