!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Xenova
conflicting_files: []
created_at: 2023-11-04 15:05:33+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/61b253b7ac5ecaae3d1efe0c/hwiQ0uvz3t-L5a-NtBIO6.png?w=200&h=200&f=face
      fullname: Joshua
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Xenova
      type: user
    createdAt: '2023-11-04T16:05:33.000Z'
    data:
      edited: true
      editors:
      - Xenova
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.38588738441467285
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/61b253b7ac5ecaae3d1efe0c/hwiQ0uvz3t-L5a-NtBIO6.png?w=200&h=200&f=face
          fullname: Joshua
          isHf: true
          isPro: false
          name: Xenova
          type: user
        html: "<p>Without setting <code>model_max_length=512</code>, it breaks with\
          \ HF's pipeline function when using &gt;512 tokens:</p>\n<pre><code class=\"\
          language-py\"><span class=\"hljs-keyword\">from</span> transformers <span\
          \ class=\"hljs-keyword\">import</span> pipeline\npipe = pipeline(<span class=\"\
          hljs-string\">'feature-extraction'</span>, <span class=\"hljs-string\">'thenlper/gte-small'</span>)\n\
          <span class=\"hljs-built_in\">input</span> = <span class=\"hljs-string\"\
          >\"# 2024 Summer Olympics\\n\\n## The Games\\\\[edit\\\\]\\n\\n### Sports\\\
          \\[edit\\\\]\\n\\nle\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt;\
          \ Basketball&lt;ul&gt;&lt;li&gt;Basketball &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;3\xD7\
          3 basketball &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span\
          \ typeof=\\\"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt;\
          \ Boxing &lt;small&gt;(13)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;&lt;span typeof=\\\
          \"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt; Breaking &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;&lt;span\
          \ typeof=\\\"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt;\
          \ Canoeing&lt;ul&gt;&lt;li&gt;Slalom &lt;small&gt;(6)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Sprint\
          \ &lt;small&gt;(10)&lt;/small&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span\
          \ typeof=\\\"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt;\
          \ Cycling&lt;ul&gt;&lt;li&gt;BMX freestyle &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;BMX\
          \ racing &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Mountain biking\
          \ &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Road &lt;small&gt;(4)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Track\
          \ &lt;small&gt;(12)&lt;/small&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span\
          \ typeof=\\\"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;/span&gt;\
          \ Equestrian&lt;ul&gt;&lt;li&gt;Dressage &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Eventing\
          \ &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;li&gt;Jumping &lt;small&gt;(2)&lt;/small&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span\
          \ typeof=\\\"mw:File\\\"&gt;&lt;span&gt;Image&lt;/span&gt;&lt;a\"</span>\n\
          output = pipe(<span class=\"hljs-built_in\">input</span>)\n</code></pre>\n\
          <p>outputs</p>\n<pre><code class=\"language-py\">    <span class=\"hljs-number\"\
          >236</span>         <span class=\"hljs-keyword\">if</span> self.position_embedding_type\
          \ == <span class=\"hljs-string\">\"absolute\"</span>:\n    <span class=\"\
          hljs-number\">237</span>             position_embeddings = self.position_embeddings(position_ids)\n\
          --&gt; <span class=\"hljs-number\">238</span>             embeddings +=\
          \ position_embeddings\n    <span class=\"hljs-number\">239</span>      \
          \   embeddings = self.LayerNorm(embeddings)\n    <span class=\"hljs-number\"\
          >240</span>         embeddings = self.dropout(embeddings)\n\nRuntimeError:\
          \ The size of tensor a (<span class=\"hljs-number\">513</span>) must <span\
          \ class=\"hljs-keyword\">match</span> the size of tensor b (<span class=\"\
          hljs-number\">512</span>) at non-singleton dimension <span class=\"hljs-number\"\
          >1</span>\n</code></pre>\n<p>See <a rel=\"nofollow\" href=\"https://github.com/xenova/transformers.js/issues/355\"\
          >https://github.com/xenova/transformers.js/issues/355</a> for more information.\
          \ This modification was also made to the Transformers.js-compatible version\
          \ of the model: <a href=\"https://huggingface.co/Xenova/gte-small/commit/7ca943b8ff118ce9eb87aa3a5669f26e3d633fd7\"\
          >https://huggingface.co/Xenova/gte-small/commit/7ca943b8ff118ce9eb87aa3a5669f26e3d633fd7</a></p>\n"
        raw: "Without setting `model_max_length=512`, it breaks with HF's pipeline\
          \ function when using >512 tokens:\n```py\nfrom transformers import pipeline\n\
          pipe = pipeline('feature-extraction', 'thenlper/gte-small')\ninput = \"\
          # 2024 Summer Olympics\\n\\n## The Games\\\\[edit\\\\]\\n\\n### Sports\\\
          \\[edit\\\\]\\n\\nle\\\"><span>Image</span></span> Basketball<ul><li>Basketball\
          \ <small>(2)</small></li><li>3\xD73 basketball <small>(2)</small></li></ul></li><li><span\
          \ typeof=\\\"mw:File\\\"><span>Image</span></span> Boxing <small>(13)</small></li><li><span\
          \ typeof=\\\"mw:File\\\"><span>Image</span></span> Breaking <small>(2)</small></li></ul></td><td><ul><li><span\
          \ typeof=\\\"mw:File\\\"><span>Image</span></span> Canoeing<ul><li>Slalom\
          \ <small>(6)</small></li><li>Sprint <small>(10)</small></li></ul></li><li><span\
          \ typeof=\\\"mw:File\\\"><span>Image</span></span> Cycling<ul><li>BMX freestyle\
          \ <small>(2)</small></li><li>BMX racing <small>(2)</small></li><li>Mountain\
          \ biking <small>(2)</small></li><li>Road <small>(4)</small></li><li>Track\
          \ <small>(12)</small></li></ul></li><li><span typeof=\\\"mw:File\\\"><span>Image</span></span>\
          \ Equestrian<ul><li>Dressage <small>(2)</small></li><li>Eventing <small>(2)</small></li><li>Jumping\
          \ <small>(2)</small></li></ul></li><li><span typeof=\\\"mw:File\\\"><span>Image</span><a\"\
          \noutput = pipe(input)\n```\n\noutputs\n```py\n    236         if self.position_embedding_type\
          \ == \"absolute\":\n    237             position_embeddings = self.position_embeddings(position_ids)\n\
          --> 238             embeddings += position_embeddings\n    239         embeddings\
          \ = self.LayerNorm(embeddings)\n    240         embeddings = self.dropout(embeddings)\n\
          \nRuntimeError: The size of tensor a (513) must match the size of tensor\
          \ b (512) at non-singleton dimension 1\n```\n\nSee https://github.com/xenova/transformers.js/issues/355\
          \ for more information. This modification was also made to the Transformers.js-compatible\
          \ version of the model: https://huggingface.co/Xenova/gte-small/commit/7ca943b8ff118ce9eb87aa3a5669f26e3d633fd7"
        updatedAt: '2023-11-04T16:06:05.348Z'
      numEdits: 2
      reactions: []
    id: 65466bcdcd0a56213913b423
    type: comment
  author: Xenova
  content: "Without setting `model_max_length=512`, it breaks with HF's pipeline function\
    \ when using >512 tokens:\n```py\nfrom transformers import pipeline\npipe = pipeline('feature-extraction',\
    \ 'thenlper/gte-small')\ninput = \"# 2024 Summer Olympics\\n\\n## The Games\\\\\
    [edit\\\\]\\n\\n### Sports\\\\[edit\\\\]\\n\\nle\\\"><span>Image</span></span>\
    \ Basketball<ul><li>Basketball <small>(2)</small></li><li>3\xD73 basketball <small>(2)</small></li></ul></li><li><span\
    \ typeof=\\\"mw:File\\\"><span>Image</span></span> Boxing <small>(13)</small></li><li><span\
    \ typeof=\\\"mw:File\\\"><span>Image</span></span> Breaking <small>(2)</small></li></ul></td><td><ul><li><span\
    \ typeof=\\\"mw:File\\\"><span>Image</span></span> Canoeing<ul><li>Slalom <small>(6)</small></li><li>Sprint\
    \ <small>(10)</small></li></ul></li><li><span typeof=\\\"mw:File\\\"><span>Image</span></span>\
    \ Cycling<ul><li>BMX freestyle <small>(2)</small></li><li>BMX racing <small>(2)</small></li><li>Mountain\
    \ biking <small>(2)</small></li><li>Road <small>(4)</small></li><li>Track <small>(12)</small></li></ul></li><li><span\
    \ typeof=\\\"mw:File\\\"><span>Image</span></span> Equestrian<ul><li>Dressage\
    \ <small>(2)</small></li><li>Eventing <small>(2)</small></li><li>Jumping <small>(2)</small></li></ul></li><li><span\
    \ typeof=\\\"mw:File\\\"><span>Image</span><a\"\noutput = pipe(input)\n```\n\n\
    outputs\n```py\n    236         if self.position_embedding_type == \"absolute\"\
    :\n    237             position_embeddings = self.position_embeddings(position_ids)\n\
    --> 238             embeddings += position_embeddings\n    239         embeddings\
    \ = self.LayerNorm(embeddings)\n    240         embeddings = self.dropout(embeddings)\n\
    \nRuntimeError: The size of tensor a (513) must match the size of tensor b (512)\
    \ at non-singleton dimension 1\n```\n\nSee https://github.com/xenova/transformers.js/issues/355\
    \ for more information. This modification was also made to the Transformers.js-compatible\
    \ version of the model: https://huggingface.co/Xenova/gte-small/commit/7ca943b8ff118ce9eb87aa3a5669f26e3d633fd7"
  created_at: 2023-11-04 15:05:33+00:00
  edited: true
  hidden: false
  id: 65466bcdcd0a56213913b423
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/61b253b7ac5ecaae3d1efe0c/hwiQ0uvz3t-L5a-NtBIO6.png?w=200&h=200&f=face
      fullname: Joshua
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Xenova
      type: user
    createdAt: '2023-11-04T16:05:34.000Z'
    data:
      oid: 15f67624bd267c82d596d0c916d61eb8445867d0
      parents:
      - c20abe89ac0cdf484944ebdc26ecaaa1bfc9cf89
      subject: Update tokenizer_config.json
    id: 65466bce0000000000000000
    type: commit
  author: Xenova
  created_at: 2023-11-04 15:05:34+00:00
  id: 65466bce0000000000000000
  oid: 15f67624bd267c82d596d0c916d61eb8445867d0
  summary: Update tokenizer_config.json
  type: commit
is_pull_request: true
merge_commit_oid: null
num: 6
repo_id: thenlper/gte-small
repo_type: model
status: open
target_branch: refs/heads/main
title: Update tokenizer_config.json
