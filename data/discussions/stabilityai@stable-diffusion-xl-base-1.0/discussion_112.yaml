!!python/object:huggingface_hub.community.DiscussionWithDetails
author: williamlzw
conflicting_files: null
created_at: 2023-11-02 06:21:38+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/a7865daae51a97c7bf218fdf6a82c4a3.svg
      fullname: william lai
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: williamlzw
      type: user
    createdAt: '2023-11-02T07:21:38.000Z'
    data:
      edited: true
      editors:
      - williamlzw
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4001856744289398
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/a7865daae51a97c7bf218fdf6a82c4a3.svg
          fullname: william lai
          isHf: false
          isPro: false
          name: williamlzw
          type: user
        html: '<p>The resulting image is almost invalid.But with the pytorch model
          you can generate high quality images.<br>optimum 1.13.2 ,  transformers
          4.34.1,  onnxruntime 1.16.1, diffusers 0.19.0</p>

          <p>import os<br>from optimum.onnxruntime import ORTStableDiffusionXLPipeline</p>

          <p>model_dir = os.getenv("SDXL_MODEL_DIR")<br>model_key_base = os.path.join(model_dir,
          "stable-diffusion-xl-base-1.0")</p>

          <p>pipeline = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base)<br>#pipeline
          = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base, provider="CUDAExecutionProvider")<br>prompt
          = ["realistic style bird. colorful, lifelike, nature"]<br>#negative = ["noisy,
          blurry, deformed, ugly, sloppy, messy"]<br>steps = 10<br>guidance_scale
          = 9<br>images = pipeline(prompt=prompt, #negative_prompt=negative,<br>                  guidance_scale=guidance_scale,
          num_inference_steps=steps).images</p>

          <p>for (i, image) in enumerate(images):<br>    image.save(f''./result_onnx/{i}.jpg'')</p>

          '
        raw: "The resulting image is almost invalid.But with the pytorch model you\
          \ can generate high quality images.\noptimum 1.13.2 ,  transformers 4.34.1,\
          \  onnxruntime 1.16.1, diffusers 0.19.0\n\nimport os\nfrom optimum.onnxruntime\
          \ import ORTStableDiffusionXLPipeline\n\nmodel_dir = os.getenv(\"SDXL_MODEL_DIR\"\
          )\nmodel_key_base = os.path.join(model_dir, \"stable-diffusion-xl-base-1.0\"\
          )\n\npipeline = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base)\n\
          #pipeline = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base,\
          \ provider=\"CUDAExecutionProvider\")\nprompt = [\"realistic style bird.\
          \ colorful, lifelike, nature\"]\n#negative = [\"noisy, blurry, deformed,\
          \ ugly, sloppy, messy\"]\nsteps = 10\nguidance_scale = 9\nimages = pipeline(prompt=prompt,\
          \ #negative_prompt=negative,\n                  guidance_scale=guidance_scale,\
          \ num_inference_steps=steps).images\n\n\nfor (i, image) in enumerate(images):\n\
          \timage.save(f'./result_onnx/{i}.jpg')"
        updatedAt: '2023-11-02T07:25:16.233Z'
      numEdits: 3
      reactions: []
    id: 65434e022997b38f4fa75dbc
    type: comment
  author: williamlzw
  content: "The resulting image is almost invalid.But with the pytorch model you can\
    \ generate high quality images.\noptimum 1.13.2 ,  transformers 4.34.1,  onnxruntime\
    \ 1.16.1, diffusers 0.19.0\n\nimport os\nfrom optimum.onnxruntime import ORTStableDiffusionXLPipeline\n\
    \nmodel_dir = os.getenv(\"SDXL_MODEL_DIR\")\nmodel_key_base = os.path.join(model_dir,\
    \ \"stable-diffusion-xl-base-1.0\")\n\npipeline = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base)\n\
    #pipeline = ORTStableDiffusionXLPipeline.from_pretrained(model_key_base, provider=\"\
    CUDAExecutionProvider\")\nprompt = [\"realistic style bird. colorful, lifelike,\
    \ nature\"]\n#negative = [\"noisy, blurry, deformed, ugly, sloppy, messy\"]\n\
    steps = 10\nguidance_scale = 9\nimages = pipeline(prompt=prompt, #negative_prompt=negative,\n\
    \                  guidance_scale=guidance_scale, num_inference_steps=steps).images\n\
    \n\nfor (i, image) in enumerate(images):\n\timage.save(f'./result_onnx/{i}.jpg')"
  created_at: 2023-11-02 06:21:38+00:00
  edited: true
  hidden: false
  id: 65434e022997b38f4fa75dbc
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 112
repo_id: stabilityai/stable-diffusion-xl-base-1.0
repo_type: model
status: open
target_branch: null
title: ORTStableDiffusionXLPipeline generated images have a problem
