!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Trangle
conflicting_files: null
created_at: 2023-08-09 02:38:30+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
      fullname: Trangle Heshvp
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Trangle
      type: user
    createdAt: '2023-08-09T03:38:30.000Z'
    data:
      edited: false
      editors:
      - Trangle
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.8856661319732666
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
          fullname: Trangle Heshvp
          isHf: false
          isPro: false
          name: Trangle
          type: user
        html: "<p>llama2\u7684\u5B9E\u9645max_position_embeddings=4096\uFF0C\u800C\
          \u4E0D\u662F\u4FEE\u6B63\u524D\u76842048\uFF0C2048\u662F\u56E0\u4E3Atransformers\u7684\
          \u8001\u4EE3\u7801\u6CA1\u66F4\u65B0\u5C31\u63D0\u524D\u8F6C\u6362\u4E4B\
          \u524D\u9ED8\u8BA4\u53C2\u6570\u5BFC\u81F4\u3002\u53E6\u5916\u53EF\u4EE5\
          \u6D4B\u6D4BIF\u7684\u80FD\u529B\uFF0C3\u6B21\u6A21\u578B\u7684\u8868\u73B0\
          \u90FD\u5F88\u5DEE</p>\n"
        raw: "llama2\u7684\u5B9E\u9645max_position_embeddings=4096\uFF0C\u800C\u4E0D\
          \u662F\u4FEE\u6B63\u524D\u76842048\uFF0C2048\u662F\u56E0\u4E3Atransformers\u7684\
          \u8001\u4EE3\u7801\u6CA1\u66F4\u65B0\u5C31\u63D0\u524D\u8F6C\u6362\u4E4B\
          \u524D\u9ED8\u8BA4\u53C2\u6570\u5BFC\u81F4\u3002\u53E6\u5916\u53EF\u4EE5\
          \u6D4B\u6D4BIF\u7684\u80FD\u529B\uFF0C3\u6B21\u6A21\u578B\u7684\u8868\u73B0\
          \u90FD\u5F88\u5DEE"
        updatedAt: '2023-08-09T03:38:30.019Z'
      numEdits: 0
      reactions: []
    id: 64d30a367f387061b8b11fc0
    type: comment
  author: Trangle
  content: "llama2\u7684\u5B9E\u9645max_position_embeddings=4096\uFF0C\u800C\u4E0D\
    \u662F\u4FEE\u6B63\u524D\u76842048\uFF0C2048\u662F\u56E0\u4E3Atransformers\u7684\
    \u8001\u4EE3\u7801\u6CA1\u66F4\u65B0\u5C31\u63D0\u524D\u8F6C\u6362\u4E4B\u524D\
    \u9ED8\u8BA4\u53C2\u6570\u5BFC\u81F4\u3002\u53E6\u5916\u53EF\u4EE5\u6D4B\u6D4B\
    IF\u7684\u80FD\u529B\uFF0C3\u6B21\u6A21\u578B\u7684\u8868\u73B0\u90FD\u5F88\u5DEE"
  created_at: 2023-08-09 02:38:30+00:00
  edited: false
  hidden: false
  id: 64d30a367f387061b8b11fc0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T04:38:36.000Z'
    data:
      edited: false
      editors:
      - i4never
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9012417793273926
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
          fullname: FC
          isHf: false
          isPro: false
          name: i4never
          type: user
        html: "<p>\u4F60\u597D\uFF0C<code>max_position_embeddings</code>\u5728llama\u4E2D\
          \u505Arotary embedding\u7684\u4E8B\u5148cache\u7528\uFF0C<code>modeling_llama.py</code>\u4E2D\
          \u505A\u4E86\u5B9E\u9645\u5E8F\u5217\u957F\u5EA6\u5927\u4E8E\u8FD9\u4E2A\
          \u503C\u65F6\u7684\u91CD\u65B0\u8BA1\u7B97\u3002\u7531\u4E8E\u6211\u4EEC\
          \u7684\u8BAD\u7EC3\u6570\u636E\u5904\u7406\u6210\u4E862048\u957F\u5EA6\u5185\
          \uFF0C\u6240\u4EE5\u6211\u4EEC\u662F\u7528\u4E862048\u957F\u5EA6\u7684cache\u3002\
          \u5982\u679C\u60A8\u8BA4\u4E3A\u8FD9\u662F\u4E2Abug\uFF0C\u53EF\u4EE5\u63D0\
          \u4F9B\u66F4\u8BE6\u7EC6\u7684\u8BF4\u660E\u6216\u8005case\u5417\uFF1F</p>\n"
        raw: "\u4F60\u597D\uFF0C`max_position_embeddings`\u5728llama\u4E2D\u505Arotary\
          \ embedding\u7684\u4E8B\u5148cache\u7528\uFF0C`modeling_llama.py`\u4E2D\u505A\
          \u4E86\u5B9E\u9645\u5E8F\u5217\u957F\u5EA6\u5927\u4E8E\u8FD9\u4E2A\u503C\
          \u65F6\u7684\u91CD\u65B0\u8BA1\u7B97\u3002\u7531\u4E8E\u6211\u4EEC\u7684\
          \u8BAD\u7EC3\u6570\u636E\u5904\u7406\u6210\u4E862048\u957F\u5EA6\u5185\uFF0C\
          \u6240\u4EE5\u6211\u4EEC\u662F\u7528\u4E862048\u957F\u5EA6\u7684cache\u3002\
          \u5982\u679C\u60A8\u8BA4\u4E3A\u8FD9\u662F\u4E2Abug\uFF0C\u53EF\u4EE5\u63D0\
          \u4F9B\u66F4\u8BE6\u7EC6\u7684\u8BF4\u660E\u6216\u8005case\u5417\uFF1F"
        updatedAt: '2023-08-09T04:38:36.582Z'
      numEdits: 0
      reactions: []
    id: 64d3184c091b53aa5a70fa18
    type: comment
  author: i4never
  content: "\u4F60\u597D\uFF0C`max_position_embeddings`\u5728llama\u4E2D\u505Arotary\
    \ embedding\u7684\u4E8B\u5148cache\u7528\uFF0C`modeling_llama.py`\u4E2D\u505A\u4E86\
    \u5B9E\u9645\u5E8F\u5217\u957F\u5EA6\u5927\u4E8E\u8FD9\u4E2A\u503C\u65F6\u7684\
    \u91CD\u65B0\u8BA1\u7B97\u3002\u7531\u4E8E\u6211\u4EEC\u7684\u8BAD\u7EC3\u6570\
    \u636E\u5904\u7406\u6210\u4E862048\u957F\u5EA6\u5185\uFF0C\u6240\u4EE5\u6211\u4EEC\
    \u662F\u7528\u4E862048\u957F\u5EA6\u7684cache\u3002\u5982\u679C\u60A8\u8BA4\u4E3A\
    \u8FD9\u662F\u4E2Abug\uFF0C\u53EF\u4EE5\u63D0\u4F9B\u66F4\u8BE6\u7EC6\u7684\u8BF4\
    \u660E\u6216\u8005case\u5417\uFF1F"
  created_at: 2023-08-09 03:38:36+00:00
  edited: false
  hidden: false
  id: 64d3184c091b53aa5a70fa18
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T04:43:11.000Z'
    data:
      edited: true
      editors:
      - i4never
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3208918273448944
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
          fullname: FC
          isHf: false
          isPro: false
          name: i4never
          type: user
        html: "<p><a rel=\"nofollow\" href=\"https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L119-L120\"\
          >https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L119-L120</a><br><a\
          \ rel=\"nofollow\" href=\"https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L157-L162\"\
          >https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L157-L162</a><br>\u8FD9\
          \u662F\u4E24\u79CDposition embedding\u7684cache\u4E0D\u6EE1\u8DB3\u5B9E\u9645\
          \u957F\u5EA6\u65F6\u7684\u5904\u7406\uFF0C\u8BF7\u67E5\u9605\u3002</p>\n"
        raw: "https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L119-L120\n\
          https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L157-L162\n\
          \u8FD9\u662F\u4E24\u79CDposition embedding\u7684cache\u4E0D\u6EE1\u8DB3\u5B9E\
          \u9645\u957F\u5EA6\u65F6\u7684\u5904\u7406\uFF0C\u8BF7\u67E5\u9605\u3002"
        updatedAt: '2023-08-09T04:49:44.532Z'
      numEdits: 1
      reactions: []
    id: 64d3195fd0d019f45eaafce0
    type: comment
  author: i4never
  content: "https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L119-L120\n\
    https://github.com/huggingface/transformers/blob/v4.31.0/src/transformers/models/llama/modeling_llama.py#L157-L162\n\
    \u8FD9\u662F\u4E24\u79CDposition embedding\u7684cache\u4E0D\u6EE1\u8DB3\u5B9E\u9645\
    \u957F\u5EA6\u65F6\u7684\u5904\u7406\uFF0C\u8BF7\u67E5\u9605\u3002"
  created_at: 2023-08-09 03:43:11+00:00
  edited: true
  hidden: false
  id: 64d3195fd0d019f45eaafce0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
      fullname: Trangle Heshvp
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Trangle
      type: user
    createdAt: '2023-08-09T05:44:35.000Z'
    data:
      edited: false
      editors:
      - Trangle
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.994783341884613
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
          fullname: Trangle Heshvp
          isHf: false
          isPro: false
          name: Trangle
          type: user
        html: "<p>\u8FD9\u4E2A\u95EE\u9898\u5728llama2\u53D1\u5E03\u7684\u7B2C\u4E09\
          \u5929\u5E94\u8BE5\u5C31\u66F4\u65B0\u4FEE\u590D\u4E86\uFF0C\u53EF\u4EE5\
          \u67E5\u9605\u6700\u65B0\u7684\u6A21\u578B\u914D\u7F6E\u3002\u5C31\u662F\
          llama2\u662F\u57282.2T tokens\u4E0A\u4EE54096\u7684\u957F\u5EA6\u8BAD\u7EC3\
          \u7684\u3002</p>\n"
        raw: "\u8FD9\u4E2A\u95EE\u9898\u5728llama2\u53D1\u5E03\u7684\u7B2C\u4E09\u5929\
          \u5E94\u8BE5\u5C31\u66F4\u65B0\u4FEE\u590D\u4E86\uFF0C\u53EF\u4EE5\u67E5\
          \u9605\u6700\u65B0\u7684\u6A21\u578B\u914D\u7F6E\u3002\u5C31\u662Fllama2\u662F\
          \u57282.2T tokens\u4E0A\u4EE54096\u7684\u957F\u5EA6\u8BAD\u7EC3\u7684\u3002"
        updatedAt: '2023-08-09T05:44:35.361Z'
      numEdits: 0
      reactions: []
    id: 64d327c3be9984dc4e45fd5c
    type: comment
  author: Trangle
  content: "\u8FD9\u4E2A\u95EE\u9898\u5728llama2\u53D1\u5E03\u7684\u7B2C\u4E09\u5929\
    \u5E94\u8BE5\u5C31\u66F4\u65B0\u4FEE\u590D\u4E86\uFF0C\u53EF\u4EE5\u67E5\u9605\
    \u6700\u65B0\u7684\u6A21\u578B\u914D\u7F6E\u3002\u5C31\u662Fllama2\u662F\u5728\
    2.2T tokens\u4E0A\u4EE54096\u7684\u957F\u5EA6\u8BAD\u7EC3\u7684\u3002"
  created_at: 2023-08-09 04:44:35+00:00
  edited: false
  hidden: false
  id: 64d327c3be9984dc4e45fd5c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T06:05:01.000Z'
    data:
      edited: true
      editors:
      - i4never
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9919822216033936
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
          fullname: FC
          isHf: false
          isPro: false
          name: i4never
          type: user
        html: "<p>\u5BF9\uFF0C\u4F46\u662F\u8FD9\u4E2A<code>max_position_embedding</code>\u5E76\
          \u4E0D\u4F1A\u5F15\u8D77\u8BA1\u7B97\u4E0A\u7684\u4E0D\u4E00\u81F4\uFF0C\
          \u54EA\u6015\u662F\u4EE54096\u957F\u5EA6\u8BAD\u7EC3\uFF0C\u5728infer\u6784\
          \u5EFA\u6A21\u578B\u65F6\u51992\u30014\u30018\u4E5F\u662F\u6CA1\u6709\u95EE\
          \u9898\u7684\uFF0C\u6211\u4EEC\u6311\u9009\u4E86\u548C\u7EE7\u7EED\u8BAD\
          \u7EC3\u7684\u6570\u636E\u957F\u5EA6\u66F4\u4E00\u81F4\u76842048\u3002\u53E6\
          \u5916\uFF0C\u60A8\u63D0\u5230\u7684IF\uFF0C\u53EF\u4EE5\u63D0\u4F9B\u66F4\
          \u8BE6\u7EC6\u4E00\u4E9B\u7684\u4FE1\u606F\u5417\uFF1F</p>\n"
        raw: "\u5BF9\uFF0C\u4F46\u662F\u8FD9\u4E2A`max_position_embedding`\u5E76\u4E0D\
          \u4F1A\u5F15\u8D77\u8BA1\u7B97\u4E0A\u7684\u4E0D\u4E00\u81F4\uFF0C\u54EA\
          \u6015\u662F\u4EE54096\u957F\u5EA6\u8BAD\u7EC3\uFF0C\u5728infer\u6784\u5EFA\
          \u6A21\u578B\u65F6\u51992\u30014\u30018\u4E5F\u662F\u6CA1\u6709\u95EE\u9898\
          \u7684\uFF0C\u6211\u4EEC\u6311\u9009\u4E86\u548C\u7EE7\u7EED\u8BAD\u7EC3\
          \u7684\u6570\u636E\u957F\u5EA6\u66F4\u4E00\u81F4\u76842048\u3002\u53E6\u5916\
          \uFF0C\u60A8\u63D0\u5230\u7684IF\uFF0C\u53EF\u4EE5\u63D0\u4F9B\u66F4\u8BE6\
          \u7EC6\u4E00\u4E9B\u7684\u4FE1\u606F\u5417\uFF1F"
        updatedAt: '2023-08-09T06:05:17.253Z'
      numEdits: 1
      reactions: []
    id: 64d32c8d80f189e40bd8e7a6
    type: comment
  author: i4never
  content: "\u5BF9\uFF0C\u4F46\u662F\u8FD9\u4E2A`max_position_embedding`\u5E76\u4E0D\
    \u4F1A\u5F15\u8D77\u8BA1\u7B97\u4E0A\u7684\u4E0D\u4E00\u81F4\uFF0C\u54EA\u6015\
    \u662F\u4EE54096\u957F\u5EA6\u8BAD\u7EC3\uFF0C\u5728infer\u6784\u5EFA\u6A21\u578B\
    \u65F6\u51992\u30014\u30018\u4E5F\u662F\u6CA1\u6709\u95EE\u9898\u7684\uFF0C\u6211\
    \u4EEC\u6311\u9009\u4E86\u548C\u7EE7\u7EED\u8BAD\u7EC3\u7684\u6570\u636E\u957F\
    \u5EA6\u66F4\u4E00\u81F4\u76842048\u3002\u53E6\u5916\uFF0C\u60A8\u63D0\u5230\u7684\
    IF\uFF0C\u53EF\u4EE5\u63D0\u4F9B\u66F4\u8BE6\u7EC6\u4E00\u4E9B\u7684\u4FE1\u606F\
    \u5417\uFF1F"
  created_at: 2023-08-09 05:05:01+00:00
  edited: true
  hidden: false
  id: 64d32c8d80f189e40bd8e7a6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/fdd267ffc8152d2e42dd75b54063add9.svg
      fullname: louis Y
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: louisY
      type: user
    createdAt: '2023-08-09T06:08:52.000Z'
    data:
      edited: false
      editors:
      - louisY
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9730886220932007
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/fdd267ffc8152d2e42dd75b54063add9.svg
          fullname: louis Y
          isHf: false
          isPro: false
          name: louisY
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Trangle&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Trangle\">@<span class=\"\
          underline\">Trangle</span></a></span>\n\n\t</span></span> \u5927\u90E8\u5206\
          llama2\u4E2D\u6587\u5316\u7684\u5DE5\u4F5Cmax_position_embedding\u90FD\u662F\
          2048\uFF0C\u53EF\u4EE5\u770B\u770B\u3002</p>\n"
        raw: "@Trangle \u5927\u90E8\u5206llama2\u4E2D\u6587\u5316\u7684\u5DE5\u4F5C\
          max_position_embedding\u90FD\u662F2048\uFF0C\u53EF\u4EE5\u770B\u770B\u3002"
        updatedAt: '2023-08-09T06:08:52.532Z'
      numEdits: 0
      reactions: []
    id: 64d32d740f36062457cd28f9
    type: comment
  author: louisY
  content: "@Trangle \u5927\u90E8\u5206llama2\u4E2D\u6587\u5316\u7684\u5DE5\u4F5C\
    max_position_embedding\u90FD\u662F2048\uFF0C\u53EF\u4EE5\u770B\u770B\u3002"
  created_at: 2023-08-09 05:08:52+00:00
  edited: false
  hidden: false
  id: 64d32d740f36062457cd28f9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
      fullname: Trangle Heshvp
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Trangle
      type: user
    createdAt: '2023-08-09T06:27:57.000Z'
    data:
      edited: false
      editors:
      - Trangle
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.23702768981456757
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/af0820f65b8db3180075bbdcb15624e0.svg
          fullname: Trangle Heshvp
          isHf: false
          isPro: false
          name: Trangle
          type: user
        html: '<p><a href="https://huggingface.co/meta-llama/Llama-2-13b-hf/blob/main/config.json#L12">https://huggingface.co/meta-llama/Llama-2-13b-hf/blob/main/config.json#L12</a></p>

          '
        raw: https://huggingface.co/meta-llama/Llama-2-13b-hf/blob/main/config.json#L12
        updatedAt: '2023-08-09T06:27:57.856Z'
      numEdits: 0
      reactions: []
    id: 64d331ed0c49a02703a41f18
    type: comment
  author: Trangle
  content: https://huggingface.co/meta-llama/Llama-2-13b-hf/blob/main/config.json#L12
  created_at: 2023-08-09 05:27:57+00:00
  edited: false
  hidden: false
  id: 64d331ed0c49a02703a41f18
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T07:29:11.000Z'
    data:
      status: closed
    id: 64d3404750310d7ad39b8297
    type: status-change
  author: i4never
  created_at: 2023-08-09 06:29:11+00:00
  id: 64d3404750310d7ad39b8297
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T07:34:52.000Z'
    data:
      status: open
    id: 64d3419c5de0bc71ffa7d30a
    type: status-change
  author: i4never
  created_at: 2023-08-09 06:34:52+00:00
  id: 64d3419c5de0bc71ffa7d30a
  new_status: open
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-09T07:59:34.000Z'
    data:
      edited: false
      editors:
      - i4never
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.26455235481262207
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
          fullname: FC
          isHf: false
          isPro: false
          name: i4never
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Trangle&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Trangle\">@<span class=\"\
          underline\">Trangle</span></a></span>\n\n\t</span></span><br>\u8FD9\u91CC\
          \u63D0\u4F9B\u4E00\u6BB5\u7B80\u5355\u7684\u4EE3\u7801\uFF0C\u4EE5\u89E3\
          \u91CA\u4E3A\u4EC0\u4E48\u867D\u7136meta\u66F4\u6539\u4E86\u8FD9\u4E2A\u53C2\
          \u6570\uFF0C\u4F46\u662F\u5E76\u4E0D\u4F1A\u5F15\u8D77\u8BA1\u7B97\u4E0A\
          \u7684\u4E0D\u4E00\u81F4\uFF0C\u56E0\u6B64\u5E76\u4E0D\u662Fbug\uFF1A</p>\n\
          <pre><code class=\"language-python\"><span class=\"hljs-keyword\">import</span>\
          \ torch\n<span class=\"hljs-keyword\">import</span> transformers\n<span\
          \ class=\"hljs-keyword\">from</span> transformers.models.llama.modeling_llama\
          \ <span class=\"hljs-keyword\">import</span> LlamaLinearScalingRotaryEmbedding\n\
          \n<span class=\"hljs-built_in\">print</span>(transformers.__version__)\n\
          \nbs = <span class=\"hljs-number\">4</span>\nnum_heads = <span class=\"\
          hljs-number\">64</span>\nseq_lengths = [<span class=\"hljs-number\">30</span>,\
          \ <span class=\"hljs-number\">300</span>, <span class=\"hljs-number\">3000</span>,\
          \ <span class=\"hljs-number\">6000</span>]\nhidden_size = <span class=\"\
          hljs-number\">64</span>\n\nllama_linear_scaling_re_4096 = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n\
          \                                                                 max_position_embeddings=<span\
          \ class=\"hljs-number\">4096</span>,\n                                 \
          \                                device=<span class=\"hljs-string\">'cpu'</span>)\n\
          llama_linear_scaling_re_2048 = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n\
          \                                                                 max_position_embeddings=<span\
          \ class=\"hljs-number\">2048</span>,\n                                 \
          \                                device=<span class=\"hljs-string\">'cpu'</span>)\n\
          \n<span class=\"hljs-keyword\">for</span> seq_length <span class=\"hljs-keyword\"\
          >in</span> seq_lengths:\n    hidden_state = torch.rand(bs, num_heads, seq_length,\
          \ hidden_size)\n    cos_by_4096, sin_by_4096 = llama_linear_scaling_re_4096(hidden_state,\
          \ seq_length)\n    cos_by_2048, sin_by_2048 = llama_linear_scaling_re_2048(hidden_state,\
          \ seq_length)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"\
          hljs-string\">f\"\"\"seq_length: <span class=\"hljs-subst\">{seq_length}</span>,\
          \ <span class=\"hljs-subst\">{cos_by_4096.shape}</span> <span class=\"hljs-subst\"\
          >{sin_by_4096.shape}</span> <span class=\"hljs-subst\">{cos_by_2048.shape}</span>\
          \ <span class=\"hljs-subst\">{sin_by_2048.shape}</span></span>\n<span class=\"\
          hljs-string\">cos pos is equal: <span class=\"hljs-subst\">{torch.equal(cos_by_4096,\
          \ cos_by_2048)}</span></span>\n<span class=\"hljs-string\">sin pos is equal:\
          \ <span class=\"hljs-subst\">{torch.equal(sin_by_4096, sin_by_2048)}</span>\"\
          \"\"</span>)\n</code></pre>\n<p>\u8F93\u51FA\u5982\u4E0B\uFF1A</p>\n<pre><code\
          \ class=\"language-shell\">4.31.0\nseq_length: 30, torch.Size([1, 1, 30,\
          \ 64]) torch.Size([1, 1, 30, 64]) torch.Size([1, 1, 30, 64]) torch.Size([1,\
          \ 1, 30, 64])\ncos pos is equal: True\nsin pos is equal: True\nseq_length:\
          \ 300, torch.Size([1, 1, 300, 64]) torch.Size([1, 1, 300, 64]) torch.Size([1,\
          \ 1, 300, 64]) torch.Size([1, 1, 300, 64])\ncos pos is equal: True\nsin\
          \ pos is equal: True\nseq_length: 3000, torch.Size([1, 1, 3000, 64]) torch.Size([1,\
          \ 1, 3000, 64]) torch.Size([1, 1, 3000, 64]) torch.Size([1, 1, 3000, 64])\n\
          cos pos is equal: True\nsin pos is equal: True\nseq_length: 6000, torch.Size([1,\
          \ 1, 6000, 64]) torch.Size([1, 1, 6000, 64]) torch.Size([1, 1, 6000, 64])\
          \ torch.Size([1, 1, 6000, 64])\ncos pos is equal: True\nsin pos is equal:\
          \ True\n</code></pre>\n<p>\u5982\u679C\u60A8\u8BA4\u4E3A\u8FD9\u4E2A\u503C\
          \u7684\u786E\u4F1A\u5BFC\u81F4\u95EE\u9898\uFF0C\u6B22\u8FCE\u63D0\u4F9B\
          \u66F4solid\u7684\u5206\u6790\u4EE5\u5E2E\u52A9\u6211\u4EEC\u4F18\u5316\u6A21\
          \u578B\u3002<br>\u53E6\u5916\u53EF\u4EE5\u63D0\u4F9B\u4E0B\u60A8\u63D0\u5230\
          \u7684IF\u80FD\u529B\u7684\u76F8\u5173\u4FE1\u606F\u548C\u6D4B\u8BD5\u65B9\
          \u6CD5\u5417\uFF1F\u8C22\u8C22\u3002</p>\n"
        raw: "@Trangle \n\u8FD9\u91CC\u63D0\u4F9B\u4E00\u6BB5\u7B80\u5355\u7684\u4EE3\
          \u7801\uFF0C\u4EE5\u89E3\u91CA\u4E3A\u4EC0\u4E48\u867D\u7136meta\u66F4\u6539\
          \u4E86\u8FD9\u4E2A\u53C2\u6570\uFF0C\u4F46\u662F\u5E76\u4E0D\u4F1A\u5F15\
          \u8D77\u8BA1\u7B97\u4E0A\u7684\u4E0D\u4E00\u81F4\uFF0C\u56E0\u6B64\u5E76\
          \u4E0D\u662Fbug\uFF1A\n```python\nimport torch\nimport transformers\nfrom\
          \ transformers.models.llama.modeling_llama import LlamaLinearScalingRotaryEmbedding\n\
          \nprint(transformers.__version__)\n\nbs = 4\nnum_heads = 64\nseq_lengths\
          \ = [30, 300, 3000, 6000]\nhidden_size = 64\n\nllama_linear_scaling_re_4096\
          \ = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n               \
          \                                                  max_position_embeddings=4096,\n\
          \                                                                 device='cpu')\n\
          llama_linear_scaling_re_2048 = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n\
          \                                                                 max_position_embeddings=2048,\n\
          \                                                                 device='cpu')\n\
          \nfor seq_length in seq_lengths:\n    hidden_state = torch.rand(bs, num_heads,\
          \ seq_length, hidden_size)\n    cos_by_4096, sin_by_4096 = llama_linear_scaling_re_4096(hidden_state,\
          \ seq_length)\n    cos_by_2048, sin_by_2048 = llama_linear_scaling_re_2048(hidden_state,\
          \ seq_length)\n    print(f\"\"\"seq_length: {seq_length}, {cos_by_4096.shape}\
          \ {sin_by_4096.shape} {cos_by_2048.shape} {sin_by_2048.shape}\ncos pos is\
          \ equal: {torch.equal(cos_by_4096, cos_by_2048)}\nsin pos is equal: {torch.equal(sin_by_4096,\
          \ sin_by_2048)}\"\"\")\n```\n\u8F93\u51FA\u5982\u4E0B\uFF1A\n```shell\n\
          4.31.0\nseq_length: 30, torch.Size([1, 1, 30, 64]) torch.Size([1, 1, 30,\
          \ 64]) torch.Size([1, 1, 30, 64]) torch.Size([1, 1, 30, 64])\ncos pos is\
          \ equal: True\nsin pos is equal: True\nseq_length: 300, torch.Size([1, 1,\
          \ 300, 64]) torch.Size([1, 1, 300, 64]) torch.Size([1, 1, 300, 64]) torch.Size([1,\
          \ 1, 300, 64])\ncos pos is equal: True\nsin pos is equal: True\nseq_length:\
          \ 3000, torch.Size([1, 1, 3000, 64]) torch.Size([1, 1, 3000, 64]) torch.Size([1,\
          \ 1, 3000, 64]) torch.Size([1, 1, 3000, 64])\ncos pos is equal: True\nsin\
          \ pos is equal: True\nseq_length: 6000, torch.Size([1, 1, 6000, 64]) torch.Size([1,\
          \ 1, 6000, 64]) torch.Size([1, 1, 6000, 64]) torch.Size([1, 1, 6000, 64])\n\
          cos pos is equal: True\nsin pos is equal: True\n```\n\u5982\u679C\u60A8\u8BA4\
          \u4E3A\u8FD9\u4E2A\u503C\u7684\u786E\u4F1A\u5BFC\u81F4\u95EE\u9898\uFF0C\
          \u6B22\u8FCE\u63D0\u4F9B\u66F4solid\u7684\u5206\u6790\u4EE5\u5E2E\u52A9\u6211\
          \u4EEC\u4F18\u5316\u6A21\u578B\u3002\n\u53E6\u5916\u53EF\u4EE5\u63D0\u4F9B\
          \u4E0B\u60A8\u63D0\u5230\u7684IF\u80FD\u529B\u7684\u76F8\u5173\u4FE1\u606F\
          \u548C\u6D4B\u8BD5\u65B9\u6CD5\u5417\uFF1F\u8C22\u8C22\u3002"
        updatedAt: '2023-08-09T07:59:34.235Z'
      numEdits: 0
      reactions: []
    id: 64d34766db0b63b977c3e337
    type: comment
  author: i4never
  content: "@Trangle \n\u8FD9\u91CC\u63D0\u4F9B\u4E00\u6BB5\u7B80\u5355\u7684\u4EE3\
    \u7801\uFF0C\u4EE5\u89E3\u91CA\u4E3A\u4EC0\u4E48\u867D\u7136meta\u66F4\u6539\u4E86\
    \u8FD9\u4E2A\u53C2\u6570\uFF0C\u4F46\u662F\u5E76\u4E0D\u4F1A\u5F15\u8D77\u8BA1\
    \u7B97\u4E0A\u7684\u4E0D\u4E00\u81F4\uFF0C\u56E0\u6B64\u5E76\u4E0D\u662Fbug\uFF1A\
    \n```python\nimport torch\nimport transformers\nfrom transformers.models.llama.modeling_llama\
    \ import LlamaLinearScalingRotaryEmbedding\n\nprint(transformers.__version__)\n\
    \nbs = 4\nnum_heads = 64\nseq_lengths = [30, 300, 3000, 6000]\nhidden_size = 64\n\
    \nllama_linear_scaling_re_4096 = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n\
    \                                                                 max_position_embeddings=4096,\n\
    \                                                                 device='cpu')\n\
    llama_linear_scaling_re_2048 = LlamaLinearScalingRotaryEmbedding(dim=hidden_size,\n\
    \                                                                 max_position_embeddings=2048,\n\
    \                                                                 device='cpu')\n\
    \nfor seq_length in seq_lengths:\n    hidden_state = torch.rand(bs, num_heads,\
    \ seq_length, hidden_size)\n    cos_by_4096, sin_by_4096 = llama_linear_scaling_re_4096(hidden_state,\
    \ seq_length)\n    cos_by_2048, sin_by_2048 = llama_linear_scaling_re_2048(hidden_state,\
    \ seq_length)\n    print(f\"\"\"seq_length: {seq_length}, {cos_by_4096.shape}\
    \ {sin_by_4096.shape} {cos_by_2048.shape} {sin_by_2048.shape}\ncos pos is equal:\
    \ {torch.equal(cos_by_4096, cos_by_2048)}\nsin pos is equal: {torch.equal(sin_by_4096,\
    \ sin_by_2048)}\"\"\")\n```\n\u8F93\u51FA\u5982\u4E0B\uFF1A\n```shell\n4.31.0\n\
    seq_length: 30, torch.Size([1, 1, 30, 64]) torch.Size([1, 1, 30, 64]) torch.Size([1,\
    \ 1, 30, 64]) torch.Size([1, 1, 30, 64])\ncos pos is equal: True\nsin pos is equal:\
    \ True\nseq_length: 300, torch.Size([1, 1, 300, 64]) torch.Size([1, 1, 300, 64])\
    \ torch.Size([1, 1, 300, 64]) torch.Size([1, 1, 300, 64])\ncos pos is equal: True\n\
    sin pos is equal: True\nseq_length: 3000, torch.Size([1, 1, 3000, 64]) torch.Size([1,\
    \ 1, 3000, 64]) torch.Size([1, 1, 3000, 64]) torch.Size([1, 1, 3000, 64])\ncos\
    \ pos is equal: True\nsin pos is equal: True\nseq_length: 6000, torch.Size([1,\
    \ 1, 6000, 64]) torch.Size([1, 1, 6000, 64]) torch.Size([1, 1, 6000, 64]) torch.Size([1,\
    \ 1, 6000, 64])\ncos pos is equal: True\nsin pos is equal: True\n```\n\u5982\u679C\
    \u60A8\u8BA4\u4E3A\u8FD9\u4E2A\u503C\u7684\u786E\u4F1A\u5BFC\u81F4\u95EE\u9898\
    \uFF0C\u6B22\u8FCE\u63D0\u4F9B\u66F4solid\u7684\u5206\u6790\u4EE5\u5E2E\u52A9\u6211\
    \u4EEC\u4F18\u5316\u6A21\u578B\u3002\n\u53E6\u5916\u53EF\u4EE5\u63D0\u4F9B\u4E0B\
    \u60A8\u63D0\u5230\u7684IF\u80FD\u529B\u7684\u76F8\u5173\u4FE1\u606F\u548C\u6D4B\
    \u8BD5\u65B9\u6CD5\u5417\uFF1F\u8C22\u8C22\u3002"
  created_at: 2023-08-09 06:59:34+00:00
  edited: false
  hidden: false
  id: 64d34766db0b63b977c3e337
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/53c9a23324151a240e4156e35b33c34d.svg
      fullname: Guangxiao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: linuxonly801
      type: user
    createdAt: '2023-08-10T07:10:40.000Z'
    data:
      edited: false
      editors:
      - linuxonly801
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9168534278869629
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/53c9a23324151a240e4156e35b33c34d.svg
          fullname: Guangxiao
          isHf: false
          isPro: false
          name: linuxonly801
          type: user
        html: "<p>\u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\u4E2A13b-chat\u6A21\
          \u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\u5C11\u5462\uFF1F\
          2K\u8FD8\u662F4K\uFF1F</p>\n"
        raw: "\u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\u4E2A13b-chat\u6A21\
          \u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\u5C11\u5462\uFF1F\
          2K\u8FD8\u662F4K\uFF1F"
        updatedAt: '2023-08-10T07:10:40.644Z'
      numEdits: 0
      reactions: []
    id: 64d48d7038d3d4a505b1ee0b
    type: comment
  author: linuxonly801
  content: "\u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\u4E2A13b-chat\u6A21\
    \u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\u5C11\u5462\uFF1F2K\u8FD8\
    \u662F4K\uFF1F"
  created_at: 2023-08-10 06:10:40+00:00
  edited: false
  hidden: false
  id: 64d48d7038d3d4a505b1ee0b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-08-10T08:04:27.000Z'
    data:
      edited: false
      editors:
      - i4never
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9856963753700256
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
          fullname: FC
          isHf: false
          isPro: false
          name: i4never
          type: user
        html: "<blockquote>\n<p>\u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\
          \u4E2A13b-chat\u6A21\u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\
          \u5C11\u5462\uFF1F2K\u8FD8\u662F4K\uFF1F</p>\n</blockquote>\n<p>\u6211\u4EEC\
          \u7684\u8BAD\u7EC3\u6570\u636E\u957F\u5EA6\u662F2K\uFF0C\u4F46\u662F\u7531\
          \u4E8ERoPE\u6709\u5916\u63A8\u6027\uFF0C\u6240\u4EE5\u5B9E\u9645\u63A8\u7406\
          \u65F6\u5019\u53EF\u4EE5\u5B9E\u9645\u573A\u666F\u548C\u663E\u5B58\u60C5\
          \u51B5\u6765\u3002\u6A21\u578B\u89C1\u8FC7\u7684\u6570\u636E\u90FD\u662F\
          \u57282k\u4EE5\u5185\uFF0C\u957F\u4E8E2k\u7684\u6548\u679C\u5EFA\u8BAE\u5B9E\
          \u9645\u6D4B\u8BD5\u4E00\u4E0B\u3002</p>\n"
        raw: "> \u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\u4E2A13b-chat\u6A21\
          \u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\u5C11\u5462\uFF1F\
          2K\u8FD8\u662F4K\uFF1F\n\n\u6211\u4EEC\u7684\u8BAD\u7EC3\u6570\u636E\u957F\
          \u5EA6\u662F2K\uFF0C\u4F46\u662F\u7531\u4E8ERoPE\u6709\u5916\u63A8\u6027\
          \uFF0C\u6240\u4EE5\u5B9E\u9645\u63A8\u7406\u65F6\u5019\u53EF\u4EE5\u5B9E\
          \u9645\u573A\u666F\u548C\u663E\u5B58\u60C5\u51B5\u6765\u3002\u6A21\u578B\
          \u89C1\u8FC7\u7684\u6570\u636E\u90FD\u662F\u57282k\u4EE5\u5185\uFF0C\u957F\
          \u4E8E2k\u7684\u6548\u679C\u5EFA\u8BAE\u5B9E\u9645\u6D4B\u8BD5\u4E00\u4E0B\
          \u3002"
        updatedAt: '2023-08-10T08:04:27.920Z'
      numEdits: 0
      reactions: []
    id: 64d49a0b5af0d234b5007c2a
    type: comment
  author: i4never
  content: "> \u6211\u597D\u5947\u60F3\u95EE\u4E00\u4E0B\uFF0C\u8FD9\u4E2A13b-chat\u6A21\
    \u578B\u7684\u4E0A\u4E0B\u6587\u957F\u5EA6\u662F\u591A\u5C11\u5462\uFF1F2K\u8FD8\
    \u662F4K\uFF1F\n\n\u6211\u4EEC\u7684\u8BAD\u7EC3\u6570\u636E\u957F\u5EA6\u662F\
    2K\uFF0C\u4F46\u662F\u7531\u4E8ERoPE\u6709\u5916\u63A8\u6027\uFF0C\u6240\u4EE5\
    \u5B9E\u9645\u63A8\u7406\u65F6\u5019\u53EF\u4EE5\u5B9E\u9645\u573A\u666F\u548C\
    \u663E\u5B58\u60C5\u51B5\u6765\u3002\u6A21\u578B\u89C1\u8FC7\u7684\u6570\u636E\
    \u90FD\u662F\u57282k\u4EE5\u5185\uFF0C\u957F\u4E8E2k\u7684\u6548\u679C\u5EFA\u8BAE\
    \u5B9E\u9645\u6D4B\u8BD5\u4E00\u4E0B\u3002"
  created_at: 2023-08-10 07:04:27+00:00
  edited: false
  hidden: false
  id: 64d49a0b5af0d234b5007c2a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/0225546cb41ceeb696e8c8f967a742a1.svg
      fullname: FC
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: i4never
      type: user
    createdAt: '2023-09-22T09:49:56.000Z'
    data:
      status: closed
    id: 650d63445b868581f9533d17
    type: status-change
  author: i4never
  created_at: 2023-09-22 08:49:56+00:00
  id: 650d63445b868581f9533d17
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: TigerResearch/tigerbot-13b-chat-v1
repo_type: model
status: closed
target_branch: null
title: "\u57FA\u4E8Ellama2\u8BAD\u7EC3\u7684\u6A21\u578B\uFF0C\u4F60\u4EEC\u6709\u4E00\
  \u4E2Abug\u5E76\u6CA1\u6709\u4FEE\u590D"
