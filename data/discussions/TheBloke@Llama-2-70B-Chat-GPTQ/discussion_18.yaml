!!python/object:huggingface_hub.community.DiscussionWithDetails
author: alejandrofdz
conflicting_files: null
created_at: 2023-07-24 09:50:49+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/db55694015cfdeaf3381428978e9bf76.svg
      fullname: "Alejandro Fern\xE1ndez Llorente"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alejandrofdz
      type: user
    createdAt: '2023-07-24T10:50:49.000Z'
    data:
      edited: false
      editors:
      - alejandrofdz
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8984581828117371
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/db55694015cfdeaf3381428978e9bf76.svg
          fullname: "Alejandro Fern\xE1ndez Llorente"
          isHf: false
          isPro: false
          name: alejandrofdz
          type: user
        html: "<p>HI everyone, thanks <span data-props=\"{&quot;user&quot;:&quot;TheBloke&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/TheBloke\"\
          >@<span class=\"underline\">TheBloke</span></a></span>\n\n\t</span></span>\
          \ for your great job.</p>\n<p>Im trying to inference with TheBloke/Llama-2-70B-chat-GPTQ\
          \ and I get the next error:</p>\n<p>out = out + self.bias if self.bias is\
          \ not None else out<br>RuntimeError: The size of tensor a (24576) must match\
          \ the size of tensor b (10240) at non-singleton dimension 2</p>\n<p>At first\
          \ I thought it was an installation problema but my code works with TheBloke/Llama-2-13B-chat-GPTQ...\
          \ It occurs also with FreeWilly2, maybe beacuse its based on Llama-2-70B.</p>\n\
          <p>Any help will be appreciated.</p>\n"
        raw: "HI everyone, thanks @TheBloke for your great job.\r\n\r\nIm trying to\
          \ inference with TheBloke/Llama-2-70B-chat-GPTQ and I get the next error:\r\
          \n\r\nout = out + self.bias if self.bias is not None else out\r\nRuntimeError:\
          \ The size of tensor a (24576) must match the size of tensor b (10240) at\
          \ non-singleton dimension 2\r\n\r\nAt first I thought it was an installation\
          \ problema but my code works with TheBloke/Llama-2-13B-chat-GPTQ... It occurs\
          \ also with FreeWilly2, maybe beacuse its based on Llama-2-70B.\r\n\r\n\
          Any help will be appreciated."
        updatedAt: '2023-07-24T10:50:49.748Z'
      numEdits: 0
      reactions: []
    id: 64be578976a6e2efccc31cd0
    type: comment
  author: alejandrofdz
  content: "HI everyone, thanks @TheBloke for your great job.\r\n\r\nIm trying to\
    \ inference with TheBloke/Llama-2-70B-chat-GPTQ and I get the next error:\r\n\r\
    \nout = out + self.bias if self.bias is not None else out\r\nRuntimeError: The\
    \ size of tensor a (24576) must match the size of tensor b (10240) at non-singleton\
    \ dimension 2\r\n\r\nAt first I thought it was an installation problema but my\
    \ code works with TheBloke/Llama-2-13B-chat-GPTQ... It occurs also with FreeWilly2,\
    \ maybe beacuse its based on Llama-2-70B.\r\n\r\nAny help will be appreciated."
  created_at: 2023-07-24 09:50:49+00:00
  edited: false
  hidden: false
  id: 64be578976a6e2efccc31cd0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-07-25T10:54:00.000Z'
    data:
      edited: false
      editors:
      - TheBloke
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.927009642124176
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
          fullname: Tom Jobbins
          isHf: false
          isPro: true
          name: TheBloke
          type: user
        html: '<p>Can you check the sha256sum of the .safetensors file, or just  try
          downloading the model again. The download may have terminated early, giving
          you an invalid file</p>

          <p>Also please confirm you''re using Transformers 4.31.0 which is required
          for 70B.</p>

          '
        raw: 'Can you check the sha256sum of the .safetensors file, or just  try downloading
          the model again. The download may have terminated early, giving you an invalid
          file


          Also please confirm you''re using Transformers 4.31.0 which is required
          for 70B.


          '
        updatedAt: '2023-07-25T10:54:00.612Z'
      numEdits: 0
      reactions: []
    id: 64bfa9c8565b827f7ef74e5e
    type: comment
  author: TheBloke
  content: 'Can you check the sha256sum of the .safetensors file, or just  try downloading
    the model again. The download may have terminated early, giving you an invalid
    file


    Also please confirm you''re using Transformers 4.31.0 which is required for 70B.


    '
  created_at: 2023-07-25 09:54:00+00:00
  edited: false
  hidden: false
  id: 64bfa9c8565b827f7ef74e5e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/db55694015cfdeaf3381428978e9bf76.svg
      fullname: "Alejandro Fern\xE1ndez Llorente"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alejandrofdz
      type: user
    createdAt: '2023-07-25T12:07:49.000Z'
    data:
      edited: false
      editors:
      - alejandrofdz
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9852807521820068
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/db55694015cfdeaf3381428978e9bf76.svg
          fullname: "Alejandro Fern\xE1ndez Llorente"
          isHf: false
          isPro: false
          name: alejandrofdz
          type: user
        html: "<p>Thank you so much <span data-props=\"{&quot;user&quot;:&quot;TheBloke&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/TheBloke\"\
          >@<span class=\"underline\">TheBloke</span></a></span>\n\n\t</span></span>\
          \ ! It was transformers version I thought I had the newest!</p>\n<p>Regards!</p>\n"
        raw: 'Thank you so much @TheBloke ! It was transformers version I thought
          I had the newest!


          Regards!'
        updatedAt: '2023-07-25T12:07:49.429Z'
      numEdits: 0
      reactions: []
    id: 64bfbb153e52e42dfdc42729
    type: comment
  author: alejandrofdz
  content: 'Thank you so much @TheBloke ! It was transformers version I thought I
    had the newest!


    Regards!'
  created_at: 2023-07-25 11:07:49+00:00
  edited: false
  hidden: false
  id: 64bfbb153e52e42dfdc42729
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
      fullname: Duong Tri Dung
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: tridungduong16
      type: user
    createdAt: '2023-07-27T11:02:13.000Z'
    data:
      edited: false
      editors:
      - tridungduong16
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8941327333450317
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
          fullname: Duong Tri Dung
          isHf: false
          isPro: false
          name: tridungduong16
          type: user
        html: '<p>I face the similar problem when fine-tuning with AutoGPTQ. Does
          you solve the problems?</p>

          '
        raw: I face the similar problem when fine-tuning with AutoGPTQ. Does you solve
          the problems?
        updatedAt: '2023-07-27T11:02:13.598Z'
      numEdits: 0
      reactions: []
    id: 64c24eb5d94bf805a3cff407
    type: comment
  author: tridungduong16
  content: I face the similar problem when fine-tuning with AutoGPTQ. Does you solve
    the problems?
  created_at: 2023-07-27 10:02:13+00:00
  edited: false
  hidden: false
  id: 64c24eb5d94bf805a3cff407
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-07-27T11:09:28.000Z'
    data:
      edited: false
      editors:
      - TheBloke
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5476508140563965
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
          fullname: Tom Jobbins
          isHf: false
          isPro: true
          name: TheBloke
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;tridungduong16&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/tridungduong16\"\
          >@<span class=\"underline\">tridungduong16</span></a></span>\n\n\t</span></span>\
          \ make sure you're using AutoGPTQ 0.3.2 + Transformers 4.31.0 </p>\n"
        raw: '@tridungduong16 make sure you''re using AutoGPTQ 0.3.2 + Transformers
          4.31.0 '
        updatedAt: '2023-07-27T11:09:28.712Z'
      numEdits: 0
      reactions: []
    id: 64c2506818378b63f7173b0d
    type: comment
  author: TheBloke
  content: '@tridungduong16 make sure you''re using AutoGPTQ 0.3.2 + Transformers
    4.31.0 '
  created_at: 2023-07-27 10:09:28+00:00
  edited: false
  hidden: false
  id: 64c2506818378b63f7173b0d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
      fullname: Duong Tri Dung
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: tridungduong16
      type: user
    createdAt: '2023-07-27T12:15:44.000Z'
    data:
      edited: false
      editors:
      - tridungduong16
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6262707710266113
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
          fullname: Duong Tri Dung
          isHf: false
          isPro: false
          name: tridungduong16
          type: user
        html: '<p>I''ve already used the latest version of Transformers indeed.</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/CIGMDPU_6ggVdik8Iz0Pr.png"><img
          alt="Screenshot 2023-07-27 at 10.15.00 pm.png" src="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/CIGMDPU_6ggVdik8Iz0Pr.png"></a></p>

          '
        raw: 'I''ve already used the latest version of Transformers indeed.


          ![Screenshot 2023-07-27 at 10.15.00 pm.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/CIGMDPU_6ggVdik8Iz0Pr.png)

          '
        updatedAt: '2023-07-27T12:15:44.598Z'
      numEdits: 0
      reactions: []
    id: 64c25ff0cb3d48f66cf83fee
    type: comment
  author: tridungduong16
  content: 'I''ve already used the latest version of Transformers indeed.


    ![Screenshot 2023-07-27 at 10.15.00 pm.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/CIGMDPU_6ggVdik8Iz0Pr.png)

    '
  created_at: 2023-07-27 11:15:44+00:00
  edited: false
  hidden: false
  id: 64c25ff0cb3d48f66cf83fee
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
      fullname: Duong Tri Dung
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: tridungduong16
      type: user
    createdAt: '2023-07-27T12:17:21.000Z'
    data:
      edited: true
      editors:
      - tridungduong16
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.47130346298217773
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
          fullname: Duong Tri Dung
          isHf: false
          isPro: false
          name: tridungduong16
          type: user
        html: '<p>Same for 4.31.0</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/ZstTKaJOmKZXBSlrctZdN.png"><img
          alt="Screenshot 2023-07-27 at 10.17.06 pm.png" src="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/ZstTKaJOmKZXBSlrctZdN.png"></a></p>

          '
        raw: 'Same for 4.31.0


          ![Screenshot 2023-07-27 at 10.17.06 pm.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/ZstTKaJOmKZXBSlrctZdN.png)


          '
        updatedAt: '2023-07-27T12:17:48.052Z'
      numEdits: 1
      reactions: []
    id: 64c260515f9e98008d4988ad
    type: comment
  author: tridungduong16
  content: 'Same for 4.31.0


    ![Screenshot 2023-07-27 at 10.17.06 pm.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/ZstTKaJOmKZXBSlrctZdN.png)


    '
  created_at: 2023-07-27 11:17:21+00:00
  edited: true
  hidden: false
  id: 64c260515f9e98008d4988ad
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-07-27T13:51:55.000Z'
    data:
      edited: false
      editors:
      - TheBloke
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9226529002189636
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
          fullname: Tom Jobbins
          isHf: false
          isPro: true
          name: TheBloke
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;tridungduong16&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/tridungduong16\"\
          >@<span class=\"underline\">tridungduong16</span></a></span>\n\n\t</span></span>\
          \ I'm confused, you said you had a problem with AutoGPTQ but your error\
          \ screenshot show ExLlama, not AutoGPTQ?  </p>\n<p>If you're using ExLlama\
          \ then please make sure ExLlama is updated to the latest version.  This\
          \ model definitely works with ExLlama, so you might have an older version\
          \ that doesn't support 70B.</p>\n"
        raw: "@tridungduong16 I'm confused, you said you had a problem with AutoGPTQ\
          \ but your error screenshot show ExLlama, not AutoGPTQ?  \n\nIf you're using\
          \ ExLlama then please make sure ExLlama is updated to the latest version.\
          \  This model definitely works with ExLlama, so you might have an older\
          \ version that doesn't support 70B."
        updatedAt: '2023-07-27T13:51:55.110Z'
      numEdits: 0
      reactions: []
    id: 64c2767b8e10666f81d18820
    type: comment
  author: TheBloke
  content: "@tridungduong16 I'm confused, you said you had a problem with AutoGPTQ\
    \ but your error screenshot show ExLlama, not AutoGPTQ?  \n\nIf you're using ExLlama\
    \ then please make sure ExLlama is updated to the latest version.  This model\
    \ definitely works with ExLlama, so you might have an older version that doesn't\
    \ support 70B."
  created_at: 2023-07-27 12:51:55+00:00
  edited: false
  hidden: false
  id: 64c2767b8e10666f81d18820
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
      fullname: Duong Tri Dung
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: tridungduong16
      type: user
    createdAt: '2023-07-27T22:25:39.000Z'
    data:
      edited: true
      editors:
      - tridungduong16
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6024620532989502
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/3GcYK4RXljPSjBUgQEArL.png?w=200&h=200&f=face
          fullname: Duong Tri Dung
          isHf: false
          isPro: false
          name: tridungduong16
          type: user
        html: '<p>Sorry, I have the wrong screenshot. I use the fine-tune scripts
          from <a rel="nofollow" href="https://github.com/PanQiWei/AutoGPTQ/blob/main/examples/peft/peft_lora_clm_instruction_tuning.py">https://github.com/PanQiWei/AutoGPTQ/blob/main/examples/peft/peft_lora_clm_instruction_tuning.py</a>.
          </p>

          <p>It works well for 13B model such as:</p>

          <ul>

          <li><a href="https://huggingface.co/TheBloke/Llama-2-13B-GPTQ">https://huggingface.co/TheBloke/Llama-2-13B-GPTQ</a></li>

          <li><a href="https://huggingface.co/TheBloke/OpenAssistant-Llama2-13B-Orca-8K-3319-GGML">https://huggingface.co/TheBloke/OpenAssistant-Llama2-13B-Orca-8K-3319-GGML</a><br>but
          when I fine-tune with 70B model, there is some problems.</li>

          </ul>

          <p>Library version I use is:</p>

          <ul>

          <li>transformers.<strong>version</strong>  ''4.32.0.dev0''</li>

          <li>auto_gptq.<strong>version</strong>  ''0.3.2''</li>

          </ul>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/dZmOqXqItndF_D6WcVCCi.png"><img
          alt="Screenshot 2023-07-28 at 8.22.12 am.png" src="https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/dZmOqXqItndF_D6WcVCCi.png"></a></p>

          '
        raw: "Sorry, I have the wrong screenshot. I use the fine-tune scripts from\
          \ https://github.com/PanQiWei/AutoGPTQ/blob/main/examples/peft/peft_lora_clm_instruction_tuning.py.\
          \ \n\nIt works well for 13B model such as:\n- https://huggingface.co/TheBloke/Llama-2-13B-GPTQ\n\
          - https://huggingface.co/TheBloke/OpenAssistant-Llama2-13B-Orca-8K-3319-GGML\n\
          but when I fine-tune with 70B model, there is some problems.\n\n\nLibrary\
          \ version I use is:\n- transformers.__version__  '4.32.0.dev0'\n- auto_gptq.__version__\
          \  '0.3.2'\n\n\n![Screenshot 2023-07-28 at 8.22.12 am.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/dZmOqXqItndF_D6WcVCCi.png)\n"
        updatedAt: '2023-07-27T22:26:38.340Z'
      numEdits: 1
      reactions: []
    id: 64c2eee3d4ace3ce33059fb4
    type: comment
  author: tridungduong16
  content: "Sorry, I have the wrong screenshot. I use the fine-tune scripts from https://github.com/PanQiWei/AutoGPTQ/blob/main/examples/peft/peft_lora_clm_instruction_tuning.py.\
    \ \n\nIt works well for 13B model such as:\n- https://huggingface.co/TheBloke/Llama-2-13B-GPTQ\n\
    - https://huggingface.co/TheBloke/OpenAssistant-Llama2-13B-Orca-8K-3319-GGML\n\
    but when I fine-tune with 70B model, there is some problems.\n\n\nLibrary version\
    \ I use is:\n- transformers.__version__  '4.32.0.dev0'\n- auto_gptq.__version__\
    \  '0.3.2'\n\n\n![Screenshot 2023-07-28 at 8.22.12 am.png](https://cdn-uploads.huggingface.co/production/uploads/6454fa48b27940efcb944bb9/dZmOqXqItndF_D6WcVCCi.png)\n"
  created_at: 2023-07-27 21:25:39+00:00
  edited: true
  hidden: false
  id: 64c2eee3d4ace3ce33059fb4
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 18
repo_id: TheBloke/Llama-2-70B-Chat-GPTQ
repo_type: model
status: open
target_branch: null
title: Inference error, tensor shapes.
