!!python/object:huggingface_hub.community.DiscussionWithDetails
author: kshitijyad
conflicting_files: null
created_at: 2023-07-15 22:04:36+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f58ca5762e0ac06a6d5580b34ca32f1f.svg
      fullname: Kshitij
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kshitijyad
      type: user
    createdAt: '2023-07-15T23:04:36.000Z'
    data:
      edited: false
      editors:
      - kshitijyad
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.41164833307266235
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f58ca5762e0ac06a6d5580b34ca32f1f.svg
          fullname: Kshitij
          isHf: false
          isPro: false
          name: kshitijyad
          type: user
        html: '<p>Hi, can someone help me debug this?<br>I am trying to deploy wizard
          coder on Sagemaker using the recommended deploy code, I am getting the following
          error -</p>

          <p>[RuntimeError: found uninitialized parameters in model : [''transformer.h.0.attn.c_attn.weight'',
          ''transformer.h.0.attn.c_proj.weight'', ''transformer.h.0.mlp.c_fc.weight'',
          ''transformer.h.0.mlp.c_proj.weight'', ''transformer.h.1.attn.c_attn.weight'',
          ](RuntimeError: found uninitialized parameters in model : [''transformer.h.0.attn.c_attn.weight'',
          ''transformer.h.0.attn.c_proj.weight'', ''transformer.h.0.mlp.c_fc.weight'',
          ''transformer.h.0.mlp.c_proj.weight'', ''transformer.h.1.attn.c_attn.weight'',
          ''transformer.h.1.attn.c_proj.weight'', ''transformer.h.1.mlp.c_fc.weight'',
          ''transformer.h.1.mlp.c_proj.weight'', ''transformer.h.2.attn.c_attn.weight'',
          ''transformer.h.2.attn.c_proj.weight'', ''transformer.h.2.mlp.c_fc.weight'',
          ''transformer.h.2.mlp.c_proj.weight'', ''transformer.h.3.attn.c_attn.weight'',
          ''transformer.h.3.attn.c_proj.weight'', ''transformer.h.3.mlp.c_fc.weight'',
          ''transformer.h.3.mlp.c_proj.weight''........</p>

          <p>Recommended Deploy code -</p>

          <p>import json<br>import sagemaker<br>import boto3<br>from sagemaker.huggingface
          import HuggingFaceModel, get_huggingface_llm_image_uri</p>

          <p>try:<br>role = sagemaker.get_execution_role()<br>except ValueError:<br>iam
          = boto3.client(''iam'')<br>role = iam.get_role(RoleName=''sagemaker_execution_role'')[''Role''][''Arn'']</p>

          <p>Hub Model configuration. <a href="https://huggingface.co/models">https://huggingface.co/models</a><br>hub
          = {<br>''HF_MODEL_ID'':''TheBloke/WizardCoder-15B-1.0-GPTQ'',<br>''SM_NUM_GPUS'':
          json.dumps(1)<br>}</p>

          <p>create Hugging Face Model Class<br>huggingface_model = HuggingFaceModel(<br>image_uri=get_huggingface_llm_image_uri("huggingface",version="0.8.2"),<br>env=hub,<br>role=role,<br>)</p>

          <p>deploy model to SageMaker Inference<br>predictor = huggingface_model.deploy(<br>initial_instance_count=1,<br>instance_type="ml.g5.2xlarge",<br>container_startup_health_check_timeout=300,<br>)</p>

          <p>send request<br>predictor.predict({<br>"inputs": "My name is Julien and
          I like to",<br>})</p>

          '
        raw: "\r\nHi, can someone help me debug this?\r\nI am trying to deploy wizard\
          \ coder on Sagemaker using the recommended deploy code, I am getting the\
          \ following error -\r\n\r\n[RuntimeError: found uninitialized parameters\
          \ in model : ['transformer.h.0.attn.c_attn.weight', 'transformer.h.0.attn.c_proj.weight',\
          \ 'transformer.h.0.mlp.c_fc.weight', 'transformer.h.0.mlp.c_proj.weight',\
          \ 'transformer.h.1.attn.c_attn.weight', ](RuntimeError: found uninitialized\
          \ parameters in model : ['transformer.h.0.attn.c_attn.weight', 'transformer.h.0.attn.c_proj.weight',\
          \ 'transformer.h.0.mlp.c_fc.weight', 'transformer.h.0.mlp.c_proj.weight',\
          \ 'transformer.h.1.attn.c_attn.weight', 'transformer.h.1.attn.c_proj.weight',\
          \ 'transformer.h.1.mlp.c_fc.weight', 'transformer.h.1.mlp.c_proj.weight',\
          \ 'transformer.h.2.attn.c_attn.weight', 'transformer.h.2.attn.c_proj.weight',\
          \ 'transformer.h.2.mlp.c_fc.weight', 'transformer.h.2.mlp.c_proj.weight',\
          \ 'transformer.h.3.attn.c_attn.weight', 'transformer.h.3.attn.c_proj.weight',\
          \ 'transformer.h.3.mlp.c_fc.weight', 'transformer.h.3.mlp.c_proj.weight'........\r\
          \n\r\nRecommended Deploy code -\r\n\r\nimport json\r\nimport sagemaker\r\
          \nimport boto3\r\nfrom sagemaker.huggingface import HuggingFaceModel, get_huggingface_llm_image_uri\r\
          \n\r\ntry:\r\nrole = sagemaker.get_execution_role()\r\nexcept ValueError:\r\
          \niam = boto3.client('iam')\r\nrole = iam.get_role(RoleName='sagemaker_execution_role')['Role']['Arn']\r\
          \n\r\nHub Model configuration. https://huggingface.co/models\r\nhub = {\r\
          \n'HF_MODEL_ID':'TheBloke/WizardCoder-15B-1.0-GPTQ',\r\n'SM_NUM_GPUS': json.dumps(1)\r\
          \n}\r\n\r\ncreate Hugging Face Model Class\r\nhuggingface_model = HuggingFaceModel(\r\
          \nimage_uri=get_huggingface_llm_image_uri(\"huggingface\",version=\"0.8.2\"\
          ),\r\nenv=hub,\r\nrole=role,\r\n)\r\n\r\ndeploy model to SageMaker Inference\r\
          \npredictor = huggingface_model.deploy(\r\ninitial_instance_count=1,\r\n\
          instance_type=\"ml.g5.2xlarge\",\r\ncontainer_startup_health_check_timeout=300,\r\
          \n)\r\n\r\nsend request\r\npredictor.predict({\r\n\"inputs\": \"My name\
          \ is Julien and I like to\",\r\n})"
        updatedAt: '2023-07-15T23:04:36.316Z'
      numEdits: 0
      reactions: []
    id: 64b32604727711e4eac55f41
    type: comment
  author: kshitijyad
  content: "\r\nHi, can someone help me debug this?\r\nI am trying to deploy wizard\
    \ coder on Sagemaker using the recommended deploy code, I am getting the following\
    \ error -\r\n\r\n[RuntimeError: found uninitialized parameters in model : ['transformer.h.0.attn.c_attn.weight',\
    \ 'transformer.h.0.attn.c_proj.weight', 'transformer.h.0.mlp.c_fc.weight', 'transformer.h.0.mlp.c_proj.weight',\
    \ 'transformer.h.1.attn.c_attn.weight', ](RuntimeError: found uninitialized parameters\
    \ in model : ['transformer.h.0.attn.c_attn.weight', 'transformer.h.0.attn.c_proj.weight',\
    \ 'transformer.h.0.mlp.c_fc.weight', 'transformer.h.0.mlp.c_proj.weight', 'transformer.h.1.attn.c_attn.weight',\
    \ 'transformer.h.1.attn.c_proj.weight', 'transformer.h.1.mlp.c_fc.weight', 'transformer.h.1.mlp.c_proj.weight',\
    \ 'transformer.h.2.attn.c_attn.weight', 'transformer.h.2.attn.c_proj.weight',\
    \ 'transformer.h.2.mlp.c_fc.weight', 'transformer.h.2.mlp.c_proj.weight', 'transformer.h.3.attn.c_attn.weight',\
    \ 'transformer.h.3.attn.c_proj.weight', 'transformer.h.3.mlp.c_fc.weight', 'transformer.h.3.mlp.c_proj.weight'........\r\
    \n\r\nRecommended Deploy code -\r\n\r\nimport json\r\nimport sagemaker\r\nimport\
    \ boto3\r\nfrom sagemaker.huggingface import HuggingFaceModel, get_huggingface_llm_image_uri\r\
    \n\r\ntry:\r\nrole = sagemaker.get_execution_role()\r\nexcept ValueError:\r\n\
    iam = boto3.client('iam')\r\nrole = iam.get_role(RoleName='sagemaker_execution_role')['Role']['Arn']\r\
    \n\r\nHub Model configuration. https://huggingface.co/models\r\nhub = {\r\n'HF_MODEL_ID':'TheBloke/WizardCoder-15B-1.0-GPTQ',\r\
    \n'SM_NUM_GPUS': json.dumps(1)\r\n}\r\n\r\ncreate Hugging Face Model Class\r\n\
    huggingface_model = HuggingFaceModel(\r\nimage_uri=get_huggingface_llm_image_uri(\"\
    huggingface\",version=\"0.8.2\"),\r\nenv=hub,\r\nrole=role,\r\n)\r\n\r\ndeploy\
    \ model to SageMaker Inference\r\npredictor = huggingface_model.deploy(\r\ninitial_instance_count=1,\r\
    \ninstance_type=\"ml.g5.2xlarge\",\r\ncontainer_startup_health_check_timeout=300,\r\
    \n)\r\n\r\nsend request\r\npredictor.predict({\r\n\"inputs\": \"My name is Julien\
    \ and I like to\",\r\n})"
  created_at: 2023-07-15 22:04:36+00:00
  edited: false
  hidden: false
  id: 64b32604727711e4eac55f41
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1cdd6f0f8d7c324bf0bae86dedd4cfaf.svg
      fullname: Zak KRider
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zkrider
      type: user
    createdAt: '2023-08-03T20:39:23.000Z'
    data:
      edited: false
      editors:
      - zkrider
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.37598294019699097
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1cdd6f0f8d7c324bf0bae86dedd4cfaf.svg
          fullname: Zak KRider
          isHf: false
          isPro: false
          name: zkrider
          type: user
        html: '<p>You need to specify the HF token like this:<br>hub = {<br>    ''HF_MODEL_ID'':''WizardLM/WizardCoder-15B-V1.0'',<br>    ''SM_NUM_GPUS'':  "4",<br>    ''HF_API_TOKEN'':
          ''''<br>}</p>

          <p>Also, you will need to run a bigger instance like a ml.g4dn.12xlarge</p>

          '
        raw: "You need to specify the HF token like this:\nhub = {\n\t'HF_MODEL_ID':'WizardLM/WizardCoder-15B-V1.0',\n\
          \t'SM_NUM_GPUS':  \"4\",\n    'HF_API_TOKEN': '<TOKEN>'\n}\n\nAlso, you\
          \ will need to run a bigger instance like a ml.g4dn.12xlarge\n"
        updatedAt: '2023-08-03T20:39:23.515Z'
      numEdits: 0
      reactions: []
    id: 64cc107b40ce646cc7f07f1b
    type: comment
  author: zkrider
  content: "You need to specify the HF token like this:\nhub = {\n\t'HF_MODEL_ID':'WizardLM/WizardCoder-15B-V1.0',\n\
    \t'SM_NUM_GPUS':  \"4\",\n    'HF_API_TOKEN': '<TOKEN>'\n}\n\nAlso, you will need\
    \ to run a bigger instance like a ml.g4dn.12xlarge\n"
  created_at: 2023-08-03 19:39:23+00:00
  edited: false
  hidden: false
  id: 64cc107b40ce646cc7f07f1b
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 18
repo_id: WizardLM/WizardCoder-15B-V1.0
repo_type: model
status: open
target_branch: null
title: Runtime error while deploying on Sagemaker
