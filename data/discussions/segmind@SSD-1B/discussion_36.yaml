!!python/object:huggingface_hub.community.DiscussionWithDetails
author: shunsso
conflicting_files: null
created_at: 2023-12-10 03:25:59+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/565bfc33509bc44cc1f339a6f6fe8059.svg
      fullname: almya
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: shunsso
      type: user
    createdAt: '2023-12-10T03:25:59.000Z'
    data:
      edited: false
      editors:
      - shunsso
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3542936444282532
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/565bfc33509bc44cc1f339a6f6fe8059.svg
          fullname: almya
          isHf: false
          isPro: false
          name: shunsso
          type: user
        html: '<p>Traceback (most recent call last):<br>  File "/content/kohya_ss/./train_network.py",
          line 1012, in <br>    trainer.train(args)<br>  File "/content/kohya_ss/./train_network.py",
          line 228, in train<br>    model_version, text_encoder, vae, unet = self.load_target_model(args,
          weight_dtype, accelerator)<br>  File "/content/kohya_ss/./train_network.py",
          line 102, in load_target_model<br>    text_encoder, vae, unet, _ = train_util.load_target_model(args,
          weight_dtype, accelerator)<br>  File "/content/kohya_ss/library/train_util.py",
          line 3917, in load_target_model<br>    text_encoder, vae, unet, load_stable_diffusion_format
          = _load_target_model(<br>  File "/content/kohya_ss/library/train_util.py",
          line 3867, in _load_target_model<br>    pipe = StableDiffusionPipeline.from_pretrained(name_or_path,
          tokenizer=None, safety_checker=None)<br>  File "/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py",
          line 1105, in from_pretrained<br>    loaded_sub_model = load_sub_model(<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py",
          line 472, in load_sub_model<br>    loaded_sub_model = load_method(os.path.join(cached_folder,
          name), **loading_kwargs)<br>  File "/usr/local/lib/python3.10/dist-packages/diffusers/models/modeling_utils.py",
          line 636, in from_pretrained<br>    model = cls.from_config(config, **unused_kwargs)<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py",
          line 254, in from_config<br>    model = cls(**init_dict)<br>  File "/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py",
          line 636, in inner_init<br>    init(self, *args, **init_kwargs)<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_condition.py",
          line 440, in <strong>init</strong><br>    down_block = get_down_block(<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py",
          line 119, in get_down_block<br>    return CrossAttnDownBlock2D(<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py",
          line 1001, in <strong>init</strong><br>    Transformer2DModel(<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py",
          line 636, in inner_init<br>    init(self, *args, **init_kwargs)<br>  File
          "/usr/local/lib/python3.10/dist-packages/diffusers/models/transformer_2d.py",
          line 191, in <strong>init</strong><br>    for d in range(num_layers)<br>TypeError:
          ''list'' object cannot be interpreted as an integer<br>Traceback (most recent
          call last):<br>  File "/usr/local/bin/accelerate", line 8, in <br>    sys.exit(main())<br>  File
          "/usr/local/lib/python3.10/dist-packages/accelerate/commands/accelerate_cli.py",
          line 47, in main<br>    args.func(args)<br>  File "/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py",
          line 986, in launch_command<br>    simple_launcher(args)<br>  File "/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py",
          line 628, in simple_launcher<br>    raise subprocess.CalledProcessError(returncode=process.returncode,
          cmd=cmd)<br>subprocess.CalledProcessError: Command ''[''/usr/bin/python3'',
          ''./train_network.py'', ''--enable_bucket'', ''--min_bucket_reso=256'',
          ''--max_bucket_reso=2048'', ''--pretrained_model_name_or_path=segmind/SSD-1B'',
          ''--train_data_dir=/content/drive/MyDrive/AI/img'', ''--resolution=512,512'',
          ''--output_dir=/content/drive/MyDrive/AI/model'', ''--network_alpha=8'',
          ''--save_model_as=safetensors'', ''--network_module=networks.lora'', ''--text_encoder_lr=5e-05'',
          ''--unet_lr=0.0001'', ''--network_dim=8'', ''--output_name=ssd1b'', ''--lr_scheduler_num_cycles=1'',
          ''--no_half_vae'', ''--learning_rate=0.0001'', ''--lr_scheduler=cosine'',
          ''--train_batch_size=1'', ''--max_train_steps=5000'', ''--save_every_n_epochs=1'',
          ''--mixed_precision=fp16'', ''--save_precision=fp16'', ''--caption_extension=.txt'',
          ''--optimizer_type=AdamW8bit'', ''--max_data_loader_n_workers=0'', ''--bucket_reso_steps=64'',
          ''--mem_eff_attn'', ''--gradient_checkpointing'', ''--bucket_no_upscale'',
          ''--noise_offset=0.0'']'' returned non-zero exit status 1.</p>

          '
        raw: "Traceback (most recent call last):\r\n  File \"/content/kohya_ss/./train_network.py\"\
          , line 1012, in <module>\r\n    trainer.train(args)\r\n  File \"/content/kohya_ss/./train_network.py\"\
          , line 228, in train\r\n    model_version, text_encoder, vae, unet = self.load_target_model(args,\
          \ weight_dtype, accelerator)\r\n  File \"/content/kohya_ss/./train_network.py\"\
          , line 102, in load_target_model\r\n    text_encoder, vae, unet, _ = train_util.load_target_model(args,\
          \ weight_dtype, accelerator)\r\n  File \"/content/kohya_ss/library/train_util.py\"\
          , line 3917, in load_target_model\r\n    text_encoder, vae, unet, load_stable_diffusion_format\
          \ = _load_target_model(\r\n  File \"/content/kohya_ss/library/train_util.py\"\
          , line 3867, in _load_target_model\r\n    pipe = StableDiffusionPipeline.from_pretrained(name_or_path,\
          \ tokenizer=None, safety_checker=None)\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py\"\
          , line 1105, in from_pretrained\r\n    loaded_sub_model = load_sub_model(\r\
          \n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py\"\
          , line 472, in load_sub_model\r\n    loaded_sub_model = load_method(os.path.join(cached_folder,\
          \ name), **loading_kwargs)\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/models/modeling_utils.py\"\
          , line 636, in from_pretrained\r\n    model = cls.from_config(config, **unused_kwargs)\r\
          \n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
          , line 254, in from_config\r\n    model = cls(**init_dict)\r\n  File \"\
          /usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
          , line 636, in inner_init\r\n    init(self, *args, **init_kwargs)\r\n  File\
          \ \"/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_condition.py\"\
          , line 440, in __init__\r\n    down_block = get_down_block(\r\n  File \"\
          /usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py\"\
          , line 119, in get_down_block\r\n    return CrossAttnDownBlock2D(\r\n  File\
          \ \"/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py\"\
          , line 1001, in __init__\r\n    Transformer2DModel(\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
          , line 636, in inner_init\r\n    init(self, *args, **init_kwargs)\r\n  File\
          \ \"/usr/local/lib/python3.10/dist-packages/diffusers/models/transformer_2d.py\"\
          , line 191, in __init__\r\n    for d in range(num_layers)\r\nTypeError:\
          \ 'list' object cannot be interpreted as an integer\r\nTraceback (most recent\
          \ call last):\r\n  File \"/usr/local/bin/accelerate\", line 8, in <module>\r\
          \n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.10/dist-packages/accelerate/commands/accelerate_cli.py\"\
          , line 47, in main\r\n    args.func(args)\r\n  File \"/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py\"\
          , line 986, in launch_command\r\n    simple_launcher(args)\r\n  File \"\
          /usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py\"\
          , line 628, in simple_launcher\r\n    raise subprocess.CalledProcessError(returncode=process.returncode,\
          \ cmd=cmd)\r\nsubprocess.CalledProcessError: Command '['/usr/bin/python3',\
          \ './train_network.py', '--enable_bucket', '--min_bucket_reso=256', '--max_bucket_reso=2048',\
          \ '--pretrained_model_name_or_path=segmind/SSD-1B', '--train_data_dir=/content/drive/MyDrive/AI/img',\
          \ '--resolution=512,512', '--output_dir=/content/drive/MyDrive/AI/model',\
          \ '--network_alpha=8', '--save_model_as=safetensors', '--network_module=networks.lora',\
          \ '--text_encoder_lr=5e-05', '--unet_lr=0.0001', '--network_dim=8', '--output_name=ssd1b',\
          \ '--lr_scheduler_num_cycles=1', '--no_half_vae', '--learning_rate=0.0001',\
          \ '--lr_scheduler=cosine', '--train_batch_size=1', '--max_train_steps=5000',\
          \ '--save_every_n_epochs=1', '--mixed_precision=fp16', '--save_precision=fp16',\
          \ '--caption_extension=.txt', '--optimizer_type=AdamW8bit', '--max_data_loader_n_workers=0',\
          \ '--bucket_reso_steps=64', '--mem_eff_attn', '--gradient_checkpointing',\
          \ '--bucket_no_upscale', '--noise_offset=0.0']' returned non-zero exit status\
          \ 1."
        updatedAt: '2023-12-10T03:25:59.432Z'
      numEdits: 0
      reactions: []
    id: 65752fc75f7efec0ae471f3f
    type: comment
  author: shunsso
  content: "Traceback (most recent call last):\r\n  File \"/content/kohya_ss/./train_network.py\"\
    , line 1012, in <module>\r\n    trainer.train(args)\r\n  File \"/content/kohya_ss/./train_network.py\"\
    , line 228, in train\r\n    model_version, text_encoder, vae, unet = self.load_target_model(args,\
    \ weight_dtype, accelerator)\r\n  File \"/content/kohya_ss/./train_network.py\"\
    , line 102, in load_target_model\r\n    text_encoder, vae, unet, _ = train_util.load_target_model(args,\
    \ weight_dtype, accelerator)\r\n  File \"/content/kohya_ss/library/train_util.py\"\
    , line 3917, in load_target_model\r\n    text_encoder, vae, unet, load_stable_diffusion_format\
    \ = _load_target_model(\r\n  File \"/content/kohya_ss/library/train_util.py\"\
    , line 3867, in _load_target_model\r\n    pipe = StableDiffusionPipeline.from_pretrained(name_or_path,\
    \ tokenizer=None, safety_checker=None)\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py\"\
    , line 1105, in from_pretrained\r\n    loaded_sub_model = load_sub_model(\r\n\
    \  File \"/usr/local/lib/python3.10/dist-packages/diffusers/pipelines/pipeline_utils.py\"\
    , line 472, in load_sub_model\r\n    loaded_sub_model = load_method(os.path.join(cached_folder,\
    \ name), **loading_kwargs)\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/models/modeling_utils.py\"\
    , line 636, in from_pretrained\r\n    model = cls.from_config(config, **unused_kwargs)\r\
    \n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
    , line 254, in from_config\r\n    model = cls(**init_dict)\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
    , line 636, in inner_init\r\n    init(self, *args, **init_kwargs)\r\n  File \"\
    /usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_condition.py\"\
    , line 440, in __init__\r\n    down_block = get_down_block(\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py\"\
    , line 119, in get_down_block\r\n    return CrossAttnDownBlock2D(\r\n  File \"\
    /usr/local/lib/python3.10/dist-packages/diffusers/models/unet_2d_blocks.py\",\
    \ line 1001, in __init__\r\n    Transformer2DModel(\r\n  File \"/usr/local/lib/python3.10/dist-packages/diffusers/configuration_utils.py\"\
    , line 636, in inner_init\r\n    init(self, *args, **init_kwargs)\r\n  File \"\
    /usr/local/lib/python3.10/dist-packages/diffusers/models/transformer_2d.py\",\
    \ line 191, in __init__\r\n    for d in range(num_layers)\r\nTypeError: 'list'\
    \ object cannot be interpreted as an integer\r\nTraceback (most recent call last):\r\
    \n  File \"/usr/local/bin/accelerate\", line 8, in <module>\r\n    sys.exit(main())\r\
    \n  File \"/usr/local/lib/python3.10/dist-packages/accelerate/commands/accelerate_cli.py\"\
    , line 47, in main\r\n    args.func(args)\r\n  File \"/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py\"\
    , line 986, in launch_command\r\n    simple_launcher(args)\r\n  File \"/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py\"\
    , line 628, in simple_launcher\r\n    raise subprocess.CalledProcessError(returncode=process.returncode,\
    \ cmd=cmd)\r\nsubprocess.CalledProcessError: Command '['/usr/bin/python3', './train_network.py',\
    \ '--enable_bucket', '--min_bucket_reso=256', '--max_bucket_reso=2048', '--pretrained_model_name_or_path=segmind/SSD-1B',\
    \ '--train_data_dir=/content/drive/MyDrive/AI/img', '--resolution=512,512', '--output_dir=/content/drive/MyDrive/AI/model',\
    \ '--network_alpha=8', '--save_model_as=safetensors', '--network_module=networks.lora',\
    \ '--text_encoder_lr=5e-05', '--unet_lr=0.0001', '--network_dim=8', '--output_name=ssd1b',\
    \ '--lr_scheduler_num_cycles=1', '--no_half_vae', '--learning_rate=0.0001', '--lr_scheduler=cosine',\
    \ '--train_batch_size=1', '--max_train_steps=5000', '--save_every_n_epochs=1',\
    \ '--mixed_precision=fp16', '--save_precision=fp16', '--caption_extension=.txt',\
    \ '--optimizer_type=AdamW8bit', '--max_data_loader_n_workers=0', '--bucket_reso_steps=64',\
    \ '--mem_eff_attn', '--gradient_checkpointing', '--bucket_no_upscale', '--noise_offset=0.0']'\
    \ returned non-zero exit status 1."
  created_at: 2023-12-10 03:25:59+00:00
  edited: false
  hidden: false
  id: 65752fc75f7efec0ae471f3f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/639362039694ec0d025f194d/jmQetjDK3ISH_IQb7SBGC.png?w=200&h=200&f=face
      fullname: Vishnu V Jaddipal
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: Icar
      type: user
    createdAt: '2023-12-10T09:06:26.000Z'
    data:
      edited: false
      editors:
      - Icar
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9686334729194641
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/639362039694ec0d025f194d/jmQetjDK3ISH_IQb7SBGC.png?w=200&h=200&f=face
          fullname: Vishnu V Jaddipal
          isHf: false
          isPro: false
          name: Icar
          type: user
        html: '<p>Kohya is not supported  AFAIK. There was a PR for support a while
          ago, I''m not sure of the status at the moment. You can train with diffusers.</p>

          '
        raw: Kohya is not supported  AFAIK. There was a PR for support a while ago,
          I'm not sure of the status at the moment. You can train with diffusers.
        updatedAt: '2023-12-10T09:06:26.167Z'
      numEdits: 0
      reactions: []
    id: 65757f9215b1ca184b0dccbe
    type: comment
  author: Icar
  content: Kohya is not supported  AFAIK. There was a PR for support a while ago,
    I'm not sure of the status at the moment. You can train with diffusers.
  created_at: 2023-12-10 09:06:26+00:00
  edited: false
  hidden: false
  id: 65757f9215b1ca184b0dccbe
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/565bfc33509bc44cc1f339a6f6fe8059.svg
      fullname: almya
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: shunsso
      type: user
    createdAt: '2023-12-10T23:55:38.000Z'
    data:
      edited: false
      editors:
      - shunsso
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.990790069103241
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/565bfc33509bc44cc1f339a6f6fe8059.svg
          fullname: almya
          isHf: false
          isPro: false
          name: shunsso
          type: user
        html: '<p>I also tried it, but it could not be trained due to running out
          of memory. Although I tried to improve it, it broke it in Colab. Do you
          have a ready-made notebook that I can use?</p>

          '
        raw: I also tried it, but it could not be trained due to running out of memory.
          Although I tried to improve it, it broke it in Colab. Do you have a ready-made
          notebook that I can use?
        updatedAt: '2023-12-10T23:55:38.955Z'
      numEdits: 0
      reactions: []
    id: 65764ffacacc1ee524b13a8f
    type: comment
  author: shunsso
  content: I also tried it, but it could not be trained due to running out of memory.
    Although I tried to improve it, it broke it in Colab. Do you have a ready-made
    notebook that I can use?
  created_at: 2023-12-10 23:55:38+00:00
  edited: false
  hidden: false
  id: 65764ffacacc1ee524b13a8f
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 36
repo_id: segmind/SSD-1B
repo_type: model
status: open
target_branch: null
title: not work in kohya_ss
