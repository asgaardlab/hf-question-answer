!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Illyap
conflicting_files: null
created_at: 2023-11-15 09:03:06+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f619bbfd8401d754a5a0ac0b01580481.svg
      fullname: Illya
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Illyap
      type: user
    createdAt: '2023-11-15T09:03:06.000Z'
    data:
      edited: false
      editors:
      - Illyap
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8349858522415161
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f619bbfd8401d754a5a0ac0b01580481.svg
          fullname: Illya
          isHf: false
          isPro: false
          name: Illyap
          type: user
        html: '<p>Hello Hugging Face Community,</p>

          <p>I am reaching out to seek your expertise regarding an issue I''m facing
          with the Salesforce/blip-image-captioning-large model via the Inference
          Endpoints.</p>

          <p>Here''s a detailed outline of the problem:</p>

          <ul>

          <li><p><strong>Interface API Functionality:</strong> When using the Interface
          API, the process is smooth. I can send an image URL using <code>json={"inputs":
          image_url}</code>, and it returns the expected caption without the need
          to download the image.</p>

          </li>

          <li><p><strong>Inference Endpoint Issue:</strong> However, the same success
          is not replicated when I switch to using the Inference Endpoints. Regardless
          of whether I send the image URL directly or download the image and send
          it, I encounter the following error: <code>{"error": "You have to specify
          either input_ids or inputs_embeds or encoder_embeds"}</code>. This error
          persists and prevents the endpoint from generating the expected caption.</p>

          </li>

          <li><p><strong>Endpoint Testing Failure:</strong> To further investigate,
          I utilized the ''Test your endpoint!'' feature within the Hugging Face platform
          by dragging and dropping an image directly. Unfortunately, this also resulted
          in the same error message.</p>

          </li>

          </ul>

          <p>The crux of the problem seems to be related to the expected request structure
          for the Inference Endpoint, which differs from the Interface API. The error
          suggests that the endpoint is expecting specific parameters (<code>input_ids</code>,
          <code>inputs_embeds</code>, or <code>encoder_embeds</code>) that are not
          clearly documented or are different from the Interface API''s requirements.</p>

          <p>I am looking for guidance on how to resolve this inconsistency:</p>

          <ol>

          <li>What is the correct way to structure the request for the Inference Endpoint
          when using image URLs?</li>

          <li>Is there a step I might be overlooking that would account for the difference
          in behavior between the Interface API and the Inference Endpoint?</li>

          <li>Has anyone successfully used the Inference Endpoint with image URLs,
          and if so, could you share an example request?</li>

          </ol>

          <p>Any insights, code snippets, or documentation references that could shed
          light on this issue would be incredibly valuable.</p>

          <p>Thank you in advance for your assistance and support.</p>

          <p>Warm regards,<br>Illya<br><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/E7oOtOBZfQZ3b7eKIUisL.png"><img
          alt="img_1.png" src="https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/E7oOtOBZfQZ3b7eKIUisL.png"></a></p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/R8jKqoyWF-tq_85Rj9TbE.png"><img
          alt="img_2.png" src="https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/R8jKqoyWF-tq_85Rj9TbE.png"></a></p>

          '
        raw: "Hello Hugging Face Community,\r\n\r\nI am reaching out to seek your\
          \ expertise regarding an issue I'm facing with the Salesforce/blip-image-captioning-large\
          \ model via the Inference Endpoints.\r\n\r\nHere's a detailed outline of\
          \ the problem:\r\n\r\n- **Interface API Functionality:** When using the\
          \ Interface API, the process is smooth. I can send an image URL using `json={\"\
          inputs\": image_url}`, and it returns the expected caption without the need\
          \ to download the image.\r\n\r\n- **Inference Endpoint Issue:** However,\
          \ the same success is not replicated when I switch to using the Inference\
          \ Endpoints. Regardless of whether I send the image URL directly or download\
          \ the image and send it, I encounter the following error: `{\"error\": \"\
          You have to specify either input_ids or inputs_embeds or encoder_embeds\"\
          }`. This error persists and prevents the endpoint from generating the expected\
          \ caption.\r\n\r\n- **Endpoint Testing Failure:** To further investigate,\
          \ I utilized the 'Test your endpoint!' feature within the Hugging Face platform\
          \ by dragging and dropping an image directly. Unfortunately, this also resulted\
          \ in the same error message.\r\n\r\nThe crux of the problem seems to be\
          \ related to the expected request structure for the Inference Endpoint,\
          \ which differs from the Interface API. The error suggests that the endpoint\
          \ is expecting specific parameters (`input_ids`, `inputs_embeds`, or `encoder_embeds`)\
          \ that are not clearly documented or are different from the Interface API's\
          \ requirements.\r\n\r\nI am looking for guidance on how to resolve this\
          \ inconsistency:\r\n\r\n1. What is the correct way to structure the request\
          \ for the Inference Endpoint when using image URLs?\r\n2. Is there a step\
          \ I might be overlooking that would account for the difference in behavior\
          \ between the Interface API and the Inference Endpoint?\r\n3. Has anyone\
          \ successfully used the Inference Endpoint with image URLs, and if so, could\
          \ you share an example request?\r\n\r\nAny insights, code snippets, or documentation\
          \ references that could shed light on this issue would be incredibly valuable.\r\
          \n\r\nThank you in advance for your assistance and support.\r\n\r\nWarm\
          \ regards,\r\nIllya\r\n![img_1.png](https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/E7oOtOBZfQZ3b7eKIUisL.png)\r\
          \n\r\n![img_2.png](https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/R8jKqoyWF-tq_85Rj9TbE.png)\r\
          \n"
        updatedAt: '2023-11-15T09:03:06.559Z'
      numEdits: 0
      reactions: []
    id: 6554894a849e7971cb6f9f83
    type: comment
  author: Illyap
  content: "Hello Hugging Face Community,\r\n\r\nI am reaching out to seek your expertise\
    \ regarding an issue I'm facing with the Salesforce/blip-image-captioning-large\
    \ model via the Inference Endpoints.\r\n\r\nHere's a detailed outline of the problem:\r\
    \n\r\n- **Interface API Functionality:** When using the Interface API, the process\
    \ is smooth. I can send an image URL using `json={\"inputs\": image_url}`, and\
    \ it returns the expected caption without the need to download the image.\r\n\r\
    \n- **Inference Endpoint Issue:** However, the same success is not replicated\
    \ when I switch to using the Inference Endpoints. Regardless of whether I send\
    \ the image URL directly or download the image and send it, I encounter the following\
    \ error: `{\"error\": \"You have to specify either input_ids or inputs_embeds\
    \ or encoder_embeds\"}`. This error persists and prevents the endpoint from generating\
    \ the expected caption.\r\n\r\n- **Endpoint Testing Failure:** To further investigate,\
    \ I utilized the 'Test your endpoint!' feature within the Hugging Face platform\
    \ by dragging and dropping an image directly. Unfortunately, this also resulted\
    \ in the same error message.\r\n\r\nThe crux of the problem seems to be related\
    \ to the expected request structure for the Inference Endpoint, which differs\
    \ from the Interface API. The error suggests that the endpoint is expecting specific\
    \ parameters (`input_ids`, `inputs_embeds`, or `encoder_embeds`) that are not\
    \ clearly documented or are different from the Interface API's requirements.\r\
    \n\r\nI am looking for guidance on how to resolve this inconsistency:\r\n\r\n\
    1. What is the correct way to structure the request for the Inference Endpoint\
    \ when using image URLs?\r\n2. Is there a step I might be overlooking that would\
    \ account for the difference in behavior between the Interface API and the Inference\
    \ Endpoint?\r\n3. Has anyone successfully used the Inference Endpoint with image\
    \ URLs, and if so, could you share an example request?\r\n\r\nAny insights, code\
    \ snippets, or documentation references that could shed light on this issue would\
    \ be incredibly valuable.\r\n\r\nThank you in advance for your assistance and\
    \ support.\r\n\r\nWarm regards,\r\nIllya\r\n![img_1.png](https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/E7oOtOBZfQZ3b7eKIUisL.png)\r\
    \n\r\n![img_2.png](https://cdn-uploads.huggingface.co/production/uploads/64c8eb72541d8225981ca7eb/R8jKqoyWF-tq_85Rj9TbE.png)\r\
    \n"
  created_at: 2023-11-15 09:03:06+00:00
  edited: false
  hidden: false
  id: 6554894a849e7971cb6f9f83
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 25
repo_id: Salesforce/blip-image-captioning-large
repo_type: model
status: open
target_branch: null
title: 'Issue with Salesforce/blip-image-captioning-large Endpoint: "input_ids or
  inputs_embeds" Error'
