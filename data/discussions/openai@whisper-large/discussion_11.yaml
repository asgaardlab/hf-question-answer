!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Spotex93
conflicting_files: null
created_at: 2022-11-11 19:43:53+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
      fullname: Johannes Ha
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Spotex93
      type: user
    createdAt: '2022-11-11T19:43:53.000Z'
    data:
      edited: false
      editors:
      - Spotex93
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
          fullname: Johannes Ha
          isHf: false
          isPro: false
          name: Spotex93
          type: user
        html: '<p>Can you run transcription via inference api? It only translates
          to english with the provided code snipped</p>

          '
        raw: Can you run transcription via inference api? It only translates to english
          with the provided code snipped
        updatedAt: '2022-11-11T19:43:53.825Z'
      numEdits: 0
      reactions: []
    id: 636ea5f9c8bbb1fcb3811bc0
    type: comment
  author: Spotex93
  content: Can you run transcription via inference api? It only translates to english
    with the provided code snipped
  created_at: 2022-11-11 19:43:53+00:00
  edited: false
  hidden: false
  id: 636ea5f9c8bbb1fcb3811bc0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2022-11-12T09:05:26.000Z'
    data:
      edited: false
      editors:
      - ArthurZ
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
          fullname: Arthur Zucker
          isHf: true
          isPro: false
          name: ArthurZ
          type: user
        html: "<p>You should be able to! The trick is to properly set the \u2018forced_decoder_ids\u2019\
          \ with the processor. Otherwise we are looking into adding the la language\
          \ detection automatically</p>\n"
        raw: "You should be able to! The trick is to properly set the \u2018forced_decoder_ids\u2019\
          \ with the processor. Otherwise we are looking into adding the la language\
          \ detection automatically"
        updatedAt: '2022-11-12T09:05:26.923Z'
      numEdits: 0
      reactions: []
    id: 636f61d65af6ffb65635f4be
    type: comment
  author: ArthurZ
  content: "You should be able to! The trick is to properly set the \u2018forced_decoder_ids\u2019\
    \ with the processor. Otherwise we are looking into adding the la language detection\
    \ automatically"
  created_at: 2022-11-12 09:05:26+00:00
  edited: false
  hidden: false
  id: 636f61d65af6ffb65635f4be
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8a4c06025be3ff8b788c7303d1f063c9.svg
      fullname: Dominik Kunz
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: muertinho
      type: user
    createdAt: '2022-11-20T13:11:28.000Z'
    data:
      edited: false
      editors:
      - muertinho
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8a4c06025be3ff8b788c7303d1f063c9.svg
          fullname: Dominik Kunz
          isHf: false
          isPro: false
          name: muertinho
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Spotex93&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Spotex93\">@<span class=\"\
          underline\">Spotex93</span></a></span>\n\n\t</span></span> , where you able\
          \ to find a solution to the transcription problem? I ran into the same question.\
          \ Kind regards</p>\n"
        raw: '@Spotex93 , where you able to find a solution to the transcription problem?
          I ran into the same question. Kind regards'
        updatedAt: '2022-11-20T13:11:28.594Z'
      numEdits: 0
      reactions: []
    id: 637a2780bdf7309aa6d49fb4
    type: comment
  author: muertinho
  content: '@Spotex93 , where you able to find a solution to the transcription problem?
    I ran into the same question. Kind regards'
  created_at: 2022-11-20 13:11:28+00:00
  edited: false
  hidden: false
  id: 637a2780bdf7309aa6d49fb4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2022-11-21T10:18:06.000Z'
    data:
      edited: true
      editors:
      - sanchit-gandhi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: '<p>You can set the <code>forced_decoder_ids</code> as follows:</p>

          <pre><code class="language-python"><span class="hljs-keyword">from</span>
          transformers <span class="hljs-keyword">import</span> WhisperForConditionalGeneration,
          WhisperProcessor


          checkpoint = <span class="hljs-string">"openai/whisper-large"</span>


          model = WhisperForConditionalGeneration.from_pretrained(checkpoint)

          processor = WhisperProcessor.from_pretrained(checkpoint)


          <span class="hljs-built_in">print</span>(<span class="hljs-string">"Default:"</span>)

          <span class="hljs-built_in">print</span>(model.config.forced_decoder_ids)

          <span class="hljs-built_in">print</span>(processor.batch_decode([i[<span
          class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span
          class="hljs-keyword">in</span> model.config.forced_decoder_ids]))


          <span class="hljs-comment"># now change to Hindi (hi)</span>

          model.config.forced_decoder_ids = processor.get_decoder_prompt_ids(language=<span
          class="hljs-string">"hi"</span>, task=<span class="hljs-string">"transcribe"</span>)


          <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nHindi:"</span>)

          <span class="hljs-built_in">print</span>(model.config.forced_decoder_ids)

          <span class="hljs-built_in">print</span>(processor.batch_decode([i[<span
          class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span
          class="hljs-keyword">in</span> model.config.forced_decoder_ids]))

          </code></pre>

          <p><strong>Print Output:</strong></p>

          <pre><code class="language-python">Default:

          [[<span class="hljs-number">1</span>, <span class="hljs-number">50259</span>],
          [<span class="hljs-number">2</span>, <span class="hljs-number">50359</span>],
          [<span class="hljs-number">3</span>, <span class="hljs-number">50363</span>]]

          [<span class="hljs-string">''&lt;|en|&gt;''</span>, <span class="hljs-string">''&lt;|transcribe|&gt;''</span>,
          <span class="hljs-string">''&lt;|notimestamps|&gt;''</span>]


          Hindi:

          [(<span class="hljs-number">1</span>, <span class="hljs-number">50276</span>),
          (<span class="hljs-number">2</span>, <span class="hljs-number">50359</span>),
          (<span class="hljs-number">3</span>, <span class="hljs-number">50363</span>)]

          [<span class="hljs-string">''&lt;|hi|&gt;''</span>, <span class="hljs-string">''&lt;|transcribe|&gt;''</span>,
          <span class="hljs-string">''&lt;|notimestamps|&gt;''</span>]

          </code></pre>

          '
        raw: 'You can set the `forced_decoder_ids` as follows:

          ```python

          from transformers import WhisperForConditionalGeneration, WhisperProcessor


          checkpoint = "openai/whisper-large"


          model = WhisperForConditionalGeneration.from_pretrained(checkpoint)

          processor = WhisperProcessor.from_pretrained(checkpoint)


          print("Default:")

          print(model.config.forced_decoder_ids)

          print(processor.batch_decode([i[1] for i in model.config.forced_decoder_ids]))


          # now change to Hindi (hi)

          model.config.forced_decoder_ids = processor.get_decoder_prompt_ids(language="hi",
          task="transcribe")


          print("\nHindi:")

          print(model.config.forced_decoder_ids)

          print(processor.batch_decode([i[1] for i in model.config.forced_decoder_ids]))

          ```


          **Print Output:**

          ```python

          Default:

          [[1, 50259], [2, 50359], [3, 50363]]

          [''<|en|>'', ''<|transcribe|>'', ''<|notimestamps|>'']


          Hindi:

          [(1, 50276), (2, 50359), (3, 50363)]

          [''<|hi|>'', ''<|transcribe|>'', ''<|notimestamps|>'']

          ```'
        updatedAt: '2022-11-24T12:04:30.128Z'
      numEdits: 2
      reactions: []
    id: 637b505ee8de1ebc272428e4
    type: comment
  author: sanchit-gandhi
  content: 'You can set the `forced_decoder_ids` as follows:

    ```python

    from transformers import WhisperForConditionalGeneration, WhisperProcessor


    checkpoint = "openai/whisper-large"


    model = WhisperForConditionalGeneration.from_pretrained(checkpoint)

    processor = WhisperProcessor.from_pretrained(checkpoint)


    print("Default:")

    print(model.config.forced_decoder_ids)

    print(processor.batch_decode([i[1] for i in model.config.forced_decoder_ids]))


    # now change to Hindi (hi)

    model.config.forced_decoder_ids = processor.get_decoder_prompt_ids(language="hi",
    task="transcribe")


    print("\nHindi:")

    print(model.config.forced_decoder_ids)

    print(processor.batch_decode([i[1] for i in model.config.forced_decoder_ids]))

    ```


    **Print Output:**

    ```python

    Default:

    [[1, 50259], [2, 50359], [3, 50363]]

    [''<|en|>'', ''<|transcribe|>'', ''<|notimestamps|>'']


    Hindi:

    [(1, 50276), (2, 50359), (3, 50363)]

    [''<|hi|>'', ''<|transcribe|>'', ''<|notimestamps|>'']

    ```'
  created_at: 2022-11-21 10:18:06+00:00
  edited: true
  hidden: false
  id: 637b505ee8de1ebc272428e4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
      fullname: Johannes Ha
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Spotex93
      type: user
    createdAt: '2022-11-21T20:47:27.000Z'
    data:
      edited: false
      editors:
      - Spotex93
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
          fullname: Johannes Ha
          isHf: false
          isPro: false
          name: Spotex93
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;muertinho&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/muertinho\">@<span class=\"\
          underline\">muertinho</span></a></span>\n\n\t</span></span> for now I switched\
          \ to <a rel=\"nofollow\" href=\"https://replicate.com/openai/whisper/api#input-audio\"\
          >https://replicate.com/openai/whisper/api#input-audio</a> since to me it\
          \ seems that it is not possible with the currently provided inference api.\
          \ Maybe you'd have to host your own.</p>\n"
        raw: '@muertinho for now I switched to https://replicate.com/openai/whisper/api#input-audio
          since to me it seems that it is not possible with the currently provided
          inference api. Maybe you''d have to host your own.'
        updatedAt: '2022-11-21T20:47:27.241Z'
      numEdits: 0
      reactions: []
    id: 637be3dfe073a16fb788a0b2
    type: comment
  author: Spotex93
  content: '@muertinho for now I switched to https://replicate.com/openai/whisper/api#input-audio
    since to me it seems that it is not possible with the currently provided inference
    api. Maybe you''d have to host your own.'
  created_at: 2022-11-21 20:47:27+00:00
  edited: false
  hidden: false
  id: 637be3dfe073a16fb788a0b2
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8a4c06025be3ff8b788c7303d1f063c9.svg
      fullname: Dominik Kunz
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: muertinho
      type: user
    createdAt: '2022-11-22T18:01:40.000Z'
    data:
      edited: false
      editors:
      - muertinho
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8a4c06025be3ff8b788c7303d1f063c9.svg
          fullname: Dominik Kunz
          isHf: false
          isPro: false
          name: muertinho
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Spotex93&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Spotex93\">@<span class=\"\
          underline\">Spotex93</span></a></span>\n\n\t</span></span> thank you for\
          \ providing me with the link. I see the same issue you mentioned above and\
          \ will look into replicate.com. <span data-props=\"{&quot;user&quot;:&quot;sanchit-gandhi&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/sanchit-gandhi\"\
          >@<span class=\"underline\">sanchit-gandhi</span></a></span>\n\n\t</span></span>\
          \ thank you for your reply and efforts as well. However, I am looking for\
          \ an option to run it over a cloud API.</p>\n"
        raw: '@Spotex93 thank you for providing me with the link. I see the same issue
          you mentioned above and will look into replicate.com. @sanchit-gandhi thank
          you for your reply and efforts as well. However, I am looking for an option
          to run it over a cloud API.'
        updatedAt: '2022-11-22T18:01:40.887Z'
      numEdits: 0
      reactions: []
    id: 637d0e8464686bd9011a9a66
    type: comment
  author: muertinho
  content: '@Spotex93 thank you for providing me with the link. I see the same issue
    you mentioned above and will look into replicate.com. @sanchit-gandhi thank you
    for your reply and efforts as well. However, I am looking for an option to run
    it over a cloud API.'
  created_at: 2022-11-22 18:01:40+00:00
  edited: false
  hidden: false
  id: 637d0e8464686bd9011a9a66
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
      fullname: Johannes Ha
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Spotex93
      type: user
    createdAt: '2022-11-23T19:32:38.000Z'
    data:
      edited: false
      editors:
      - Spotex93
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/968866309d023e89ab77bf8d0768308a.svg
          fullname: Johannes Ha
          isHf: false
          isPro: false
          name: Spotex93
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;muertinho&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/muertinho\">@<span class=\"\
          underline\">muertinho</span></a></span>\n\n\t</span></span> tell me if you\
          \ found a better solution!</p>\n"
        raw: '@muertinho tell me if you found a better solution!'
        updatedAt: '2022-11-23T19:32:38.425Z'
      numEdits: 0
      reactions: []
    id: 637e7556258e9767199696e5
    type: comment
  author: Spotex93
  content: '@muertinho tell me if you found a better solution!'
  created_at: 2022-11-23 19:32:38+00:00
  edited: false
  hidden: false
  id: 637e7556258e9767199696e5
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 11
repo_id: openai/whisper-large
repo_type: model
status: open
target_branch: null
title: Transcription
