!!python/object:huggingface_hub.community.DiscussionWithDetails
author: csinva
conflicting_files: null
created_at: 2022-11-05 18:23:47+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1660330237411-62b0bee117fa24819dd0999c.jpeg?w=200&h=200&f=face
      fullname: Chandan Singh
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: csinva
      type: user
    createdAt: '2022-11-05T19:23:47.000Z'
    data:
      edited: false
      editors:
      - csinva
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1660330237411-62b0bee117fa24819dd0999c.jpeg?w=200&h=200&f=face
          fullname: Chandan Singh
          isHf: false
          isPro: false
          name: csinva
          type: user
        html: '<p>Hello, thanks for releasing this wonderful work! I''m having trouble
          running inference with this model.</p>

          <p>Specifically, when I run the model on the tweet-eval dataset, I get an
          error `IndexError: index out of range in self''. Have you encountered this
          error before?</p>

          <p>This doesn''t happen with other models (including the toxigen roberta
          model), so I don''t think it''s an issue with preprocessing etc.</p>

          '
        raw: "Hello, thanks for releasing this wonderful work! I'm having trouble\
          \ running inference with this model.\r\n\r\nSpecifically, when I run the\
          \ model on the tweet-eval dataset, I get an error `IndexError: index out\
          \ of range in self'. Have you encountered this error before?\r\n\r\nThis\
          \ doesn't happen with other models (including the toxigen roberta model),\
          \ so I don't think it's an issue with preprocessing etc."
        updatedAt: '2022-11-05T19:23:47.472Z'
      numEdits: 0
      reactions: []
    id: 6366b8432d6ba9a4f71c0d22
    type: comment
  author: csinva
  content: "Hello, thanks for releasing this wonderful work! I'm having trouble running\
    \ inference with this model.\r\n\r\nSpecifically, when I run the model on the\
    \ tweet-eval dataset, I get an error `IndexError: index out of range in self'.\
    \ Have you encountered this error before?\r\n\r\nThis doesn't happen with other\
    \ models (including the toxigen roberta model), so I don't think it's an issue\
    \ with preprocessing etc."
  created_at: 2022-11-05 18:23:47+00:00
  edited: false
  hidden: false
  id: 6366b8432d6ba9a4f71c0d22
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-04T00:34:26.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: '<p>I get the same. The tokenizer has a vocab size of 50257 but ....the
          classifier maybe less?</p>

          '
        raw: I get the same. The tokenizer has a vocab size of 50257 but ....the classifier
          maybe less?
        updatedAt: '2023-04-04T00:34:26.610Z'
      numEdits: 0
      reactions: []
    id: 642b709274600bc5d477bb42
    type: comment
  author: kljensen
  content: I get the same. The tokenizer has a vocab size of 50257 but ....the classifier
    maybe less?
  created_at: 2023-04-03 23:34:26+00:00
  edited: false
  hidden: false
  id: 642b709274600bc5d477bb42
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
      fullname: Tom Hartvigsen
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: tomh
      type: user
    createdAt: '2023-04-04T12:18:05.000Z'
    data:
      edited: false
      editors:
      - tomh
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
          fullname: Tom Hartvigsen
          isHf: false
          isPro: false
          name: tomh
          type: user
        html: '<p>Hi there, please try using the bert-base-uncased tokenizer and let
          me know if that solves your problem!</p>

          '
        raw: Hi there, please try using the bert-base-uncased tokenizer and let me
          know if that solves your problem!
        updatedAt: '2023-04-04T12:18:05.881Z'
      numEdits: 0
      reactions: []
    id: 642c157d225f748ce304a2e2
    type: comment
  author: tomh
  content: Hi there, please try using the bert-base-uncased tokenizer and let me know
    if that solves your problem!
  created_at: 2023-04-04 11:18:05+00:00
  edited: false
  hidden: false
  id: 642c157d225f748ce304a2e2
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-04T12:34:05.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;tomh&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/tomh\">@<span class=\"\
          underline\">tomh</span></a></span>\n\n\t</span></span> - yes that works.\
          \ I will send a PR on GitHub for this. I used</p>\n<p><code>toxigen_hatebert\
          \ = pipeline(\"text-classification\", model=\"tomh/toxigen_hatebert\", tokenizer=\"\
          bert-base-cased\")</code></p>\n<p>Not sure why the <code>pipeline</code>\
          \ chooses the wrong tokenizer to start with.</p>\n"
        raw: 'Hi @tomh - yes that works. I will send a PR on GitHub for this. I used


          ```toxigen_hatebert = pipeline("text-classification", model="tomh/toxigen_hatebert",
          tokenizer="bert-base-cased")```


          Not sure why the `pipeline` chooses the wrong tokenizer to start with.'
        updatedAt: '2023-04-04T12:34:05.936Z'
      numEdits: 0
      reactions: []
    id: 642c193d9deaaff5f0b28cf6
    type: comment
  author: kljensen
  content: 'Hi @tomh - yes that works. I will send a PR on GitHub for this. I used


    ```toxigen_hatebert = pipeline("text-classification", model="tomh/toxigen_hatebert",
    tokenizer="bert-base-cased")```


    Not sure why the `pipeline` chooses the wrong tokenizer to start with.'
  created_at: 2023-04-04 11:34:05+00:00
  edited: false
  hidden: false
  id: 642c193d9deaaff5f0b28cf6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
      fullname: Tom Hartvigsen
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: tomh
      type: user
    createdAt: '2023-04-04T12:40:40.000Z'
    data:
      edited: false
      editors:
      - tomh
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
          fullname: Tom Hartvigsen
          isHf: false
          isPro: false
          name: tomh
          type: user
        html: '<p>Ok I''ll update the README to use that. Something went wrong with
          the toxigen_hatebert tokenizer.</p>

          '
        raw: Ok I'll update the README to use that. Something went wrong with the
          toxigen_hatebert tokenizer.
        updatedAt: '2023-04-04T12:40:40.335Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - kljensen
    id: 642c1ac8cd5f4f52d4a4c341
    type: comment
  author: tomh
  content: Ok I'll update the README to use that. Something went wrong with the toxigen_hatebert
    tokenizer.
  created_at: 2023-04-04 11:40:40+00:00
  edited: false
  hidden: false
  id: 642c1ac8cd5f4f52d4a4c341
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-04T12:49:21.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;tomh&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/tomh\">@<span class=\"\
          underline\">tomh</span></a></span>\n\n\t</span></span> actually.... It seems\
          \ to make the exception to away, but the results are then incorrect I think</p>\n\
          <pre><code>In [123]: toxigen_hatebert = pipeline(\"text-classification\"\
          , model=\"tomh/toxigen_hatebert\", tokenizer=\"bert-base-cased\")\n\nIn\
          \ [124]: toxigen_hatebert(\"hello\")\nOut[124]: [{'label': 'LABEL_0', 'score':\
          \ 0.7423402667045593}]\n\nIn [125]: toxigen_hatebert(\"die you scum\")\n\
          Out[125]: [{'label': 'LABEL_0', 'score': 0.9332824945449829}]\n</code></pre>\n"
        raw: '@tomh actually.... It seems to make the exception to away, but the results
          are then incorrect I think


          ```

          In [123]: toxigen_hatebert = pipeline("text-classification", model="tomh/toxigen_hatebert",
          tokenizer="bert-base-cased")


          In [124]: toxigen_hatebert("hello")

          Out[124]: [{''label'': ''LABEL_0'', ''score'': 0.7423402667045593}]


          In [125]: toxigen_hatebert("die you scum")

          Out[125]: [{''label'': ''LABEL_0'', ''score'': 0.9332824945449829}]

          ```'
        updatedAt: '2023-04-04T12:49:21.170Z'
      numEdits: 0
      reactions: []
    id: 642c1cd1cd5f4f52d4a4d2d2
    type: comment
  author: kljensen
  content: '@tomh actually.... It seems to make the exception to away, but the results
    are then incorrect I think


    ```

    In [123]: toxigen_hatebert = pipeline("text-classification", model="tomh/toxigen_hatebert",
    tokenizer="bert-base-cased")


    In [124]: toxigen_hatebert("hello")

    Out[124]: [{''label'': ''LABEL_0'', ''score'': 0.7423402667045593}]


    In [125]: toxigen_hatebert("die you scum")

    Out[125]: [{''label'': ''LABEL_0'', ''score'': 0.9332824945449829}]

    ```'
  created_at: 2023-04-04 11:49:21+00:00
  edited: false
  hidden: false
  id: 642c1cd1cd5f4f52d4a4d2d2
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-04T12:50:31.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: '<p>My fault should be </p>

          <pre><code>toxigen_hatebert = pipeline("text-classification", model="tomh/toxigen_hatebert",
          tokenizer="bert-base-uncased")

          </code></pre>

          <p>As you said. Sorry for spam.</p>

          '
        raw: "My fault should be \n\n```\ntoxigen_hatebert = pipeline(\"text-classification\"\
          , model=\"tomh/toxigen_hatebert\", tokenizer=\"bert-base-uncased\")\n```\n\
          \nAs you said. Sorry for spam."
        updatedAt: '2023-04-04T12:50:31.998Z'
      numEdits: 0
      reactions: []
    id: 642c1d1765c45c71ebf59a0a
    type: comment
  author: kljensen
  content: "My fault should be \n\n```\ntoxigen_hatebert = pipeline(\"text-classification\"\
    , model=\"tomh/toxigen_hatebert\", tokenizer=\"bert-base-uncased\")\n```\n\nAs\
    \ you said. Sorry for spam."
  created_at: 2023-04-04 11:50:31+00:00
  edited: false
  hidden: false
  id: 642c1d1765c45c71ebf59a0a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-04T12:52:52.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: '<p>For future readers, see <a rel="nofollow" href="https://github.com/microsoft/TOXIGEN/issues/8">https://github.com/microsoft/TOXIGEN/issues/8</a></p>

          '
        raw: For future readers, see https://github.com/microsoft/TOXIGEN/issues/8
        updatedAt: '2023-04-04T12:52:52.237Z'
      numEdits: 0
      reactions: []
    id: 642c1da4db95af333d1aa166
    type: comment
  author: kljensen
  content: For future readers, see https://github.com/microsoft/TOXIGEN/issues/8
  created_at: 2023-04-04 11:52:52+00:00
  edited: false
  hidden: false
  id: 642c1da4db95af333d1aa166
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
      fullname: Tom Hartvigsen
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: tomh
      type: user
    createdAt: '2023-04-04T12:54:56.000Z'
    data:
      edited: false
      editors:
      - tomh
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
          fullname: Tom Hartvigsen
          isHf: false
          isPro: false
          name: tomh
          type: user
        html: '<p>Interesting... let me dig in a bit more. I just checked <a href="https://huggingface.co/tomh/toxigen_hatebert">Hugginface''s
          Hosted API for toxigen_hatebert</a> and it indeed works differently:</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/SRCWcEzb8CWutMq4r1d2L.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/SRCWcEzb8CWutMq4r1d2L.png"></a></p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/0jTjmjGl-HqvfBR5TxjN6.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/0jTjmjGl-HqvfBR5TxjN6.png"></a></p>

          <p>Good catch!</p>

          '
        raw: 'Interesting... let me dig in a bit more. I just checked [Hugginface''s
          Hosted API for toxigen_hatebert](https://huggingface.co/tomh/toxigen_hatebert)
          and it indeed works differently:



          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/SRCWcEzb8CWutMq4r1d2L.png)



          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/0jTjmjGl-HqvfBR5TxjN6.png)


          Good catch!'
        updatedAt: '2023-04-04T12:54:56.468Z'
      numEdits: 0
      reactions: []
    id: 642c1e20dc9e0b2bac89f0a9
    type: comment
  author: tomh
  content: 'Interesting... let me dig in a bit more. I just checked [Hugginface''s
    Hosted API for toxigen_hatebert](https://huggingface.co/tomh/toxigen_hatebert)
    and it indeed works differently:



    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/SRCWcEzb8CWutMq4r1d2L.png)



    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/6266b41dc4b2a50b97eea2fe/0jTjmjGl-HqvfBR5TxjN6.png)


    Good catch!'
  created_at: 2023-04-04 11:54:56+00:00
  edited: false
  hidden: false
  id: 642c1e20dc9e0b2bac89f0a9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
      fullname: Tom Hartvigsen
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: tomh
      type: user
    createdAt: '2023-04-04T12:57:14.000Z'
    data:
      edited: false
      editors:
      - tomh
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9444762da6129c1e5ad0ddd99a301090.svg
          fullname: Tom Hartvigsen
          isHf: false
          isPro: false
          name: tomh
          type: user
        html: '<p>Aha so switching the tokenizer worked?</p>

          '
        raw: Aha so switching the tokenizer worked?
        updatedAt: '2023-04-04T12:57:14.283Z'
      numEdits: 0
      reactions: []
    id: 642c1eaa225f748ce304ec66
    type: comment
  author: tomh
  content: Aha so switching the tokenizer worked?
  created_at: 2023-04-04 11:57:14+00:00
  edited: false
  hidden: false
  id: 642c1eaa225f748ce304ec66
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
      fullname: Kyle Jensen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kljensen
      type: user
    createdAt: '2023-04-08T21:16:30.000Z'
    data:
      edited: false
      editors:
      - kljensen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/8ea09150f5874d84f2bdcab9df639478.svg
          fullname: Kyle Jensen
          isHf: false
          isPro: false
          name: kljensen
          type: user
        html: "<p>Yes, it worked. Thanks <span data-props=\"{&quot;user&quot;:&quot;tomh&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/tomh\"\
          >@<span class=\"underline\">tomh</span></a></span>\n\n\t</span></span></p>\n"
        raw: Yes, it worked. Thanks @tomh
        updatedAt: '2023-04-08T21:16:30.017Z'
      numEdits: 0
      reactions: []
    id: 6431d9ae7d795d8e703355c2
    type: comment
  author: kljensen
  content: Yes, it worked. Thanks @tomh
  created_at: 2023-04-08 20:16:30+00:00
  edited: false
  hidden: false
  id: 6431d9ae7d795d8e703355c2
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: tomh/toxigen_hatebert
repo_type: model
status: open
target_branch: null
title: Issue running inference
