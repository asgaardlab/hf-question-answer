!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Supreeth
conflicting_files: null
created_at: 2023-05-06 04:38:39+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1627701114915-noauth.png?w=200&h=200&f=face
      fullname: Supreeth Rao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Supreeth
      type: user
    createdAt: '2023-05-06T05:38:39.000Z'
    data:
      edited: false
      editors:
      - Supreeth
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1627701114915-noauth.png?w=200&h=200&f=face
          fullname: Supreeth Rao
          isHf: false
          isPro: false
          name: Supreeth
          type: user
        html: '<p>I''m trying run the model on multiple GPU''s use <code>device_map="auto"</code>
          but I get <code>MPTForCausalLM</code> does not support <code>device_map="auto"</code>
          yet. </p>

          '
        raw: 'I''m trying run the model on multiple GPU''s use `device_map="auto"`
          but I get `MPTForCausalLM` does not support `device_map="auto"` yet. '
        updatedAt: '2023-05-06T05:38:39.543Z'
      numEdits: 0
      reactions:
      - count: 9
        reaction: "\U0001F44D"
        users:
        - abhinavkulkarni
        - joelniklaus
        - leminda-ai
        - dominguesm
        - Justin9989214
        - Ekiwa
        - ringle
        - alex-laptiev
        - labyrinthosgcp
      - count: 3
        reaction: "\U0001F614"
        users:
        - rajarshic
        - nischalhp
        - alex-laptiev
    id: 6455e7df83fee1965c1927a3
    type: comment
  author: Supreeth
  content: 'I''m trying run the model on multiple GPU''s use `device_map="auto"` but
    I get `MPTForCausalLM` does not support `device_map="auto"` yet. '
  created_at: 2023-05-06 04:38:39+00:00
  edited: false
  hidden: false
  id: 6455e7df83fee1965c1927a3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6f25f1eb3f633d06851db60a8fc655d9.svg
      fullname: Rajarshi Chakraborty
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: rajarshic
      type: user
    createdAt: '2023-05-06T23:04:29.000Z'
    data:
      edited: false
      editors:
      - rajarshic
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6f25f1eb3f633d06851db60a8fc655d9.svg
          fullname: Rajarshi Chakraborty
          isHf: false
          isPro: false
          name: rajarshic
          type: user
        html: '<p>Same here</p>

          '
        raw: Same here
        updatedAt: '2023-05-06T23:04:29.225Z'
      numEdits: 0
      reactions: []
    id: 6456dcfdcd6567f52fbc6f1a
    type: comment
  author: rajarshic
  content: Same here
  created_at: 2023-05-06 22:04:29+00:00
  edited: false
  hidden: false
  id: 6456dcfdcd6567f52fbc6f1a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1641390233716-60bccec062080d33f875cd0c.png?w=200&h=200&f=face
      fullname: Peter Szemraj
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: pszemraj
      type: user
    createdAt: '2023-05-09T18:15:35.000Z'
    data:
      edited: false
      editors:
      - pszemraj
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1641390233716-60bccec062080d33f875cd0c.png?w=200&h=200&f=face
          fullname: Peter Szemraj
          isHf: false
          isPro: false
          name: pszemraj
          type: user
        html: '<p>I took a pass at this on the <code>storywriter</code> variant. can''t
          promise it''s perfect, but I added the main block to <code>modeling_mpt.py</code>
          and let it support gradient checkpointing, seems to work fine. you can check
          out the commit/details here: <a href="https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/commit/0688e28bf6d9c7c0ee98a03628948f81eca2bdd6">https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/commit/0688e28bf6d9c7c0ee98a03628948f81eca2bdd6</a></p>

          <p>also there''s a colab demo on the model card if you want to test first
          etc <a href="https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded">https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded</a></p>

          '
        raw: 'I took a pass at this on the `storywriter` variant. can''t promise it''s
          perfect, but I added the main block to `modeling_mpt.py` and let it support
          gradient checkpointing, seems to work fine. you can check out the commit/details
          here: https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/commit/0688e28bf6d9c7c0ee98a03628948f81eca2bdd6


          also there''s a colab demo on the model card if you want to test first etc
          https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded'
        updatedAt: '2023-05-09T18:15:35.526Z'
      numEdits: 0
      reactions:
      - count: 3
        reaction: "\U0001F44D"
        users:
        - fendiprime
        - mikolodz
        - simecek
    id: 645a8dc7214503ad17aa1f84
    type: comment
  author: pszemraj
  content: 'I took a pass at this on the `storywriter` variant. can''t promise it''s
    perfect, but I added the main block to `modeling_mpt.py` and let it support gradient
    checkpointing, seems to work fine. you can check out the commit/details here:
    https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/commit/0688e28bf6d9c7c0ee98a03628948f81eca2bdd6


    also there''s a colab demo on the model card if you want to test first etc https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded'
  created_at: 2023-05-09 17:15:35+00:00
  edited: false
  hidden: false
  id: 645a8dc7214503ad17aa1f84
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6c38ab704073570dd4682c5fc4e7c248.svg
      fullname: Alex Laptiev
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alex-laptiev
      type: user
    createdAt: '2023-05-24T22:43:37.000Z'
    data:
      edited: false
      editors:
      - alex-laptiev
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6c38ab704073570dd4682c5fc4e7c248.svg
          fullname: Alex Laptiev
          isHf: false
          isPro: false
          name: alex-laptiev
          type: user
        html: '<p>Is there a plan to add ''device_map'' ?</p>

          '
        raw: Is there a plan to add 'device_map' ?
        updatedAt: '2023-05-24T22:43:37.222Z'
      numEdits: 0
      reactions: []
    id: 646e93197942c36e9dabba25
    type: comment
  author: alex-laptiev
  content: Is there a plan to add 'device_map' ?
  created_at: 2023-05-24 21:43:37+00:00
  edited: false
  hidden: false
  id: 646e93197942c36e9dabba25
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1641390233716-60bccec062080d33f875cd0c.png?w=200&h=200&f=face
      fullname: Peter Szemraj
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: pszemraj
      type: user
    createdAt: '2023-05-25T01:11:34.000Z'
    data:
      edited: false
      editors:
      - pszemraj
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1641390233716-60bccec062080d33f875cd0c.png?w=200&h=200&f=face
          fullname: Peter Szemraj
          isHf: false
          isPro: false
          name: pszemraj
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;alex-laptiev&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/alex-laptiev\"\
          >@<span class=\"underline\">alex-laptiev</span></a></span>\n\n\t</span></span>\
          \ it already works! <em>that said</em>, it works for single-GPU as I don't\
          \ have a multi-GPU setup, so debugging the custom modeling code is tricky\
          \ without that. Discussing that <a href=\"https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/discussions/3\"\
          >here</a></p>\n<p>Also - <span data-props=\"{&quot;user&quot;:&quot;jprafael&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/jprafael\"\
          >@<span class=\"underline\">jprafael</span></a></span>\n\n\t</span></span>\
          \ replicated what I did on the storywriter and made an instruct version,\
          \ you can see that here: <a href=\"https://huggingface.co/jprafael/mpt-7b-instruct-sharded\"\
          >https://huggingface.co/jprafael/mpt-7b-instruct-sharded</a></p>\n<p>hope\
          \ that helps!</p>\n"
        raw: '@alex-laptiev it already works! _that said_, it works for single-GPU
          as I don''t have a multi-GPU setup, so debugging the custom modeling code
          is tricky without that. Discussing that [here](https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/discussions/3)


          Also - @jprafael replicated what I did on the storywriter and made an instruct
          version, you can see that here: https://huggingface.co/jprafael/mpt-7b-instruct-sharded


          hope that helps!'
        updatedAt: '2023-05-25T01:11:34.240Z'
      numEdits: 0
      reactions: []
    id: 646eb5c67a376d3010cc9563
    type: comment
  author: pszemraj
  content: '@alex-laptiev it already works! _that said_, it works for single-GPU as
    I don''t have a multi-GPU setup, so debugging the custom modeling code is tricky
    without that. Discussing that [here](https://huggingface.co/ethzanalytics/mpt-7b-storywriter-sharded/discussions/3)


    Also - @jprafael replicated what I did on the storywriter and made an instruct
    version, you can see that here: https://huggingface.co/jprafael/mpt-7b-instruct-sharded


    hope that helps!'
  created_at: 2023-05-25 00:11:34+00:00
  edited: false
  hidden: false
  id: 646eb5c67a376d3010cc9563
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1676410153781-63ebfcf06ef3ce22b887cb04.jpeg?w=200&h=200&f=face
      fullname: Abhi Venigalla
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: abhi-mosaic
      type: user
    createdAt: '2023-06-03T00:25:17.000Z'
    data:
      edited: false
      editors:
      - abhi-mosaic
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7801315188407898
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1676410153781-63ebfcf06ef3ce22b887cb04.jpeg?w=200&h=200&f=face
          fullname: Abhi Venigalla
          isHf: false
          isPro: false
          name: abhi-mosaic
          type: user
        html: '<p><code>device_map</code> is now supported with this PR: <a href="https://huggingface.co/mosaicml/mpt-7b-instruct/discussions/41">https://huggingface.co/mosaicml/mpt-7b-instruct/discussions/41</a></p>

          '
        raw: '`device_map` is now supported with this PR: https://huggingface.co/mosaicml/mpt-7b-instruct/discussions/41'
        updatedAt: '2023-06-03T00:25:17.206Z'
      numEdits: 0
      reactions: []
      relatedEventId: 647a886d44b6a3ae9d299435
    id: 647a886d44b6a3ae9d29942f
    type: comment
  author: abhi-mosaic
  content: '`device_map` is now supported with this PR: https://huggingface.co/mosaicml/mpt-7b-instruct/discussions/41'
  created_at: 2023-06-02 23:25:17+00:00
  edited: false
  hidden: false
  id: 647a886d44b6a3ae9d29942f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1676410153781-63ebfcf06ef3ce22b887cb04.jpeg?w=200&h=200&f=face
      fullname: Abhi Venigalla
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: abhi-mosaic
      type: user
    createdAt: '2023-06-03T00:25:17.000Z'
    data:
      status: closed
    id: 647a886d44b6a3ae9d299435
    type: status-change
  author: abhi-mosaic
  created_at: 2023-06-02 23:25:17+00:00
  id: 647a886d44b6a3ae9d299435
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: mosaicml/mpt-7b-instruct
repo_type: model
status: closed
target_branch: null
title: Support Auto Device Map
