!!python/object:huggingface_hub.community.DiscussionWithDetails
author: jasonzhang76
conflicting_files: null
created_at: 2023-11-11 05:29:00+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/457b70492ccf125bb71ef345334b07ef.svg
      fullname: jason
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jasonzhang76
      type: user
    createdAt: '2023-11-11T05:29:00.000Z'
    data:
      edited: false
      editors:
      - jasonzhang76
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.47848066687583923
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/457b70492ccf125bb71ef345334b07ef.svg
          fullname: jason
          isHf: false
          isPro: false
          name: jasonzhang76
          type: user
        html: "<p>I exported the model to onnx, it generate a encoder.onnx and decoder.onnx<br>I\
          \ use c# to do encoder and it generate the result of \"encoder_hidden_states\"\
          ,<br>Then I merge the input_ids and change to \"attension_mask\" to \"encoder_attention_mask\"\
          \ and also merge into a tensor array,<br>And aflter decode by decoder.onnx,\
          \ it outputs many tensor results like \"logits\",\"present.0.decoder.key\
          \ \",\"present.0.decoder.value\" and so on .<br>but I dont know hwo to use\
          \ the result to do text2textgeneation .<br>the sample I am using also the\
          \ demo \"\u4F5C\u4E3A\u7535\u5B50[MASK]\u7684\u5E73\u53F0\uFF0C\u4EAC\u4E1C\
          \u7EDD\u5BF9\u662F\u9886\u5148\u8005\u3002\u5982\u4ECA\u7684\u5218\u5F3A\
          [MASK]\u5DF2\u7ECF\u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\u8001\u677F\u3002\
          \"<br>the pseudo code like below ( I am using C#)<br>text= \"\u4F5C\u4E3A\
          \u7535\u5B50[MASK]\u7684\u5E73\u53F0\uFF0C\u4EAC\u4E1C\u7EDD\u5BF9\u662F\
          \u9886\u5148\u8005\u3002\u5982\u4ECA\u7684\u5218\u5F3A[MASK]\u5DF2\u7ECF\
          \u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\u8001\u677F\u3002\"<br>encoder_model\
          \ = \"encoder.onnx\"<br>decoder_model = \"decoder.onnx\"<br>tokenizer =\
          \ tokenizer.from(\"vocab.txt\")<br>tokens= tokenizer(text)<br>input = processtokensAsInput()<br>var\
          \ after_encode= onnx_encoder_infersession.run(input)<br>add after_encode\
          \ to decode_input \"which is \"encoder_hidden_states\"<br>input[\"attension_mask\"\
          ].name = \"decoder_attension_mask\"<br>add input[\"attension_mask\"] to\
          \ decode_input<br>add input[\"input_ids\"] to decode_input<br>var after_decode=\
          \ onnx_decoder_infersession.run( decode_input)</p>\n<p>the after_Decode\
          \ contains \"logits\",\"present.0.decoder.key \",\"present.0.decoder.value......\"\
          <br>how can I leverage above to gerante the result text ?</p>\n<p>Please\
          \ kindly advise, I am new to onnxruntime .</p>\n<p>thanks in advance.<br><a\
          \ rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/654a2e40b9cfada0bd331e76/bE0yOH3uWkdvndFegqVMZ.jpeg\"\
          ><img alt=\"1.jpg\" src=\"https://cdn-uploads.huggingface.co/production/uploads/654a2e40b9cfada0bd331e76/bE0yOH3uWkdvndFegqVMZ.jpeg\"\
          ></a></p>\n"
        raw: "I exported the model to onnx, it generate a encoder.onnx and decoder.onnx\r\
          \nI use c# to do encoder and it generate the result of \"encoder_hidden_states\"\
          ,\r\nThen I merge the input_ids and change to \"attension_mask\" to \"encoder_attention_mask\"\
          \ and also merge into a tensor array,\r\nAnd aflter decode by decoder.onnx,\
          \ it outputs many tensor results like \"logits\",\"present.0.decoder.key\
          \ \",\"present.0.decoder.value\" and so on .\r\nbut I dont know hwo to use\
          \ the result to do text2textgeneation . \r\nthe sample I am using also the\
          \ demo \"\u4F5C\u4E3A\u7535\u5B50[MASK]\u7684\u5E73\u53F0\uFF0C\u4EAC\u4E1C\
          \u7EDD\u5BF9\u662F\u9886\u5148\u8005\u3002\u5982\u4ECA\u7684\u5218\u5F3A\
          [MASK]\u5DF2\u7ECF\u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\u8001\u677F\u3002\
          \"\r\nthe pseudo code like below ( I am using C#)\r\ntext= \"\u4F5C\u4E3A\
          \u7535\u5B50[MASK]\u7684\u5E73\u53F0\uFF0C\u4EAC\u4E1C\u7EDD\u5BF9\u662F\
          \u9886\u5148\u8005\u3002\u5982\u4ECA\u7684\u5218\u5F3A[MASK]\u5DF2\u7ECF\
          \u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\u8001\u677F\u3002\"\r\nencoder_model\
          \ = \"encoder.onnx\"\r\ndecoder_model = \"decoder.onnx\"\r\ntokenizer =\
          \ tokenizer.from(\"vocab.txt\")\r\ntokens= tokenizer(text)\r\ninput = processtokensAsInput()\r\
          \nvar after_encode= onnx_encoder_infersession.run(input)\r\nadd after_encode\
          \ to decode_input \"which is \"encoder_hidden_states\"\r\ninput[\"attension_mask\"\
          ].name = \"decoder_attension_mask\"\r\nadd input[\"attension_mask\"] to\
          \ decode_input \r\nadd input[\"input_ids\"] to decode_input\r\nvar after_decode=\
          \ onnx_decoder_infersession.run( decode_input)\r\n\r\nthe after_Decode contains\
          \ \"logits\",\"present.0.decoder.key \",\"present.0.decoder.value......\"\
          \r\nhow can I leverage above to gerante the result text ?\r\n\r\n\r\nPlease\
          \ kindly advise, I am new to onnxruntime .\r\n\r\nthanks in advance.\r\n\
          ![1.jpg](https://cdn-uploads.huggingface.co/production/uploads/654a2e40b9cfada0bd331e76/bE0yOH3uWkdvndFegqVMZ.jpeg)\r\
          \n"
        updatedAt: '2023-11-11T05:29:00.780Z'
      numEdits: 0
      reactions: []
    id: 654f111ce5f380aca8c806c8
    type: comment
  author: jasonzhang76
  content: "I exported the model to onnx, it generate a encoder.onnx and decoder.onnx\r\
    \nI use c# to do encoder and it generate the result of \"encoder_hidden_states\"\
    ,\r\nThen I merge the input_ids and change to \"attension_mask\" to \"encoder_attention_mask\"\
    \ and also merge into a tensor array,\r\nAnd aflter decode by decoder.onnx, it\
    \ outputs many tensor results like \"logits\",\"present.0.decoder.key \",\"present.0.decoder.value\"\
    \ and so on .\r\nbut I dont know hwo to use the result to do text2textgeneation\
    \ . \r\nthe sample I am using also the demo \"\u4F5C\u4E3A\u7535\u5B50[MASK]\u7684\
    \u5E73\u53F0\uFF0C\u4EAC\u4E1C\u7EDD\u5BF9\u662F\u9886\u5148\u8005\u3002\u5982\
    \u4ECA\u7684\u5218\u5F3A[MASK]\u5DF2\u7ECF\u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\
    \u8001\u677F\u3002\"\r\nthe pseudo code like below ( I am using C#)\r\ntext= \"\
    \u4F5C\u4E3A\u7535\u5B50[MASK]\u7684\u5E73\u53F0\uFF0C\u4EAC\u4E1C\u7EDD\u5BF9\
    \u662F\u9886\u5148\u8005\u3002\u5982\u4ECA\u7684\u5218\u5F3A[MASK]\u5DF2\u7ECF\
    \u662F\u8EAB\u4EF7\u8FC7[MASK]\u7684\u8001\u677F\u3002\"\r\nencoder_model = \"\
    encoder.onnx\"\r\ndecoder_model = \"decoder.onnx\"\r\ntokenizer = tokenizer.from(\"\
    vocab.txt\")\r\ntokens= tokenizer(text)\r\ninput = processtokensAsInput()\r\n\
    var after_encode= onnx_encoder_infersession.run(input)\r\nadd after_encode to\
    \ decode_input \"which is \"encoder_hidden_states\"\r\ninput[\"attension_mask\"\
    ].name = \"decoder_attension_mask\"\r\nadd input[\"attension_mask\"] to decode_input\
    \ \r\nadd input[\"input_ids\"] to decode_input\r\nvar after_decode= onnx_decoder_infersession.run(\
    \ decode_input)\r\n\r\nthe after_Decode contains \"logits\",\"present.0.decoder.key\
    \ \",\"present.0.decoder.value......\"\r\nhow can I leverage above to gerante\
    \ the result text ?\r\n\r\n\r\nPlease kindly advise, I am new to onnxruntime .\r\
    \n\r\nthanks in advance.\r\n![1.jpg](https://cdn-uploads.huggingface.co/production/uploads/654a2e40b9cfada0bd331e76/bE0yOH3uWkdvndFegqVMZ.jpeg)\r\
    \n"
  created_at: 2023-11-11 05:29:00+00:00
  edited: false
  hidden: false
  id: 654f111ce5f380aca8c806c8
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: uer/bart-base-chinese-cluecorpussmall
repo_type: model
status: open
target_branch: null
title: How to generate text by using c#
