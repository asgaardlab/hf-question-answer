!!python/object:huggingface_hub.community.DiscussionWithDetails
author: msteele
conflicting_files: null
created_at: 2023-07-26 11:39:56+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
      fullname: Matthew Steele
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: msteele
      type: user
    createdAt: '2023-07-26T12:39:56.000Z'
    data:
      edited: true
      editors:
      - msteele
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9186890125274658
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
          fullname: Matthew Steele
          isHf: false
          isPro: false
          name: msteele
          type: user
        html: '<p>Hi,</p>

          <p>I''m getting the following error when trying to run this model with TGI:<br>RuntimeError:
          weight model.layers.0.self_attn.rotary_emb.inv_freq does not exist</p>

          <p>I don''t see weight model.layers.0.self_attn.rotary_emb.inv_freq in pytorch_model.bin.index.json
          even though it is present in the llama-2 index (and in the other l2 airoboros
          models). Not sure if it is an issue with the model or with something I''m
          doing, but if anyone has successfully used with TGI and could point me in
          the right direction I''d appreciate it!</p>

          <p>Thanks for your awesome work on this model!!</p>

          '
        raw: 'Hi,


          I''m getting the following error when trying to run this model with TGI:

          RuntimeError: weight model.layers.0.self_attn.rotary_emb.inv_freq does not
          exist


          I don''t see weight model.layers.0.self_attn.rotary_emb.inv_freq in pytorch_model.bin.index.json
          even though it is present in the llama-2 index (and in the other l2 airoboros
          models). Not sure if it is an issue with the model or with something I''m
          doing, but if anyone has successfully used with TGI and could point me in
          the right direction I''d appreciate it!


          Thanks for your awesome work on this model!!'
        updatedAt: '2023-07-26T13:11:55.450Z'
      numEdits: 1
      reactions:
      - count: 2
        reaction: "\U0001F44D"
        users:
        - bikalnetomi
        - soohoonc
    id: 64c1141c5a8f5b0d13ce1eb2
    type: comment
  author: msteele
  content: 'Hi,


    I''m getting the following error when trying to run this model with TGI:

    RuntimeError: weight model.layers.0.self_attn.rotary_emb.inv_freq does not exist


    I don''t see weight model.layers.0.self_attn.rotary_emb.inv_freq in pytorch_model.bin.index.json
    even though it is present in the llama-2 index (and in the other l2 airoboros
    models). Not sure if it is an issue with the model or with something I''m doing,
    but if anyone has successfully used with TGI and could point me in the right direction
    I''d appreciate it!


    Thanks for your awesome work on this model!!'
  created_at: 2023-07-26 11:39:56+00:00
  edited: true
  hidden: false
  id: 64c1141c5a8f5b0d13ce1eb2
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
      fullname: Manoranjan Rajguru
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: monuminu
      type: user
    createdAt: '2023-07-26T12:48:05.000Z'
    data:
      edited: false
      editors:
      - monuminu
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8570231199264526
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
          fullname: Manoranjan Rajguru
          isHf: false
          isPro: false
          name: monuminu
          type: user
        html: '<p>same issue</p>

          '
        raw: same issue
        updatedAt: '2023-07-26T12:48:05.767Z'
      numEdits: 0
      reactions: []
    id: 64c11605e062a72f15c9a022
    type: comment
  author: monuminu
  content: same issue
  created_at: 2023-07-26 11:48:05+00:00
  edited: false
  hidden: false
  id: 64c11605e062a72f15c9a022
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6453dafca647b92069ac541a/QkUleoJtHHdTkqtW54QIG.jpeg?w=200&h=200&f=face
      fullname: Jon Durbin
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: jondurbin
      type: user
    createdAt: '2023-07-27T06:55:52.000Z'
    data:
      edited: false
      editors:
      - jondurbin
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8309816718101501
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6453dafca647b92069ac541a/QkUleoJtHHdTkqtW54QIG.jpeg?w=200&h=200&f=face
          fullname: Jon Durbin
          isHf: false
          isPro: true
          name: jondurbin
          type: user
        html: '<p>Not sure why, but it seems the merge -&gt; save_pretrained saved
          everything except the *rotary_emb.inv_freq data to the index.  I uploaded
          a new version: <a href="https://huggingface.co/jondurbin/airoboros-l2-70b-gpt4-1.4.1/blob/main/pytorch_model.bin.index.json">https://huggingface.co/jondurbin/airoboros-l2-70b-gpt4-1.4.1/blob/main/pytorch_model.bin.index.json</a></p>

          <p>Try downloading that again and let me know.</p>

          '
        raw: 'Not sure why, but it seems the merge -> save_pretrained saved everything
          except the *rotary_emb.inv_freq data to the index.  I uploaded a new version:
          https://huggingface.co/jondurbin/airoboros-l2-70b-gpt4-1.4.1/blob/main/pytorch_model.bin.index.json


          Try downloading that again and let me know.'
        updatedAt: '2023-07-27T06:55:52.679Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\u2764\uFE0F"
        users:
        - algorithm
    id: 64c214f82bac49787a9efaa8
    type: comment
  author: jondurbin
  content: 'Not sure why, but it seems the merge -> save_pretrained saved everything
    except the *rotary_emb.inv_freq data to the index.  I uploaded a new version:
    https://huggingface.co/jondurbin/airoboros-l2-70b-gpt4-1.4.1/blob/main/pytorch_model.bin.index.json


    Try downloading that again and let me know.'
  created_at: 2023-07-27 05:55:52+00:00
  edited: false
  hidden: false
  id: 64c214f82bac49787a9efaa8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
      fullname: Manoranjan Rajguru
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: monuminu
      type: user
    createdAt: '2023-07-27T07:04:46.000Z'
    data:
      edited: false
      editors:
      - monuminu
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9577409625053406
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
          fullname: Manoranjan Rajguru
          isHf: false
          isPro: false
          name: monuminu
          type: user
        html: '<p>thank you. Let me try again !</p>

          '
        raw: thank you. Let me try again !
        updatedAt: '2023-07-27T07:04:46.119Z'
      numEdits: 0
      reactions: []
    id: 64c2170ea3d4c23e0e996ea5
    type: comment
  author: monuminu
  content: thank you. Let me try again !
  created_at: 2023-07-27 06:04:46+00:00
  edited: false
  hidden: false
  id: 64c2170ea3d4c23e0e996ea5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
      fullname: Matthew Steele
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: msteele
      type: user
    createdAt: '2023-07-27T15:47:31.000Z'
    data:
      edited: false
      editors:
      - msteele
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.937663197517395
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
          fullname: Matthew Steele
          isHf: false
          isPro: false
          name: msteele
          type: user
        html: '<p>Thanks for uploading the new file. I am still getting the same error,
          trying to figure out how TGI is loading the model and debug to see if it
          is on their end. Its not clear to me if the bin.index is causing the issue
          or the actual files.</p>

          '
        raw: Thanks for uploading the new file. I am still getting the same error,
          trying to figure out how TGI is loading the model and debug to see if it
          is on their end. Its not clear to me if the bin.index is causing the issue
          or the actual files.
        updatedAt: '2023-07-27T15:47:31.140Z'
      numEdits: 0
      reactions: []
    id: 64c291933499e4f3a2055e0f
    type: comment
  author: msteele
  content: Thanks for uploading the new file. I am still getting the same error, trying
    to figure out how TGI is loading the model and debug to see if it is on their
    end. Its not clear to me if the bin.index is causing the issue or the actual files.
  created_at: 2023-07-27 14:47:31+00:00
  edited: false
  hidden: false
  id: 64c291933499e4f3a2055e0f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
      fullname: Matthew Steele
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: msteele
      type: user
    createdAt: '2023-07-28T16:23:59.000Z'
    data:
      edited: false
      editors:
      - msteele
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9888266324996948
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/102d537bdc535c922ffe199c88bec191.svg
          fullname: Matthew Steele
          isHf: false
          isPro: false
          name: msteele
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;monuminu&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/monuminu\">@<span class=\"\
          underline\">monuminu</span></a></span>\n\n\t</span></span> did you have\
          \ any luck?</p>\n"
        raw: '@monuminu did you have any luck?'
        updatedAt: '2023-07-28T16:23:59.326Z'
      numEdits: 0
      reactions: []
    id: 64c3eb9f57e5b2cd8abd27f9
    type: comment
  author: msteele
  content: '@monuminu did you have any luck?'
  created_at: 2023-07-28 15:23:59+00:00
  edited: false
  hidden: false
  id: 64c3eb9f57e5b2cd8abd27f9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6453dafca647b92069ac541a/QkUleoJtHHdTkqtW54QIG.jpeg?w=200&h=200&f=face
      fullname: Jon Durbin
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: true
      name: jondurbin
      type: user
    createdAt: '2023-07-29T10:19:06.000Z'
    data:
      edited: false
      editors:
      - jondurbin
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9566762447357178
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6453dafca647b92069ac541a/QkUleoJtHHdTkqtW54QIG.jpeg?w=200&h=200&f=face
          fullname: Jon Durbin
          isHf: false
          isPro: true
          name: jondurbin
          type: user
        html: '<p>Sorry I don''t have an answer for you, but I don''t use TGI.  I
          usually do one-off tests with FastChat, "real" work directly with python/transformers
          library.</p>

          <p>Just a thought: have you considered vllm?  With the TGI license change,
          and better inference speed of vllm, it might be worth a look, although I
          haven''t tested it with my model yet.<br><a rel="nofollow" href="https://github.com/vllm-project/vllm">https://github.com/vllm-project/vllm</a></p>

          '
        raw: 'Sorry I don''t have an answer for you, but I don''t use TGI.  I usually
          do one-off tests with FastChat, "real" work directly with python/transformers
          library.


          Just a thought: have you considered vllm?  With the TGI license change,
          and better inference speed of vllm, it might be worth a look, although I
          haven''t tested it with my model yet.

          https://github.com/vllm-project/vllm'
        updatedAt: '2023-07-29T10:19:06.415Z'
      numEdits: 0
      reactions: []
    id: 64c4e79ae356b52a98630929
    type: comment
  author: jondurbin
  content: 'Sorry I don''t have an answer for you, but I don''t use TGI.  I usually
    do one-off tests with FastChat, "real" work directly with python/transformers
    library.


    Just a thought: have you considered vllm?  With the TGI license change, and better
    inference speed of vllm, it might be worth a look, although I haven''t tested
    it with my model yet.

    https://github.com/vllm-project/vllm'
  created_at: 2023-07-29 09:19:06+00:00
  edited: false
  hidden: false
  id: 64c4e79ae356b52a98630929
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
      fullname: Manoranjan Rajguru
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: monuminu
      type: user
    createdAt: '2023-08-03T16:43:41.000Z'
    data:
      edited: false
      editors:
      - monuminu
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5982299447059631
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/80147200fd8355db9f7c9845096d4c2e.svg
          fullname: Manoranjan Rajguru
          isHf: false
          isPro: false
          name: monuminu
          type: user
        html: '<p>no it dint work RuntimeError: weight model.layers.40.self_attn.rotary_emb.inv_freq
          does not exist</p>

          '
        raw: 'no it dint work RuntimeError: weight model.layers.40.self_attn.rotary_emb.inv_freq
          does not exist'
        updatedAt: '2023-08-03T16:43:41.318Z'
      numEdits: 0
      reactions: []
    id: 64cbd93d8a16b1748f10700e
    type: comment
  author: monuminu
  content: 'no it dint work RuntimeError: weight model.layers.40.self_attn.rotary_emb.inv_freq
    does not exist'
  created_at: 2023-08-03 15:43:41+00:00
  edited: false
  hidden: false
  id: 64cbd93d8a16b1748f10700e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5f905f6ac52a231a15ea755c710613b3.svg
      fullname: 'Sven Schultze '
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: svenschultze
      type: user
    createdAt: '2023-08-03T21:25:31.000Z'
    data:
      edited: false
      editors:
      - svenschultze
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8885570764541626
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5f905f6ac52a231a15ea755c710613b3.svg
          fullname: 'Sven Schultze '
          isHf: false
          isPro: false
          name: svenschultze
          type: user
        html: '<p>This is happening because of this PR: <a rel="nofollow" href="https://github.com/huggingface/transformers/pull/24998">https://github.com/huggingface/transformers/pull/24998</a>.<br>Try
          to load with a newer version of transformers (install from source) or save
          from older version.</p>

          '
        raw: 'This is happening because of this PR: https://github.com/huggingface/transformers/pull/24998.

          Try to load with a newer version of transformers (install from source) or
          save from older version.'
        updatedAt: '2023-08-03T21:25:31.192Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\u2764\uFE0F"
        users:
        - liqiqimali
    id: 64cc1b4ba257a3212c0e473b
    type: comment
  author: svenschultze
  content: 'This is happening because of this PR: https://github.com/huggingface/transformers/pull/24998.

    Try to load with a newer version of transformers (install from source) or save
    from older version.'
  created_at: 2023-08-03 20:25:31+00:00
  edited: false
  hidden: false
  id: 64cc1b4ba257a3212c0e473b
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: jondurbin/airoboros-l2-70b-gpt4-1.4.1
repo_type: model
status: open
target_branch: null
title: 'Error using with Text-Generation-Inference RuntimeError: weight model.layers.0.self_attn.rotary_emb.inv_freq
  does not exist'
