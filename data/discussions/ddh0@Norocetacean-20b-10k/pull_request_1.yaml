!!python/object:huggingface_hub.community.DiscussionWithDetails
author: TheBloke
conflicting_files: []
created_at: 2023-12-18 13:33:06+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-12-18T13:33:06.000Z'
    data:
      edited: false
      editors:
      - TheBloke
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3262268602848053
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
          fullname: Tom Jobbins
          isHf: false
          isPro: true
          name: TheBloke
          type: user
        html: "<p>I checked how NousResearch YaRN models did it, and they have <code>rope_scaling=None</code>\
          \ defined in this Python file.  Then that will be overriden by the values\
          \ specified in your config.json:</p>\n<p>Before this PR I couldn't load\
          \ the model, but this PR enables me to load it - below confirms that correct\
          \ <code>rope_scaling</code> is then applied:</p>\n<pre><code>In [1]: from\
          \ transformers import AutoModelForCausalLM, AutoTokenizer\n\nIn [2]: model\
          \ = AutoModelForCausalLM.from_pretrained(\"/workspace/process/ddh0_norocetacean-20b-10k/source\"\
          \ , low_cpu_mem_usage=True, trust_remote_code=True)\nLoading checkpoint\
          \ shards: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5/5 [00:08&lt;00:00, \
          \ 1.77s/it]\n\nIn [4]: model.config.rope_scaling\nOut[4]:\n{'factor': 2.5,\n\
          \ 'original_max_position_embeddings': 4096,\n 'type': 'yarn',\n 'finetuned':\
          \ False}\n\nIn [5]:\n</code></pre>\n"
        raw: "I checked how NousResearch YaRN models did it, and they have `rope_scaling=None`\
          \ defined in this Python file.  Then that will be overriden by the values\
          \ specified in your config.json:\n\nBefore this PR I couldn't load the model,\
          \ but this PR enables me to load it - below confirms that correct `rope_scaling`\
          \ is then applied:\n\n```\nIn [1]: from transformers import AutoModelForCausalLM,\
          \ AutoTokenizer\n\nIn [2]: model = AutoModelForCausalLM.from_pretrained(\"\
          /workspace/process/ddh0_norocetacean-20b-10k/source\" , low_cpu_mem_usage=True,\
          \ trust_remote_code=True)\nLoading checkpoint shards: 100%|\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588| 5/5 [00:08<00:00,  1.77s/it]\n\nIn [4]: model.config.rope_scaling\n\
          Out[4]:\n{'factor': 2.5,\n 'original_max_position_embeddings': 4096,\n 'type':\
          \ 'yarn',\n 'finetuned': False}\n\nIn [5]:\n```"
        updatedAt: '2023-12-18T13:33:06.384Z'
      numEdits: 0
      reactions: []
    id: 65804a12c1b5aed69321fe0e
    type: comment
  author: TheBloke
  content: "I checked how NousResearch YaRN models did it, and they have `rope_scaling=None`\
    \ defined in this Python file.  Then that will be overriden by the values specified\
    \ in your config.json:\n\nBefore this PR I couldn't load the model, but this PR\
    \ enables me to load it - below confirms that correct `rope_scaling` is then applied:\n\
    \n```\nIn [1]: from transformers import AutoModelForCausalLM, AutoTokenizer\n\n\
    In [2]: model = AutoModelForCausalLM.from_pretrained(\"/workspace/process/ddh0_norocetacean-20b-10k/source\"\
    \ , low_cpu_mem_usage=True, trust_remote_code=True)\nLoading checkpoint shards:\
    \ 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5/5 [00:08<00:00,\
    \  1.77s/it]\n\nIn [4]: model.config.rope_scaling\nOut[4]:\n{'factor': 2.5,\n\
    \ 'original_max_position_embeddings': 4096,\n 'type': 'yarn',\n 'finetuned': False}\n\
    \nIn [5]:\n```"
  created_at: 2023-12-18 13:33:06+00:00
  edited: false
  hidden: false
  id: 65804a12c1b5aed69321fe0e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6426d3f3a7723d62b53c259b/tvPikpAzKTKGN5wrpadOJ.jpeg?w=200&h=200&f=face
      fullname: Tom Jobbins
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: true
      name: TheBloke
      type: user
    createdAt: '2023-12-18T13:33:07.000Z'
    data:
      oid: 4d436dbbce1605d4eb4f290648f02446eaac372f
      parents:
      - 09e6f8b83427aeab05be9077fc704aa63bb775d7
      subject: Update configuration_llama.py, required to get model to Load as `rope_scaling`
        needs to be None, or else a dictionary
    id: 65804a130000000000000000
    type: commit
  author: TheBloke
  created_at: 2023-12-18 13:33:07+00:00
  id: 65804a130000000000000000
  oid: 4d436dbbce1605d4eb4f290648f02446eaac372f
  summary: Update configuration_llama.py, required to get model to Load as `rope_scaling`
    needs to be None, or else a dictionary
  type: commit
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/64bc5b4512d00c4589dfa8a6/0U8IW9ZKT5crAIR30sLP_.png?w=200&h=200&f=face
      fullname: ddh0
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ddh0
      type: user
    createdAt: '2023-12-18T14:06:13.000Z'
    data:
      status: merged
    id: 658051d58108945fd39eefa5
    type: status-change
  author: ddh0
  created_at: 2023-12-18 14:06:13+00:00
  id: 658051d58108945fd39eefa5
  new_status: merged
  type: status-change
is_pull_request: true
merge_commit_oid: a9d4e89b09e4cda4aff6bdc29e0d5db3d41e15e4
num: 1
repo_id: ddh0/Norocetacean-20b-10k
repo_type: model
status: merged
target_branch: refs/heads/main
title: Update configuration_llama.py, required to get model to Load as `rope_scaling`
  needs to be None, or else a dictionary
