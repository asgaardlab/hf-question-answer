!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Beck777
conflicting_files: null
created_at: 2023-09-07 11:45:23+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/65567f5e847c6761b1fe382937258466.svg
      fullname: Beck
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Beck777
      type: user
    createdAt: '2023-09-07T12:45:23.000Z'
    data:
      edited: false
      editors:
      - Beck777
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3766951858997345
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/65567f5e847c6761b1fe382937258466.svg
          fullname: Beck
          isHf: false
          isPro: false
          name: Beck777
          type: user
        html: '<blockquote>

          <blockquote>

          <blockquote>

          <blockquote>

          <p>Flash Attention installed<br>Flash RoPE installed</p>

          </blockquote>

          </blockquote>

          </blockquote>

          </blockquote>

          <p>*** Generate:<br>/home/beck/.cache/huggingface/modules/transformers_modules/TheBloke/Yarn-Llama-2-7B-128K-GPTQ/d4fc0fb58bb6426ddb0ad7c104493c611a0a3a69/modeling_llama_together_yarn.py:522:
          UserWarning: operator() profile_node %34 : int[] = prim::profile_ivalue(%32)<br>
          does not have profile information (Triggered internally at ../third_party/nvfuser/csrc/graph_fuser.cpp:104.)<br>  kv
          = repeat_kv(kv, self.num_key_value_groups)<br>Traceback (most recent call
          last):<br>  File "", line 198, in _run_module_as_main<br>  File "", line
          88, in _run_code<br>  File "/var/local/acp/dashboards/draft/weaviate/app/module/consumer_distil_url_content.py",
          line 296, in <br>    output = model.generate(inputs=input_ids, temperature=0.7,
          max_new_tokens=512)<br>             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/torch/utils/_contextlib.py",
          line 115, in decorate_context<br>    return func(*args, **kwargs)<br>           ^^^^^^^^^^^^^^^^^^^^^<br>  File
          "/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py",
          line 1648, in generate<br>    return self.sample(<br>           ^^^^^^^^^^^^<br>  File
          "/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py",
          line 2766, in sample<br>    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)<br>                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>RuntimeError:
          probability tensor contains either <code>inf</code>, <code>nan</code> or
          element &lt; 0</p>

          '
        raw: ">>>> Flash Attention installed\r\n>>>> Flash RoPE installed\r\n\r\n\r\
          \n*** Generate:\r\n/home/beck/.cache/huggingface/modules/transformers_modules/TheBloke/Yarn-Llama-2-7B-128K-GPTQ/d4fc0fb58bb6426ddb0ad7c104493c611a0a3a69/modeling_llama_together_yarn.py:522:\
          \ UserWarning: operator() profile_node %34 : int[] = prim::profile_ivalue(%32)\r\
          \n does not have profile information (Triggered internally at ../third_party/nvfuser/csrc/graph_fuser.cpp:104.)\r\
          \n  kv = repeat_kv(kv, self.num_key_value_groups)\r\nTraceback (most recent\
          \ call last):\r\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\r\
          \n  File \"<frozen runpy>\", line 88, in _run_code\r\n  File \"/var/local/acp/dashboards/draft/weaviate/app/module/consumer_distil_url_content.py\"\
          , line 296, in <module>\r\n    output = model.generate(inputs=input_ids,\
          \ temperature=0.7, max_new_tokens=512)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\
          \n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
          , line 115, in decorate_context\r\n    return func(*args, **kwargs)\r\n\
          \           ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py\"\
          , line 1648, in generate\r\n    return self.sample(\r\n           ^^^^^^^^^^^^\r\
          \n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py\"\
          , line 2766, in sample\r\n    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)\r\
          \n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nRuntimeError:\
          \ probability tensor contains either `inf`, `nan` or element < 0\r\n"
        updatedAt: '2023-09-07T12:45:23.880Z'
      numEdits: 0
      reactions: []
    id: 64f9c5e3f1bcfdb88f0ca1e8
    type: comment
  author: Beck777
  content: ">>>> Flash Attention installed\r\n>>>> Flash RoPE installed\r\n\r\n\r\n\
    *** Generate:\r\n/home/beck/.cache/huggingface/modules/transformers_modules/TheBloke/Yarn-Llama-2-7B-128K-GPTQ/d4fc0fb58bb6426ddb0ad7c104493c611a0a3a69/modeling_llama_together_yarn.py:522:\
    \ UserWarning: operator() profile_node %34 : int[] = prim::profile_ivalue(%32)\r\
    \n does not have profile information (Triggered internally at ../third_party/nvfuser/csrc/graph_fuser.cpp:104.)\r\
    \n  kv = repeat_kv(kv, self.num_key_value_groups)\r\nTraceback (most recent call\
    \ last):\r\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\r\n  File\
    \ \"<frozen runpy>\", line 88, in _run_code\r\n  File \"/var/local/acp/dashboards/draft/weaviate/app/module/consumer_distil_url_content.py\"\
    , line 296, in <module>\r\n    output = model.generate(inputs=input_ids, temperature=0.7,\
    \ max_new_tokens=512)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\
    \n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/torch/utils/_contextlib.py\"\
    , line 115, in decorate_context\r\n    return func(*args, **kwargs)\r\n      \
    \     ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py\"\
    , line 1648, in generate\r\n    return self.sample(\r\n           ^^^^^^^^^^^^\r\
    \n  File \"/home/beck/.local/share/virtualenvs/weaviate-CeQZUpy1/lib/python3.11/site-packages/transformers/generation/utils.py\"\
    , line 2766, in sample\r\n    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)\r\
    \n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nRuntimeError: probability\
    \ tensor contains either `inf`, `nan` or element < 0\r\n"
  created_at: 2023-09-07 11:45:23+00:00
  edited: false
  hidden: false
  id: 64f9c5e3f1bcfdb88f0ca1e8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/-6Yq7oM_Ju6Zi2GEvobvb.jpeg?w=200&h=200&f=face
      fullname: Ronan McGovern
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: RonanMcGovern
      type: user
    createdAt: '2023-09-08T10:54:23.000Z'
    data:
      edited: false
      editors:
      - RonanMcGovern
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.965072751045227
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/-6Yq7oM_Ju6Zi2GEvobvb.jpeg?w=200&h=200&f=face
          fullname: Ronan McGovern
          isHf: false
          isPro: false
          name: RonanMcGovern
          type: user
        html: "<p>Yes <span data-props=\"{&quot;user&quot;:&quot;TheBloke&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/TheBloke\"\
          >@<span class=\"underline\">TheBloke</span></a></span>\n\n\t</span></span>\
          \ there seems to be an inconsistency between the 7B and 13B YaRN models\
          \ (both 64k and 128k) whereby the 7B model gives this error and also a Llama\
          \ config error because it can't find rope_theta. 13B seems to work.</p>\n"
        raw: Yes @TheBloke there seems to be an inconsistency between the 7B and 13B
          YaRN models (both 64k and 128k) whereby the 7B model gives this error and
          also a Llama config error because it can't find rope_theta. 13B seems to
          work.
        updatedAt: '2023-09-08T10:54:23.959Z'
      numEdits: 0
      reactions: []
    id: 64fafd5fb961d0d12c7cef8a
    type: comment
  author: RonanMcGovern
  content: Yes @TheBloke there seems to be an inconsistency between the 7B and 13B
    YaRN models (both 64k and 128k) whereby the 7B model gives this error and also
    a Llama config error because it can't find rope_theta. 13B seems to work.
  created_at: 2023-09-08 09:54:23+00:00
  edited: false
  hidden: false
  id: 64fafd5fb961d0d12c7cef8a
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: TheBloke/Yarn-Llama-2-7B-128K-GPTQ
repo_type: model
status: open
target_branch: null
title: Error, example not working
