!!python/object:huggingface_hub.community.DiscussionWithDetails
author: mxxtsai
conflicting_files: null
created_at: 2023-09-28 23:58:31+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e705f4c5c5fbba081c8ed6f5ad70d858.svg
      fullname: Maxwell Tsai
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mxxtsai
      type: user
    createdAt: '2023-09-29T00:58:31.000Z'
    data:
      edited: false
      editors:
      - mxxtsai
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8300228714942932
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e705f4c5c5fbba081c8ed6f5ad70d858.svg
          fullname: Maxwell Tsai
          isHf: false
          isPro: false
          name: mxxtsai
          type: user
        html: '<p>Hi,</p>

          <p>First of all, thank you all for releasing such an amazing model! I''m
          trying to further train Mistral-7B-v0.1 on some custom data. </p>

          <p>I noticed that the official implementation (<a rel="nofollow" href="https://github.com/mistralai/mistral-src/blob/main/mistral/model.py">https://github.com/mistralai/mistral-src/blob/main/mistral/model.py</a>)
          has Flash Attention built in. </p>

          <p>However, the HuggingFace version (<a rel="nofollow" href="https://github.com/huggingface/transformers/blob/main/src/transformers/models/mistral/modeling_mistral.py">https://github.com/huggingface/transformers/blob/main/src/transformers/models/mistral/modeling_mistral.py</a>)
          doesn''t seem to have Flash Attention integrated.</p>

          <p>Is it possible if you can provide a script so that we can replace standard
          attention with Flash Attention after we''ve loaded the model via </p>

          <pre><code>model = AutoModelForCausalLM.from_pretrained("mistralai/Mistral-7B-v0.1")

          </code></pre>

          <p>Thank you for your time and effort :)</p>

          '
        raw: "Hi,\r\n\r\nFirst of all, thank you all for releasing such an amazing\
          \ model! I'm trying to further train Mistral-7B-v0.1 on some custom data.\
          \ \r\n\r\nI noticed that the official implementation (https://github.com/mistralai/mistral-src/blob/main/mistral/model.py)\
          \ has Flash Attention built in. \r\n\r\nHowever, the HuggingFace version\
          \ (https://github.com/huggingface/transformers/blob/main/src/transformers/models/mistral/modeling_mistral.py)\
          \ doesn't seem to have Flash Attention integrated.\r\n\r\nIs it possible\
          \ if you can provide a script so that we can replace standard attention\
          \ with Flash Attention after we've loaded the model via \r\n```\r\nmodel\
          \ = AutoModelForCausalLM.from_pretrained(\"mistralai/Mistral-7B-v0.1\")\r\
          \n```\r\n\r\nThank you for your time and effort :)"
        updatedAt: '2023-09-29T00:58:31.807Z'
      numEdits: 0
      reactions:
      - count: 4
        reaction: "\U0001F44D"
        users:
        - bhenrym14
        - JojoPuppet
        - CoolWP
        - usholanb
    id: 65162137c4792fb5c80fa7b0
    type: comment
  author: mxxtsai
  content: "Hi,\r\n\r\nFirst of all, thank you all for releasing such an amazing model!\
    \ I'm trying to further train Mistral-7B-v0.1 on some custom data. \r\n\r\nI noticed\
    \ that the official implementation (https://github.com/mistralai/mistral-src/blob/main/mistral/model.py)\
    \ has Flash Attention built in. \r\n\r\nHowever, the HuggingFace version (https://github.com/huggingface/transformers/blob/main/src/transformers/models/mistral/modeling_mistral.py)\
    \ doesn't seem to have Flash Attention integrated.\r\n\r\nIs it possible if you\
    \ can provide a script so that we can replace standard attention with Flash Attention\
    \ after we've loaded the model via \r\n```\r\nmodel = AutoModelForCausalLM.from_pretrained(\"\
    mistralai/Mistral-7B-v0.1\")\r\n```\r\n\r\nThank you for your time and effort\
    \ :)"
  created_at: 2023-09-28 23:58:31+00:00
  edited: false
  hidden: false
  id: 65162137c4792fb5c80fa7b0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/689ccd722bf64220364b9601d0bc3a7b.svg
      fullname: kiran
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kira
      type: user
    createdAt: '2023-10-02T09:31:15.000Z'
    data:
      edited: true
      editors:
      - kira
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9779384136199951
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/689ccd722bf64220364b9601d0bc3a7b.svg
          fullname: kiran
          isHf: false
          isPro: false
          name: kira
          type: user
        html: '<p>its still WIP, but I used this seems to work fine for FA2 <a rel="nofollow"
          href="https://github.com/huggingface/transformers/pull/26464">https://github.com/huggingface/transformers/pull/26464</a></p>

          '
        raw: its still WIP, but I used this seems to work fine for FA2 https://github.com/huggingface/transformers/pull/26464
        updatedAt: '2023-10-02T09:31:36.451Z'
      numEdits: 1
      reactions: []
    id: 651a8de30d365fb776480c95
    type: comment
  author: kira
  content: its still WIP, but I used this seems to work fine for FA2 https://github.com/huggingface/transformers/pull/26464
  created_at: 2023-10-02 08:31:15+00:00
  edited: true
  hidden: false
  id: 651a8de30d365fb776480c95
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 17
repo_id: mistralai/Mistral-7B-v0.1
repo_type: model
status: open
target_branch: null
title: FlashAttention support for Mistral HF Implementation
