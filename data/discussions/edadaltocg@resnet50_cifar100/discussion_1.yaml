!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Devrim
conflicting_files: null
created_at: 2023-06-06 18:15:07+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f52adcf86a5baf5c306e412a864edccc.svg
      fullname: "Devrim \xC7avu\u015Fo\u011Flu"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Devrim
      type: user
    createdAt: '2023-06-06T19:15:07.000Z'
    data:
      edited: false
      editors:
      - Devrim
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3222077190876007
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f52adcf86a5baf5c306e412a864edccc.svg
          fullname: "Devrim \xC7avu\u015Fo\u011Flu"
          isHf: false
          isPro: false
          name: Devrim
          type: user
        html: "<p>Getting an error while loading the pretrained model with timm.</p>\n\
          <p>Versions:<br>timm: 0.9.2<br>torch: 1.12.1</p>\n<pre><code class=\"language-python\"\
          ><span class=\"hljs-meta\">&gt;&gt;&gt; </span><span class=\"hljs-keyword\"\
          >import</span> timm\n<span class=\"hljs-meta\">&gt;&gt;&gt; </span>model\
          \ = timm.create_model(<span class=\"hljs-string\">\"hf_hub:edadaltocg/resnet50_cifar100\"\
          </span>, pretrained=<span class=\"hljs-literal\">True</span>)\nDownloading\
          \ (\u2026)lve/main/config.json: <span class=\"hljs-number\">100</span>%|\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588| <span class=\"hljs-number\">885</span>/<span class=\"\
          hljs-number\">885</span> [<span class=\"hljs-number\">00</span>:<span class=\"\
          hljs-number\">00</span>&lt;<span class=\"hljs-number\">00</span>:<span class=\"\
          hljs-number\">00</span>, 299kB/s]\nDownloading pytorch_model.<span class=\"\
          hljs-built_in\">bin</span>: <span class=\"hljs-number\">100</span>%|\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588| <span class=\"hljs-number\">95.1</span>M/<span\
          \ class=\"hljs-number\">95.1</span>M [<span class=\"hljs-number\">00</span>:01&lt;<span\
          \ class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>,\
          \ <span class=\"hljs-number\">73.7</span>MB/s]\nTraceback (most recent call\
          \ last):\n  File <span class=\"hljs-string\">\"&lt;stdin&gt;\"</span>, line\
          \ <span class=\"hljs-number\">1</span>, <span class=\"hljs-keyword\">in</span>\
          \ &lt;module&gt;\n  File <span class=\"hljs-string\">\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_factory.py\"\
          </span>, line <span class=\"hljs-number\">114</span>, <span class=\"hljs-keyword\"\
          >in</span> create_model\n    model = create_fn(\n  File <span class=\"hljs-string\"\
          >\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
          </span>, line <span class=\"hljs-number\">1276</span>, <span class=\"hljs-keyword\"\
          >in</span> resnet50\n    <span class=\"hljs-keyword\">return</span> _create_resnet(<span\
          \ class=\"hljs-string\">'resnet50'</span>, pretrained, **<span class=\"\
          hljs-built_in\">dict</span>(model_args, **kwargs))\n  File <span class=\"\
          hljs-string\">\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
          </span>, line <span class=\"hljs-number\">547</span>, <span class=\"hljs-keyword\"\
          >in</span> _create_resnet\n    <span class=\"hljs-keyword\">return</span>\
          \ build_model_with_cfg(ResNet, variant, pretrained, **kwargs)\n  File <span\
          \ class=\"hljs-string\">\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
          </span>, line <span class=\"hljs-number\">393</span>, <span class=\"hljs-keyword\"\
          >in</span> build_model_with_cfg\n    load_pretrained(\n  File <span class=\"\
          hljs-string\">\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
          </span>, line <span class=\"hljs-number\">233</span>, <span class=\"hljs-keyword\"\
          >in</span> load_pretrained\n    model.load_state_dict(state_dict, strict=strict)\n\
          \  File <span class=\"hljs-string\">\"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/torch/nn/modules/module.py\"\
          </span>, line <span class=\"hljs-number\">1604</span>, <span class=\"hljs-keyword\"\
          >in</span> load_state_dict\n    <span class=\"hljs-keyword\">raise</span>\
          \ RuntimeError(<span class=\"hljs-string\">'Error(s) in loading state_dict\
          \ for {}:\\n\\t{}'</span>.<span class=\"hljs-built_in\">format</span>(\n\
          RuntimeError: Error(s) <span class=\"hljs-keyword\">in</span> loading state_dict\
          \ <span class=\"hljs-keyword\">for</span> ResNet:\n    size mismatch <span\
          \ class=\"hljs-keyword\">for</span> conv1.weight: copying a param <span\
          \ class=\"hljs-keyword\">with</span> shape torch.Size([<span class=\"hljs-number\"\
          >64</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\"\
          >3</span>, <span class=\"hljs-number\">3</span>]) <span class=\"hljs-keyword\"\
          >from</span> checkpoint, the shape <span class=\"hljs-keyword\">in</span>\
          \ current model <span class=\"hljs-keyword\">is</span> torch.Size([<span\
          \ class=\"hljs-number\">64</span>, <span class=\"hljs-number\">3</span>,\
          \ <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">7</span>]).\n\
          </code></pre>\n"
        raw: "Getting an error while loading the pretrained model with timm.\r\n\r\
          \nVersions:\r\ntimm: 0.9.2\r\ntorch: 1.12.1\r\n\r\n```python\r\n>>> import\
          \ timm\r\n>>> model = timm.create_model(\"hf_hub:edadaltocg/resnet50_cifar100\"\
          , pretrained=True)\r\nDownloading (\u2026)lve/main/config.json: 100%|\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588| 885/885 [00:00<00:00, 299kB/s]\r\nDownloading\
          \ pytorch_model.bin: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
          \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 95.1M/95.1M\
          \ [00:01<00:00, 73.7MB/s]\r\nTraceback (most recent call last):\r\n  File\
          \ \"<stdin>\", line 1, in <module>\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_factory.py\"\
          , line 114, in create_model\r\n    model = create_fn(\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
          , line 1276, in resnet50\r\n    return _create_resnet('resnet50', pretrained,\
          \ **dict(model_args, **kwargs))\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
          , line 547, in _create_resnet\r\n    return build_model_with_cfg(ResNet,\
          \ variant, pretrained, **kwargs)\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
          , line 393, in build_model_with_cfg\r\n    load_pretrained(\r\n  File \"\
          /home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
          , line 233, in load_pretrained\r\n    model.load_state_dict(state_dict,\
          \ strict=strict)\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/torch/nn/modules/module.py\"\
          , line 1604, in load_state_dict\r\n    raise RuntimeError('Error(s) in loading\
          \ state_dict for {}:\\n\\t{}'.format(\r\nRuntimeError: Error(s) in loading\
          \ state_dict for ResNet:\r\n\tsize mismatch for conv1.weight: copying a\
          \ param with shape torch.Size([64, 3, 3, 3]) from checkpoint, the shape\
          \ in current model is torch.Size([64, 3, 7, 7]).\r\n```"
        updatedAt: '2023-06-06T19:15:07.272Z'
      numEdits: 0
      reactions: []
    id: 647f85bb4da748fc4abe660a
    type: comment
  author: Devrim
  content: "Getting an error while loading the pretrained model with timm.\r\n\r\n\
    Versions:\r\ntimm: 0.9.2\r\ntorch: 1.12.1\r\n\r\n```python\r\n>>> import timm\r\
    \n>>> model = timm.create_model(\"hf_hub:edadaltocg/resnet50_cifar100\", pretrained=True)\r\
    \nDownloading (\u2026)lve/main/config.json: 100%|\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 885/885 [00:00<00:00, 299kB/s]\r\
    \nDownloading pytorch_model.bin: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\
    \u2588\u2588\u2588\u2588\u2588\u2588\u2588| 95.1M/95.1M [00:01<00:00, 73.7MB/s]\r\
    \nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\
    \n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_factory.py\"\
    , line 114, in create_model\r\n    model = create_fn(\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
    , line 1276, in resnet50\r\n    return _create_resnet('resnet50', pretrained,\
    \ **dict(model_args, **kwargs))\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/resnet.py\"\
    , line 547, in _create_resnet\r\n    return build_model_with_cfg(ResNet, variant,\
    \ pretrained, **kwargs)\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
    , line 393, in build_model_with_cfg\r\n    load_pretrained(\r\n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/timm/models/_builder.py\"\
    , line 233, in load_pretrained\r\n    model.load_state_dict(state_dict, strict=strict)\r\
    \n  File \"/home/devrim/miniconda3/envs/std/lib/python3.9/site-packages/torch/nn/modules/module.py\"\
    , line 1604, in load_state_dict\r\n    raise RuntimeError('Error(s) in loading\
    \ state_dict for {}:\\n\\t{}'.format(\r\nRuntimeError: Error(s) in loading state_dict\
    \ for ResNet:\r\n\tsize mismatch for conv1.weight: copying a param with shape\
    \ torch.Size([64, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([64,\
    \ 3, 7, 7]).\r\n```"
  created_at: 2023-06-06 18:15:07+00:00
  edited: false
  hidden: false
  id: 647f85bb4da748fc4abe660a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670087621682-638b80f9b0cc3ae137c44899.jpeg?w=200&h=200&f=face
      fullname: Eduardo Dadalto
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: edadaltocg
      type: user
    createdAt: '2023-06-07T14:45:51.000Z'
    data:
      edited: false
      editors:
      - edadaltocg
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8822705149650574
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1670087621682-638b80f9b0cc3ae137c44899.jpeg?w=200&h=200&f=face
          fullname: Eduardo Dadalto
          isHf: false
          isPro: false
          name: edadaltocg
          type: user
        html: '<p>Hi! You should <code>pip install detectors</code> first, or manually
          change the first convolutional layer to have filters of size 3 and not 7
          as the model trained on Imagenet.<br>Best.</p>

          '
        raw: 'Hi! You should `pip install detectors` first, or manually change the
          first convolutional layer to have filters of size 3 and not 7 as the model
          trained on Imagenet.

          Best.'
        updatedAt: '2023-06-07T14:45:51.826Z'
      numEdits: 0
      reactions: []
    id: 6480981fe1421e205fd98f96
    type: comment
  author: edadaltocg
  content: 'Hi! You should `pip install detectors` first, or manually change the first
    convolutional layer to have filters of size 3 and not 7 as the model trained on
    Imagenet.

    Best.'
  created_at: 2023-06-07 13:45:51+00:00
  edited: false
  hidden: false
  id: 6480981fe1421e205fd98f96
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: edadaltocg/resnet50_cifar100
repo_type: model
status: open
target_branch: null
title: "RuntimeError: Error(s) in loading state_dict for ResNet: \tsize mismatch for\
  \ conv1.weight"
