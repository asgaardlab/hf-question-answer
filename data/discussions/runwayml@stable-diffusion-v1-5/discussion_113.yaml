!!python/object:huggingface_hub.community.DiscussionWithDetails
author: mauricio-repetto
conflicting_files: null
created_at: 2023-04-24 21:57:08+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
      fullname: "Andr\xE9s Mauricio Repetto Ferrero"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mauricio-repetto
      type: user
    createdAt: '2023-04-24T22:57:08.000Z'
    data:
      edited: false
      editors:
      - mauricio-repetto
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
          fullname: "Andr\xE9s Mauricio Repetto Ferrero"
          isHf: false
          isPro: false
          name: mauricio-repetto
          type: user
        html: "<p>Hi! I'm running a set of experiments with chest x-ray images and\
          \ I'm applying different small noises. With amount of 0.2 of noise with\
          \ only 5 steps I'm getting a bunch of NSFW in return.</p>\n<p>Here is an\
          \ example of the code:</p>\n<pre><code>    init_image = Image.open(image).convert(\"\
          RGB\")\n    prompt = \"a chest-xray image\"\n    images = pipe(prompt=prompt,\
          \ image=init_image, strength=0.2, guidance_scale=10, num_inference_steps=5).images\n\
          \    images[0].save( f'noise_{image}')\n</code></pre>\n<p>When using 0.1/0.15\
          \  I get 2 NSFW but using 0.2 I get a lot of those prompts:</p>\n<p><a rel=\"\
          nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/62910f0d279de3b720971689/LzsC3l4m2RV1xEU3Dq-t-.png\"\
          ><img alt=\"nsfw.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/62910f0d279de3b720971689/LzsC3l4m2RV1xEU3Dq-t-.png\"\
          ></a></p>\n<p>Anybody had the same issue with this type of images or others?\
          \ or at least has a possible explanation for this behaviour?</p>\n"
        raw: "Hi! I'm running a set of experiments with chest x-ray images and I'm\
          \ applying different small noises. With amount of 0.2 of noise with only\
          \ 5 steps I'm getting a bunch of NSFW in return.\r\n\r\nHere is an example\
          \ of the code:\r\n```\r\n    init_image = Image.open(image).convert(\"RGB\"\
          )\r\n    prompt = \"a chest-xray image\"\r\n    images = pipe(prompt=prompt,\
          \ image=init_image, strength=0.2, guidance_scale=10, num_inference_steps=5).images\r\
          \n    images[0].save( f'noise_{image}')\r\n```\r\n\r\nWhen using 0.1/0.15\
          \  I get 2 NSFW but using 0.2 I get a lot of those prompts:\r\n\r\n![nsfw.png](https://cdn-uploads.huggingface.co/production/uploads/62910f0d279de3b720971689/LzsC3l4m2RV1xEU3Dq-t-.png)\r\
          \n\r\nAnybody had the same issue with this type of images or others? or\
          \ at least has a possible explanation for this behaviour?"
        updatedAt: '2023-04-24T22:57:08.779Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - adnanshussain
    id: 64470944beec3f80b28f507c
    type: comment
  author: mauricio-repetto
  content: "Hi! I'm running a set of experiments with chest x-ray images and I'm applying\
    \ different small noises. With amount of 0.2 of noise with only 5 steps I'm getting\
    \ a bunch of NSFW in return.\r\n\r\nHere is an example of the code:\r\n```\r\n\
    \    init_image = Image.open(image).convert(\"RGB\")\r\n    prompt = \"a chest-xray\
    \ image\"\r\n    images = pipe(prompt=prompt, image=init_image, strength=0.2,\
    \ guidance_scale=10, num_inference_steps=5).images\r\n    images[0].save( f'noise_{image}')\r\
    \n```\r\n\r\nWhen using 0.1/0.15  I get 2 NSFW but using 0.2 I get a lot of those\
    \ prompts:\r\n\r\n![nsfw.png](https://cdn-uploads.huggingface.co/production/uploads/62910f0d279de3b720971689/LzsC3l4m2RV1xEU3Dq-t-.png)\r\
    \n\r\nAnybody had the same issue with this type of images or others? or at least\
    \ has a possible explanation for this behaviour?"
  created_at: 2023-04-24 21:57:08+00:00
  edited: false
  hidden: false
  id: 64470944beec3f80b28f507c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-27T06:34:42.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: '<p>The safety checker is not great</p>

          '
        raw: The safety checker is not great
        updatedAt: '2023-04-27T06:34:42.127Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F614"
        users:
        - mauricio-repetto
    id: 644a1782f3ff2cb84eb07344
    type: comment
  author: patrickvonplaten
  content: The safety checker is not great
  created_at: 2023-04-27 05:34:42+00:00
  edited: false
  hidden: false
  id: 644a1782f3ff2cb84eb07344
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
      fullname: Adnan Hussain
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: adnanshussain
      type: user
    createdAt: '2023-07-05T15:56:34.000Z'
    data:
      edited: false
      editors:
      - adnanshussain
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7494223713874817
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
          fullname: Adnan Hussain
          isHf: false
          isPro: false
          name: adnanshussain
          type: user
        html: '<p>I''m having the same problem with the sample given here itself !!</p>

          <p>prompt = "a photo of an astronaut riding a horse on mars"</p>

          <p>so i dunno what i''m doing wrong !?</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/2wnf3Ag7JmImOJYQyuprr.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/2wnf3Ag7JmImOJYQyuprr.png"></a></p>

          '
        raw: 'I''m having the same problem with the sample given here itself !!


          prompt = "a photo of an astronaut riding a horse on mars"


          so i dunno what i''m doing wrong !?



          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/2wnf3Ag7JmImOJYQyuprr.png)

          '
        updatedAt: '2023-07-05T15:56:34.098Z'
      numEdits: 0
      reactions: []
    id: 64a592b2e80cee25b9fc0291
    type: comment
  author: adnanshussain
  content: 'I''m having the same problem with the sample given here itself !!


    prompt = "a photo of an astronaut riding a horse on mars"


    so i dunno what i''m doing wrong !?



    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/2wnf3Ag7JmImOJYQyuprr.png)

    '
  created_at: 2023-07-05 14:56:34+00:00
  edited: false
  hidden: false
  id: 64a592b2e80cee25b9fc0291
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
      fullname: "Andr\xE9s Mauricio Repetto Ferrero"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mauricio-repetto
      type: user
    createdAt: '2023-07-05T20:24:08.000Z'
    data:
      edited: false
      editors:
      - mauricio-repetto
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9581472873687744
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
          fullname: "Andr\xE9s Mauricio Repetto Ferrero"
          isHf: false
          isPro: false
          name: mauricio-repetto
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;adnanshussain&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/adnanshussain\"\
          >@<span class=\"underline\">adnanshussain</span></a></span>\n\n\t</span></span>\
          \ indeed it's weird that you're getting that for the given prompt.. but\
          \ as patrick said the safety checker is not great and you can disable it\
          \ by setting <code>safety_checker=None</code> when creating the pipeline.</p>\n"
        raw: '@adnanshussain indeed it''s weird that you''re getting that for the
          given prompt.. but as patrick said the safety checker is not great and you
          can disable it by setting `safety_checker=None` when creating the pipeline.'
        updatedAt: '2023-07-05T20:24:08.103Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - adnanshussain
    id: 64a5d16849b08110f7566f6e
    type: comment
  author: mauricio-repetto
  content: '@adnanshussain indeed it''s weird that you''re getting that for the given
    prompt.. but as patrick said the safety checker is not great and you can disable
    it by setting `safety_checker=None` when creating the pipeline.'
  created_at: 2023-07-05 19:24:08+00:00
  edited: false
  hidden: false
  id: 64a5d16849b08110f7566f6e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
      fullname: Adnan Hussain
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: adnanshussain
      type: user
    createdAt: '2023-07-06T06:49:25.000Z'
    data:
      edited: false
      editors:
      - adnanshussain
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7541394829750061
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
          fullname: Adnan Hussain
          isHf: false
          isPro: false
          name: adnanshussain
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;mauricio-repetto&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/mauricio-repetto\"\
          >@<span class=\"underline\">mauricio-repetto</span></a></span>\n\n\t</span></span>\
          \ thanks, but i cannot seem to find any safety_checker options in the from_pretrained\
          \ function and if I am trying to create a pipe like this</p>\n<p>pipe =\
          \ StableDiffusionPipeline(safety_checker=False)</p>\n<p>it asks for too\
          \ many other pameters also..</p>\n<p>Any idea what can be done ?</p>\n"
        raw: '@mauricio-repetto thanks, but i cannot seem to find any safety_checker
          options in the from_pretrained function and if I am trying to create a pipe
          like this


          pipe = StableDiffusionPipeline(safety_checker=False)


          it asks for too many other pameters also..


          Any idea what can be done ?'
        updatedAt: '2023-07-06T06:49:25.998Z'
      numEdits: 0
      reactions: []
    id: 64a663f523caaba1d2e89529
    type: comment
  author: adnanshussain
  content: '@mauricio-repetto thanks, but i cannot seem to find any safety_checker
    options in the from_pretrained function and if I am trying to create a pipe like
    this


    pipe = StableDiffusionPipeline(safety_checker=False)


    it asks for too many other pameters also..


    Any idea what can be done ?'
  created_at: 2023-07-06 05:49:25+00:00
  edited: false
  hidden: false
  id: 64a663f523caaba1d2e89529
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
      fullname: Adnan Hussain
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: adnanshussain
      type: user
    createdAt: '2023-07-06T08:21:03.000Z'
    data:
      edited: false
      editors:
      - adnanshussain
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.46774381399154663
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/647dd483770c299e56f7fc70/VuEIIqoDCf0CVLkDA0_o_.jpeg?w=200&h=200&f=face
          fullname: Adnan Hussain
          isHf: false
          isPro: false
          name: adnanshussain
          type: user
        html: '<p>Ok so this worked for me.</p>

          <p><code>from diffusers.pipelines.stable_diffusion import safety_checker</code></p>

          <p><code>def sc(self, clip_input, images) :     return images, [False for
          i in images]</code></p>

          <p><code># edit the StableDiffusionSafetyChecker class so that, when called,
          it just returns the images and an array of True values</code><br><code>safety_checker.StableDiffusionSafetyChecker.forward
          = sc</code></p>

          '
        raw: "Ok so this worked for me.\n\n`from diffusers.pipelines.stable_diffusion\
          \ import safety_checker`\n\n`def sc(self, clip_input, images) :\n    return\
          \ images, [False for i in images]`\n\n`# edit the StableDiffusionSafetyChecker\
          \ class so that, when called, it just returns the images and an array of\
          \ True values`\n`safety_checker.StableDiffusionSafetyChecker.forward = sc`\n"
        updatedAt: '2023-07-06T08:21:03.955Z'
      numEdits: 0
      reactions: []
    id: 64a6796f5f93bfafa74c904f
    type: comment
  author: adnanshussain
  content: "Ok so this worked for me.\n\n`from diffusers.pipelines.stable_diffusion\
    \ import safety_checker`\n\n`def sc(self, clip_input, images) :\n    return images,\
    \ [False for i in images]`\n\n`# edit the StableDiffusionSafetyChecker class so\
    \ that, when called, it just returns the images and an array of True values`\n\
    `safety_checker.StableDiffusionSafetyChecker.forward = sc`\n"
  created_at: 2023-07-06 07:21:03+00:00
  edited: false
  hidden: false
  id: 64a6796f5f93bfafa74c904f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
      fullname: "Andr\xE9s Mauricio Repetto Ferrero"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mauricio-repetto
      type: user
    createdAt: '2023-07-06T14:47:42.000Z'
    data:
      edited: false
      editors:
      - mauricio-repetto
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7369020581245422
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653673654684-noauth.jpeg?w=200&h=200&f=face
          fullname: "Andr\xE9s Mauricio Repetto Ferrero"
          isHf: false
          isPro: false
          name: mauricio-repetto
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;adnanshussain&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/adnanshussain\"\
          >@<span class=\"underline\">adnanshussain</span></a></span>\n\n\t</span></span>\
          \ you are making it too complex, you just need to add the optional parameter\
          \ to the ones you were already passing. </p>\n<pre><code>from diffusers\
          \ import DiffusionPipeline\nimport torch\n\npipeline = DiffusionPipeline.from_pretrained(\"\
          runwayml/stable-diffusion-v1-5\", torch_dtype=torch.float16, safety_checker=None)\n\
          pipeline.to(\"cuda\")\npipeline(\"An image of a squirrel in Picasso style\"\
          ).images[0]\n</code></pre>\n<p>I took the basic example from <a rel=\"nofollow\"\
          \ href=\"https://github.com/huggingface/diffusers#quickstart\">diffusers\
          \ github</a>, adding the parameter as I described you.</p>\n"
        raw: "@adnanshussain you are making it too complex, you just need to add the\
          \ optional parameter to the ones you were already passing. \n\n```\nfrom\
          \ diffusers import DiffusionPipeline\nimport torch\n\npipeline = DiffusionPipeline.from_pretrained(\"\
          runwayml/stable-diffusion-v1-5\", torch_dtype=torch.float16, safety_checker=None)\n\
          pipeline.to(\"cuda\")\npipeline(\"An image of a squirrel in Picasso style\"\
          ).images[0]\n```\n\nI took the basic example from [diffusers github](https://github.com/huggingface/diffusers#quickstart),\
          \ adding the parameter as I described you."
        updatedAt: '2023-07-06T14:47:42.302Z'
      numEdits: 0
      reactions: []
    id: 64a6d40e7d8732ae9d6a61af
    type: comment
  author: mauricio-repetto
  content: "@adnanshussain you are making it too complex, you just need to add the\
    \ optional parameter to the ones you were already passing. \n\n```\nfrom diffusers\
    \ import DiffusionPipeline\nimport torch\n\npipeline = DiffusionPipeline.from_pretrained(\"\
    runwayml/stable-diffusion-v1-5\", torch_dtype=torch.float16, safety_checker=None)\n\
    pipeline.to(\"cuda\")\npipeline(\"An image of a squirrel in Picasso style\").images[0]\n\
    ```\n\nI took the basic example from [diffusers github](https://github.com/huggingface/diffusers#quickstart),\
    \ adding the parameter as I described you."
  created_at: 2023-07-06 13:47:42+00:00
  edited: false
  hidden: false
  id: 64a6d40e7d8732ae9d6a61af
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 113
repo_id: runwayml/stable-diffusion-v1-5
repo_type: model
status: open
target_branch: null
title: NSFW for chest xrays
