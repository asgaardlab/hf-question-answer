!!python/object:huggingface_hub.community.DiscussionWithDetails
author: wen020
conflicting_files: null
created_at: 2023-01-17 08:46:11+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/310199a7c9b0a1469039ec97e091a1aa.svg
      fullname: wen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: wen020
      type: user
    createdAt: '2023-01-17T08:46:11.000Z'
    data:
      edited: true
      editors:
      - wen020
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/310199a7c9b0a1469039ec97e091a1aa.svg
          fullname: wen
          isHf: false
          isPro: false
          name: wen020
          type: user
        html: "<p>I have encountered a memory leak problem, we need to store and switch\
          \ the model of stable diffusion in memory, but when we convert the model\
          \ in memory to gpu, the memory is not reclaimed, and at the same time, when\
          \ the model in memory is deleted, the memory also not recycled.<br>Therefore,\
          \ what should I do to reclaim the memory occupied by the stable diffusion\
          \ model.</p>\n<p>code\uFF1A<br><a rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/1673944537468-6377272a0c233a6c5ec9d40b.png\"\
          ><img alt=\"51739229-1161-4286-9FEB-728C4EA7E976.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/1673944537468-6377272a0c233a6c5ec9d40b.png\"\
          ></a></p>\n<p>runing log\uFF1A<br><a rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/1673944582546-6377272a0c233a6c5ec9d40b.png\"\
          ><img alt=\"FF8085CC-A11A-48C3-94ED-1F5BE84AF27A.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/1673944582546-6377272a0c233a6c5ec9d40b.png\"\
          ></a></p>\n"
        raw: "I have encountered a memory leak problem, we need to store and switch\
          \ the model of stable diffusion in memory, but when we convert the model\
          \ in memory to gpu, the memory is not reclaimed, and at the same time, when\
          \ the model in memory is deleted, the memory also not recycled.\r\nTherefore,\
          \ what should I do to reclaim the memory occupied by the stable diffusion\
          \ model.\r\n\r\ncode\uFF1A\r\n![51739229-1161-4286-9FEB-728C4EA7E976.png](https://cdn-uploads.huggingface.co/production/uploads/1673944537468-6377272a0c233a6c5ec9d40b.png)\r\
          \n\r\nruning log\uFF1A\r\n![FF8085CC-A11A-48C3-94ED-1F5BE84AF27A.png](https://cdn-uploads.huggingface.co/production/uploads/1673944582546-6377272a0c233a6c5ec9d40b.png)"
        updatedAt: '2023-02-08T08:48:16.790Z'
      numEdits: 1
      reactions: []
    id: 63c66053b167901a39335aeb
    type: comment
  author: wen020
  content: "I have encountered a memory leak problem, we need to store and switch\
    \ the model of stable diffusion in memory, but when we convert the model in memory\
    \ to gpu, the memory is not reclaimed, and at the same time, when the model in\
    \ memory is deleted, the memory also not recycled.\r\nTherefore, what should I\
    \ do to reclaim the memory occupied by the stable diffusion model.\r\n\r\ncode\uFF1A\
    \r\n![51739229-1161-4286-9FEB-728C4EA7E976.png](https://cdn-uploads.huggingface.co/production/uploads/1673944537468-6377272a0c233a6c5ec9d40b.png)\r\
    \n\r\nruning log\uFF1A\r\n![FF8085CC-A11A-48C3-94ED-1F5BE84AF27A.png](https://cdn-uploads.huggingface.co/production/uploads/1673944582546-6377272a0c233a6c5ec9d40b.png)"
  created_at: 2023-01-17 08:46:11+00:00
  edited: true
  hidden: false
  id: 63c66053b167901a39335aeb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-01-18T23:34:31.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: '<p>Hey, </p>

          <p>Can you try:<br><a rel="nofollow" href="https://discuss.pytorch.org/t/how-can-we-release-gpu-memory-cache/14530">https://discuss.pytorch.org/t/how-can-we-release-gpu-memory-cache/14530</a><br>?</p>

          <p>This usually works for me</p>

          '
        raw: "Hey, \n\nCan you try:\nhttps://discuss.pytorch.org/t/how-can-we-release-gpu-memory-cache/14530\n\
          ?\n\nThis usually works for me"
        updatedAt: '2023-01-18T23:34:31.556Z'
      numEdits: 0
      reactions: []
    id: 63c882074720d55a4efa529b
    type: comment
  author: patrickvonplaten
  content: "Hey, \n\nCan you try:\nhttps://discuss.pytorch.org/t/how-can-we-release-gpu-memory-cache/14530\n\
    ?\n\nThis usually works for me"
  created_at: 2023-01-18 23:34:31+00:00
  edited: false
  hidden: false
  id: 63c882074720d55a4efa529b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/310199a7c9b0a1469039ec97e091a1aa.svg
      fullname: wen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: wen020
      type: user
    createdAt: '2023-02-08T02:47:27.000Z'
    data:
      edited: true
      editors:
      - wen020
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/310199a7c9b0a1469039ec97e091a1aa.svg
          fullname: wen
          isHf: false
          isPro: false
          name: wen020
          type: user
        html: '<p>thank you! i will try it.<br>But i want to release cpu memory cache.</p>

          <p>This only works for GPU memory, but what I noticed is machine memory
          leak</p>

          '
        raw: 'thank you! i will try it.

          But i want to release cpu memory cache.


          This only works for GPU memory, but what I noticed is machine memory leak'
        updatedAt: '2023-02-08T08:46:16.103Z'
      numEdits: 1
      reactions: []
    id: 63e30d3fdd70dbdb823bfdd8
    type: comment
  author: wen020
  content: 'thank you! i will try it.

    But i want to release cpu memory cache.


    This only works for GPU memory, but what I noticed is machine memory leak'
  created_at: 2023-02-08 02:47:27+00:00
  edited: true
  hidden: false
  id: 63e30d3fdd70dbdb823bfdd8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/7fREBijCIysoOlkLR6bf_.jpeg?w=200&h=200&f=face
      fullname: Jinwoo Park
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: curt-park
      type: user
    createdAt: '2023-10-15T15:00:45.000Z'
    data:
      edited: false
      editors:
      - curt-park
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8283880949020386
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/7fREBijCIysoOlkLR6bf_.jpeg?w=200&h=200&f=face
          fullname: Jinwoo Park
          isHf: false
          isPro: false
          name: curt-park
          type: user
        html: '<p>This issue is caused by <code>torch._C.PyTorchFileReader</code>.<br>I
          opened an issue in the PyTorch project repository.</p>

          <p><a rel="nofollow" href="https://github.com/pytorch/pytorch/issues/111330">https://github.com/pytorch/pytorch/issues/111330</a></p>

          '
        raw: 'This issue is caused by `torch._C.PyTorchFileReader`.

          I opened an issue in the PyTorch project repository.


          https://github.com/pytorch/pytorch/issues/111330'
        updatedAt: '2023-10-15T15:00:45.898Z'
      numEdits: 0
      reactions: []
    id: 652bfe9d1198736f311794c1
    type: comment
  author: curt-park
  content: 'This issue is caused by `torch._C.PyTorchFileReader`.

    I opened an issue in the PyTorch project repository.


    https://github.com/pytorch/pytorch/issues/111330'
  created_at: 2023-10-15 14:00:45+00:00
  edited: false
  hidden: false
  id: 652bfe9d1198736f311794c1
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 71
repo_id: runwayml/stable-diffusion-v1-5
repo_type: model
status: open
target_branch: null
title: stable diffusion memory leak
