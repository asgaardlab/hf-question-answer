!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ArthurZ
conflicting_files: []
created_at: 2023-10-09 19:09:28+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2023-10-09T20:09:28.000Z'
    data:
      edited: false
      editors:
      - ArthurZ
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8110489845275879
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
          fullname: Arthur Zucker
          isHf: true
          isPro: false
          name: ArthurZ
          type: user
        html: '<p>Following the merge of <a rel="nofollow" href="https://github.com/huggingface/transformers/pull/24310">a
          PR</a> in <code>transformers</code> it appeared that this model was not
          properly converted. This PR will fix the inference and was tested using
          the following script:</p>

          <pre><code class="language-python">

          <span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span>
          transformers <span class="hljs-keyword">import</span> MarianModel, MarianMTModel


          <span class="hljs-meta">&gt;&gt;&gt; </span>tokenizer = AutoTokenizer.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


          <span class="hljs-meta">&gt;&gt;&gt; </span>inputs = tokenizer(Hey how are
          you?, return_tensors=pt, padding=<span class="hljs-literal">True</span>)


          <span class="hljs-meta">&gt;&gt;&gt; </span>model = MarianMTModel.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


          <span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(tokenizer.batch_decode(model.generate(**inputs)))


          [<span class="hljs-string">''&lt;pad&gt; Hey he he he he he he he he he
          he he he? he he he he he? he he he? he he? he he he?? he he?? he he?? he
          he?? he he?? he he?? he he?? he he?? he he?? Hey??? he he??? he he?? he
          he?? Hey??? he he??? he????? Hey Hey Hey Hey he??? Hey Hey he he? Hey Hey
          Hey Hey Hey Hey?????? Hey Hey Hey Hey Hey Hey Hey Hey?? Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey?? Hey Hey Hey Hey? Hey? Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey? Hey Hey Hey Hey Hey Hey? Hey? Hey Hey Hey Hey Hey? Hey Hey Hey?
          Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey? Hey? Hey Hey Hey Hey Hey?
          Hey Hey Hey Hey Hey Hey? Hey? Hey? Hey? Hey Hey Hey? Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey? Hey? Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey?
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey?
          Hey Hey Hey Hey Hey? Hey Hey? Hey Hey Hey? Hey Hey Hey? Hey? Hey? Hey Hey
          Hey Hey? Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey? Hey? Hey? Hey? Hey?
          Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey Hey? Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey&lt;/s&gt;''</span>]

          </code></pre>

          '
        raw: 'Following the merge of [a PR](https://github.com/huggingface/transformers/pull/24310)
          in `transformers` it appeared that this model was not properly converted.
          This PR will fix the inference and was tested using the following script:


          ```python


          >>> from transformers import MarianModel, MarianMTModel


          >>> tokenizer = AutoTokenizer.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


          >>> inputs = tokenizer(Hey how are you?, return_tensors=pt, padding=True)


          >>> model = MarianMTModel.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


          >>> print(tokenizer.batch_decode(model.generate(**inputs)))


          [''<pad> Hey he he he he he he he he he he he he? he he he he he? he he
          he? he he? he he he?? he he?? he he?? he he?? he he?? he he?? he he?? he
          he?? he he?? Hey??? he he??? he he?? he he?? Hey??? he he??? he????? Hey
          Hey Hey Hey he??? Hey Hey he he? Hey Hey Hey Hey Hey Hey?????? Hey Hey Hey
          Hey Hey Hey Hey Hey?? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey?? Hey
          Hey Hey Hey? Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey?
          Hey Hey Hey Hey Hey? Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey
          Hey Hey? Hey? Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey? Hey? Hey?
          Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey? Hey? Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey? Hey Hey? Hey Hey Hey?
          Hey Hey Hey? Hey? Hey? Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey Hey
          Hey Hey Hey? Hey? Hey? Hey? Hey? Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey?
          Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
          Hey Hey Hey Hey</s>'']


          ```'
        updatedAt: '2023-10-09T20:09:28.165Z'
      numEdits: 0
      reactions: []
    id: 65245df8d4b61d080784ac07
    type: comment
  author: ArthurZ
  content: 'Following the merge of [a PR](https://github.com/huggingface/transformers/pull/24310)
    in `transformers` it appeared that this model was not properly converted. This
    PR will fix the inference and was tested using the following script:


    ```python


    >>> from transformers import MarianModel, MarianMTModel


    >>> tokenizer = AutoTokenizer.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


    >>> inputs = tokenizer(Hey how are you?, return_tensors=pt, padding=True)


    >>> model = MarianMTModel.from_pretrained(Helsinki-NLP/opus-mt-tc-big-gmw-gmw)


    >>> print(tokenizer.batch_decode(model.generate(**inputs)))


    [''<pad> Hey he he he he he he he he he he he he? he he he he he? he he he? he
    he? he he he?? he he?? he he?? he he?? he he?? he he?? he he?? he he?? he he??
    Hey??? he he??? he he?? he he?? Hey??? he he??? he????? Hey Hey Hey Hey he???
    Hey Hey he he? Hey Hey Hey Hey Hey Hey?????? Hey Hey Hey Hey Hey Hey Hey Hey??
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey?? Hey Hey Hey Hey? Hey? Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey? Hey Hey Hey Hey Hey Hey? Hey? Hey Hey Hey Hey Hey? Hey Hey Hey? Hey Hey
    Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey? Hey Hey Hey Hey Hey Hey Hey? Hey? Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey
    Hey? Hey? Hey? Hey? Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey? Hey? Hey? Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey? Hey Hey Hey Hey Hey? Hey Hey? Hey Hey Hey? Hey Hey Hey? Hey?
    Hey? Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey Hey Hey Hey Hey? Hey? Hey?
    Hey? Hey? Hey Hey Hey Hey? Hey Hey Hey Hey Hey Hey? Hey Hey? Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey Hey
    Hey Hey Hey Hey Hey Hey Hey</s>'']


    ```'
  created_at: 2023-10-09 19:09:28+00:00
  edited: false
  hidden: false
  id: 65245df8d4b61d080784ac07
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2023-10-09T20:09:28.000Z'
    data:
      oid: 0c90125099db6c748fe09e128ed9edaa91ab3827
      parents:
      - 04f66eee6baa445106bfe0d4f43dbf96dd837ae5
      subject: Update checkpoint for transformers >= 4.29
    id: 65245df80000000000000000
    type: commit
  author: ArthurZ
  created_at: 2023-10-09 19:09:28+00:00
  id: 65245df80000000000000000
  oid: 0c90125099db6c748fe09e128ed9edaa91ab3827
  summary: Update checkpoint for transformers >= 4.29
  type: commit
is_pull_request: true
merge_commit_oid: null
num: 8
repo_id: ArthurZ/first-test
repo_type: model
status: open
target_branch: refs/heads/main
title: Update checkpoint for transformers >= 4.29
