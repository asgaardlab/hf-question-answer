!!python/object:huggingface_hub.community.DiscussionWithDetails
author: BenjaminB
conflicting_files: null
created_at: 2022-07-08 13:24:48+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1656685953025-62bf03d1e80cec527083cd66.jpeg?w=200&h=200&f=face
      fullname: Benjamin Bossan
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: BenjaminB
      type: user
    createdAt: '2022-07-08T14:24:48.000Z'
    data:
      edited: false
      editors:
      - BenjaminB
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1656685953025-62bf03d1e80cec527083cd66.jpeg?w=200&h=200&f=face
          fullname: Benjamin Bossan
          isHf: true
          isPro: false
          name: BenjaminB
          type: user
        html: '<p>I wanted to try the inference API but got "Internal Server Error"
          while loading the model :/ Is there any way to see the logs?</p>

          '
        raw: I wanted to try the inference API but got "Internal Server Error" while
          loading the model :/ Is there any way to see the logs?
        updatedAt: '2022-07-08T14:24:48.225Z'
      numEdits: 0
      reactions: []
    id: 62c83e30822f40a04aedd409
    type: comment
  author: BenjaminB
  content: I wanted to try the inference API but got "Internal Server Error" while
    loading the model :/ Is there any way to see the logs?
  created_at: 2022-07-08 13:24:48+00:00
  edited: false
  hidden: false
  id: 62c83e30822f40a04aedd409
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/5dd96eb166059660ed1ee413/NQtzmrDdbG0H8qkZvRyGk.jpeg?w=200&h=200&f=face
      fullname: Julien Chaumond
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: true
      name: julien-c
      type: user
    createdAt: '2022-07-09T08:56:20.000Z'
    data:
      edited: false
      editors:
      - julien-c
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/5dd96eb166059660ed1ee413/NQtzmrDdbG0H8qkZvRyGk.jpeg?w=200&h=200&f=face
          fullname: Julien Chaumond
          isHf: true
          isPro: true
          name: julien-c
          type: user
        html: "<p>don't hesitate to ping <span data-props=\"{&quot;user&quot;:&quot;Narsil&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/Narsil\"\
          >@<span class=\"underline\">Narsil</span></a></span>\n\n\t</span></span>\
          \ and <span data-props=\"{&quot;user&quot;:&quot;osanseviero&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/osanseviero\">@<span\
          \ class=\"underline\">osanseviero</span></a></span>\n\n\t</span></span>\
          \ =)</p>\n"
        raw: don't hesitate to ping @Narsil and @osanseviero =)
        updatedAt: '2022-07-09T08:56:20.414Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F91D"
        users:
        - osanseviero
      - count: 1
        reaction: "\U0001F917"
        users:
        - osanseviero
    id: 62c942b41405c95dc6769ff7
    type: comment
  author: julien-c
  content: don't hesitate to ping @Narsil and @osanseviero =)
  created_at: 2022-07-09 07:56:20+00:00
  edited: false
  hidden: false
  id: 62c942b41405c95dc6769ff7
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f40271d9ff5ac148aab4c512f8ae6402.svg
      fullname: Adrin Jalali
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: adrin
      type: user
    createdAt: '2022-07-11T09:05:04.000Z'
    data:
      edited: false
      editors:
      - adrin
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f40271d9ff5ac148aab4c512f8ae6402.svg
          fullname: Adrin Jalali
          isHf: false
          isPro: false
          name: adrin
          type: user
        html: '<p>The server ATM basically only supports models persisted with scikit-learn=0.24.2
          (IIRC). Also, if there are any warnings during the inference, there will
          be an error, which can be anything from dtype mismatch to wrong columns.
          The new versions of sklearn also check if the new data has the same feature
          names as the one used during fit, and our code doesn''t necessarily pass
          feature names which produces a warning.</p>

          <p>This PR (<a rel="nofollow" href="https://github.com/huggingface/api-inference-community/pull/67">https://github.com/huggingface/api-inference-community/pull/67</a>)
          fixes some of those issues, and other issues need to be fixed in future
          PRs, like having a transformer at the beginning of a sklearn pipeline to
          do the dtype conversion and the right order of features maybe.</p>

          '
        raw: 'The server ATM basically only supports models persisted with scikit-learn=0.24.2
          (IIRC). Also, if there are any warnings during the inference, there will
          be an error, which can be anything from dtype mismatch to wrong columns.
          The new versions of sklearn also check if the new data has the same feature
          names as the one used during fit, and our code doesn''t necessarily pass
          feature names which produces a warning.


          This PR (https://github.com/huggingface/api-inference-community/pull/67)
          fixes some of those issues, and other issues need to be fixed in future
          PRs, like having a transformer at the beginning of a sklearn pipeline to
          do the dtype conversion and the right order of features maybe.'
        updatedAt: '2022-07-11T09:05:04.811Z'
      numEdits: 0
      reactions: []
    id: 62cbe7c0a55839423633e698
    type: comment
  author: adrin
  content: 'The server ATM basically only supports models persisted with scikit-learn=0.24.2
    (IIRC). Also, if there are any warnings during the inference, there will be an
    error, which can be anything from dtype mismatch to wrong columns. The new versions
    of sklearn also check if the new data has the same feature names as the one used
    during fit, and our code doesn''t necessarily pass feature names which produces
    a warning.


    This PR (https://github.com/huggingface/api-inference-community/pull/67) fixes
    some of those issues, and other issues need to be fixed in future PRs, like having
    a transformer at the beginning of a sklearn pipeline to do the dtype conversion
    and the right order of features maybe.'
  created_at: 2022-07-11 08:05:04+00:00
  edited: false
  hidden: false
  id: 62cbe7c0a55839423633e698
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6032802e1f993496bc14d9e3/w6hr-DEQot4VVkoyRIBiy.png?w=200&h=200&f=face
      fullname: Omar Sanseviero
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: osanseviero
      type: user
    createdAt: '2022-07-11T16:30:02.000Z'
    data:
      edited: false
      editors:
      - osanseviero
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6032802e1f993496bc14d9e3/w6hr-DEQot4VVkoyRIBiy.png?w=200&h=200&f=face
          fullname: Omar Sanseviero
          isHf: true
          isPro: false
          name: osanseviero
          type: user
        html: "<p>Another issue is that this repository is a <code>text-classification</code>\
          \ model, but the API only supports <code>tabular-classification</code> for\
          \ <code>sklearn</code> at the moment. <a rel=\"nofollow\" href=\"https://github.com/huggingface/api-inference-community/tree/main/docker_images/sklearn/app/pipelines\"\
          >https://github.com/huggingface/api-inference-community/tree/main/docker_images/sklearn/app/pipelines</a>.</p>\n\
          <p>Now, note that this repo is tagged as <code>generic</code>, which means\
          \ it runs the code from within <a href=\"https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/pipeline.py\"\
          >https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/pipeline.py</a>\
          \ to do inference. The <code>generic</code> API should just be used for\
          \ demo purposes, not for real cases. To see the error logs, you can right\
          \ click &gt; inspect  &gt; Network. Then click \"Compute\" in the widget,\
          \ and you get the error in the Network tab.</p>\n<pre><code>0: \"There was\
          \ an inference error: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis\
          \ (`None`) and integer or boolean arrays are valid indices\"\n</code></pre>\n\
          <p>So it seems there is a bug in the <code>pipeline.py</code> file (cc <span\
          \ data-props=\"{&quot;user&quot;:&quot;merve&quot;}\" data-target=\"UserMention\"\
          \ class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"inline-block\"\
          ><span class=\"contents\"><a href=\"/merve\">@<span class=\"underline\"\
          >merve</span></a></span>\n\n\t</span></span>)</p>\n"
        raw: 'Another issue is that this repository is a `text-classification` model,
          but the API only supports `tabular-classification` for `sklearn` at the
          moment. https://github.com/huggingface/api-inference-community/tree/main/docker_images/sklearn/app/pipelines.


          Now, note that this repo is tagged as `generic`, which means it runs the
          code from within https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/pipeline.py
          to do inference. The `generic` API should just be used for demo purposes,
          not for real cases. To see the error logs, you can right click > inspect  >
          Network. Then click "Compute" in the widget, and you get the error in the
          Network tab.


          ```

          0: "There was an inference error: only integers, slices (`:`), ellipsis
          (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid
          indices"

          ```


          So it seems there is a bug in the `pipeline.py` file (cc @merve)'
        updatedAt: '2022-07-11T16:30:02.371Z'
      numEdits: 0
      reactions: []
    id: 62cc500a73b2512b816784b0
    type: comment
  author: osanseviero
  content: 'Another issue is that this repository is a `text-classification` model,
    but the API only supports `tabular-classification` for `sklearn` at the moment.
    https://github.com/huggingface/api-inference-community/tree/main/docker_images/sklearn/app/pipelines.


    Now, note that this repo is tagged as `generic`, which means it runs the code
    from within https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/pipeline.py
    to do inference. The `generic` API should just be used for demo purposes, not
    for real cases. To see the error logs, you can right click > inspect  > Network.
    Then click "Compute" in the widget, and you get the error in the Network tab.


    ```

    0: "There was an inference error: only integers, slices (`:`), ellipsis (`...`),
    numpy.newaxis (`None`) and integer or boolean arrays are valid indices"

    ```


    So it seems there is a bug in the `pipeline.py` file (cc @merve)'
  created_at: 2022-07-11 15:30:02+00:00
  edited: false
  hidden: false
  id: 62cc500a73b2512b816784b0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1608285816082-5e2967b819407e3277369b95.png?w=200&h=200&f=face
      fullname: Nicolas Patry
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Narsil
      type: user
    createdAt: '2022-07-20T08:30:12.000Z'
    data:
      edited: false
      editors:
      - Narsil
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1608285816082-5e2967b819407e3277369b95.png?w=200&h=200&f=face
          fullname: Nicolas Patry
          isHf: true
          isPro: false
          name: Narsil
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;BenjaminB&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/BenjaminB\">@<span class=\"\
          underline\">BenjaminB</span></a></span>\n\n\t</span></span> </p>\n<p>The\
          \ easiest way to checkout what's happening is</p>\n<pre><code>git clone\
          \ https://github.com/huggingface/api-inference-community/\ncd api-inference-community\n\
          ./manage.py docker scikit-learn/sklearn-transformers\n</code></pre>\n<p>This\
          \ will start the exact version on the API as a docker image, on port <code>8000</code>\
          \ so you can start and sending it requests.<br>As <span data-props=\"{&quot;user&quot;:&quot;osanseviero&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/osanseviero\"\
          >@<span class=\"underline\">osanseviero</span></a></span>\n\n\t</span></span>\
          \ suggested, the API actually returns a warning that basically the input\
          \ format is invalid (probably this repo is misconfigured)</p>\n<p>Does that\
          \ help ?</p>\n<p>Cheers.</p>\n"
        raw: "@BenjaminB \n\nThe easiest way to checkout what's happening is\n\n```\n\
          git clone https://github.com/huggingface/api-inference-community/\ncd api-inference-community\n\
          ./manage.py docker scikit-learn/sklearn-transformers\n```\n\nThis will start\
          \ the exact version on the API as a docker image, on port `8000` so you\
          \ can start and sending it requests.\nAs @osanseviero suggested, the API\
          \ actually returns a warning that basically the input format is invalid\
          \ (probably this repo is misconfigured)\n\nDoes that help ?\n\nCheers."
        updatedAt: '2022-07-20T08:30:12.304Z'
      numEdits: 0
      reactions: []
    id: 62d7bd149b629105a5d6d4f7
    type: comment
  author: Narsil
  content: "@BenjaminB \n\nThe easiest way to checkout what's happening is\n\n```\n\
    git clone https://github.com/huggingface/api-inference-community/\ncd api-inference-community\n\
    ./manage.py docker scikit-learn/sklearn-transformers\n```\n\nThis will start the\
    \ exact version on the API as a docker image, on port `8000` so you can start\
    \ and sending it requests.\nAs @osanseviero suggested, the API actually returns\
    \ a warning that basically the input format is invalid (probably this repo is\
    \ misconfigured)\n\nDoes that help ?\n\nCheers."
  created_at: 2022-07-20 07:30:12+00:00
  edited: false
  hidden: false
  id: 62d7bd149b629105a5d6d4f7
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6032802e1f993496bc14d9e3/w6hr-DEQot4VVkoyRIBiy.png?w=200&h=200&f=face
      fullname: Omar Sanseviero
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: osanseviero
      type: user
    createdAt: '2022-07-20T08:36:09.000Z'
    data:
      edited: true
      editors:
      - osanseviero
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6032802e1f993496bc14d9e3/w6hr-DEQot4VVkoyRIBiy.png?w=200&h=200&f=face
          fullname: Omar Sanseviero
          isHf: true
          isPro: false
          name: osanseviero
          type: user
        html: '<p>I do want to remind that this repo is marked as <code>generic</code>
          library, not <code>sklearn</code>, so this will not even go to the sklearn
          endpoint. We need to update <a href="https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/README.md#L5">https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/README.md#L5</a>
          if we want this to go to the sklearn endpoint.</p>

          '
        raw: I do want to remind that this repo is marked as `generic` library, not
          `sklearn`, so this will not even go to the sklearn endpoint. We need to
          update https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/README.md#L5
          if we want this to go to the sklearn endpoint.
        updatedAt: '2022-07-20T08:36:44.295Z'
      numEdits: 1
      reactions: []
    id: 62d7be794c44cb22510b7852
    type: comment
  author: osanseviero
  content: I do want to remind that this repo is marked as `generic` library, not
    `sklearn`, so this will not even go to the sklearn endpoint. We need to update
    https://huggingface.co/scikit-learn/sklearn-transformers/blob/main/README.md#L5
    if we want this to go to the sklearn endpoint.
  created_at: 2022-07-20 07:36:09+00:00
  edited: true
  hidden: false
  id: 62d7be794c44cb22510b7852
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1608285816082-5e2967b819407e3277369b95.png?w=200&h=200&f=face
      fullname: Nicolas Patry
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Narsil
      type: user
    createdAt: '2022-07-20T08:46:06.000Z'
    data:
      edited: false
      editors:
      - Narsil
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1608285816082-5e2967b819407e3277369b95.png?w=200&h=200&f=face
          fullname: Nicolas Patry
          isHf: true
          isPro: false
          name: Narsil
          type: user
        html: '<p>(The command I mentionned will launch <code>generic</code> yes but
          that''s a way to debug and discover that it might be misconfigured is what
          I wanted to convey).</p>

          <p>Basically it''s exactly what happens on the server. That''s how you get
          full logs. Full logs are not exposed on the API since it''s tricky to expose
          them while making sure we''re not exposing any sensitive information.</p>

          '
        raw: '(The command I mentionned will launch `generic` yes but that''s a way
          to debug and discover that it might be misconfigured is what I wanted to
          convey).


          Basically it''s exactly what happens on the server. That''s how you get
          full logs. Full logs are not exposed on the API since it''s tricky to expose
          them while making sure we''re not exposing any sensitive information.'
        updatedAt: '2022-07-20T08:46:06.606Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - osanseviero
    id: 62d7c0ce63583ad7bf1d84b1
    type: comment
  author: Narsil
  content: '(The command I mentionned will launch `generic` yes but that''s a way
    to debug and discover that it might be misconfigured is what I wanted to convey).


    Basically it''s exactly what happens on the server. That''s how you get full logs.
    Full logs are not exposed on the API since it''s tricky to expose them while making
    sure we''re not exposing any sensitive information.'
  created_at: 2022-07-20 07:46:06+00:00
  edited: false
  hidden: false
  id: 62d7c0ce63583ad7bf1d84b1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1656685953025-62bf03d1e80cec527083cd66.jpeg?w=200&h=200&f=face
      fullname: Benjamin Bossan
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: BenjaminB
      type: user
    createdAt: '2022-07-20T08:54:54.000Z'
    data:
      edited: false
      editors:
      - BenjaminB
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1656685953025-62bf03d1e80cec527083cd66.jpeg?w=200&h=200&f=face
          fullname: Benjamin Bossan
          isHf: true
          isPro: false
          name: BenjaminB
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;Narsil&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Narsil\">@<span class=\"\
          underline\">Narsil</span></a></span>\n\n\t</span></span> Thanks, that's\
          \ very helpful.</p>\n"
        raw: '@Narsil Thanks, that''s very helpful.'
        updatedAt: '2022-07-20T08:54:54.666Z'
      numEdits: 0
      reactions: []
    id: 62d7c2de9b629105a5d6fdce
    type: comment
  author: BenjaminB
  content: '@Narsil Thanks, that''s very helpful.'
  created_at: 2022-07-20 07:54:54+00:00
  edited: false
  hidden: false
  id: 62d7c2de9b629105a5d6fdce
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: scikit-learn/sklearn-transformers
repo_type: model
status: open
target_branch: null
title: Inference API broken
