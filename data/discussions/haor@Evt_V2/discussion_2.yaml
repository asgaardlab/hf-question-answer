!!python/object:huggingface_hub.community.DiscussionWithDetails
author: LandonBayer
conflicting_files: null
created_at: 2022-12-09 00:10:36+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6d422c97a58a64970bdb7940262ef990.svg
      fullname: Landon Bayer
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: LandonBayer
      type: user
    createdAt: '2022-12-09T00:10:36.000Z'
    data:
      edited: false
      editors:
      - LandonBayer
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6d422c97a58a64970bdb7940262ef990.svg
          fullname: Landon Bayer
          isHf: false
          isPro: false
          name: LandonBayer
          type: user
        html: "<p>Hi haor,</p>\n<p>I've been working on accessing this project via\
          \ the Inference API through Hugging Face, which it seems to do fine. The\
          \ issue comes in the decoding, where utf-8 decoding throws the error \"\
          UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0:\
          \ invalid start byte\". I assume this is due in some way to the VAE encode/decode\
          \ cycle, but I'm not sure what to do about it. Trying to force a string\
          \ with str() also gives it a decode error. If you could tell me what I can\
          \ do to fix this, please do. Thank you for your help!</p>\n<p>Here is my\
          \ code:</p>\n<pre><code>import json\nimport requests\nAPI_URL = \"https://api-inference.huggingface.co/models/haor/Evt_V2\"\
          \nAPI_TOKEN = \"realapitoken\"\nheaders = {\"Authorization\": f\"Bearer\
          \ {API_TOKEN}\"}\ndef query(payload):\n    data = json.dumps(payload)\n\
          \    response = requests.request(\"POST\", API_URL, headers=headers, data=data)\n\
          \    return json.loads(response.content.decode(\"utf-8\"))\ndat = query(\"\
          best quality, illustration,highly detailed,1girl,upper body,beautiful detailed\
          \ eyes, medium_breasts, long hair,grey hair, grey eyes, curly hair, bangs,empty\
          \ eyes,expressionless, ((masterpiece)),twintails,beautiful detailed sky,\
          \ beautiful detailed water, cinematic lighting, dramatic angle,((back to\
          \ the viewer)),(an extremely delicate and beautiful),school uniform,black\
          \ ribbon,light smile\")\nprint(dat)\n</code></pre>\n<p>And here is another\
          \ version that does the same (it chooses utf-8 by default):</p>\n<pre><code>from\
          \ huggingface_hub.inference_api import InferenceApi\nAPI_TOKEN = \"realapitoken\"\
          \n\ninf = InferenceApi(repo_id=\"haor/Evt_V2\", token=API_TOKEN)\ninf(inputs=\"\
          best quality, illustration,highly detailed,1girl,upper body,beautiful detailed\
          \ eyes, medium_breasts, long hair,grey hair, grey eyes, curly hair, bangs,empty\
          \ eyes,expressionless, ((masterpiece)),twintails,beautiful detailed sky,\
          \ beautiful detailed water, cinematic lighting, dramatic angle,((back to\
          \ the viewer)),(an extremely delicate and beautiful),school uniform,black\
          \ ribbon,light smile\")\n</code></pre>\n<p>Let me know what I can do to\
          \ make it work or test to clarify better.</p>\n<p>Thank you!</p>\n"
        raw: "Hi haor,\r\n\r\nI've been working on accessing this project via the\
          \ Inference API through Hugging Face, which it seems to do fine. The issue\
          \ comes in the decoding, where utf-8 decoding throws the error \"UnicodeDecodeError:\
          \ 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte\"\
          . I assume this is due in some way to the VAE encode/decode cycle, but I'm\
          \ not sure what to do about it. Trying to force a string with str() also\
          \ gives it a decode error. If you could tell me what I can do to fix this,\
          \ please do. Thank you for your help!\r\n\r\nHere is my code:\r\n```\r\n\
          import json\r\nimport requests\r\nAPI_URL = \"https://api-inference.huggingface.co/models/haor/Evt_V2\"\
          \r\nAPI_TOKEN = \"realapitoken\"\r\nheaders = {\"Authorization\": f\"Bearer\
          \ {API_TOKEN}\"}\r\ndef query(payload):\r\n    data = json.dumps(payload)\r\
          \n    response = requests.request(\"POST\", API_URL, headers=headers, data=data)\r\
          \n    return json.loads(response.content.decode(\"utf-8\"))\r\ndat = query(\"\
          best quality, illustration,highly detailed,1girl,upper body,beautiful detailed\
          \ eyes, medium_breasts, long hair,grey hair, grey eyes, curly hair, bangs,empty\
          \ eyes,expressionless, ((masterpiece)),twintails,beautiful detailed sky,\
          \ beautiful detailed water, cinematic lighting, dramatic angle,((back to\
          \ the viewer)),(an extremely delicate and beautiful),school uniform,black\
          \ ribbon,light smile\")\r\nprint(dat)\r\n```\r\nAnd here is another version\
          \ that does the same (it chooses utf-8 by default):\r\n```\r\nfrom huggingface_hub.inference_api\
          \ import InferenceApi\r\nAPI_TOKEN = \"realapitoken\"\r\n\r\ninf = InferenceApi(repo_id=\"\
          haor/Evt_V2\", token=API_TOKEN)\r\ninf(inputs=\"best quality, illustration,highly\
          \ detailed,1girl,upper body,beautiful detailed eyes, medium_breasts, long\
          \ hair,grey hair, grey eyes, curly hair, bangs,empty eyes,expressionless,\
          \ ((masterpiece)),twintails,beautiful detailed sky, beautiful detailed water,\
          \ cinematic lighting, dramatic angle,((back to the viewer)),(an extremely\
          \ delicate and beautiful),school uniform,black ribbon,light smile\")\r\n\
          ```\r\nLet me know what I can do to make it work or test to clarify better.\r\
          \n\r\nThank you!"
        updatedAt: '2022-12-09T00:10:36.960Z'
      numEdits: 0
      reactions: []
    id: 63927cfc55224faf65490cde
    type: comment
  author: LandonBayer
  content: "Hi haor,\r\n\r\nI've been working on accessing this project via the Inference\
    \ API through Hugging Face, which it seems to do fine. The issue comes in the\
    \ decoding, where utf-8 decoding throws the error \"UnicodeDecodeError: 'utf-8'\
    \ codec can't decode byte 0xff in position 0: invalid start byte\". I assume this\
    \ is due in some way to the VAE encode/decode cycle, but I'm not sure what to\
    \ do about it. Trying to force a string with str() also gives it a decode error.\
    \ If you could tell me what I can do to fix this, please do. Thank you for your\
    \ help!\r\n\r\nHere is my code:\r\n```\r\nimport json\r\nimport requests\r\nAPI_URL\
    \ = \"https://api-inference.huggingface.co/models/haor/Evt_V2\"\r\nAPI_TOKEN =\
    \ \"realapitoken\"\r\nheaders = {\"Authorization\": f\"Bearer {API_TOKEN}\"}\r\
    \ndef query(payload):\r\n    data = json.dumps(payload)\r\n    response = requests.request(\"\
    POST\", API_URL, headers=headers, data=data)\r\n    return json.loads(response.content.decode(\"\
    utf-8\"))\r\ndat = query(\"best quality, illustration,highly detailed,1girl,upper\
    \ body,beautiful detailed eyes, medium_breasts, long hair,grey hair, grey eyes,\
    \ curly hair, bangs,empty eyes,expressionless, ((masterpiece)),twintails,beautiful\
    \ detailed sky, beautiful detailed water, cinematic lighting, dramatic angle,((back\
    \ to the viewer)),(an extremely delicate and beautiful),school uniform,black ribbon,light\
    \ smile\")\r\nprint(dat)\r\n```\r\nAnd here is another version that does the same\
    \ (it chooses utf-8 by default):\r\n```\r\nfrom huggingface_hub.inference_api\
    \ import InferenceApi\r\nAPI_TOKEN = \"realapitoken\"\r\n\r\ninf = InferenceApi(repo_id=\"\
    haor/Evt_V2\", token=API_TOKEN)\r\ninf(inputs=\"best quality, illustration,highly\
    \ detailed,1girl,upper body,beautiful detailed eyes, medium_breasts, long hair,grey\
    \ hair, grey eyes, curly hair, bangs,empty eyes,expressionless, ((masterpiece)),twintails,beautiful\
    \ detailed sky, beautiful detailed water, cinematic lighting, dramatic angle,((back\
    \ to the viewer)),(an extremely delicate and beautiful),school uniform,black ribbon,light\
    \ smile\")\r\n```\r\nLet me know what I can do to make it work or test to clarify\
    \ better.\r\n\r\nThank you!"
  created_at: 2022-12-09 00:10:36+00:00
  edited: false
  hidden: false
  id: 63927cfc55224faf65490cde
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: haor/Evt_V2
repo_type: model
status: open
target_branch: null
title: Issue with the Returned Output using Inference API
