!!python/object:huggingface_hub.community.DiscussionWithDetails
author: yoma0101
conflicting_files: null
created_at: 2023-10-02 09:23:38+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
      fullname: yoma0101
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yoma0101
      type: user
    createdAt: '2023-10-02T10:23:38.000Z'
    data:
      edited: false
      editors:
      - yoma0101
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3276979923248291
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
          fullname: yoma0101
          isHf: false
          isPro: false
          name: yoma0101
          type: user
        html: "<p>  File \"C:\\Users\\msh01/.cache\\huggingface\\modules\\transformers_modules\\\
          chatglm-fitness-RLHF\\modeling_chatglm.py\", line 1434, in quantize<br>\
          \    self.transformer = quantize(self.transformer, bits, empty_init=empty_init,\
          \ **kwargs)<br>  File \"C:\\Users\\msh01/.cache\\huggingface\\modules\\\
          transformers_modules\\chatglm-fitness-RLHF\\quantization.py\", line 159,\
          \ in quantize<br>    weight_tensor=layer.attention.query_key_value.weight.to(torch.cuda.current_device()),<br>NotImplementedError:\
          \ Cannot copy out of meta tensor; no data!</p>\n<p>\u5F53\u524D\u7CFB\u7EDF\
          \u73AF\u5883\u4E3A<br>win11+python3.10+ pytorch2.0.1+cuda11.8+nvdia rtx\
          \ 3060 (12gb\u663E\u5B58)<br>\u52A0\u8F7D\u6A21\u578B\u7684\u65B9\u5F0F\u4E3A\
          <br>sys.path.append('..')<br>        # fb700/chatglm-fitness-RLHF\u4E3A\
          hg\u81EA\u52A8\u4E0B\u8F7D\u5730\u5740\uFF0C\u5982\u5DF2\u7ECF\u81EA\u884C\
          \u4E0B\u8F7D\u8BF7\u66FF\u6362<br>        model = AutoModel.from_pretrained(model_name_or_path,\
          \ device_map='auto', empty_init=False,<br>                             \
          \             trust_remote_code=True)<br>        # model = PeftModel.from_pretrained(model,\
          \ \"model/chatglm_fitness_lora\") # lora\u6587\u4EF6\u4FDD\u5B58\u76EE\u5F55\
          <br>        # model = model.half().quantize(4).cuda()  # int4<br>      \
          \  model = model.half().quantize(8).cuda()  # int8<br>        # model =\
          \ model.half().cuda()  # fp16<br>        tokenizer = AutoTokenizer.from_pretrained(model_name_or_path,\
          \ trust_remote_code=True)</p>\n"
        raw: "  File \"C:\\Users\\msh01/.cache\\huggingface\\modules\\transformers_modules\\\
          chatglm-fitness-RLHF\\modeling_chatglm.py\", line 1434, in quantize\r\n\
          \    self.transformer = quantize(self.transformer, bits, empty_init=empty_init,\
          \ **kwargs)\r\n  File \"C:\\Users\\msh01/.cache\\huggingface\\modules\\\
          transformers_modules\\chatglm-fitness-RLHF\\quantization.py\", line 159,\
          \ in quantize\r\n    weight_tensor=layer.attention.query_key_value.weight.to(torch.cuda.current_device()),\r\
          \nNotImplementedError: Cannot copy out of meta tensor; no data!\r\n\r\n\u5F53\
          \u524D\u7CFB\u7EDF\u73AF\u5883\u4E3A\r\nwin11+python3.10+ pytorch2.0.1+cuda11.8+nvdia\
          \ rtx 3060 (12gb\u663E\u5B58)\r\n\u52A0\u8F7D\u6A21\u578B\u7684\u65B9\u5F0F\
          \u4E3A\r\nsys.path.append('..')\r\n        # fb700/chatglm-fitness-RLHF\u4E3A\
          hg\u81EA\u52A8\u4E0B\u8F7D\u5730\u5740\uFF0C\u5982\u5DF2\u7ECF\u81EA\u884C\
          \u4E0B\u8F7D\u8BF7\u66FF\u6362\r\n        model = AutoModel.from_pretrained(model_name_or_path,\
          \ device_map='auto', empty_init=False,\r\n                             \
          \             trust_remote_code=True)\r\n        # model = PeftModel.from_pretrained(model,\
          \ \"model/chatglm_fitness_lora\") # lora\u6587\u4EF6\u4FDD\u5B58\u76EE\u5F55\
          \r\n        # model = model.half().quantize(4).cuda()  # int4\r\n      \
          \  model = model.half().quantize(8).cuda()  # int8\r\n        # model =\
          \ model.half().cuda()  # fp16\r\n        tokenizer = AutoTokenizer.from_pretrained(model_name_or_path,\
          \ trust_remote_code=True)"
        updatedAt: '2023-10-02T10:23:38.514Z'
      numEdits: 0
      reactions: []
    id: 651a9a2a66074c09263e67e9
    type: comment
  author: yoma0101
  content: "  File \"C:\\Users\\msh01/.cache\\huggingface\\modules\\transformers_modules\\\
    chatglm-fitness-RLHF\\modeling_chatglm.py\", line 1434, in quantize\r\n    self.transformer\
    \ = quantize(self.transformer, bits, empty_init=empty_init, **kwargs)\r\n  File\
    \ \"C:\\Users\\msh01/.cache\\huggingface\\modules\\transformers_modules\\chatglm-fitness-RLHF\\\
    quantization.py\", line 159, in quantize\r\n    weight_tensor=layer.attention.query_key_value.weight.to(torch.cuda.current_device()),\r\
    \nNotImplementedError: Cannot copy out of meta tensor; no data!\r\n\r\n\u5F53\u524D\
    \u7CFB\u7EDF\u73AF\u5883\u4E3A\r\nwin11+python3.10+ pytorch2.0.1+cuda11.8+nvdia\
    \ rtx 3060 (12gb\u663E\u5B58)\r\n\u52A0\u8F7D\u6A21\u578B\u7684\u65B9\u5F0F\u4E3A\
    \r\nsys.path.append('..')\r\n        # fb700/chatglm-fitness-RLHF\u4E3Ahg\u81EA\
    \u52A8\u4E0B\u8F7D\u5730\u5740\uFF0C\u5982\u5DF2\u7ECF\u81EA\u884C\u4E0B\u8F7D\
    \u8BF7\u66FF\u6362\r\n        model = AutoModel.from_pretrained(model_name_or_path,\
    \ device_map='auto', empty_init=False,\r\n                                   \
    \       trust_remote_code=True)\r\n        # model = PeftModel.from_pretrained(model,\
    \ \"model/chatglm_fitness_lora\") # lora\u6587\u4EF6\u4FDD\u5B58\u76EE\u5F55\r\
    \n        # model = model.half().quantize(4).cuda()  # int4\r\n        model =\
    \ model.half().quantize(8).cuda()  # int8\r\n        # model = model.half().cuda()\
    \  # fp16\r\n        tokenizer = AutoTokenizer.from_pretrained(model_name_or_path,\
    \ trust_remote_code=True)"
  created_at: 2023-10-02 09:23:38+00:00
  edited: false
  hidden: false
  id: 651a9a2a66074c09263e67e9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
      fullname: yoma0101
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yoma0101
      type: user
    createdAt: '2023-10-02T10:24:06.000Z'
    data:
      from: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u4FDD\u6301\
        \u4EE3\u7801\u884C\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\
        \u6D4B\u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\
        \u6A21\u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
      to: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u62A5\u9519\
        \u4EE3\u7801\u5730\u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\
        \u731C\u6D4B\u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\
        \u7684\u6A21\u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\
        \u4EF6"
    id: 651a9a46404da51aa06f2346
    type: title-change
  author: yoma0101
  created_at: 2023-10-02 09:24:06+00:00
  id: 651a9a46404da51aa06f2346
  new_title: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u62A5\u9519\
    \u4EE3\u7801\u5730\u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\
    \u6D4B\u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\
    \u6A21\u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
  old_title: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u4FDD\u6301\
    \u4EE3\u7801\u884C\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\u6D4B\
    \u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\u6A21\
    \u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
      fullname: yoma0101
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yoma0101
      type: user
    createdAt: '2023-10-02T10:26:09.000Z'
    data:
      from: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u62A5\u9519\
        \u4EE3\u7801\u5730\u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\
        \u731C\u6D4B\u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\
        \u7684\u6A21\u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\
        \u4EF6"
      to: "Cannot copy out of meta tensor; no data!\uFF0C\u62A5\u9519\u4EE3\u7801\u5730\
        \u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\u6D4B\u662F\
        \u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\u6A21\u578B\
        \u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
    id: 651a9ac1a9e1c4c6cdcafe0b
    type: title-change
  author: yoma0101
  created_at: 2023-10-02 09:26:09+00:00
  id: 651a9ac1a9e1c4c6cdcafe0b
  new_title: "Cannot copy out of meta tensor; no data!\uFF0C\u62A5\u9519\u4EE3\u7801\
    \u5730\u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\u6D4B\u662F\
    \u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\u6A21\u578B\
    \u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
  old_title: "\u52A0\u8F7D\u6A21\u578B\u7684\u65F6\u5019\u62A5\u9519\uFF0C\u62A5\u9519\
    \u4EE3\u7801\u5730\u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\
    \u6D4B\u662F\u91CF\u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\
    \u6A21\u578B\u4E0A\u4F20\u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
      fullname: yoma0101
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yoma0101
      type: user
    createdAt: '2023-10-02T10:37:01.000Z'
    data:
      edited: false
      editors:
      - yoma0101
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.7321359515190125
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
          fullname: yoma0101
          isHf: false
          isPro: false
          name: yoma0101
          type: user
        html: "<p>\u5C1D\u8BD5\u4E86\u52A0\u5165empty_init=False, \u4F9D\u7136\u662F\
          \u540C\u6837\u7684\u9519\u8BEF</p>\n"
        raw: "\u5C1D\u8BD5\u4E86\u52A0\u5165empty_init=False, \u4F9D\u7136\u662F\u540C\
          \u6837\u7684\u9519\u8BEF"
        updatedAt: '2023-10-02T10:37:01.085Z'
      numEdits: 0
      reactions: []
    id: 651a9d4de570bf24925082c4
    type: comment
  author: yoma0101
  content: "\u5C1D\u8BD5\u4E86\u52A0\u5165empty_init=False, \u4F9D\u7136\u662F\u540C\
    \u6837\u7684\u9519\u8BEF"
  created_at: 2023-10-02 09:37:01+00:00
  edited: false
  hidden: false
  id: 651a9d4de570bf24925082c4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ce27e6fa46ccb9aba6505a5def09806a.svg
      fullname: fbai
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: fb700
      type: user
    createdAt: '2023-10-15T03:56:22.000Z'
    data:
      edited: false
      editors:
      - fb700
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9989143013954163
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ce27e6fa46ccb9aba6505a5def09806a.svg
          fullname: fbai
          isHf: false
          isPro: false
          name: fb700
          type: user
        html: "<p>\u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\u5883\uFF0C\
          \u6211\u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\u6709\u95EE\
          \u9898\u7684</p>\n"
        raw: "\u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\u5883\uFF0C\u6211\
          \u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\u6709\u95EE\u9898\
          \u7684"
        updatedAt: '2023-10-15T03:56:22.445Z'
      numEdits: 0
      reactions: []
    id: 652b62e6b20d500447152a25
    type: comment
  author: fb700
  content: "\u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\u5883\uFF0C\u6211\
    \u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\u6709\u95EE\u9898\u7684"
  created_at: 2023-10-15 02:56:22+00:00
  edited: false
  hidden: false
  id: 652b62e6b20d500447152a25
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
      fullname: yoma0101
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yoma0101
      type: user
    createdAt: '2023-10-18T08:55:35.000Z'
    data:
      edited: false
      editors:
      - yoma0101
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9934519529342651
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/f82634f9ce389d63e87bb8cbbf1a19dd.svg
          fullname: yoma0101
          isHf: false
          isPro: false
          name: yoma0101
          type: user
        html: "<blockquote>\n<p>\u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\
          \u5883\uFF0C\u6211\u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\
          \u6709\u95EE\u9898\u7684</p>\n</blockquote>\n<p>chatglm1\u548Cchatglm2\u90FD\
          \u662F\u53EF\u4EE5\u5728\u6211\u7684\u7535\u8111\u4E0A\u8FD0\u4F5C\u7684\
          </p>\n"
        raw: "> \u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\u5883\uFF0C\u6211\
          \u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\u6709\u95EE\u9898\
          \u7684\n\nchatglm1\u548Cchatglm2\u90FD\u662F\u53EF\u4EE5\u5728\u6211\u7684\
          \u7535\u8111\u4E0A\u8FD0\u4F5C\u7684"
        updatedAt: '2023-10-18T08:55:35.571Z'
      numEdits: 0
      reactions: []
    id: 652f9d875280b2cd03b56bf0
    type: comment
  author: yoma0101
  content: "> \u4F60\u7528glm1\u6D4B\u8BD5\u4E0B\u4F60\u7684\u73AF\u5883\uFF0C\u6211\
    \u8FD9\u8FB9\u6D4B\u8BD5\u6D4B\u8BD5\uFF0C\u662F\u6CA1\u6709\u95EE\u9898\u7684\
    \n\nchatglm1\u548Cchatglm2\u90FD\u662F\u53EF\u4EE5\u5728\u6211\u7684\u7535\u8111\
    \u4E0A\u8FD0\u4F5C\u7684"
  created_at: 2023-10-18 07:55:35+00:00
  edited: false
  hidden: false
  id: 652f9d875280b2cd03b56bf0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ce27e6fa46ccb9aba6505a5def09806a.svg
      fullname: fbai
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: fb700
      type: user
    createdAt: '2023-11-15T11:55:03.000Z'
    data:
      edited: false
      editors:
      - fb700
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.9996136426925659
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ce27e6fa46ccb9aba6505a5def09806a.svg
          fullname: fbai
          isHf: false
          isPro: false
          name: fb700
          type: user
        html: "<p>\u597D\u5427</p>\n"
        raw: "\u597D\u5427"
        updatedAt: '2023-11-15T11:55:03.217Z'
      numEdits: 0
      reactions: []
    id: 6554b19717ec62b54f9b2962
    type: comment
  author: fb700
  content: "\u597D\u5427"
  created_at: 2023-11-15 11:55:03+00:00
  edited: false
  hidden: false
  id: 6554b19717ec62b54f9b2962
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 18
repo_id: fb700/chatglm-fitness-RLHF
repo_type: model
status: open
target_branch: null
title: "Cannot copy out of meta tensor; no data!\uFF0C\u62A5\u9519\u4EE3\u7801\u5730\
  \u65B9\u4E3Amodel = model.half().quantize(4).cuda()  \uFF0C\u731C\u6D4B\u662F\u91CF\
  \u5316\u76F8\u5173\u95EE\u9898\u6216\u8005\u4F5C\u8005\u7684\u6A21\u578B\u4E0A\u4F20\
  \u7684\u65F6\u5019\u6709\u9057\u6F0F\u7684\u6587\u4EF6"
