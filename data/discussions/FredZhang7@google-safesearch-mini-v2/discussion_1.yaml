!!python/object:huggingface_hub.community.DiscussionWithDetails
author: feature
conflicting_files: null
created_at: 2023-02-09 04:39:55+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d4e0de678dc56810f454414049d17b5f.svg
      fullname: zhang
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: feature
      type: user
    createdAt: '2023-02-09T04:39:55.000Z'
    data:
      edited: true
      editors:
      - feature
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d4e0de678dc56810f454414049d17b5f.svg
          fullname: zhang
          isHf: false
          isPro: false
          name: feature
          type: user
        html: '<p>model = timm.create_model("hf_hub:FredZhang7/google-safesearch-mini-v2",
          pretrained=True)</p>

          <p>.....<br>RuntimeError: Error(s) in loading state_dict for InceptionResnetV2:<br>        size
          mismatch for classif.weight: copying a param with shape torch.Size([2, 1536])
          from checkpoint, the shape in current model is torch.Size([3, 1536]).<br>        size
          mismatch for classif.bias: copying a param with shape torch.Size([2]) from
          checkpoint, the shape in current model is torch.Size([3]).</p>

          <p>BUT</p>

          <p>model = timm.create_model(''inception_resnet_v2'', pretrained=False,
          num_classes=3)<br>weights = torch.load(''pytorch_model.bin'')<br>model.load_state_dict(weights)</p>

          <p>  SUCCEEDED</p>

          '
        raw: "model = timm.create_model(\"hf_hub:FredZhang7/google-safesearch-mini-v2\"\
          , pretrained=True)\n\n.....\nRuntimeError: Error(s) in loading state_dict\
          \ for InceptionResnetV2:\n        size mismatch for classif.weight: copying\
          \ a param with shape torch.Size([2, 1536]) from checkpoint, the shape in\
          \ current model is torch.Size([3, 1536]).\n        size mismatch for classif.bias:\
          \ copying a param with shape torch.Size([2]) from checkpoint, the shape\
          \ in current model is torch.Size([3]).\n\nBUT\n\nmodel = timm.create_model('inception_resnet_v2',\
          \ pretrained=False, num_classes=3)\nweights = torch.load('pytorch_model.bin')\n\
          model.load_state_dict(weights)\n\n  SUCCEEDED"
        updatedAt: '2023-02-09T04:56:30.665Z'
      numEdits: 1
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - FredZhang7
    id: 63e4791b8083f19a21903545
    type: comment
  author: feature
  content: "model = timm.create_model(\"hf_hub:FredZhang7/google-safesearch-mini-v2\"\
    , pretrained=True)\n\n.....\nRuntimeError: Error(s) in loading state_dict for\
    \ InceptionResnetV2:\n        size mismatch for classif.weight: copying a param\
    \ with shape torch.Size([2, 1536]) from checkpoint, the shape in current model\
    \ is torch.Size([3, 1536]).\n        size mismatch for classif.bias: copying a\
    \ param with shape torch.Size([2]) from checkpoint, the shape in current model\
    \ is torch.Size([3]).\n\nBUT\n\nmodel = timm.create_model('inception_resnet_v2',\
    \ pretrained=False, num_classes=3)\nweights = torch.load('pytorch_model.bin')\n\
    model.load_state_dict(weights)\n\n  SUCCEEDED"
  created_at: 2023-02-09 04:39:55+00:00
  edited: true
  hidden: false
  id: 63e4791b8083f19a21903545
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62ecabfb9a6804372e4bacbf/mR2QYNuVShnzU-hbFh1rY.png?w=200&h=200&f=face
      fullname: Fred Zhang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: FredZhang7
      type: user
    createdAt: '2023-02-09T05:18:15.000Z'
    data:
      edited: false
      editors:
      - FredZhang7
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62ecabfb9a6804372e4bacbf/mR2QYNuVShnzU-hbFh1rY.png?w=200&h=200&f=face
          fullname: Fred Zhang
          isHf: false
          isPro: false
          name: FredZhang7
          type: user
        html: '<p>Thank you! I''m looking into it.</p>

          '
        raw: Thank you! I'm looking into it.
        updatedAt: '2023-02-09T05:18:15.441Z'
      numEdits: 0
      reactions: []
    id: 63e4821717cf6751440f1744
    type: comment
  author: FredZhang7
  content: Thank you! I'm looking into it.
  created_at: 2023-02-09 05:18:15+00:00
  edited: false
  hidden: false
  id: 63e4821717cf6751440f1744
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62ecabfb9a6804372e4bacbf/mR2QYNuVShnzU-hbFh1rY.png?w=200&h=200&f=face
      fullname: Fred Zhang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: FredZhang7
      type: user
    createdAt: '2023-02-11T01:18:31.000Z'
    data:
      edited: false
      editors:
      - FredZhang7
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62ecabfb9a6804372e4bacbf/mR2QYNuVShnzU-hbFh1rY.png?w=200&h=200&f=face
          fullname: Fred Zhang
          isHf: false
          isPro: false
          name: FredZhang7
          type: user
        html: '<p>Hi!</p>

          <pre><code class="language-python">model = timm.create_model(<span class="hljs-string">"hf_hub:FredZhang7/google-safesearch-mini-v2"</span>,
          pretrained=<span class="hljs-literal">True</span>)

          </code></pre>

          <p>shouldn''t cause errors anymore. It turned out to be a silly mistake.
          <code>label_offset</code> in <code>config.json</code> should have been set
          to 0 (class labels: 0, 1, 2) instead of 1 (class labels: 1, 2).</p>

          '
        raw: 'Hi!

          ```python

          model = timm.create_model("hf_hub:FredZhang7/google-safesearch-mini-v2",
          pretrained=True)

          ```

          shouldn''t cause errors anymore. It turned out to be a silly mistake. `label_offset`
          in `config.json` should have been set to 0 (class labels: 0, 1, 2) instead
          of 1 (class labels: 1, 2).'
        updatedAt: '2023-02-11T01:18:31.255Z'
      numEdits: 0
      reactions: []
      relatedEventId: 63e6ece763037c7d96297a77
    id: 63e6ece763037c7d96297a76
    type: comment
  author: FredZhang7
  content: 'Hi!

    ```python

    model = timm.create_model("hf_hub:FredZhang7/google-safesearch-mini-v2", pretrained=True)

    ```

    shouldn''t cause errors anymore. It turned out to be a silly mistake. `label_offset`
    in `config.json` should have been set to 0 (class labels: 0, 1, 2) instead of
    1 (class labels: 1, 2).'
  created_at: 2023-02-11 01:18:31+00:00
  edited: false
  hidden: false
  id: 63e6ece763037c7d96297a76
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62ecabfb9a6804372e4bacbf/mR2QYNuVShnzU-hbFh1rY.png?w=200&h=200&f=face
      fullname: Fred Zhang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: FredZhang7
      type: user
    createdAt: '2023-02-11T01:18:31.000Z'
    data:
      status: closed
    id: 63e6ece763037c7d96297a77
    type: status-change
  author: FredZhang7
  created_at: 2023-02-11 01:18:31+00:00
  id: 63e6ece763037c7d96297a77
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: FredZhang7/google-safesearch-mini-v2
repo_type: model
status: closed
target_branch: null
title: timm.create_model failed
