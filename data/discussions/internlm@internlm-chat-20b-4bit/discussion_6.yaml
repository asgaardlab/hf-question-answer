!!python/object:huggingface_hub.community.DiscussionWithDetails
author: BBLL3456
conflicting_files: null
created_at: 2023-09-27 03:14:16+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/0df4268f9ce3f803235e13f95b2f21a0.svg
      fullname: supersuper
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: BBLL3456
      type: user
    createdAt: '2023-09-27T04:14:16.000Z'
    data:
      edited: false
      editors:
      - BBLL3456
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4669569730758667
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/0df4268f9ce3f803235e13f95b2f21a0.svg
          fullname: supersuper
          isHf: false
          isPro: false
          name: BBLL3456
          type: user
        html: '<p>When ran with lmdeploy, while converting the model i ran into this
          error:</p>

          <p>layers.59.attention_norm.weight torch.Size([5120])<br>layers.59.ffn_norm.weight
          torch.Size([5120])<br>tok_embeddings.weight torch.Size([103168, 5120])<br>norm.weight
          torch.Size([5120])<br>output.weight torch.Size([103168, 5120])<br>Traceback
          (most recent call last):<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py",
          line 196, in _run_module_as_main<br>    return _run_code(code, main_globals,
          None,<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py",
          line 86, in _run_code<br>    exec(code, run_globals)<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py",
          line 1028, in <br>    fire.Fire(main)<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py",
          line 141, in Fire<br>    component_trace = _Fire(component, args, parsed_flag_args,
          context, name)<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py",
          line 475, in _Fire<br>    component, remaining_args = _CallAndUpdateTrace(<br>  File
          "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py",
          line 691, in _CallAndUpdateTrace<br>    component = fn(*varargs, **kwargs)<br>  File
          "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py",
          line 992, in main<br>    res = deploy_hf(model_name, model_path, tokenizer_path,<br>  File
          "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py",
          line 541, in deploy_hf<br>    return export(model_name,<br>  File "/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py",
          line 202, in export<br>    assert inter_size &gt; 0<br>AssertionError</p>

          '
        raw: "When ran with lmdeploy, while converting the model i ran into this error:\r\
          \n\r\nlayers.59.attention_norm.weight torch.Size([5120])\r\nlayers.59.ffn_norm.weight\
          \ torch.Size([5120])\r\ntok_embeddings.weight torch.Size([103168, 5120])\r\
          \nnorm.weight torch.Size([5120])\r\noutput.weight torch.Size([103168, 5120])\r\
          \nTraceback (most recent call last):\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py\"\
          , line 196, in _run_module_as_main\r\n    return _run_code(code, main_globals,\
          \ None,\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py\"\
          , line 86, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
          , line 1028, in <module>\r\n    fire.Fire(main)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
          , line 141, in Fire\r\n    component_trace = _Fire(component, args, parsed_flag_args,\
          \ context, name)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
          , line 475, in _Fire\r\n    component, remaining_args = _CallAndUpdateTrace(\r\
          \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
          , line 691, in _CallAndUpdateTrace\r\n    component = fn(*varargs, **kwargs)\r\
          \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
          , line 992, in main\r\n    res = deploy_hf(model_name, model_path, tokenizer_path,\r\
          \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
          , line 541, in deploy_hf\r\n    return export(model_name,\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
          , line 202, in export\r\n    assert inter_size > 0\r\nAssertionError"
        updatedAt: '2023-09-27T04:14:16.950Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F614"
        users:
        - choya
    id: 6513ac1897fb08378de6c5ff
    type: comment
  author: BBLL3456
  content: "When ran with lmdeploy, while converting the model i ran into this error:\r\
    \n\r\nlayers.59.attention_norm.weight torch.Size([5120])\r\nlayers.59.ffn_norm.weight\
    \ torch.Size([5120])\r\ntok_embeddings.weight torch.Size([103168, 5120])\r\nnorm.weight\
    \ torch.Size([5120])\r\noutput.weight torch.Size([103168, 5120])\r\nTraceback\
    \ (most recent call last):\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py\"\
    , line 196, in _run_module_as_main\r\n    return _run_code(code, main_globals,\
    \ None,\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/runpy.py\"\
    , line 86, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
    , line 1028, in <module>\r\n    fire.Fire(main)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
    , line 141, in Fire\r\n    component_trace = _Fire(component, args, parsed_flag_args,\
    \ context, name)\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
    , line 475, in _Fire\r\n    component, remaining_args = _CallAndUpdateTrace(\r\
    \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/fire/core.py\"\
    , line 691, in _CallAndUpdateTrace\r\n    component = fn(*varargs, **kwargs)\r\
    \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
    , line 992, in main\r\n    res = deploy_hf(model_name, model_path, tokenizer_path,\r\
    \n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
    , line 541, in deploy_hf\r\n    return export(model_name,\r\n  File \"/home/user/miniconda3/envs/internlm2/lib/python3.10/site-packages/lmdeploy/serve/turbomind/deploy.py\"\
    , line 202, in export\r\n    assert inter_size > 0\r\nAssertionError"
  created_at: 2023-09-27 03:14:16+00:00
  edited: false
  hidden: false
  id: 6513ac1897fb08378de6c5ff
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3f6279ee9e9f6a5b2f6794c5a394ef09.svg
      fullname: lmdeploy
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: unsubscribe
      type: user
    createdAt: '2023-10-09T02:59:42.000Z'
    data:
      edited: false
      editors:
      - unsubscribe
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6474072337150574
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3f6279ee9e9f6a5b2f6794c5a394ef09.svg
          fullname: lmdeploy
          isHf: false
          isPro: false
          name: unsubscribe
          type: user
        html: '<p>please paste the conversion script.</p>

          '
        raw: please paste the conversion script.
        updatedAt: '2023-10-09T02:59:42.184Z'
      numEdits: 0
      reactions: []
    id: 65236c9e974423bd3e0438a2
    type: comment
  author: unsubscribe
  content: please paste the conversion script.
  created_at: 2023-10-09 01:59:42+00:00
  edited: false
  hidden: false
  id: 65236c9e974423bd3e0438a2
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 6
repo_id: internlm/internlm-chat-20b-4bit
repo_type: model
status: open
target_branch: null
title: Assertion Error
