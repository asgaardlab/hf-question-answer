!!python/object:huggingface_hub.community.DiscussionWithDetails
author: omerjadoon1
conflicting_files: null
created_at: 2023-08-24 00:01:23+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/73fc90e7677ebfa63fef59614bfc246a.svg
      fullname: Omer jadoon
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: omerjadoon1
      type: user
    createdAt: '2023-08-24T01:01:23.000Z'
    data:
      edited: false
      editors:
      - omerjadoon1
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6127621531486511
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/73fc90e7677ebfa63fef59614bfc246a.svg
          fullname: Omer jadoon
          isHf: false
          isPro: false
          name: omerjadoon1
          type: user
        html: '<p>How to get individual labels and seperate segmented masks for each
          category? e.g the code you provided return an image with all the segmented
          images on top of each other. how can i get it seperately and how do i know
          which segment belongs to which category.</p>

          <p>Reference Code:<br>from transformers import SegformerImageProcessor,
          AutoModelForSemanticSegmentation<br>from PIL import Image<br>import requests<br>import
          matplotlib.pyplot as plt<br>import torch.nn as nn</p>

          <p>processor = SegformerImageProcessor.from_pretrained("mattmdjaga/segformer_b2_clothes")<br>model
          = AutoModelForSemanticSegmentation.from_pretrained("mattmdjaga/segformer_b2_clothes")</p>

          <p>url = "<a rel="nofollow" href="https://img.ltwebstatic.com/images3_pi/2022/12/30/16723672772d7cd1f75a62454976de69df7d4b2bd2_thumbnail_600x.webp&quot;">https://img.ltwebstatic.com/images3_pi/2022/12/30/16723672772d7cd1f75a62454976de69df7d4b2bd2_thumbnail_600x.webp"</a></p>

          <p>image = Image.open(requests.get(url, stream=True).raw)<br>inputs = processor(images=image,
          return_tensors="pt")</p>

          <p>outputs = model(**inputs)<br>logits = outputs.logits.cpu()</p>

          <p>upsampled_logits = nn.functional.interpolate(<br>    logits,<br>    size=image.size[::-1],<br>    mode="bilinear",<br>    align_corners=True,<br>)</p>

          <p>pred_seg = upsampled_logits.argmax(dim=1)[0]<br>plt.imshow(pred_seg)</p>

          '
        raw: "How to get individual labels and seperate segmented masks for each category?\
          \ e.g the code you provided return an image with all the segmented images\
          \ on top of each other. how can i get it seperately and how do i know which\
          \ segment belongs to which category.\r\n\r\n\r\nReference Code:\r\nfrom\
          \ transformers import SegformerImageProcessor, AutoModelForSemanticSegmentation\r\
          \nfrom PIL import Image\r\nimport requests\r\nimport matplotlib.pyplot as\
          \ plt\r\nimport torch.nn as nn\r\n\r\nprocessor = SegformerImageProcessor.from_pretrained(\"\
          mattmdjaga/segformer_b2_clothes\")\r\nmodel = AutoModelForSemanticSegmentation.from_pretrained(\"\
          mattmdjaga/segformer_b2_clothes\")\r\n\r\nurl = \"https://img.ltwebstatic.com/images3_pi/2022/12/30/16723672772d7cd1f75a62454976de69df7d4b2bd2_thumbnail_600x.webp\"\
          \r\n\r\nimage = Image.open(requests.get(url, stream=True).raw)\r\ninputs\
          \ = processor(images=image, return_tensors=\"pt\")\r\n\r\noutputs = model(**inputs)\r\
          \nlogits = outputs.logits.cpu()\r\n\r\nupsampled_logits = nn.functional.interpolate(\r\
          \n    logits,\r\n    size=image.size[::-1],\r\n    mode=\"bilinear\",\r\n\
          \    align_corners=True,\r\n)\r\n\r\npred_seg = upsampled_logits.argmax(dim=1)[0]\r\
          \nplt.imshow(pred_seg)\r\n"
        updatedAt: '2023-08-24T01:01:23.032Z'
      numEdits: 0
      reactions: []
    id: 64e6abe31703da9e63cc5c71
    type: comment
  author: omerjadoon1
  content: "How to get individual labels and seperate segmented masks for each category?\
    \ e.g the code you provided return an image with all the segmented images on top\
    \ of each other. how can i get it seperately and how do i know which segment belongs\
    \ to which category.\r\n\r\n\r\nReference Code:\r\nfrom transformers import SegformerImageProcessor,\
    \ AutoModelForSemanticSegmentation\r\nfrom PIL import Image\r\nimport requests\r\
    \nimport matplotlib.pyplot as plt\r\nimport torch.nn as nn\r\n\r\nprocessor =\
    \ SegformerImageProcessor.from_pretrained(\"mattmdjaga/segformer_b2_clothes\"\
    )\r\nmodel = AutoModelForSemanticSegmentation.from_pretrained(\"mattmdjaga/segformer_b2_clothes\"\
    )\r\n\r\nurl = \"https://img.ltwebstatic.com/images3_pi/2022/12/30/16723672772d7cd1f75a62454976de69df7d4b2bd2_thumbnail_600x.webp\"\
    \r\n\r\nimage = Image.open(requests.get(url, stream=True).raw)\r\ninputs = processor(images=image,\
    \ return_tensors=\"pt\")\r\n\r\noutputs = model(**inputs)\r\nlogits = outputs.logits.cpu()\r\
    \n\r\nupsampled_logits = nn.functional.interpolate(\r\n    logits,\r\n    size=image.size[::-1],\r\
    \n    mode=\"bilinear\",\r\n    align_corners=True,\r\n)\r\n\r\npred_seg = upsampled_logits.argmax(dim=1)[0]\r\
    \nplt.imshow(pred_seg)\r\n"
  created_at: 2023-08-24 00:01:23+00:00
  edited: false
  hidden: false
  id: 64e6abe31703da9e63cc5c71
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62710bd57b9f120adb36e451/xv02RE8VgayDPDE6jkwV2.png?w=200&h=200&f=face
      fullname: Mateusz Dziemian
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: mattmdjaga
      type: user
    createdAt: '2023-08-24T09:19:23.000Z'
    data:
      edited: false
      editors:
      - mattmdjaga
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6858228445053101
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62710bd57b9f120adb36e451/xv02RE8VgayDPDE6jkwV2.png?w=200&h=200&f=face
          fullname: Mateusz Dziemian
          isHf: false
          isPro: false
          name: mattmdjaga
          type: user
        html: "<p>Hi, the code blow loops over the masks and sets the name of that\
          \ label as the title, does that help?</p>\n<pre><code>import numpy as np\
          \ \nimport torch\n\nsegments = torch.unique(pred_seg) # Get a list of all\
          \ the predicted items\nfor i in segments: \n    mask = pred_seg == i # Filter\
          \ out anything that isn't the current item\n    img = Image.fromarray((mask\
          \ * 255).numpy().astype(np.uint8))\n    name = model.config.id2label[i.item()]\
          \ # get the item name\n    plt.imshow(img)\n    plt.title(name)\n    plt.show()\n\
          </code></pre>\n"
        raw: "Hi, the code blow loops over the masks and sets the name of that label\
          \ as the title, does that help?\n```\nimport numpy as np \nimport torch\n\
          \nsegments = torch.unique(pred_seg) # Get a list of all the predicted items\n\
          for i in segments: \n    mask = pred_seg == i # Filter out anything that\
          \ isn't the current item\n    img = Image.fromarray((mask * 255).numpy().astype(np.uint8))\n\
          \    name = model.config.id2label[i.item()] # get the item name\n    plt.imshow(img)\n\
          \    plt.title(name)\n    plt.show()\n```"
        updatedAt: '2023-08-24T09:19:23.193Z'
      numEdits: 0
      reactions: []
    id: 64e7209bdafbba06bec6aa0e
    type: comment
  author: mattmdjaga
  content: "Hi, the code blow loops over the masks and sets the name of that label\
    \ as the title, does that help?\n```\nimport numpy as np \nimport torch\n\nsegments\
    \ = torch.unique(pred_seg) # Get a list of all the predicted items\nfor i in segments:\
    \ \n    mask = pred_seg == i # Filter out anything that isn't the current item\n\
    \    img = Image.fromarray((mask * 255).numpy().astype(np.uint8))\n    name =\
    \ model.config.id2label[i.item()] # get the item name\n    plt.imshow(img)\n \
    \   plt.title(name)\n    plt.show()\n```"
  created_at: 2023-08-24 08:19:23+00:00
  edited: false
  hidden: false
  id: 64e7209bdafbba06bec6aa0e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/73fc90e7677ebfa63fef59614bfc246a.svg
      fullname: Omer jadoon
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: omerjadoon1
      type: user
    createdAt: '2023-08-24T13:13:56.000Z'
    data:
      edited: false
      editors:
      - omerjadoon1
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8260655403137207
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/73fc90e7677ebfa63fef59614bfc246a.svg
          fullname: Omer jadoon
          isHf: false
          isPro: false
          name: omerjadoon1
          type: user
        html: '<p>Thanks alot. :)</p>

          '
        raw: Thanks alot. :)
        updatedAt: '2023-08-24T13:13:56.095Z'
      numEdits: 0
      reactions: []
      relatedEventId: 64e757943b9c1e300e0c6a9c
    id: 64e757943b9c1e300e0c6a97
    type: comment
  author: omerjadoon1
  content: Thanks alot. :)
  created_at: 2023-08-24 12:13:56+00:00
  edited: false
  hidden: false
  id: 64e757943b9c1e300e0c6a97
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/73fc90e7677ebfa63fef59614bfc246a.svg
      fullname: Omer jadoon
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: omerjadoon1
      type: user
    createdAt: '2023-08-24T13:13:56.000Z'
    data:
      status: closed
    id: 64e757943b9c1e300e0c6a9c
    type: status-change
  author: omerjadoon1
  created_at: 2023-08-24 12:13:56+00:00
  id: 64e757943b9c1e300e0c6a9c
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 14
repo_id: mattmdjaga/segformer_b2_clothes
repo_type: model
status: closed
target_branch: null
title: How to get individual labels and seperate segmented masks for each category
