!!python/object:huggingface_hub.community.DiscussionWithDetails
author: irenedea
conflicting_files: []
created_at: 2024-01-20 02:09:02+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/21a9a778ee5350a1e620d2bd848ee581.svg
      fullname: Irene Dea
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: irenedea
      type: user
    createdAt: '2024-01-20T02:09:02.000Z'
    data:
      edited: true
      editors:
      - irenedea
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7681947350502014
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/21a9a778ee5350a1e620d2bd848ee581.svg
          fullname: Irene Dea
          isHf: false
          isPro: false
          name: irenedea
          type: user
        html: "<p>We should only add generation prompt after the last message. </p>\n\
          <p>Code</p>\n<pre><code>from transformers import AutoTokenizer\n\ntokenizer\
          \ = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat', revision='refs/pr/7')\n\
          \nchat = [{\n    'content':\n        'Please summarize the goals in this\
          \ text:\\n\\nGoing outside has benefits include reducing stress and triggering\
          \ the relaxation response, which can help us not only feel better mentally,\
          \ but even heal faster from physical ailments.',\n    'role':\n        'user'\n\
          }, {\n    'content': 'You should go outside and touch grass.',\n    'role':\
          \ 'assistant'\n}, {\n    'content': 'What else can I do?',\n    'role':\
          \ 'user'\n}\n]\n\nprint('\\nBEFORE!')\nprint(tokenizer.apply_chat_template(chat,\
          \ tokenize=False, add_generation_prompt=True))\n\n\ntokenizer = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat',\
          \ revision='refs/pr/8')\n\nprint('\\nAFTER!')\nprint(tokenizer.apply_chat_template(chat,\
          \ tokenize=False, add_generation_prompt=True))\n</code></pre>\n<p>Output</p>\n\
          <pre><code>BEFORE!\n&lt;|im_start|&gt;system\nA conversation between a user\
          \ and an LLM-based AI assistant. The assistant gives helpful and honest\
          \ answers.\n&lt;|im_start|&gt;user\nPlease summarize the goals in this text:\n\
          \nGoing outside has benefits include reducing stress and triggering the\
          \ relaxation response, which can help us not only feel better mentally,\
          \ but even heal faster from physical ailments.&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant\n\
          \n&lt;|im_start|&gt;assistant\nYou should go outside and touch grass.&lt;|im_end|&gt;\n\
          &lt;|im_start|&gt;assistant\n\n&lt;|im_start|&gt;user\nWhat else can I do?&lt;|im_end|&gt;\n\
          &lt;|im_start|&gt;assistant\n\nSpecial tokens have been added in the vocabulary,\
          \ make sure the associated word embeddings are fine-tuned or trained.\n\n\
          AFTER!\n&lt;|im_start|&gt;system\nA conversation between a user and an LLM-based\
          \ AI assistant. The assistant gives helpful and honest answers.\n&lt;|im_start|&gt;user\n\
          Please summarize the goals in this text:\n\nGoing outside has benefits include\
          \ reducing stress and triggering the relaxation response, which can help\
          \ us not only feel better mentally, but even heal faster from physical ailments.&lt;|im_end|&gt;\n\
          &lt;|im_start|&gt;assistant\nYou should go outside and touch grass.&lt;|im_end|&gt;\n\
          &lt;|im_start|&gt;user\nWhat else can I do?&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant\n\
          </code></pre>\n"
        raw: "We should only add generation prompt after the last message. \n\nCode\n\
          ```\nfrom transformers import AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat',\
          \ revision='refs/pr/7')\n\nchat = [{\n    'content':\n        'Please summarize\
          \ the goals in this text:\\n\\nGoing outside has benefits include reducing\
          \ stress and triggering the relaxation response, which can help us not only\
          \ feel better mentally, but even heal faster from physical ailments.',\n\
          \    'role':\n        'user'\n}, {\n    'content': 'You should go outside\
          \ and touch grass.',\n    'role': 'assistant'\n}, {\n    'content': 'What\
          \ else can I do?',\n    'role': 'user'\n}\n]\n\nprint('\\nBEFORE!')\nprint(tokenizer.apply_chat_template(chat,\
          \ tokenize=False, add_generation_prompt=True))\n\n\ntokenizer = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat',\
          \ revision='refs/pr/8')\n\nprint('\\nAFTER!')\nprint(tokenizer.apply_chat_template(chat,\
          \ tokenize=False, add_generation_prompt=True))\n\n```\n\nOutput\n```\nBEFORE!\n\
          <|im_start|>system\nA conversation between a user and an LLM-based AI assistant.\
          \ The assistant gives helpful and honest answers.\n<|im_start|>user\nPlease\
          \ summarize the goals in this text:\n\nGoing outside has benefits include\
          \ reducing stress and triggering the relaxation response, which can help\
          \ us not only feel better mentally, but even heal faster from physical ailments.<|im_end|>\n\
          <|im_start|>assistant\n\n<|im_start|>assistant\nYou should go outside and\
          \ touch grass.<|im_end|>\n<|im_start|>assistant\n\n<|im_start|>user\nWhat\
          \ else can I do?<|im_end|>\n<|im_start|>assistant\n\nSpecial tokens have\
          \ been added in the vocabulary, make sure the associated word embeddings\
          \ are fine-tuned or trained.\n\nAFTER!\n<|im_start|>system\nA conversation\
          \ between a user and an LLM-based AI assistant. The assistant gives helpful\
          \ and honest answers.\n<|im_start|>user\nPlease summarize the goals in this\
          \ text:\n\nGoing outside has benefits include reducing stress and triggering\
          \ the relaxation response, which can help us not only feel better mentally,\
          \ but even heal faster from physical ailments.<|im_end|>\n<|im_start|>assistant\n\
          You should go outside and touch grass.<|im_end|>\n<|im_start|>user\nWhat\
          \ else can I do?<|im_end|>\n<|im_start|>assistant\n\n```"
        updatedAt: '2024-01-20T02:09:51.467Z'
      numEdits: 1
      reactions: []
    id: 65ab2b3e5c84d7d5e705d33b
    type: comment
  author: irenedea
  content: "We should only add generation prompt after the last message. \n\nCode\n\
    ```\nfrom transformers import AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat',\
    \ revision='refs/pr/7')\n\nchat = [{\n    'content':\n        'Please summarize\
    \ the goals in this text:\\n\\nGoing outside has benefits include reducing stress\
    \ and triggering the relaxation response, which can help us not only feel better\
    \ mentally, but even heal faster from physical ailments.',\n    'role':\n    \
    \    'user'\n}, {\n    'content': 'You should go outside and touch grass.',\n\
    \    'role': 'assistant'\n}, {\n    'content': 'What else can I do?',\n    'role':\
    \ 'user'\n}\n]\n\nprint('\\nBEFORE!')\nprint(tokenizer.apply_chat_template(chat,\
    \ tokenize=False, add_generation_prompt=True))\n\n\ntokenizer = AutoTokenizer.from_pretrained('mosaicml/mpt-7b-8k-chat',\
    \ revision='refs/pr/8')\n\nprint('\\nAFTER!')\nprint(tokenizer.apply_chat_template(chat,\
    \ tokenize=False, add_generation_prompt=True))\n\n```\n\nOutput\n```\nBEFORE!\n\
    <|im_start|>system\nA conversation between a user and an LLM-based AI assistant.\
    \ The assistant gives helpful and honest answers.\n<|im_start|>user\nPlease summarize\
    \ the goals in this text:\n\nGoing outside has benefits include reducing stress\
    \ and triggering the relaxation response, which can help us not only feel better\
    \ mentally, but even heal faster from physical ailments.<|im_end|>\n<|im_start|>assistant\n\
    \n<|im_start|>assistant\nYou should go outside and touch grass.<|im_end|>\n<|im_start|>assistant\n\
    \n<|im_start|>user\nWhat else can I do?<|im_end|>\n<|im_start|>assistant\n\nSpecial\
    \ tokens have been added in the vocabulary, make sure the associated word embeddings\
    \ are fine-tuned or trained.\n\nAFTER!\n<|im_start|>system\nA conversation between\
    \ a user and an LLM-based AI assistant. The assistant gives helpful and honest\
    \ answers.\n<|im_start|>user\nPlease summarize the goals in this text:\n\nGoing\
    \ outside has benefits include reducing stress and triggering the relaxation response,\
    \ which can help us not only feel better mentally, but even heal faster from physical\
    \ ailments.<|im_end|>\n<|im_start|>assistant\nYou should go outside and touch\
    \ grass.<|im_end|>\n<|im_start|>user\nWhat else can I do?<|im_end|>\n<|im_start|>assistant\n\
    \n```"
  created_at: 2024-01-20 02:09:02+00:00
  edited: true
  hidden: false
  id: 65ab2b3e5c84d7d5e705d33b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/21a9a778ee5350a1e620d2bd848ee581.svg
      fullname: Irene Dea
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: irenedea
      type: user
    createdAt: '2024-01-20T02:09:03.000Z'
    data:
      oid: 5b376ae7100eeee33d5dba9cf5dc2c4fc17f5fd7
      parents:
      - 03fb479d26de4c9c358909f375b2d8942422a9d9
      subject: Fix add_generation_prompt in tokenizer.config
    id: 65ab2b3f0000000000000000
    type: commit
  author: irenedea
  created_at: 2024-01-20 02:09:03+00:00
  id: 65ab2b3f0000000000000000
  oid: 5b376ae7100eeee33d5dba9cf5dc2c4fc17f5fd7
  summary: Fix add_generation_prompt in tokenizer.config
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1668560930781-noauth.png?w=200&h=200&f=face
      fullname: Sam Havens
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sam-mosaic
      type: user
    createdAt: '2024-01-20T02:09:28.000Z'
    data:
      edited: false
      editors:
      - sam-mosaic
      hidden: false
      identifiedLanguage:
        language: pl
        probability: 0.7158764600753784
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1668560930781-noauth.png?w=200&h=200&f=face
          fullname: Sam Havens
          isHf: false
          isPro: false
          name: sam-mosaic
          type: user
        html: '<p>ty!</p>

          '
        raw: ty!
        updatedAt: '2024-01-20T02:09:28.977Z'
      numEdits: 0
      reactions: []
      relatedEventId: 65ab2b59356bf23b4aaf068a
    id: 65ab2b58356bf23b4aaf0686
    type: comment
  author: sam-mosaic
  content: ty!
  created_at: 2024-01-20 02:09:28+00:00
  edited: false
  hidden: false
  id: 65ab2b58356bf23b4aaf0686
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1668560930781-noauth.png?w=200&h=200&f=face
      fullname: Sam Havens
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sam-mosaic
      type: user
    createdAt: '2024-01-20T02:09:29.000Z'
    data:
      status: merged
    id: 65ab2b59356bf23b4aaf068a
    type: status-change
  author: sam-mosaic
  created_at: 2024-01-20 02:09:29+00:00
  id: 65ab2b59356bf23b4aaf068a
  new_status: merged
  type: status-change
is_pull_request: true
merge_commit_oid: fa71e006599f2db2a3f0bc388ebbe8b555847077
num: 8
repo_id: mosaicml/mpt-7b-8k-chat
repo_type: model
status: merged
target_branch: refs/heads/main
title: Fix add_generation_prompt in tokenizer.config
