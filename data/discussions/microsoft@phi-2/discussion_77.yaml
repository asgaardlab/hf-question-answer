!!python/object:huggingface_hub.community.DiscussionWithDetails
author: chriamue
conflicting_files: null
created_at: 2024-01-11 19:57:13+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1312f0b5418d001b2d9341a76630a20b.svg
      fullname: Christian
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: chriamue
      type: user
    createdAt: '2024-01-11T19:57:13.000Z'
    data:
      edited: false
      editors:
      - chriamue
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7581304907798767
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1312f0b5418d001b2d9341a76630a20b.svg
          fullname: Christian
          isHf: false
          isPro: false
          name: chriamue
          type: user
        html: "<p>Hi, I try to run the Model with chat-ui on a candle backend.</p>\n\
          <p>How should the chatPromptTemplate look like?<br>I started with following,\
          \ derived from the Llama example and the description of the model card.<br>But\
          \ it looks like, when asking the second time, the context of last answer\
          \ is not used correctly.</p>\n<p>Here is my configuration.</p>\n<pre><code\
          \ class=\"language-json\">    <span class=\"hljs-punctuation\">{</span>\n\
          \      <span class=\"hljs-attr\">\"name\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-string\">\"microsoft/phi-2\"</span><span class=\"\
          hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"description\"\
          </span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\"\
          >\"1.3b and 2.7b LLM with state of the art performance for &lt;10b models\"\
          </span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\"\
          >\"websiteUrl\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-string\">\"https://huggingface.co/microsoft/phi-2\"</span><span class=\"\
          hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"userMessageToken\"\
          </span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\"\
          >\"\"</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"\
          hljs-attr\">\"userMessageEndToken\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-string\">\" [/INST] \"</span><span class=\"\
          hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"assistantMessageToken\"\
          </span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\"\
          >\"\"</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"\
          hljs-attr\">\"assistantMessageEndToken\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-string\">\" &lt;/s&gt;&lt;s&gt;[INST] \"</span><span\
          \ class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"\
          preprompt\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-string\">\" \"</span><span class=\"hljs-punctuation\">,</span>\n  \
          \    <span class=\"hljs-attr\">\"chatPromptTemplate\"</span> <span class=\"\
          hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Instruct: {{#each\
          \ messages}}{{#ifUser}}{{content}}\\n{{/ifUser}}{{#ifAssistant}}{{content}}\\\
          n{{/ifAssistant}}{{/each}}\\nOutput:\"</span><span class=\"hljs-punctuation\"\
          >,</span>\n      <span class=\"hljs-attr\">\"endpoints\"</span><span class=\"\
          hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span\
          \ class=\"hljs-punctuation\">{</span>\n            <span class=\"hljs-attr\"\
          >\"type\"</span> <span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-string\">\"tgi\"</span><span class=\"hljs-punctuation\">,</span>\n\
          \            <span class=\"hljs-attr\">\"url\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-string\">\"http://chat-flame-backend:8080/model/phi-v2/\"\
          </span>\n            <span class=\"hljs-punctuation\">}</span><span class=\"\
          hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n \
          \     <span class=\"hljs-attr\">\"promptExamples\"</span><span class=\"\
          hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n\
          \        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"\
          hljs-attr\">\"title\"</span><span class=\"hljs-punctuation\">:</span> <span\
          \ class=\"hljs-string\">\"Write an email from bullet list\"</span><span\
          \ class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\"\
          >\"prompt\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-string\">\"As a restaurant owner, write a professional email to the\
          \ supplier to get these products every week: \\n\\n- Wine (x10)\\n- Eggs\
          \ (x24)\\n- Bread (x12)\"</span>\n        <span class=\"hljs-punctuation\"\
          >}</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-punctuation\"\
          >{</span>\n          <span class=\"hljs-attr\">\"title\"</span><span class=\"\
          hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Code a snake game\"\
          </span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"\
          hljs-attr\">\"prompt\"</span><span class=\"hljs-punctuation\">:</span> <span\
          \ class=\"hljs-string\">\"Code a basic snake game in python, give explanations\
          \ for each step.\"</span>\n        <span class=\"hljs-punctuation\">}</span><span\
          \ class=\"hljs-punctuation\">,</span> <span class=\"hljs-punctuation\">{</span>\n\
          \          <span class=\"hljs-attr\">\"title\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-string\">\"Assist in a task\"</span><span class=\"\
          hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">\"prompt\"\
          </span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\"\
          >\"How do I make a delicious lemon cheesecake?\"</span>\n        <span class=\"\
          hljs-punctuation\">}</span>\n      <span class=\"hljs-punctuation\">]</span><span\
          \ class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">\"\
          parameters\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">\"temperature\"\
          </span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\"\
          >0.1</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"\
          hljs-attr\">\"top_p\"</span><span class=\"hljs-punctuation\">:</span> <span\
          \ class=\"hljs-number\">0.95</span><span class=\"hljs-punctuation\">,</span>\n\
          \        <span class=\"hljs-attr\">\"repetition_penalty\"</span><span class=\"\
          hljs-punctuation\">:</span> <span class=\"hljs-number\">1.2</span><span\
          \ class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\"\
          >\"top_k\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-number\">50</span><span class=\"hljs-punctuation\">,</span>\n     \
          \   <span class=\"hljs-attr\">\"truncate\"</span><span class=\"hljs-punctuation\"\
          >:</span> <span class=\"hljs-number\">3072</span><span class=\"hljs-punctuation\"\
          >,</span>\n        <span class=\"hljs-attr\">\"max_new_tokens\"</span><span\
          \ class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1024</span><span\
          \ class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\"\
          >\"stop\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"\
          hljs-punctuation\">[</span><span class=\"hljs-string\">\"&lt;/s&gt;\"</span><span\
          \ class=\"hljs-punctuation\">]</span>\n      <span class=\"hljs-punctuation\"\
          >}</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\"\
          >,</span>\n</code></pre>\n<p>Here is a conversation:</p>\n<pre><code>Prompt:\n\
          As a restaurant owner, write a professional email to the supplier to get\
          \ these products every week: \n\n- Wine (x10)\n- Eggs (x24)\n- Bread (x12)\n\
          \nAnswer:\nSupplier,\n\nI hope this email finds you well. I am writing to\
          \ place an order for our weekly supplies of wine, eggs and bread. The quantity\
          \ required is as follows: 10 bottles of wine, 24 cartons of eggs and 12\
          \ loaves of bread. Please let me know when the delivery can be made. Thank\
          \ you for your continued support.\n\nBest regards,\n[Your Name]\n\nPrompt:\n\
          \ rewrite it more happy\n\nAnswer:\n Weekly Supplies Order - Wine, Eggs\
          \ &amp; Bread\n</code></pre>\n"
        raw: "Hi, I try to run the Model with chat-ui on a candle backend.\r\n\r\n\
          How should the chatPromptTemplate look like?\r\nI started with following,\
          \ derived from the Llama example and the description of the model card.\r\
          \nBut it looks like, when asking the second time, the context of last answer\
          \ is not used correctly.\r\n\r\nHere is my configuration.\r\n\r\n```json\r\
          \n    {\r\n      \"name\": \"microsoft/phi-2\",\r\n      \"description\"\
          : \"1.3b and 2.7b LLM with state of the art performance for <10b models\"\
          ,\r\n      \"websiteUrl\": \"https://huggingface.co/microsoft/phi-2\",\r\
          \n      \"userMessageToken\": \"\",\r\n      \"userMessageEndToken\": \"\
          \ [/INST] \",\r\n      \"assistantMessageToken\": \"\",\r\n      \"assistantMessageEndToken\"\
          : \" </s><s>[INST] \",\r\n      \"preprompt\": \" \",\r\n      \"chatPromptTemplate\"\
          \ : \"Instruct: {{#each messages}}{{#ifUser}}{{content}}\\n{{/ifUser}}{{#ifAssistant}}{{content}}\\\
          n{{/ifAssistant}}{{/each}}\\nOutput:\",\r\n      \"endpoints\": [{\r\n \
          \           \"type\" : \"tgi\",\r\n            \"url\": \"http://chat-flame-backend:8080/model/phi-v2/\"\
          \r\n            }],\r\n      \"promptExamples\": [\r\n        {\r\n    \
          \      \"title\": \"Write an email from bullet list\",\r\n          \"prompt\"\
          : \"As a restaurant owner, write a professional email to the supplier to\
          \ get these products every week: \\n\\n- Wine (x10)\\n- Eggs (x24)\\n- Bread\
          \ (x12)\"\r\n        }, {\r\n          \"title\": \"Code a snake game\"\
          ,\r\n          \"prompt\": \"Code a basic snake game in python, give explanations\
          \ for each step.\"\r\n        }, {\r\n          \"title\": \"Assist in a\
          \ task\",\r\n          \"prompt\": \"How do I make a delicious lemon cheesecake?\"\
          \r\n        }\r\n      ],\r\n      \"parameters\": {\r\n        \"temperature\"\
          : 0.1,\r\n        \"top_p\": 0.95,\r\n        \"repetition_penalty\": 1.2,\r\
          \n        \"top_k\": 50,\r\n        \"truncate\": 3072,\r\n        \"max_new_tokens\"\
          : 1024,\r\n        \"stop\": [\"</s>\"]\r\n      }\r\n    },\r\n```\r\n\r\
          \nHere is a conversation:\r\n\r\n```\r\nPrompt:\r\nAs a restaurant owner,\
          \ write a professional email to the supplier to get these products every\
          \ week: \r\n\r\n- Wine (x10)\r\n- Eggs (x24)\r\n- Bread (x12)\r\n\r\nAnswer:\r\
          \nSupplier,\r\n\r\nI hope this email finds you well. I am writing to place\
          \ an order for our weekly supplies of wine, eggs and bread. The quantity\
          \ required is as follows: 10 bottles of wine, 24 cartons of eggs and 12\
          \ loaves of bread. Please let me know when the delivery can be made. Thank\
          \ you for your continued support.\r\n\r\nBest regards,\r\n[Your Name]\r\n\
          \r\nPrompt:\r\n rewrite it more happy\r\n\r\nAnswer:\r\n Weekly Supplies\
          \ Order - Wine, Eggs & Bread\r\n```\r\n"
        updatedAt: '2024-01-11T19:57:13.206Z'
      numEdits: 0
      reactions: []
    id: 65a04819e969415381d5da70
    type: comment
  author: chriamue
  content: "Hi, I try to run the Model with chat-ui on a candle backend.\r\n\r\nHow\
    \ should the chatPromptTemplate look like?\r\nI started with following, derived\
    \ from the Llama example and the description of the model card.\r\nBut it looks\
    \ like, when asking the second time, the context of last answer is not used correctly.\r\
    \n\r\nHere is my configuration.\r\n\r\n```json\r\n    {\r\n      \"name\": \"\
    microsoft/phi-2\",\r\n      \"description\": \"1.3b and 2.7b LLM with state of\
    \ the art performance for <10b models\",\r\n      \"websiteUrl\": \"https://huggingface.co/microsoft/phi-2\"\
    ,\r\n      \"userMessageToken\": \"\",\r\n      \"userMessageEndToken\": \" [/INST]\
    \ \",\r\n      \"assistantMessageToken\": \"\",\r\n      \"assistantMessageEndToken\"\
    : \" </s><s>[INST] \",\r\n      \"preprompt\": \" \",\r\n      \"chatPromptTemplate\"\
    \ : \"Instruct: {{#each messages}}{{#ifUser}}{{content}}\\n{{/ifUser}}{{#ifAssistant}}{{content}}\\\
    n{{/ifAssistant}}{{/each}}\\nOutput:\",\r\n      \"endpoints\": [{\r\n       \
    \     \"type\" : \"tgi\",\r\n            \"url\": \"http://chat-flame-backend:8080/model/phi-v2/\"\
    \r\n            }],\r\n      \"promptExamples\": [\r\n        {\r\n          \"\
    title\": \"Write an email from bullet list\",\r\n          \"prompt\": \"As a\
    \ restaurant owner, write a professional email to the supplier to get these products\
    \ every week: \\n\\n- Wine (x10)\\n- Eggs (x24)\\n- Bread (x12)\"\r\n        },\
    \ {\r\n          \"title\": \"Code a snake game\",\r\n          \"prompt\": \"\
    Code a basic snake game in python, give explanations for each step.\"\r\n    \
    \    }, {\r\n          \"title\": \"Assist in a task\",\r\n          \"prompt\"\
    : \"How do I make a delicious lemon cheesecake?\"\r\n        }\r\n      ],\r\n\
    \      \"parameters\": {\r\n        \"temperature\": 0.1,\r\n        \"top_p\"\
    : 0.95,\r\n        \"repetition_penalty\": 1.2,\r\n        \"top_k\": 50,\r\n\
    \        \"truncate\": 3072,\r\n        \"max_new_tokens\": 1024,\r\n        \"\
    stop\": [\"</s>\"]\r\n      }\r\n    },\r\n```\r\n\r\nHere is a conversation:\r\
    \n\r\n```\r\nPrompt:\r\nAs a restaurant owner, write a professional email to the\
    \ supplier to get these products every week: \r\n\r\n- Wine (x10)\r\n- Eggs (x24)\r\
    \n- Bread (x12)\r\n\r\nAnswer:\r\nSupplier,\r\n\r\nI hope this email finds you\
    \ well. I am writing to place an order for our weekly supplies of wine, eggs and\
    \ bread. The quantity required is as follows: 10 bottles of wine, 24 cartons of\
    \ eggs and 12 loaves of bread. Please let me know when the delivery can be made.\
    \ Thank you for your continued support.\r\n\r\nBest regards,\r\n[Your Name]\r\n\
    \r\nPrompt:\r\n rewrite it more happy\r\n\r\nAnswer:\r\n Weekly Supplies Order\
    \ - Wine, Eggs & Bread\r\n```\r\n"
  created_at: 2024-01-11 19:57:13+00:00
  edited: false
  hidden: false
  id: 65a04819e969415381d5da70
  type: comment
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: /avatars/1312f0b5418d001b2d9341a76630a20b.svg
      fullname: Christian
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: chriamue
      type: user
    createdAt: '2024-01-11T20:14:04.000Z'
    data:
      from: Chat-ui Model Config
      to: How should the chatPromptTemplate for Chat-ui Model Config look like?
    id: 65a04c0cbbbb7b8dd16d4a6a
    type: title-change
  author: chriamue
  created_at: 2024-01-11 20:14:04+00:00
  id: 65a04c0cbbbb7b8dd16d4a6a
  new_title: How should the chatPromptTemplate for Chat-ui Model Config look like?
  old_title: Chat-ui Model Config
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6252622d818a5dc29aba994a/OBmhWypYj_AYJ-Ey7UPom.jpeg?w=200&h=200&f=face
      fullname: James O'Leary
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jpohhhh
      type: user
    createdAt: '2024-01-13T04:30:45.000Z'
    data:
      edited: false
      editors:
      - jpohhhh
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6829807162284851
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6252622d818a5dc29aba994a/OBmhWypYj_AYJ-Ey7UPom.jpeg?w=200&h=200&f=face
          fullname: James O'Leary
          isHf: false
          isPro: false
          name: jpohhhh
          type: user
        html: '<p>It''s not trained for chat, see the README for information on a
          minimal template.</p>

          '
        raw: It's not trained for chat, see the README for information on a minimal
          template.
        updatedAt: '2024-01-13T04:30:45.745Z'
      numEdits: 0
      reactions: []
    id: 65a211f5e82b0b849095716d
    type: comment
  author: jpohhhh
  content: It's not trained for chat, see the README for information on a minimal
    template.
  created_at: 2024-01-13 04:30:45+00:00
  edited: false
  hidden: false
  id: 65a211f5e82b0b849095716d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-22T17:50:54.000Z'
    data:
      status: closed
    id: 65aeaafe0214b35f1bd9d222
    type: status-change
  author: gugarosa
  created_at: 2024-01-22 17:50:54+00:00
  id: 65aeaafe0214b35f1bd9d222
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 77
repo_id: microsoft/phi-2
repo_type: model
status: closed
target_branch: null
title: How should the chatPromptTemplate for Chat-ui Model Config look like?
