!!python/object:huggingface_hub.community.DiscussionWithDetails
author: luciodery
conflicting_files: null
created_at: 2024-01-12 06:42:39+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ca01a372e0791fbf015a524093351c56.svg
      fullname: Lucio Dery
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: luciodery
      type: user
    createdAt: '2024-01-12T06:42:39.000Z'
    data:
      edited: false
      editors:
      - luciodery
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8207780122756958
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ca01a372e0791fbf015a524093351c56.svg
          fullname: Lucio Dery
          isHf: false
          isPro: false
          name: luciodery
          type: user
        html: '<p>Hi, I am using transformers 4.28.0 (I need to keep this version
          of transformer for reproducibility).<br>It seems that the most recent code
          updates broke my code :(</p>

          <p>Leading to tensor name mismatches as shown in the snapshot attached.<br>Could
          you help me figure out how to fix this ?<br><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/656cf67b665d15428ab1c642/f-1StZfT5scvbqzQjAtkx.png"><img
          alt="Screen Shot 2024-01-12 at 1.42.19 AM.png" src="https://cdn-uploads.huggingface.co/production/uploads/656cf67b665d15428ab1c642/f-1StZfT5scvbqzQjAtkx.png"></a></p>

          '
        raw: "Hi, I am using transformers 4.28.0 (I need to keep this version of transformer\
          \ for reproducibility).\r\nIt seems that the most recent code updates broke\
          \ my code :(\r\n\r\nLeading to tensor name mismatches as shown in the snapshot\
          \ attached. \r\nCould you help me figure out how to fix this ? \r\n![Screen\
          \ Shot 2024-01-12 at 1.42.19 AM.png](https://cdn-uploads.huggingface.co/production/uploads/656cf67b665d15428ab1c642/f-1StZfT5scvbqzQjAtkx.png)\r\
          \n"
        updatedAt: '2024-01-12T06:42:39.779Z'
      numEdits: 0
      reactions: []
    id: 65a0df5f9185dcca306f1582
    type: comment
  author: luciodery
  content: "Hi, I am using transformers 4.28.0 (I need to keep this version of transformer\
    \ for reproducibility).\r\nIt seems that the most recent code updates broke my\
    \ code :(\r\n\r\nLeading to tensor name mismatches as shown in the snapshot attached.\
    \ \r\nCould you help me figure out how to fix this ? \r\n![Screen Shot 2024-01-12\
    \ at 1.42.19 AM.png](https://cdn-uploads.huggingface.co/production/uploads/656cf67b665d15428ab1c642/f-1StZfT5scvbqzQjAtkx.png)\r\
    \n"
  created_at: 2024-01-12 06:42:39+00:00
  edited: false
  hidden: false
  id: 65a0df5f9185dcca306f1582
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c892d351437f680596f0ccfa63af2ebe.svg
      fullname: KiYoon Yoo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kiyoonyoo
      type: user
    createdAt: '2024-01-12T09:38:15.000Z'
    data:
      edited: false
      editors:
      - kiyoonyoo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9422080516815186
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c892d351437f680596f0ccfa63af2ebe.svg
          fullname: KiYoon Yoo
          isHf: false
          isPro: false
          name: kiyoonyoo
          type: user
        html: '<p>Hi,<br>I am having a similar issue.<br>I haven''t figured out a
          solution yet, but it seems like this is due to an update 9 hours ago.<br>The
          update is this commit (<code><a href="/microsoft/phi-2/commit/cb2f4533604d8b67de604e7df03bfe6f3ca22869">cb2f4533604d8b67de604e7df03bfe6f3ca22869</a></code>).</p>

          '
        raw: 'Hi,

          I am having a similar issue.

          I haven''t figured out a solution yet, but it seems like this is due to
          an update 9 hours ago.

          The update is this commit (`cb2f4533604d8b67de604e7df03bfe6f3ca22869`).'
        updatedAt: '2024-01-12T09:38:15.400Z'
      numEdits: 0
      reactions: []
    id: 65a10887e0b49a84d2491063
    type: comment
  author: kiyoonyoo
  content: 'Hi,

    I am having a similar issue.

    I haven''t figured out a solution yet, but it seems like this is due to an update
    9 hours ago.

    The update is this commit (`cb2f4533604d8b67de604e7df03bfe6f3ca22869`).'
  created_at: 2024-01-12 09:38:15+00:00
  edited: false
  hidden: false
  id: 65a10887e0b49a84d2491063
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c892d351437f680596f0ccfa63af2ebe.svg
      fullname: KiYoon Yoo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kiyoonyoo
      type: user
    createdAt: '2024-01-12T10:01:37.000Z'
    data:
      edited: true
      editors:
      - kiyoonyoo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9697363376617432
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c892d351437f680596f0ccfa63af2ebe.svg
          fullname: KiYoon Yoo
          isHf: false
          isPro: false
          name: kiyoonyoo
          type: user
        html: "<p>My issue was fixed by setting <code>trust_remote_code=True</code>.<br>FYI,\
          \ mine was probably unrelated to the update. I had not set the argument\
          \ that I previously used to. \n </p>\n"
        raw: "My issue was fixed by setting `trust_remote_code=True`.\nFYI, mine was\
          \ probably unrelated to the update. I had not set the argument that I previously\
          \ used to. \n "
        updatedAt: '2024-01-12T10:08:55.818Z'
      numEdits: 1
      reactions: []
    id: 65a10e019185dcca3080b651
    type: comment
  author: kiyoonyoo
  content: "My issue was fixed by setting `trust_remote_code=True`.\nFYI, mine was\
    \ probably unrelated to the update. I had not set the argument that I previously\
    \ used to. \n "
  created_at: 2024-01-12 10:01:37+00:00
  edited: true
  hidden: false
  id: 65a10e019185dcca3080b651
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-12T13:08:04.000Z'
    data:
      edited: false
      editors:
      - gugarosa
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.566476583480835
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
          fullname: Gustavo de Rosa
          isHf: false
          isPro: false
          name: gugarosa
          type: user
        html: "<p>Hello <span data-props=\"{&quot;user&quot;:&quot;kiyoonyoo&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/kiyoonyoo\"\
          >@<span class=\"underline\">kiyoonyoo</span></a></span>\n\n\t</span></span>\
          \ and <span data-props=\"{&quot;user&quot;:&quot;luciodery&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/luciodery\">@<span class=\"\
          underline\">luciodery</span></a></span>\n\n\t</span></span>!</p>\n<p>Please\
          \ always use <code>trust_remote_code=True</code> if below <code>transformers==4.37.0</code>.</p>\n\
          <p>Regards,<br>Gustavo.</p>\n"
        raw: 'Hello @kiyoonyoo and @luciodery!


          Please always use `trust_remote_code=True` if below `transformers==4.37.0`.


          Regards,

          Gustavo.'
        updatedAt: '2024-01-12T13:08:04.326Z'
      numEdits: 0
      reactions: []
      relatedEventId: 65a139b464520347aaa37591
    id: 65a139b464520347aaa3758c
    type: comment
  author: gugarosa
  content: 'Hello @kiyoonyoo and @luciodery!


    Please always use `trust_remote_code=True` if below `transformers==4.37.0`.


    Regards,

    Gustavo.'
  created_at: 2024-01-12 13:08:04+00:00
  edited: false
  hidden: false
  id: 65a139b464520347aaa3758c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-12T13:08:04.000Z'
    data:
      status: closed
    id: 65a139b464520347aaa37591
    type: status-change
  author: gugarosa
  created_at: 2024-01-12 13:08:04+00:00
  id: 65a139b464520347aaa37591
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/ca01a372e0791fbf015a524093351c56.svg
      fullname: Lucio Dery
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: luciodery
      type: user
    createdAt: '2024-01-12T22:17:23.000Z'
    data:
      status: open
    id: 65a1ba7381a46e7dd9a79336
    type: status-change
  author: luciodery
  created_at: 2024-01-12 22:17:23+00:00
  id: 65a1ba7381a46e7dd9a79336
  new_status: open
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ca01a372e0791fbf015a524093351c56.svg
      fullname: Lucio Dery
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: luciodery
      type: user
    createdAt: '2024-01-12T22:18:13.000Z'
    data:
      edited: false
      editors:
      - luciodery
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9390049576759338
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ca01a372e0791fbf015a524093351c56.svg
          fullname: Lucio Dery
          isHf: false
          isPro: false
          name: luciodery
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;gugarosa&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/gugarosa\"\
          >@<span class=\"underline\">gugarosa</span></a></span>\n\n\t</span></span>\
          \ ,<br>This was not the issue. I already had trust_remote_code.<br>Also,\
          \ I was not using the automodel -- I am directly using the phiForCasualLLM\
          \ import.<br>Please advise. Thanks</p>\n"
        raw: 'Hi @gugarosa ,

          This was not the issue. I already had trust_remote_code.

          Also, I was not using the automodel -- I am directly using the phiForCasualLLM
          import.

          Please advise. Thanks'
        updatedAt: '2024-01-12T22:18:13.584Z'
      numEdits: 0
      reactions: []
    id: 65a1baa5482c457f35085ba4
    type: comment
  author: luciodery
  content: 'Hi @gugarosa ,

    This was not the issue. I already had trust_remote_code.

    Also, I was not using the automodel -- I am directly using the phiForCasualLLM
    import.

    Please advise. Thanks'
  created_at: 2024-01-12 22:18:13+00:00
  edited: false
  hidden: false
  id: 65a1baa5482c457f35085ba4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
      fullname: Tadas Pyragius
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: TP6174
      type: user
    createdAt: '2024-01-12T22:49:07.000Z'
    data:
      edited: false
      editors:
      - TP6174
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5719528794288635
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
          fullname: Tadas Pyragius
          isHf: false
          isPro: false
          name: TP6174
          type: user
        html: "<blockquote>\n<p>Hello <span data-props=\"{&quot;user&quot;:&quot;kiyoonyoo&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/kiyoonyoo\"\
          >@<span class=\"underline\">kiyoonyoo</span></a></span>\n\n\t</span></span>\
          \ and <span data-props=\"{&quot;user&quot;:&quot;luciodery&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/luciodery\">@<span class=\"\
          underline\">luciodery</span></a></span>\n\n\t</span></span>!</p>\n<p>Please\
          \ always use <code>trust_remote_code=True</code> if below <code>transformers==4.37.0</code>.</p>\n\
          <p>Regards,<br>Gustavo.</p>\n</blockquote>\n<p>Hi gugarosa, </p>\n<p>the\
          \ setup you described does not run with the most recent update of phi2.\
          \ I've tried to get it to run with transformer versions &lt; 4.37.0 to no\
          \ avail. I've not encountered any issues at all before this update. Here's\
          \ the basic setup and error message:</p>\n<p>from transformers import AutoModelForCausalLM,\
          \ AutoTokenizer</p>\n<h1 id=\"initialize-your-model-and-tokenizer\">Initialize\
          \ your model and tokenizer</h1>\n<p>model_name = \"microsoft/phi-2\"<br>tokenizer\
          \ = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)<br>model\
          \ = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype=\"auto\"\
          , device_map=\"cuda\", trust_remote_code=True)</p>\n<hr>\n<p>ImportError\
          \                               Traceback (most recent call last)</p>\n\
          <p> in &lt;cell line: 4&gt;()<br>      2 model_name = \"microsoft/phi-2\"\
          <br>      3 tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)<br>----&gt;\
          \ 4 model = AutoModelForCausalLM.from_pretrained(model_name,<br>      5\
          \                                              torch_dtype=\"auto\",<br>\
          \      6                                              device_map=\"cuda\"\
          ,</p>\n<p>11 frames</p>\n<p>/usr/local/lib/python3.10/dist-packages/transformers/modeling_utils.py\
          \ in <br>     52 )<br>     53 from .safetensors_conversion import auto_conversion<br>---&gt;\
          \ 54 from .utils import (<br>     55     ADAPTER_SAFE_WEIGHTS_NAME,<br>\
          \     56     ADAPTER_WEIGHTS_NAME,</p>\n<p>ImportError: cannot import name\
          \ 'is_torch_sdpa_available' from 'transformers.utils' (/usr/local/lib/python3.10/dist-packages/transformers/utils/<strong>init</strong>.py)</p>\n"
        raw: "> Hello @kiyoonyoo and @luciodery!\n> \n> Please always use `trust_remote_code=True`\
          \ if below `transformers==4.37.0`.\n> \n> Regards,\n> Gustavo.\n\nHi gugarosa,\
          \ \n\nthe setup you described does not run with the most recent update of\
          \ phi2. I've tried to get it to run with transformer versions < 4.37.0 to\
          \ no avail. I've not encountered any issues at all before this update. Here's\
          \ the basic setup and error message:\n\nfrom transformers import AutoModelForCausalLM,\
          \ AutoTokenizer\n\n# Initialize your model and tokenizer\nmodel_name = \"\
          microsoft/phi-2\"\ntokenizer = AutoTokenizer.from_pretrained(model_name,\
          \ trust_remote_code=True)\nmodel = AutoModelForCausalLM.from_pretrained(model_name,\
          \ torch_dtype=\"auto\", device_map=\"cuda\", trust_remote_code=True)\n\n\
          \n---------------------------------------------------------------------------\n\
          \nImportError                               Traceback (most recent call\
          \ last)\n\n<ipython-input-14-22b46c1d2246> in <cell line: 4>()\n      2\
          \ model_name = \"microsoft/phi-2\"\n      3 tokenizer = AutoTokenizer.from_pretrained(model_name,\
          \ trust_remote_code=True)\n----> 4 model = AutoModelForCausalLM.from_pretrained(model_name,\n\
          \      5                                              torch_dtype=\"auto\"\
          ,\n      6                                              device_map=\"cuda\"\
          ,\n\n11 frames\n\n/usr/local/lib/python3.10/dist-packages/transformers/modeling_utils.py\
          \ in <module>\n     52 )\n     53 from .safetensors_conversion import auto_conversion\n\
          ---> 54 from .utils import (\n     55     ADAPTER_SAFE_WEIGHTS_NAME,\n \
          \    56     ADAPTER_WEIGHTS_NAME,\n\nImportError: cannot import name 'is_torch_sdpa_available'\
          \ from 'transformers.utils' (/usr/local/lib/python3.10/dist-packages/transformers/utils/__init__.py)\n"
        updatedAt: '2024-01-12T22:49:07.639Z'
      numEdits: 0
      reactions: []
    id: 65a1c1e3d0e350dbc9315919
    type: comment
  author: TP6174
  content: "> Hello @kiyoonyoo and @luciodery!\n> \n> Please always use `trust_remote_code=True`\
    \ if below `transformers==4.37.0`.\n> \n> Regards,\n> Gustavo.\n\nHi gugarosa,\
    \ \n\nthe setup you described does not run with the most recent update of phi2.\
    \ I've tried to get it to run with transformer versions < 4.37.0 to no avail.\
    \ I've not encountered any issues at all before this update. Here's the basic\
    \ setup and error message:\n\nfrom transformers import AutoModelForCausalLM, AutoTokenizer\n\
    \n# Initialize your model and tokenizer\nmodel_name = \"microsoft/phi-2\"\ntokenizer\
    \ = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)\nmodel =\
    \ AutoModelForCausalLM.from_pretrained(model_name, torch_dtype=\"auto\", device_map=\"\
    cuda\", trust_remote_code=True)\n\n\n---------------------------------------------------------------------------\n\
    \nImportError                               Traceback (most recent call last)\n\
    \n<ipython-input-14-22b46c1d2246> in <cell line: 4>()\n      2 model_name = \"\
    microsoft/phi-2\"\n      3 tokenizer = AutoTokenizer.from_pretrained(model_name,\
    \ trust_remote_code=True)\n----> 4 model = AutoModelForCausalLM.from_pretrained(model_name,\n\
    \      5                                              torch_dtype=\"auto\",\n\
    \      6                                              device_map=\"cuda\",\n\n\
    11 frames\n\n/usr/local/lib/python3.10/dist-packages/transformers/modeling_utils.py\
    \ in <module>\n     52 )\n     53 from .safetensors_conversion import auto_conversion\n\
    ---> 54 from .utils import (\n     55     ADAPTER_SAFE_WEIGHTS_NAME,\n     56\
    \     ADAPTER_WEIGHTS_NAME,\n\nImportError: cannot import name 'is_torch_sdpa_available'\
    \ from 'transformers.utils' (/usr/local/lib/python3.10/dist-packages/transformers/utils/__init__.py)\n"
  created_at: 2024-01-12 22:49:07+00:00
  edited: false
  hidden: false
  id: 65a1c1e3d0e350dbc9315919
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c9b06fea1e2c35258b7eb4d27c482d1b.svg
      fullname: Laur Lazar
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: llaz
      type: user
    createdAt: '2024-01-13T13:30:56.000Z'
    data:
      edited: false
      editors:
      - llaz
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.924767255783081
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c9b06fea1e2c35258b7eb4d27c482d1b.svg
          fullname: Laur Lazar
          isHf: false
          isPro: false
          name: llaz
          type: user
        html: '<p>maybe !pip install transformers==4.36.1 </p>

          '
        raw: 'maybe !pip install transformers==4.36.1 '
        updatedAt: '2024-01-13T13:30:56.312Z'
      numEdits: 0
      reactions: []
    id: 65a290903522df7a277fc947
    type: comment
  author: llaz
  content: 'maybe !pip install transformers==4.36.1 '
  created_at: 2024-01-13 13:30:56+00:00
  edited: false
  hidden: false
  id: 65a290903522df7a277fc947
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4ee4ca6a4c9911980a8250bcf30f0281.svg
      fullname: Christopher McMaster
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: true
      name: cmcmaster
      type: user
    createdAt: '2024-01-14T08:00:57.000Z'
    data:
      edited: true
      editors:
      - cmcmaster
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.635507345199585
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4ee4ca6a4c9911980a8250bcf30f0281.svg
          fullname: Christopher McMaster
          isHf: false
          isPro: true
          name: cmcmaster
          type: user
        html: "<p>How do I load a finetuned phi-2 model from before this update? <span\
          \ data-props=\"{&quot;user&quot;:&quot;gugarosa&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/gugarosa\">@<span class=\"\
          underline\">gugarosa</span></a></span>\n\n\t</span></span> </p>\n<p>Or better\
          \ yet, convert it so there\u2019s no friction when other people try to load\
          \ it? Just rename the layers based on this commit?</p>\n"
        raw: "How do I load a finetuned phi-2 model from before this update? @gugarosa\
          \ \n\nOr better yet, convert it so there\u2019s no friction when other people\
          \ try to load it? Just rename the layers based on this commit?"
        updatedAt: '2024-01-14T08:02:22.208Z'
      numEdits: 1
      reactions: []
    id: 65a394b93e3a00a9c163fb7c
    type: comment
  author: cmcmaster
  content: "How do I load a finetuned phi-2 model from before this update? @gugarosa\
    \ \n\nOr better yet, convert it so there\u2019s no friction when other people\
    \ try to load it? Just rename the layers based on this commit?"
  created_at: 2024-01-14 08:00:57+00:00
  edited: true
  hidden: false
  id: 65a394b93e3a00a9c163fb7c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
      fullname: Tadas Pyragius
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: TP6174
      type: user
    createdAt: '2024-01-14T12:07:57.000Z'
    data:
      edited: true
      editors:
      - TP6174
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7004343867301941
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
          fullname: Tadas Pyragius
          isHf: false
          isPro: false
          name: TP6174
          type: user
        html: "<blockquote>\n<p>Hello <span data-props=\"{&quot;user&quot;:&quot;kiyoonyoo&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/kiyoonyoo\"\
          >@<span class=\"underline\">kiyoonyoo</span></a></span>\n\n\t</span></span>\
          \ and <span data-props=\"{&quot;user&quot;:&quot;luciodery&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/luciodery\">@<span class=\"\
          underline\">luciodery</span></a></span>\n\n\t</span></span>!</p>\n<p>Please\
          \ always use <code>trust_remote_code=True</code> if below <code>transformers==4.37.0</code>.</p>\n\
          <p>Regards,<br>Gustavo.</p>\n</blockquote>\n<p>ok, so I got a workaround\
          \ found in a thread here [1] - instead of \"pip install transformers==\"\
          \ git clone from source of hugging face transformer repo:</p>\n<p>!pip install\
          \ git+<a rel=\"nofollow\" href=\"https://github.com/huggingface/transformers\"\
          >https://github.com/huggingface/transformers</a></p>\n<p>Reference:<br>[1]\
          \ <a href=\"https://huggingface.co/DiscoResearch/mixtral-7b-8expert/discussions/9\"\
          >https://huggingface.co/DiscoResearch/mixtral-7b-8expert/discussions/9</a></p>\n"
        raw: "> Hello @kiyoonyoo and @luciodery!\n> \n> Please always use `trust_remote_code=True`\
          \ if below `transformers==4.37.0`.\n> \n> Regards,\n> Gustavo.\n\nok, so\
          \ I got a workaround found in a thread here [1] - instead of \"pip install\
          \ transformers==<version_number>\" git clone from source of hugging face\
          \ transformer repo:\n\n!pip install git+https://github.com/huggingface/transformers\n\
          \nReference:\n[1] https://huggingface.co/DiscoResearch/mixtral-7b-8expert/discussions/9"
        updatedAt: '2024-01-14T12:08:29.840Z'
      numEdits: 1
      reactions: []
    id: 65a3ce9d680cb2eb94621d9b
    type: comment
  author: TP6174
  content: "> Hello @kiyoonyoo and @luciodery!\n> \n> Please always use `trust_remote_code=True`\
    \ if below `transformers==4.37.0`.\n> \n> Regards,\n> Gustavo.\n\nok, so I got\
    \ a workaround found in a thread here [1] - instead of \"pip install transformers==<version_number>\"\
    \ git clone from source of hugging face transformer repo:\n\n!pip install git+https://github.com/huggingface/transformers\n\
    \nReference:\n[1] https://huggingface.co/DiscoResearch/mixtral-7b-8expert/discussions/9"
  created_at: 2024-01-14 12:07:57+00:00
  edited: true
  hidden: false
  id: 65a3ce9d680cb2eb94621d9b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/DzEcl80Y1CRQ3-mfYzJfW.jpeg?w=200&h=200&f=face
      fullname: Tigran Zhampeissov
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Tigranchick
      type: user
    createdAt: '2024-01-14T12:58:24.000Z'
    data:
      edited: false
      editors:
      - Tigranchick
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9666962027549744
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/DzEcl80Y1CRQ3-mfYzJfW.jpeg?w=200&h=200&f=face
          fullname: Tigran Zhampeissov
          isHf: false
          isPro: false
          name: Tigranchick
          type: user
        html: '<p>is it workaround with revision use? </p>

          '
        raw: 'is it workaround with revision use? '
        updatedAt: '2024-01-14T12:58:24.772Z'
      numEdits: 0
      reactions: []
    id: 65a3da705772dbcae3300f59
    type: comment
  author: Tigranchick
  content: 'is it workaround with revision use? '
  created_at: 2024-01-14 12:58:24+00:00
  edited: false
  hidden: false
  id: 65a3da705772dbcae3300f59
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
      fullname: Tadas Pyragius
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: TP6174
      type: user
    createdAt: '2024-01-14T17:09:42.000Z'
    data:
      edited: false
      editors:
      - TP6174
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9547516107559204
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/766e627499bbe29b7984391d144fb651.svg
          fullname: Tadas Pyragius
          isHf: false
          isPro: false
          name: TP6174
          type: user
        html: '<blockquote>

          <p>is it workaround with revision use?</p>

          </blockquote>

          <p>yes.</p>

          '
        raw: '> is it workaround with revision use?


          yes.'
        updatedAt: '2024-01-14T17:09:42.641Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F91D"
        users:
        - Tigranchick
    id: 65a41556b4f188a4db97fcc1
    type: comment
  author: TP6174
  content: '> is it workaround with revision use?


    yes.'
  created_at: 2024-01-14 17:09:42+00:00
  edited: false
  hidden: false
  id: 65a41556b4f188a4db97fcc1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/DzEcl80Y1CRQ3-mfYzJfW.jpeg?w=200&h=200&f=face
      fullname: Tigran Zhampeissov
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Tigranchick
      type: user
    createdAt: '2024-01-15T21:37:49.000Z'
    data:
      edited: false
      editors:
      - Tigranchick
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.862975001335144
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/noauth/DzEcl80Y1CRQ3-mfYzJfW.jpeg?w=200&h=200&f=face
          fullname: Tigran Zhampeissov
          isHf: false
          isPro: false
          name: Tigranchick
          type: user
        html: '<p>just reminder if you try workaround with revision also set code_revision</p>

          '
        raw: just reminder if you try workaround with revision also set code_revision
        updatedAt: '2024-01-15T21:37:49.640Z'
      numEdits: 0
      reactions: []
    id: 65a5a5ad13557dd7ce0e9940
    type: comment
  author: Tigranchick
  content: just reminder if you try workaround with revision also set code_revision
  created_at: 2024-01-15 21:37:49+00:00
  edited: false
  hidden: false
  id: 65a5a5ad13557dd7ce0e9940
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-16T17:31:25.000Z'
    data:
      edited: false
      editors:
      - gugarosa
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7729806303977966
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
          fullname: Gustavo de Rosa
          isHf: false
          isPro: false
          name: gugarosa
          type: user
        html: "<blockquote>\n<p>How do I load a finetuned phi-2 model from before\
          \ this update? <span data-props=\"{&quot;user&quot;:&quot;gugarosa&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/gugarosa\"\
          >@<span class=\"underline\">gugarosa</span></a></span>\n\n\t</span></span>\
          \ </p>\n<p>Or better yet, convert it so there\u2019s no friction when other\
          \ people try to load it? Just rename the layers based on this commit?</p>\n\
          </blockquote>\n<p>This conversion script should work out for your case:\
          \ <a rel=\"nofollow\" href=\"https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py\"\
          >https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py</a></p>\n"
        raw: "> How do I load a finetuned phi-2 model from before this update? @gugarosa\
          \ \n> \n> Or better yet, convert it so there\u2019s no friction when other\
          \ people try to load it? Just rename the layers based on this commit?\n\n\
          This conversion script should work out for your case: https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py"
        updatedAt: '2024-01-16T17:31:25.857Z'
      numEdits: 0
      reactions: []
    id: 65a6bd6de504d9738d1ba561
    type: comment
  author: gugarosa
  content: "> How do I load a finetuned phi-2 model from before this update? @gugarosa\
    \ \n> \n> Or better yet, convert it so there\u2019s no friction when other people\
    \ try to load it? Just rename the layers based on this commit?\n\nThis conversion\
    \ script should work out for your case: https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py"
  created_at: 2024-01-16 17:31:25+00:00
  edited: false
  hidden: false
  id: 65a6bd6de504d9738d1ba561
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-16T17:32:00.000Z'
    data:
      edited: false
      editors:
      - gugarosa
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9060665369033813
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
          fullname: Gustavo de Rosa
          isHf: false
          isPro: false
          name: gugarosa
          type: user
        html: '<p>Besides, I have updated the README.md to clear indicate the two
          alternatives we have for loading Phi-2 (until 4.37.0 is officially released).</p>

          '
        raw: Besides, I have updated the README.md to clear indicate the two alternatives
          we have for loading Phi-2 (until 4.37.0 is officially released).
        updatedAt: '2024-01-16T17:32:00.632Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - cmcmaster
    id: 65a6bd903d3c839408ddcb91
    type: comment
  author: gugarosa
  content: Besides, I have updated the README.md to clear indicate the two alternatives
    we have for loading Phi-2 (until 4.37.0 is officially released).
  created_at: 2024-01-16 17:32:00+00:00
  edited: false
  hidden: false
  id: 65a6bd903d3c839408ddcb91
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4ee4ca6a4c9911980a8250bcf30f0281.svg
      fullname: Christopher McMaster
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: true
      name: cmcmaster
      type: user
    createdAt: '2024-01-16T20:19:55.000Z'
    data:
      edited: false
      editors:
      - cmcmaster
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7526589632034302
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4ee4ca6a4c9911980a8250bcf30f0281.svg
          fullname: Christopher McMaster
          isHf: false
          isPro: true
          name: cmcmaster
          type: user
        html: "<blockquote>\n<blockquote>\n<p>How do I load a finetuned phi-2 model\
          \ from before this update? <span data-props=\"{&quot;user&quot;:&quot;gugarosa&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/gugarosa\"\
          >@<span class=\"underline\">gugarosa</span></a></span>\n\n\t</span></span>\
          \ </p>\n<p>Or better yet, convert it so there\u2019s no friction when other\
          \ people try to load it? Just rename the layers based on this commit?</p>\n\
          </blockquote>\n<p>This conversion script should work out for your case:\
          \ <a rel=\"nofollow\" href=\"https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py\"\
          >https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py</a></p>\n\
          </blockquote>\n<p>Legend. Thank you!</p>\n"
        raw: "> > How do I load a finetuned phi-2 model from before this update? @gugarosa\
          \ \n> > \n> > Or better yet, convert it so there\u2019s no friction when\
          \ other people try to load it? Just rename the layers based on this commit?\n\
          > \n> This conversion script should work out for your case: https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py\n\
          \nLegend. Thank you!"
        updatedAt: '2024-01-16T20:19:55.124Z'
      numEdits: 0
      reactions: []
    id: 65a6e4eb293926cc0766e26b
    type: comment
  author: cmcmaster
  content: "> > How do I load a finetuned phi-2 model from before this update? @gugarosa\
    \ \n> > \n> > Or better yet, convert it so there\u2019s no friction when other\
    \ people try to load it? Just rename the layers based on this commit?\n> \n> This\
    \ conversion script should work out for your case: https://github.com/huggingface/transformers/blob/main/src/transformers/models/phi/convert_phi_weights_to_hf.py\n\
    \nLegend. Thank you!"
  created_at: 2024-01-16 20:19:55+00:00
  edited: false
  hidden: false
  id: 65a6e4eb293926cc0766e26b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1666203761402-6157454831624da88210e627.jpeg?w=200&h=200&f=face
      fullname: Gustavo de Rosa
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: gugarosa
      type: user
    createdAt: '2024-01-19T13:53:43.000Z'
    data:
      status: closed
    id: 65aa7ee7abf6d1ccb761c228
    type: status-change
  author: gugarosa
  created_at: 2024-01-19 13:53:43+00:00
  id: 65aa7ee7abf6d1ccb761c228
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 79
repo_id: microsoft/phi-2
repo_type: model
status: closed
target_branch: null
title: Can't load phi-2 model anymore after recent code updates
