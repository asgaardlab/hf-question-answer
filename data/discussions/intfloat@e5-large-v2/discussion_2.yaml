!!python/object:huggingface_hub.community.DiscussionWithDetails
author: moooji
conflicting_files: null
created_at: 2023-05-26 07:26:24+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9c5afb03a9261570598f44b5aa5bc2a6.svg
      fullname: "Steffen Str\xE4tz"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: moooji
      type: user
    createdAt: '2023-05-26T08:26:24.000Z'
    data:
      edited: false
      editors:
      - moooji
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9c5afb03a9261570598f44b5aa5bc2a6.svg
          fullname: "Steffen Str\xE4tz"
          isHf: false
          isPro: false
          name: moooji
          type: user
        html: '<p>Hi,</p>

          <p>we would like to use the model for document embedding and retrieval.
          We noticed that the model returns 3 different vectors though (all 1024 dimensions).
          What is the difference between them and which of those should we use for
          retrieval with cosine similarity? Or do we have to compute the feature vector
          in another step out of those 3?</p>

          '
        raw: "Hi,\r\n\r\nwe would like to use the model for document embedding and\
          \ retrieval. We noticed that the model returns 3 different vectors though\
          \ (all 1024 dimensions). What is the difference between them and which of\
          \ those should we use for retrieval with cosine similarity? Or do we have\
          \ to compute the feature vector in another step out of those 3?"
        updatedAt: '2023-05-26T08:26:24.106Z'
      numEdits: 0
      reactions: []
    id: 64706d303601bb7b0664fd9b
    type: comment
  author: moooji
  content: "Hi,\r\n\r\nwe would like to use the model for document embedding and retrieval.\
    \ We noticed that the model returns 3 different vectors though (all 1024 dimensions).\
    \ What is the difference between them and which of those should we use for retrieval\
    \ with cosine similarity? Or do we have to compute the feature vector in another\
    \ step out of those 3?"
  created_at: 2023-05-26 07:26:24+00:00
  edited: false
  hidden: false
  id: 64706d303601bb7b0664fd9b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: /avatars/9c5afb03a9261570598f44b5aa5bc2a6.svg
      fullname: "Steffen Str\xE4tz"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: moooji
      type: user
    createdAt: '2023-05-26T08:27:11.000Z'
    data:
      from: Which vector for embeddings?
      to: Which embedding vector to use?
    id: 64706d5f806c7d87fa128045
    type: title-change
  author: moooji
  created_at: 2023-05-26 07:27:11+00:00
  id: 64706d5f806c7d87fa128045
  new_title: Which embedding vector to use?
  old_title: Which vector for embeddings?
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
      fullname: Liang Wang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: intfloat
      type: user
    createdAt: '2023-05-26T08:42:46.000Z'
    data:
      edited: true
      editors:
      - intfloat
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
          fullname: Liang Wang
          isHf: false
          isPro: false
          name: intfloat
          type: user
        html: '<p>Not sure about your problem, the code at <a href="https://huggingface.co/intfloat/e5-large-v2#usage">https://huggingface.co/intfloat/e5-large-v2#usage</a>
          only produces one vector for each input text.</p>

          <p>Can you provide more details on how you compute the embeddings?</p>

          '
        raw: 'Not sure about your problem, the code at https://huggingface.co/intfloat/e5-large-v2#usage
          only produces one vector for each input text.


          Can you provide more details on how you compute the embeddings?'
        updatedAt: '2023-05-26T08:43:33.163Z'
      numEdits: 1
      reactions: []
    id: 647071069fe78d69a8ac701e
    type: comment
  author: intfloat
  content: 'Not sure about your problem, the code at https://huggingface.co/intfloat/e5-large-v2#usage
    only produces one vector for each input text.


    Can you provide more details on how you compute the embeddings?'
  created_at: 2023-05-26 07:42:46+00:00
  edited: true
  hidden: false
  id: 647071069fe78d69a8ac701e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9c5afb03a9261570598f44b5aa5bc2a6.svg
      fullname: "Steffen Str\xE4tz"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: moooji
      type: user
    createdAt: '2023-05-26T09:15:12.000Z'
    data:
      edited: true
      editors:
      - moooji
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9c5afb03a9261570598f44b5aa5bc2a6.svg
          fullname: "Steffen Str\xE4tz"
          isHf: false
          isPro: false
          name: moooji
          type: user
        html: "<p>Thank you for your quick reply! What I mean is that when we deploy\
          \ the model to \"Inference Endpoints\" or use the \"Hosted inference API\"\
          \ on the hugging face page, it will output multiple vectors.</p>\n<p><a\
          \ rel=\"nofollow\" href=\"https://cdn-uploads.huggingface.co/production/uploads/6321b681b97c618f9a5c7f06/9o5JvoiHWzc5ar-D7WfQZ.png\"\
          ><img alt=\"Screenshot 2023-05-26 at 11.13.09.png\" src=\"https://cdn-uploads.huggingface.co/production/uploads/6321b681b97c618f9a5c7f06/9o5JvoiHWzc5ar-D7WfQZ.png\"\
          ></a></p>\n<p>So it's a bit unclear to us what the output of the \"Hosted\
          \ Inference API\" represents. For example for this input \"passage: E5 is\
          \ awesome\", it will return 8 vectors like this:</p>\n<pre><code>[\n  [\n\
          \    [1024], \n    [1024], \n    [1024],\n    [1024],\n    [1024],\n   \
          \ [1024],\n    [1024],\n    [1024]\n  ]\n]\n</code></pre>\n<p>Is this maybe\
          \ one vector per token?<br>Do I understand it correctly that we would have\
          \ to average those to get one feature vector?</p>\n"
        raw: "Thank you for your quick reply! What I mean is that when we deploy the\
          \ model to \"Inference Endpoints\" or use the \"Hosted inference API\" on\
          \ the hugging face page, it will output multiple vectors.\n\n![Screenshot\
          \ 2023-05-26 at 11.13.09.png](https://cdn-uploads.huggingface.co/production/uploads/6321b681b97c618f9a5c7f06/9o5JvoiHWzc5ar-D7WfQZ.png)\n\
          \nSo it's a bit unclear to us what the output of the \"Hosted Inference\
          \ API\" represents. For example for this input \"passage: E5 is awesome\"\
          , it will return 8 vectors like this:\n\n```\n[\n  [\n    [1024], \n   \
          \ [1024], \n    [1024],\n    [1024],\n    [1024],\n    [1024],\n    [1024],\n\
          \    [1024]\n  ]\n]\n```\n\nIs this maybe one vector per token?\nDo I understand\
          \ it correctly that we would have to average those to get one feature vector?"
        updatedAt: '2023-05-26T09:25:12.485Z'
      numEdits: 6
      reactions: []
    id: 647078a01f0e7ee7fb177a5f
    type: comment
  author: moooji
  content: "Thank you for your quick reply! What I mean is that when we deploy the\
    \ model to \"Inference Endpoints\" or use the \"Hosted inference API\" on the\
    \ hugging face page, it will output multiple vectors.\n\n![Screenshot 2023-05-26\
    \ at 11.13.09.png](https://cdn-uploads.huggingface.co/production/uploads/6321b681b97c618f9a5c7f06/9o5JvoiHWzc5ar-D7WfQZ.png)\n\
    \nSo it's a bit unclear to us what the output of the \"Hosted Inference API\"\
    \ represents. For example for this input \"passage: E5 is awesome\", it will return\
    \ 8 vectors like this:\n\n```\n[\n  [\n    [1024], \n    [1024], \n    [1024],\n\
    \    [1024],\n    [1024],\n    [1024],\n    [1024],\n    [1024]\n  ]\n]\n```\n\
    \nIs this maybe one vector per token?\nDo I understand it correctly that we would\
    \ have to average those to get one feature vector?"
  created_at: 2023-05-26 08:15:12+00:00
  edited: true
  hidden: false
  id: 647078a01f0e7ee7fb177a5f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
      fullname: Liang Wang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: intfloat
      type: user
    createdAt: '2023-05-26T09:42:05.000Z'
    data:
      edited: true
      editors:
      - intfloat
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
          fullname: Liang Wang
          isHf: false
          isPro: false
          name: intfloat
          type: user
        html: '<p>This inference API is automatically set up by HuggingFace, looks
          like it returns the last layer hidden states.</p>

          <p>Yes, please follow our demo code to average them into one vector and
          use cosine similarity for retrieval.</p>

          '
        raw: 'This inference API is automatically set up by HuggingFace, looks like
          it returns the last layer hidden states.


          Yes, please follow our demo code to average them into one vector and use
          cosine similarity for retrieval.'
        updatedAt: '2023-05-26T09:42:31.179Z'
      numEdits: 1
      reactions: []
    id: 64707eed3df93fddecdf307e
    type: comment
  author: intfloat
  content: 'This inference API is automatically set up by HuggingFace, looks like
    it returns the last layer hidden states.


    Yes, please follow our demo code to average them into one vector and use cosine
    similarity for retrieval.'
  created_at: 2023-05-26 08:42:05+00:00
  edited: true
  hidden: false
  id: 64707eed3df93fddecdf307e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/be702ec82340a3be9dca4406891151d9.svg
      fullname: Amir Sharif
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: amirhalo
      type: user
    createdAt: '2023-06-09T04:40:20.000Z'
    data:
      edited: false
      editors:
      - amirhalo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9371598958969116
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/be702ec82340a3be9dca4406891151d9.svg
          fullname: Amir Sharif
          isHf: false
          isPro: false
          name: amirhalo
          type: user
        html: '<p>Is it possible to edit the Hugging Face model to do that instead
          of having clients do it?</p>

          '
        raw: Is it possible to edit the Hugging Face model to do that instead of having
          clients do it?
        updatedAt: '2023-06-09T04:40:20.090Z'
      numEdits: 0
      reactions: []
    id: 6482ad3485ce4d2973d4f90c
    type: comment
  author: amirhalo
  content: Is it possible to edit the Hugging Face model to do that instead of having
    clients do it?
  created_at: 2023-06-09 03:40:20+00:00
  edited: false
  hidden: false
  id: 6482ad3485ce4d2973d4f90c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
      fullname: Liang Wang
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: intfloat
      type: user
    createdAt: '2023-06-11T14:43:55.000Z'
    data:
      edited: false
      editors:
      - intfloat
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8084345459938049
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5a1ee74c2dbe349a6ec9843a1599d281.svg
          fullname: Liang Wang
          isHf: false
          isPro: false
          name: intfloat
          type: user
        html: '<p>I am not aware of any way to do it automatically. Prepending a string
          prefix should be fairly trivial to do on client side.</p>

          '
        raw: I am not aware of any way to do it automatically. Prepending a string
          prefix should be fairly trivial to do on client side.
        updatedAt: '2023-06-11T14:43:55.871Z'
      numEdits: 0
      reactions: []
    id: 6485ddab3ccc030918b0c7c1
    type: comment
  author: intfloat
  content: I am not aware of any way to do it automatically. Prepending a string prefix
    should be fairly trivial to do on client side.
  created_at: 2023-06-11 13:43:55+00:00
  edited: false
  hidden: false
  id: 6485ddab3ccc030918b0c7c1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
      fullname: Brandt
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ababeal
      type: user
    createdAt: '2023-10-13T19:36:43.000Z'
    data:
      edited: false
      editors:
      - ababeal
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5906200408935547
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
          fullname: Brandt
          isHf: false
          isPro: false
          name: ababeal
          type: user
        html: '<p>Same thing is happening when running it with <code>from sagemaker.huggingface.model
          import HuggingFaceModel</code> </p>

          '
        raw: 'Same thing is happening when running it with `from sagemaker.huggingface.model
          import HuggingFaceModel` '
        updatedAt: '2023-10-13T19:36:43.000Z'
      numEdits: 0
      reactions: []
    id: 65299c4b703b3743c2263319
    type: comment
  author: ababeal
  content: 'Same thing is happening when running it with `from sagemaker.huggingface.model
    import HuggingFaceModel` '
  created_at: 2023-10-13 18:36:43+00:00
  edited: false
  hidden: false
  id: 65299c4b703b3743c2263319
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
      fullname: Brandt
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ababeal
      type: user
    createdAt: '2023-10-13T19:38:11.000Z'
    data:
      edited: true
      editors: []
      hidden: true
      hiddenBy: ''
      latest:
        author:
          avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
          fullname: Brandt
          isHf: false
          isPro: false
          name: ababeal
          type: user
        html: This comment has been hidden
        raw: This comment has been hidden
        updatedAt: '2023-10-13T21:33:08.871Z'
      numEdits: 1
      reactions: []
    id: 65299ca36f88e29851731313
    type: comment
  author: ababeal
  content: This comment has been hidden
  created_at: 2023-10-13 18:38:11+00:00
  edited: true
  hidden: true
  id: 65299ca36f88e29851731313
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
      fullname: Brandt
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ababeal
      type: user
    createdAt: '2023-10-13T20:01:27.000Z'
    data:
      edited: true
      editors: []
      hidden: true
      hiddenBy: ''
      latest:
        author:
          avatarUrl: /avatars/3f9ceaff0c115c80f2656337353e8559.svg
          fullname: Brandt
          isHf: false
          isPro: false
          name: ababeal
          type: user
        html: This comment has been hidden
        raw: This comment has been hidden
        updatedAt: '2023-10-13T21:33:02.716Z'
      numEdits: 1
      reactions: []
    id: 6529a217b355406e2dadf8a6
    type: comment
  author: ababeal
  content: This comment has been hidden
  created_at: 2023-10-13 19:01:27+00:00
  edited: true
  hidden: true
  id: 6529a217b355406e2dadf8a6
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: intfloat/e5-large-v2
repo_type: model
status: open
target_branch: null
title: Which embedding vector to use?
