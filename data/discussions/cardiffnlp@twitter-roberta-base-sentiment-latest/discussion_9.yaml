!!python/object:huggingface_hub.community.DiscussionWithDetails
author: muhbdeir
conflicting_files: null
created_at: 2023-04-13 12:22:02+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/02e5d947c9fbfbf822c052c43bce8ca0.svg
      fullname: Muhammad bdeir
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: muhbdeir
      type: user
    createdAt: '2023-04-13T13:22:02.000Z'
    data:
      edited: false
      editors:
      - muhbdeir
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/02e5d947c9fbfbf822c052c43bce8ca0.svg
          fullname: Muhammad bdeir
          isHf: false
          isPro: false
          name: muhbdeir
          type: user
        html: '<p>I cannot load weights of TF model:<br>got this error</p>

          <p>ValueError                                Traceback (most recent call
          last)<br>Cell In[17], line 4<br>      2 model = TFAutoModelForSequenceClassification.from_pretrained(MODEL)<br>      3
          model.save_pretrained(MODEL)<br>----&gt; 4 model.load_weights("/home/muhammad/git.flare/Warmfire/tf_model.h5")</p>

          <p>File ~/anaconda3/lib/python3.10/site-packages/keras/utils/traceback_utils.py:70,
          in filter_traceback..error_handler(*args, **kwargs)<br>     67     filtered_tb
          = _process_traceback_frames(e.<strong>traceback</strong>)<br>     68     #
          To get the full stack trace, call:<br>     69     # <code>tf.debugging.disable_traceback_filtering()</code><br>---&gt;
          70     raise e.with_traceback(filtered_tb) from None<br>     71 finally:<br>     72     del
          filtered_tb</p>

          <p>File ~/anaconda3/lib/python3.10/site-packages/keras/saving/legacy/hdf5_format.py:808,
          in load_weights_from_hdf5_group(f, model)<br>    806 layer_names = filtered_layer_names<br>    807
          if len(layer_names) != len(filtered_layers):<br>--&gt; 808     raise ValueError(<br>    809         "Layer
          count mismatch when loading weights from file. "<br>    810         f"Model
          expected {len(filtered_layers)} layers, found "<br>    811         f"{len(layer_names)}
          saved layers."<br>    812     )<br>    814 # We batch weight value assignments
          in a single backend call<br>    815 # which provides a speedup in TensorFlow.<br>    816
          weight_value_tuples = []</p>

          <p>ValueError: Layer count mismatch when loading weights from file. Model
          expected 2 layers, found 1 saved layers.</p>

          '
        raw: "I cannot load weights of TF model:\r\ngot this error\r\n\r\nValueError\
          \                                Traceback (most recent call last)\r\nCell\
          \ In[17], line 4\r\n      2 model = TFAutoModelForSequenceClassification.from_pretrained(MODEL)\r\
          \n      3 model.save_pretrained(MODEL)\r\n----> 4 model.load_weights(\"\
          /home/muhammad/git.flare/Warmfire/tf_model.h5\")\r\n\r\nFile ~/anaconda3/lib/python3.10/site-packages/keras/utils/traceback_utils.py:70,\
          \ in filter_traceback.<locals>.error_handler(*args, **kwargs)\r\n     67\
          \     filtered_tb = _process_traceback_frames(e.__traceback__)\r\n     68\
          \     # To get the full stack trace, call:\r\n     69     # `tf.debugging.disable_traceback_filtering()`\r\
          \n---> 70     raise e.with_traceback(filtered_tb) from None\r\n     71 finally:\r\
          \n     72     del filtered_tb\r\n\r\nFile ~/anaconda3/lib/python3.10/site-packages/keras/saving/legacy/hdf5_format.py:808,\
          \ in load_weights_from_hdf5_group(f, model)\r\n    806 layer_names = filtered_layer_names\r\
          \n    807 if len(layer_names) != len(filtered_layers):\r\n--> 808     raise\
          \ ValueError(\r\n    809         \"Layer count mismatch when loading weights\
          \ from file. \"\r\n    810         f\"Model expected {len(filtered_layers)}\
          \ layers, found \"\r\n    811         f\"{len(layer_names)} saved layers.\"\
          \r\n    812     )\r\n    814 # We batch weight value assignments in a single\
          \ backend call\r\n    815 # which provides a speedup in TensorFlow.\r\n\
          \    816 weight_value_tuples = []\r\n\r\nValueError: Layer count mismatch\
          \ when loading weights from file. Model expected 2 layers, found 1 saved\
          \ layers.\r\n"
        updatedAt: '2023-04-13T13:22:02.697Z'
      numEdits: 0
      reactions: []
    id: 643801fa961bb61e463b94cf
    type: comment
  author: muhbdeir
  content: "I cannot load weights of TF model:\r\ngot this error\r\n\r\nValueError\
    \                                Traceback (most recent call last)\r\nCell In[17],\
    \ line 4\r\n      2 model = TFAutoModelForSequenceClassification.from_pretrained(MODEL)\r\
    \n      3 model.save_pretrained(MODEL)\r\n----> 4 model.load_weights(\"/home/muhammad/git.flare/Warmfire/tf_model.h5\"\
    )\r\n\r\nFile ~/anaconda3/lib/python3.10/site-packages/keras/utils/traceback_utils.py:70,\
    \ in filter_traceback.<locals>.error_handler(*args, **kwargs)\r\n     67     filtered_tb\
    \ = _process_traceback_frames(e.__traceback__)\r\n     68     # To get the full\
    \ stack trace, call:\r\n     69     # `tf.debugging.disable_traceback_filtering()`\r\
    \n---> 70     raise e.with_traceback(filtered_tb) from None\r\n     71 finally:\r\
    \n     72     del filtered_tb\r\n\r\nFile ~/anaconda3/lib/python3.10/site-packages/keras/saving/legacy/hdf5_format.py:808,\
    \ in load_weights_from_hdf5_group(f, model)\r\n    806 layer_names = filtered_layer_names\r\
    \n    807 if len(layer_names) != len(filtered_layers):\r\n--> 808     raise ValueError(\r\
    \n    809         \"Layer count mismatch when loading weights from file. \"\r\n\
    \    810         f\"Model expected {len(filtered_layers)} layers, found \"\r\n\
    \    811         f\"{len(layer_names)} saved layers.\"\r\n    812     )\r\n  \
    \  814 # We batch weight value assignments in a single backend call\r\n    815\
    \ # which provides a speedup in TensorFlow.\r\n    816 weight_value_tuples = []\r\
    \n\r\nValueError: Layer count mismatch when loading weights from file. Model expected\
    \ 2 layers, found 1 saved layers.\r\n"
  created_at: 2023-04-13 12:22:02+00:00
  edited: false
  hidden: false
  id: 643801fa961bb61e463b94cf
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 9
repo_id: cardiffnlp/twitter-roberta-base-sentiment-latest
repo_type: model
status: open
target_branch: null
title: Load TF weights
