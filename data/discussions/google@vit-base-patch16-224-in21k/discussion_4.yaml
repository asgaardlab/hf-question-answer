!!python/object:huggingface_hub.community.DiscussionWithDetails
author: z-hb
conflicting_files: null
created_at: 2023-04-16 06:15:42+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9b9bbecef5d5815540abf92d74012f55.svg
      fullname: Hongbo Zhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: z-hb
      type: user
    createdAt: '2023-04-16T07:15:42.000Z'
    data:
      edited: false
      editors:
      - z-hb
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9b9bbecef5d5815540abf92d74012f55.svg
          fullname: Hongbo Zhao
          isHf: false
          isPro: false
          name: z-hb
          type: user
        html: '<pre><code>from transformers import ViTImageProcessor, ViTModel

          from PIL import Image

          import requests


          url = ''http://images.cocodataset.org/val2017/000000039769.jpg''

          image = Image.open(requests.get(url, stream=True).raw)


          processor = ViTImageProcessor.from_pretrained(''google/vit-base-patch16-224-in21k'')

          model = ViTModel.from_pretrained(''google/vit-base-patch16-224-in21k'')

          inputs = processor(images=image, return_tensors="pt")


          outputs = model(**inputs)

          last_hidden_states = outputs.last_hidden_state

          </code></pre>

          <p>This is an example of the VIT model shown on the model card, if I want
          to infer on GPU, what should I do?<br>I know I should  put </p>

          <pre><code>model = model.cuda()

          </code></pre>

          <p>But how to put the data into GPU? What code should I use for the processor?</p>

          '
        raw: "```\r\nfrom transformers import ViTImageProcessor, ViTModel\r\nfrom\
          \ PIL import Image\r\nimport requests\r\n\r\nurl = 'http://images.cocodataset.org/val2017/000000039769.jpg'\r\
          \nimage = Image.open(requests.get(url, stream=True).raw)\r\n\r\nprocessor\
          \ = ViTImageProcessor.from_pretrained('google/vit-base-patch16-224-in21k')\r\
          \nmodel = ViTModel.from_pretrained('google/vit-base-patch16-224-in21k')\r\
          \ninputs = processor(images=image, return_tensors=\"pt\")\r\n\r\noutputs\
          \ = model(**inputs)\r\nlast_hidden_states = outputs.last_hidden_state\r\n\
          ```\r\nThis is an example of the VIT model shown on the model card, if I\
          \ want to infer on GPU, what should I do?\r\nI know I should  put \r\n```\r\
          \nmodel = model.cuda()\r\n```\r\nBut how to put the data into GPU? What\
          \ code should I use for the processor?\r\n"
        updatedAt: '2023-04-16T07:15:42.552Z'
      numEdits: 0
      reactions: []
    id: 643ba09e5ec6af9c3319af4e
    type: comment
  author: z-hb
  content: "```\r\nfrom transformers import ViTImageProcessor, ViTModel\r\nfrom PIL\
    \ import Image\r\nimport requests\r\n\r\nurl = 'http://images.cocodataset.org/val2017/000000039769.jpg'\r\
    \nimage = Image.open(requests.get(url, stream=True).raw)\r\n\r\nprocessor = ViTImageProcessor.from_pretrained('google/vit-base-patch16-224-in21k')\r\
    \nmodel = ViTModel.from_pretrained('google/vit-base-patch16-224-in21k')\r\ninputs\
    \ = processor(images=image, return_tensors=\"pt\")\r\n\r\noutputs = model(**inputs)\r\
    \nlast_hidden_states = outputs.last_hidden_state\r\n```\r\nThis is an example\
    \ of the VIT model shown on the model card, if I want to infer on GPU, what should\
    \ I do?\r\nI know I should  put \r\n```\r\nmodel = model.cuda()\r\n```\r\nBut\
    \ how to put the data into GPU? What code should I use for the processor?\r\n"
  created_at: 2023-04-16 06:15:42+00:00
  edited: false
  hidden: false
  id: 643ba09e5ec6af9c3319af4e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/9b9bbecef5d5815540abf92d74012f55.svg
      fullname: Hongbo Zhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: z-hb
      type: user
    createdAt: '2023-04-16T07:28:10.000Z'
    data:
      status: closed
    id: 643ba38a2eeda4c051516f43
    type: status-change
  author: z-hb
  created_at: 2023-04-16 06:28:10+00:00
  id: 643ba38a2eeda4c051516f43
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: google/vit-base-patch16-224-in21k
repo_type: model
status: closed
target_branch: null
title: How to infer on GPU?
