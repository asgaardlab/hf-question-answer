!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ldavid
conflicting_files: null
created_at: 2023-11-15 23:26:58+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b129557811ccd6a7e0acf2bf72b92342.svg
      fullname: David Li
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ldavid
      type: user
    createdAt: '2023-11-15T23:26:58.000Z'
    data:
      edited: false
      editors:
      - ldavid
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6847997903823853
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b129557811ccd6a7e0acf2bf72b92342.svg
          fullname: David Li
          isHf: false
          isPro: false
          name: ldavid
          type: user
        html: "<p>Is there a way to reconcile the space that is added between the\
          \ <code>&lt;s&gt;</code> and <code>[INST]</code> tokens? A simple example:</p>\n\
          <pre><code>from transformers import AutoTokenizer\n\nmodel_id = \"mistralai/Mistral-7B-Instruct-v0.1\"\
          \ntokenizer = AutoTokenizer.from_pretrained(model_id)\nchat = [\n    {\n\
          \        \"role\": \"user\",\n        \"content\": \"You are my Python programming\
          \ assistant. Write a program that generates the first 10 fibonacci numbers\
          \ in Python.\"\n    }\n]\n\nprompt = tokenizer.apply_chat_template(chat,\
          \ tokenize=False)\nprint(prompt)\nprint(tokenizer.decode(tokenizer(prompt,\
          \ add_special_tokens=False).get(\"input_ids\")))\n</code></pre>\n<p>This\
          \ prints:</p>\n<pre><code>&lt;s&gt;[INST] You are my Python programming\
          \ assistant. Write a program that generates the first 10 fibonacci numbers\
          \ in Python. [/INST]\n&lt;s&gt; [INST] You are my Python programming assistant.\
          \ Write a program that generates the first 10 fibonacci numbers in Python.\
          \ [/INST]\n</code></pre>\n<p>I'm trying to get only the completion of my\
          \ prompt by subtracting my prompt from the final model output.</p>\n"
        raw: "Is there a way to reconcile the space that is added between the `<s>`\
          \ and `[INST]` tokens? A simple example:\r\n```\r\nfrom transformers import\
          \ AutoTokenizer\r\n\r\nmodel_id = \"mistralai/Mistral-7B-Instruct-v0.1\"\
          \r\ntokenizer = AutoTokenizer.from_pretrained(model_id)\r\nchat = [\r\n\
          \    {\r\n        \"role\": \"user\",\r\n        \"content\": \"You are\
          \ my Python programming assistant. Write a program that generates the first\
          \ 10 fibonacci numbers in Python.\"\r\n    }\r\n]\r\n\r\nprompt = tokenizer.apply_chat_template(chat,\
          \ tokenize=False)\r\nprint(prompt)\r\nprint(tokenizer.decode(tokenizer(prompt,\
          \ add_special_tokens=False).get(\"input_ids\")))\r\n```\r\nThis prints:\r\
          \n```\r\n<s>[INST] You are my Python programming assistant. Write a program\
          \ that generates the first 10 fibonacci numbers in Python. [/INST]\r\n<s>\
          \ [INST] You are my Python programming assistant. Write a program that generates\
          \ the first 10 fibonacci numbers in Python. [/INST]\r\n```\r\n\r\nI'm trying\
          \ to get only the completion of my prompt by subtracting my prompt from\
          \ the final model output."
        updatedAt: '2023-11-15T23:26:58.264Z'
      numEdits: 0
      reactions: []
    id: 655553c2bc6ff300d44d7f8f
    type: comment
  author: ldavid
  content: "Is there a way to reconcile the space that is added between the `<s>`\
    \ and `[INST]` tokens? A simple example:\r\n```\r\nfrom transformers import AutoTokenizer\r\
    \n\r\nmodel_id = \"mistralai/Mistral-7B-Instruct-v0.1\"\r\ntokenizer = AutoTokenizer.from_pretrained(model_id)\r\
    \nchat = [\r\n    {\r\n        \"role\": \"user\",\r\n        \"content\": \"\
    You are my Python programming assistant. Write a program that generates the first\
    \ 10 fibonacci numbers in Python.\"\r\n    }\r\n]\r\n\r\nprompt = tokenizer.apply_chat_template(chat,\
    \ tokenize=False)\r\nprint(prompt)\r\nprint(tokenizer.decode(tokenizer(prompt,\
    \ add_special_tokens=False).get(\"input_ids\")))\r\n```\r\nThis prints:\r\n```\r\
    \n<s>[INST] You are my Python programming assistant. Write a program that generates\
    \ the first 10 fibonacci numbers in Python. [/INST]\r\n<s> [INST] You are my Python\
    \ programming assistant. Write a program that generates the first 10 fibonacci\
    \ numbers in Python. [/INST]\r\n```\r\n\r\nI'm trying to get only the completion\
    \ of my prompt by subtracting my prompt from the final model output."
  created_at: 2023-11-15 23:26:58+00:00
  edited: false
  hidden: false
  id: 655553c2bc6ff300d44d7f8f
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 74
repo_id: mistralai/Mistral-7B-Instruct-v0.1
repo_type: model
status: open
target_branch: null
title: Tokenizer adds space between sentence start and instruction start
