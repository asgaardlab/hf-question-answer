!!python/object:huggingface_hub.community.DiscussionWithDetails
author: abipani
conflicting_files: null
created_at: 2023-09-28 22:10:59+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/7d017da21188189b1745528dac5bb7ec.svg
      fullname: Abhisek Panigrahi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: abipani
      type: user
    createdAt: '2023-09-28T23:10:59.000Z'
    data:
      edited: false
      editors:
      - abipani
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8407338857650757
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/7d017da21188189b1745528dac5bb7ec.svg
          fullname: Abhisek Panigrahi
          isHf: false
          isPro: false
          name: abipani
          type: user
        html: '<p>I finetuned 7b chat int4 model on 200 sample dataset. It started
          with loss 2.00 then went to 0 for rest of the steps.<br>I saved the model
          and when I trying to inference. It shows me below error.<br>next_tokens
          = torch.multinomial(probs, num_samples=1).squeeze(1)<br>RuntimeError: probability
          tensor contains either inf, nan or element &lt; 0</p>

          '
        raw: "I finetuned 7b chat int4 model on 200 sample dataset. It started with\
          \ loss 2.00 then went to 0 for rest of the steps.\r\nI saved the model and\
          \ when I trying to inference. It shows me below error.\r\nnext_tokens =\
          \ torch.multinomial(probs, num_samples=1).squeeze(1)\r\nRuntimeError: probability\
          \ tensor contains either inf, nan or element < 0"
        updatedAt: '2023-09-28T23:10:59.303Z'
      numEdits: 0
      reactions: []
    id: 65160803b26534355c024dac
    type: comment
  author: abipani
  content: "I finetuned 7b chat int4 model on 200 sample dataset. It started with\
    \ loss 2.00 then went to 0 for rest of the steps.\r\nI saved the model and when\
    \ I trying to inference. It shows me below error.\r\nnext_tokens = torch.multinomial(probs,\
    \ num_samples=1).squeeze(1)\r\nRuntimeError: probability tensor contains either\
    \ inf, nan or element < 0"
  created_at: 2023-09-28 22:10:59+00:00
  edited: false
  hidden: false
  id: 65160803b26534355c024dac
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9921ca8568f9d53c919681d8960ad802.svg
      fullname: jklj077
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: jklj077
      type: user
    createdAt: '2023-10-09T10:50:21.000Z'
    data:
      edited: false
      editors:
      - jklj077
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9180781841278076
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9921ca8568f9d53c919681d8960ad802.svg
          fullname: jklj077
          isHf: false
          isPro: false
          name: jklj077
          type: user
        html: '<p>Could you please open an issue at <a rel="nofollow" href="https://github.com/QwenLM/Qwen/issues">https://github.com/QwenLM/Qwen/issues</a>
          , so that we can better track this?<br>We also need more context, such as,
          the script or framework, the devices, and the software environment you used.<br>Thanks!</p>

          '
        raw: "Could you please open an issue at https://github.com/QwenLM/Qwen/issues\
          \ , so that we can better track this? \nWe also need more context, such\
          \ as, the script or framework, the devices, and the software environment\
          \ you used. \nThanks!"
        updatedAt: '2023-10-09T10:50:21.246Z'
      numEdits: 0
      reactions: []
    id: 6523daedc428cceeb71b755a
    type: comment
  author: jklj077
  content: "Could you please open an issue at https://github.com/QwenLM/Qwen/issues\
    \ , so that we can better track this? \nWe also need more context, such as, the\
    \ script or framework, the devices, and the software environment you used. \n\
    Thanks!"
  created_at: 2023-10-09 09:50:21+00:00
  edited: false
  hidden: false
  id: 6523daedc428cceeb71b755a
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: Qwen/Qwen-7B-Chat-Int4
repo_type: model
status: open
target_branch: null
title: 'Finetuning: Loss is 0 after 1 step, Runtime error in inference'
