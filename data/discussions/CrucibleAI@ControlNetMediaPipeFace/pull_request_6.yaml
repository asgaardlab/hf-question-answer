!!python/object:huggingface_hub.community.DiscussionWithDetails
author: patrickvonplaten
conflicting_files: []
created_at: 2023-04-03 08:06:17+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:06:17.000Z'
    data:
      edited: true
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: "<p>This PR uploads the diffusers controlnet model for this repo. This\
          \ allows users to use it within the diffusers ecosystem: <a rel=\"nofollow\"\
          \ href=\"https://github.com/huggingface/diffusers\">https://github.com/huggingface/diffusers</a>\
          \ , and later also use the inference API here. </p>\n<p>4 checkpoints are\
          \ uploaded</p>\n<ul>\n<li>fp32 in torch.bin</li>\n<li>fp32 in safetensors</li>\n\
          <li>fp16 in torch.bin</li>\n<li>fp16 in safetensors</li>\n</ul>\n<p>Code\
          \ to check the model:</p>\n<pre><code class=\"language-py\"><span class=\"\
          hljs-keyword\">import</span> torch\n<span class=\"hljs-keyword\">import</span>\
          \ os\n<span class=\"hljs-keyword\">from</span> diffusers.utils <span class=\"\
          hljs-keyword\">import</span> load_image\n\n<span class=\"hljs-keyword\"\
          >from</span> diffusers <span class=\"hljs-keyword\">import</span> (\n  \
          \  ControlNetModel,\n    StableDiffusionControlNetPipeline,\n)\n\nimage\
          \ = load_image(<span class=\"hljs-string\">\"https://huggingface.co/CrucibleAI/ControlNetMediaPipeFace/resolve/main/samples_laion_face_dataset/family_annotation.png\"\
          </span>)\n\ncontrolnet = ControlNetModel.from_pretrained(<span class=\"\
          hljs-string\">\"CrucibleAI/ControlNetMediaPipeFace\"</span>, torch_dtype=torch.float16,\
          \ variant=<span class=\"hljs-string\">\"fp16\"</span>, revision=<span class=\"\
          hljs-string\">\"refs/pr/6\"</span>)\n\npipe = StableDiffusionControlNetPipeline.from_pretrained(\n\
          \    <span class=\"hljs-string\">\"stabilityai/stable-diffusion-2-1-base\"\
          </span>, controlnet=controlnet, torch_dtype=torch.float16\n)\npipe.enable_model_cpu_offload()\n\
          \nout_image = pipe(<span class=\"hljs-string\">\"A happy family in a dentist\
          \ advertisement.\"</span>, image=image).images[<span class=\"hljs-number\"\
          >0</span>]\n</code></pre>\n"
        raw: "This PR uploads the diffusers controlnet model for this repo. This allows\
          \ users to use it within the diffusers ecosystem: https://github.com/huggingface/diffusers\
          \ , and later also use the inference API here. \n\n4 checkpoints are uploaded\n\
          - fp32 in torch.bin\n- fp32 in safetensors\n- fp16 in torch.bin\n- fp16\
          \ in safetensors\n\nCode to check the model:\n\n```py\nimport torch\nimport\
          \ os\nfrom diffusers.utils import load_image\n\nfrom diffusers import (\n\
          \    ControlNetModel,\n    StableDiffusionControlNetPipeline,\n)\n\nimage\
          \ = load_image(\"https://huggingface.co/CrucibleAI/ControlNetMediaPipeFace/resolve/main/samples_laion_face_dataset/family_annotation.png\"\
          )\n\ncontrolnet = ControlNetModel.from_pretrained(\"CrucibleAI/ControlNetMediaPipeFace\"\
          , torch_dtype=torch.float16, variant=\"fp16\", revision=\"refs/pr/6\")\n\
          \npipe = StableDiffusionControlNetPipeline.from_pretrained(\n    \"stabilityai/stable-diffusion-2-1-base\"\
          , controlnet=controlnet, torch_dtype=torch.float16\n)\npipe.enable_model_cpu_offload()\n\
          \nout_image = pipe(\"A happy family in a dentist advertisement.\", image=image).images[0]\n\
          ```"
        updatedAt: '2023-04-03T09:42:06.820Z'
      numEdits: 1
      reactions:
      - count: 3
        reaction: "\u2764\uFE0F"
        users:
        - radames
        - patrickvonplaten
        - sayakpaul
      - count: 1
        reaction: "\U0001F917"
        users:
        - JosephCatrambone
    id: 642a97096b3a23fe494183ce
    type: comment
  author: patrickvonplaten
  content: "This PR uploads the diffusers controlnet model for this repo. This allows\
    \ users to use it within the diffusers ecosystem: https://github.com/huggingface/diffusers\
    \ , and later also use the inference API here. \n\n4 checkpoints are uploaded\n\
    - fp32 in torch.bin\n- fp32 in safetensors\n- fp16 in torch.bin\n- fp16 in safetensors\n\
    \nCode to check the model:\n\n```py\nimport torch\nimport os\nfrom diffusers.utils\
    \ import load_image\n\nfrom diffusers import (\n    ControlNetModel,\n    StableDiffusionControlNetPipeline,\n\
    )\n\nimage = load_image(\"https://huggingface.co/CrucibleAI/ControlNetMediaPipeFace/resolve/main/samples_laion_face_dataset/family_annotation.png\"\
    )\n\ncontrolnet = ControlNetModel.from_pretrained(\"CrucibleAI/ControlNetMediaPipeFace\"\
    , torch_dtype=torch.float16, variant=\"fp16\", revision=\"refs/pr/6\")\n\npipe\
    \ = StableDiffusionControlNetPipeline.from_pretrained(\n    \"stabilityai/stable-diffusion-2-1-base\"\
    , controlnet=controlnet, torch_dtype=torch.float16\n)\npipe.enable_model_cpu_offload()\n\
    \nout_image = pipe(\"A happy family in a dentist advertisement.\", image=image).images[0]\n\
    ```"
  created_at: 2023-04-03 08:06:17+00:00
  edited: true
  hidden: false
  id: 642a97096b3a23fe494183ce
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:26:11.000Z'
    data:
      oid: f182414fe08712897ad2303fd70016f6a55bf3cf
      parents:
      - f3e7dd80cf370bad71eb03caf751bb04a388af34
      subject: upload diffusers
    id: 642a9bb30000000000000000
    type: commit
  author: patrickvonplaten
  created_at: 2023-04-03 08:26:11+00:00
  id: 642a9bb30000000000000000
  oid: f182414fe08712897ad2303fd70016f6a55bf3cf
  summary: upload diffusers
  type: commit
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:37:04.000Z'
    data:
      oid: 1e93c51ebfd257020ae423c0755016a84afd2aa8
      parents:
      - f182414fe08712897ad2303fd70016f6a55bf3cf
      subject: correct
    id: 642a9e400000000000000000
    type: commit
  author: patrickvonplaten
  created_at: 2023-04-03 08:37:04+00:00
  id: 642a9e400000000000000000
  oid: 1e93c51ebfd257020ae423c0755016a84afd2aa8
  summary: correct
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:43:18.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: '<p>Running the above code gives</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/5dfcb1aada6d0311fd3d5448/lCDgm7AnM3VGYh5bkwzV-.png"><img
          alt="dentist.png" src="https://cdn-uploads.huggingface.co/production/uploads/5dfcb1aada6d0311fd3d5448/lCDgm7AnM3VGYh5bkwzV-.png"></a></p>

          '
        raw: 'Running the above code gives


          ![dentist.png](https://cdn-uploads.huggingface.co/production/uploads/5dfcb1aada6d0311fd3d5448/lCDgm7AnM3VGYh5bkwzV-.png)'
        updatedAt: '2023-04-03T09:43:18.807Z'
      numEdits: 0
      reactions: []
    id: 642a9fb60a586b371e059e81
    type: comment
  author: patrickvonplaten
  content: 'Running the above code gives


    ![dentist.png](https://cdn-uploads.huggingface.co/production/uploads/5dfcb1aada6d0311fd3d5448/lCDgm7AnM3VGYh5bkwzV-.png)'
  created_at: 2023-04-03 08:43:18+00:00
  edited: false
  hidden: false
  id: 642a9fb60a586b371e059e81
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:43:36.000Z'
    data:
      status: open
    id: 642a9fc8469b80a9a8b8605b
    type: status-change
  author: patrickvonplaten
  created_at: 2023-04-03 08:43:36+00:00
  id: 642a9fc8469b80a9a8b8605b
  new_status: open
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-03T09:45:15.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;chris-crucible&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/chris-crucible\"\
          >@<span class=\"underline\">chris-crucible</span></a></span>\n\n\t</span></span>\
          \ I think this PR is good to go. I also added a short code snippet showing\
          \ how the model can be used :-) </p>\n<p>We're currently working on enabling\
          \ the inference API for controlnet so adding the diffusers checkpoint should\
          \ also help you run the inference API later</p>\n"
        raw: "@chris-crucible I think this PR is good to go. I also added a short\
          \ code snippet showing how the model can be used :-) \n\nWe're currently\
          \ working on enabling the inference API for controlnet so adding the diffusers\
          \ checkpoint should also help you run the inference API later"
        updatedAt: '2023-04-03T09:45:15.495Z'
      numEdits: 0
      reactions: []
    id: 642aa02b4ba0a1e2caa90c74
    type: comment
  author: patrickvonplaten
  content: "@chris-crucible I think this PR is good to go. I also added a short code\
    \ snippet showing how the model can be used :-) \n\nWe're currently working on\
    \ enabling the inference API for controlnet so adding the diffusers checkpoint\
    \ should also help you run the inference API later"
  created_at: 2023-04-03 08:45:15+00:00
  edited: false
  hidden: false
  id: 642aa02b4ba0a1e2caa90c74
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1678441071764-63c7459b50cc81901dac5fe2.png?w=200&h=200&f=face
      fullname: NA
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ForserX
      type: user
    createdAt: '2023-04-03T11:53:53.000Z'
    data:
      edited: true
      editors:
      - ForserX
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1678441071764-63c7459b50cc81901dac5fe2.png?w=200&h=200&f=face
          fullname: NA
          isHf: false
          isPro: false
          name: ForserX
          type: user
        html: '<p>Excellent. It remains to make an ONNX model :)</p>

          '
        raw: Excellent. It remains to make an ONNX model :)
        updatedAt: '2023-04-03T12:14:14.456Z'
      numEdits: 1
      reactions: []
    id: 642abe517604c4e9d51c8fa9
    type: comment
  author: ForserX
  content: Excellent. It remains to make an ONNX model :)
  created_at: 2023-04-03 10:53:53+00:00
  edited: true
  hidden: false
  id: 642abe517604c4e9d51c8fa9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60a86aec17722074ec658f7e/JuDJOux1TT2ApTKGJXDpr.jpeg?w=200&h=200&f=face
      fullname: Joseph Catrambone
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: JosephCatrambone
      type: user
    createdAt: '2023-04-03T21:54:54.000Z'
    data:
      edited: false
      editors:
      - JosephCatrambone
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60a86aec17722074ec658f7e/JuDJOux1TT2ApTKGJXDpr.jpeg?w=200&h=200&f=face
          fullname: Joseph Catrambone
          isHf: false
          isPro: false
          name: JosephCatrambone
          type: user
        html: '<p>LGTM.  Outstanding work.  </p>

          <p>I have a deep-seated desire to move everything to the same directory
          level so the models are all in "/models" or "/", rather than a mix.  I think
          you have a better understanding of HF best practices so I''ll do a follow-up
          PR to style-match you.</p>

          '
        raw: "LGTM.  Outstanding work.  \n\nI have a deep-seated desire to move everything\
          \ to the same directory level so the models are all in \"/models\" or \"\
          /\", rather than a mix.  I think you have a better understanding of HF best\
          \ practices so I'll do a follow-up PR to style-match you."
        updatedAt: '2023-04-03T21:54:54.296Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - patrickvonplaten
      relatedEventId: 642b4b2ef3d829a868c73e44
    id: 642b4b2ef3d829a868c73e43
    type: comment
  author: JosephCatrambone
  content: "LGTM.  Outstanding work.  \n\nI have a deep-seated desire to move everything\
    \ to the same directory level so the models are all in \"/models\" or \"/\", rather\
    \ than a mix.  I think you have a better understanding of HF best practices so\
    \ I'll do a follow-up PR to style-match you."
  created_at: 2023-04-03 20:54:54+00:00
  edited: false
  hidden: false
  id: 642b4b2ef3d829a868c73e43
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60a86aec17722074ec658f7e/JuDJOux1TT2ApTKGJXDpr.jpeg?w=200&h=200&f=face
      fullname: Joseph Catrambone
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: JosephCatrambone
      type: user
    createdAt: '2023-04-03T21:54:54.000Z'
    data:
      status: merged
    id: 642b4b2ef3d829a868c73e44
    type: status-change
  author: JosephCatrambone
  created_at: 2023-04-03 20:54:54+00:00
  id: 642b4b2ef3d829a868c73e44
  new_status: merged
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-04-05T10:42:01.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: "<p>That's interesting feedback <span data-props=\"{&quot;user&quot;:&quot;JosephCatrambone&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/JosephCatrambone\"\
          >@<span class=\"underline\">JosephCatrambone</span></a></span>\n\n\t</span></span>!\
          \ Sadly diffusers more or less requires to have nested folders now as it's\
          \ the core of how pipeline components are handled.</p>\n"
        raw: That's interesting feedback @JosephCatrambone! Sadly diffusers more or
          less requires to have nested folders now as it's the core of how pipeline
          components are handled.
        updatedAt: '2023-04-05T10:42:01.089Z'
      numEdits: 0
      reactions: []
    id: 642d5079892562f0cde9367c
    type: comment
  author: patrickvonplaten
  content: That's interesting feedback @JosephCatrambone! Sadly diffusers more or
    less requires to have nested folders now as it's the core of how pipeline components
    are handled.
  created_at: 2023-04-05 09:42:01+00:00
  edited: false
  hidden: false
  id: 642d5079892562f0cde9367c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60a86aec17722074ec658f7e/JuDJOux1TT2ApTKGJXDpr.jpeg?w=200&h=200&f=face
      fullname: Joseph Catrambone
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: JosephCatrambone
      type: user
    createdAt: '2023-04-05T19:23:47.000Z'
    data:
      edited: false
      editors:
      - JosephCatrambone
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60a86aec17722074ec658f7e/JuDJOux1TT2ApTKGJXDpr.jpeg?w=200&h=200&f=face
          fullname: Joseph Catrambone
          isHf: false
          isPro: false
          name: JosephCatrambone
          type: user
        html: "<p>\U0001F937 No worries. I am not married to the idea of /models/*.pt.\
          \ </p>\n<p>In fact, I think it looks nicer without the extra folder.  Thanks\
          \ again for this PR.</p>\n"
        raw: "\U0001F937 No worries. I am not married to the idea of /models/*.pt.\
          \ \n\nIn fact, I think it looks nicer without the extra folder.  Thanks\
          \ again for this PR."
        updatedAt: '2023-04-05T19:23:47.850Z'
      numEdits: 0
      reactions: []
    id: 642dcac3bd4d3f3296d50710
    type: comment
  author: JosephCatrambone
  content: "\U0001F937 No worries. I am not married to the idea of /models/*.pt. \n\
    \nIn fact, I think it looks nicer without the extra folder.  Thanks again for\
    \ this PR."
  created_at: 2023-04-05 18:23:47+00:00
  edited: false
  hidden: false
  id: 642dcac3bd4d3f3296d50710
  type: comment
is_pull_request: true
merge_commit_oid: 761020004904fd238a41fa9c862f75ede17ea925
num: 6
repo_id: CrucibleAI/ControlNetMediaPipeFace
repo_type: model
status: merged
target_branch: refs/heads/main
title: Add Diffusers weights
