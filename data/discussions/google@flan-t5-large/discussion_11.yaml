!!python/object:huggingface_hub.community.DiscussionWithDetails
author: estebarb
conflicting_files: null
created_at: 2023-02-20 03:30:45+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/378b6705b7ebdbd39c9ea901f267ac01.svg
      fullname: "Esteban Rodr\xEDguez Betancourt"
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: estebarb
      type: user
    createdAt: '2023-02-20T03:30:45.000Z'
    data:
      edited: false
      editors:
      - estebarb
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/378b6705b7ebdbd39c9ea901f267ac01.svg
          fullname: "Esteban Rodr\xEDguez Betancourt"
          isHf: false
          isPro: false
          name: estebarb
          type: user
        html: "<p>I'm trying to use this model exactly as the instructions said, but\
          \ I got the following error:</p>\n<pre><code>---------------------------------------------------------------------------\n\
          NameError                                 Traceback (most recent call last)\n\
          Cell In[5], line 4\n      1 from transformers import T5Tokenizer, T5ForConditionalGeneration\n\
          \      3 tokenizer = T5Tokenizer.from_pretrained(\"google/flan-t5-large\"\
          )\n----&gt; 4 model = T5ForConditionalGeneration.from_pretrained(\"google/flan-t5-large\"\
          , device_map=\"auto\")\n\nFile ~/src/test/venv/lib/python3.10/site-packages/transformers/modeling_utils.py:2273,\
          \ in PreTrainedModel.from_pretrained(cls, pretrained_model_name_or_path,\
          \ *model_args, **kwargs)\n   2271     init_contexts = [deepspeed.zero.Init(config_dict_or_path=deepspeed_config())]\
          \ + init_contexts\n   2272 elif load_in_8bit or low_cpu_mem_usage:\n-&gt;\
          \ 2273     init_contexts.append(init_empty_weights())\n   2275 with ContextManagers(init_contexts):\n\
          \   2276     model = cls(config, *model_args, **model_kwargs)\n\nNameError:\
          \ name 'init_empty_weights' is not defined\n</code></pre>\n<p>My code is:</p>\n\
          <pre><code class=\"language-python\"><span class=\"hljs-keyword\">from</span>\
          \ transformers <span class=\"hljs-keyword\">import</span> T5Tokenizer, T5ForConditionalGeneration\n\
          \ntokenizer = T5Tokenizer.from_pretrained(<span class=\"hljs-string\">\"\
          google/flan-t5-large\"</span>)\nmodel = T5ForConditionalGeneration.from_pretrained(<span\
          \ class=\"hljs-string\">\"google/flan-t5-large\"</span>, device_map=<span\
          \ class=\"hljs-string\">\"auto\"</span>)\n</code></pre>\n"
        raw: "I'm trying to use this model exactly as the instructions said, but I\
          \ got the following error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\
          \nNameError                                 Traceback (most recent call\
          \ last)\r\nCell In[5], line 4\r\n      1 from transformers import T5Tokenizer,\
          \ T5ForConditionalGeneration\r\n      3 tokenizer = T5Tokenizer.from_pretrained(\"\
          google/flan-t5-large\")\r\n----> 4 model = T5ForConditionalGeneration.from_pretrained(\"\
          google/flan-t5-large\", device_map=\"auto\")\r\n\r\nFile ~/src/test/venv/lib/python3.10/site-packages/transformers/modeling_utils.py:2273,\
          \ in PreTrainedModel.from_pretrained(cls, pretrained_model_name_or_path,\
          \ *model_args, **kwargs)\r\n   2271     init_contexts = [deepspeed.zero.Init(config_dict_or_path=deepspeed_config())]\
          \ + init_contexts\r\n   2272 elif load_in_8bit or low_cpu_mem_usage:\r\n\
          -> 2273     init_contexts.append(init_empty_weights())\r\n   2275 with ContextManagers(init_contexts):\r\
          \n   2276     model = cls(config, *model_args, **model_kwargs)\r\n\r\nNameError:\
          \ name 'init_empty_weights' is not defined\r\n```\r\n\r\nMy code is:\r\n\
          \r\n```python\r\nfrom transformers import T5Tokenizer, T5ForConditionalGeneration\r\
          \n\r\ntokenizer = T5Tokenizer.from_pretrained(\"google/flan-t5-large\")\r\
          \nmodel = T5ForConditionalGeneration.from_pretrained(\"google/flan-t5-large\"\
          , device_map=\"auto\")\r\n```"
        updatedAt: '2023-02-20T03:30:45.082Z'
      numEdits: 0
      reactions: []
    id: 63f2e965f4e30ffd2bd930f9
    type: comment
  author: estebarb
  content: "I'm trying to use this model exactly as the instructions said, but I got\
    \ the following error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\
    \nNameError                                 Traceback (most recent call last)\r\
    \nCell In[5], line 4\r\n      1 from transformers import T5Tokenizer, T5ForConditionalGeneration\r\
    \n      3 tokenizer = T5Tokenizer.from_pretrained(\"google/flan-t5-large\")\r\n\
    ----> 4 model = T5ForConditionalGeneration.from_pretrained(\"google/flan-t5-large\"\
    , device_map=\"auto\")\r\n\r\nFile ~/src/test/venv/lib/python3.10/site-packages/transformers/modeling_utils.py:2273,\
    \ in PreTrainedModel.from_pretrained(cls, pretrained_model_name_or_path, *model_args,\
    \ **kwargs)\r\n   2271     init_contexts = [deepspeed.zero.Init(config_dict_or_path=deepspeed_config())]\
    \ + init_contexts\r\n   2272 elif load_in_8bit or low_cpu_mem_usage:\r\n-> 2273\
    \     init_contexts.append(init_empty_weights())\r\n   2275 with ContextManagers(init_contexts):\r\
    \n   2276     model = cls(config, *model_args, **model_kwargs)\r\n\r\nNameError:\
    \ name 'init_empty_weights' is not defined\r\n```\r\n\r\nMy code is:\r\n\r\n```python\r\
    \nfrom transformers import T5Tokenizer, T5ForConditionalGeneration\r\n\r\ntokenizer\
    \ = T5Tokenizer.from_pretrained(\"google/flan-t5-large\")\r\nmodel = T5ForConditionalGeneration.from_pretrained(\"\
    google/flan-t5-large\", device_map=\"auto\")\r\n```"
  created_at: 2023-02-20 03:30:45+00:00
  edited: false
  hidden: false
  id: 63f2e965f4e30ffd2bd930f9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2023-02-20T19:07:18.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;estebarb&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/estebarb\"\
          >@<span class=\"underline\">estebarb</span></a></span>\n\n\t</span></span><br>Thanks\
          \ for the issue! Can you double check you are using the latest versions\
          \ of <code>transformers</code> and <code>accelerate</code> ?<br><code>pip\
          \ install --upgrade transformers accelerate</code></p>\n"
        raw: "Hi @estebarb \nThanks for the issue! Can you double check you are using\
          \ the latest versions of `transformers` and `accelerate` ?\n`pip install\
          \ --upgrade transformers accelerate`"
        updatedAt: '2023-02-20T19:07:18.490Z'
      numEdits: 0
      reactions: []
    id: 63f3c4e6e13a558a4d697c82
    type: comment
  author: ybelkada
  content: "Hi @estebarb \nThanks for the issue! Can you double check you are using\
    \ the latest versions of `transformers` and `accelerate` ?\n`pip install --upgrade\
    \ transformers accelerate`"
  created_at: 2023-02-20 19:07:18+00:00
  edited: false
  hidden: false
  id: 63f3c4e6e13a558a4d697c82
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 11
repo_id: google/flan-t5-large
repo_type: model
status: open
target_branch: null
title: name 'init_empty_weights' is not defined
