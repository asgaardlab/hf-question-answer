!!python/object:huggingface_hub.community.DiscussionWithDetails
author: zhuowan
conflicting_files: null
created_at: 2023-05-30 15:19:38+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/7148362c63b1633bee2c08f2b7709585.svg
      fullname: Zhuowan Li
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zhuowan
      type: user
    createdAt: '2023-05-30T16:19:38.000Z'
    data:
      edited: true
      editors:
      - zhuowan
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/7148362c63b1633bee2c08f2b7709585.svg
          fullname: Zhuowan Li
          isHf: false
          isPro: false
          name: zhuowan
          type: user
        html: '<p>I am using the <code>pix2struct-infographics-vqa-base</code> and
          <code>pix2struct-infographics-vqa-large</code> model here and doing inference
          on InfographicsVQA. However, I get 29.53 ANLS for base and 34.31 ANLS for
          large, which do not match with the 38.2 and 40.0 results as in the original
          paper. Could anyone help with this?</p>

          <p>Here is my inference code:</p>

          <pre><code>import requests

          from PIL import Image

          import torch

          from transformers import Pix2StructForConditionalGeneration, Pix2StructProcessor


          model = Pix2StructForConditionalGeneration.from_pretrained("google/pix2struct-infographics-vqa-base").to("cuda")

          processor = Pix2StructProcessor.from_pretrained("google/pix2struct-infographics-vqa-base")


          image_url = "https://blogs.constantcontact.com/wp-content/uploads/2019/03/Social-Media-Infographic.png"

          image = Image.open(requests.get(image_url, stream=True).raw)

          question = "Which social platform has heavy female audience?"

          inputs = processor(images=image, text=question, return_tensors="pt").to("cuda")


          predictions = model.generate(**inputs)

          pred = processor.decode(predictions[0], skip_special_tokens=True)

          gt = ''pinterest''


          print(pred)

          </code></pre>

          '
        raw: 'I am using the `pix2struct-infographics-vqa-base` and `pix2struct-infographics-vqa-large`
          model here and doing inference on InfographicsVQA. However, I get 29.53
          ANLS for base and 34.31 ANLS for large, which do not match with the 38.2
          and 40.0 results as in the original paper. Could anyone help with this?


          Here is my inference code:

          ```

          import requests

          from PIL import Image

          import torch

          from transformers import Pix2StructForConditionalGeneration, Pix2StructProcessor


          model = Pix2StructForConditionalGeneration.from_pretrained("google/pix2struct-infographics-vqa-base").to("cuda")

          processor = Pix2StructProcessor.from_pretrained("google/pix2struct-infographics-vqa-base")


          image_url = "https://blogs.constantcontact.com/wp-content/uploads/2019/03/Social-Media-Infographic.png"

          image = Image.open(requests.get(image_url, stream=True).raw)

          question = "Which social platform has heavy female audience?"

          inputs = processor(images=image, text=question, return_tensors="pt").to("cuda")


          predictions = model.generate(**inputs)

          pred = processor.decode(predictions[0], skip_special_tokens=True)

          gt = ''pinterest''


          print(pred)

          ```'
        updatedAt: '2023-05-30T16:26:33.387Z'
      numEdits: 1
      reactions: []
    id: 6476221aabc39d77adeb6b9d
    type: comment
  author: zhuowan
  content: 'I am using the `pix2struct-infographics-vqa-base` and `pix2struct-infographics-vqa-large`
    model here and doing inference on InfographicsVQA. However, I get 29.53 ANLS for
    base and 34.31 ANLS for large, which do not match with the 38.2 and 40.0 results
    as in the original paper. Could anyone help with this?


    Here is my inference code:

    ```

    import requests

    from PIL import Image

    import torch

    from transformers import Pix2StructForConditionalGeneration, Pix2StructProcessor


    model = Pix2StructForConditionalGeneration.from_pretrained("google/pix2struct-infographics-vqa-base").to("cuda")

    processor = Pix2StructProcessor.from_pretrained("google/pix2struct-infographics-vqa-base")


    image_url = "https://blogs.constantcontact.com/wp-content/uploads/2019/03/Social-Media-Infographic.png"

    image = Image.open(requests.get(image_url, stream=True).raw)

    question = "Which social platform has heavy female audience?"

    inputs = processor(images=image, text=question, return_tensors="pt").to("cuda")


    predictions = model.generate(**inputs)

    pred = processor.decode(predictions[0], skip_special_tokens=True)

    gt = ''pinterest''


    print(pred)

    ```'
  created_at: 2023-05-30 15:19:38+00:00
  edited: true
  hidden: false
  id: 6476221aabc39d77adeb6b9d
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: google/pix2struct-infographics-vqa-base
repo_type: model
status: open
target_branch: null
title: Cannot reproduce results on InfographicsVQA
