!!python/object:huggingface_hub.community.DiscussionWithDetails
author: andreagasparini
conflicting_files: []
created_at: 2022-07-25 10:25:20+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
      fullname: Andrea Gasparini
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: andreagasparini
      type: user
    createdAt: '2022-07-25T11:25:20.000Z'
    data:
      edited: true
      editors:
      - andreagasparini
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
          fullname: Andrea Gasparini
          isHf: false
          isPro: false
          name: andreagasparini
          type: user
        html: '<p>Hi, I was trying to evaluate the model on LibriSpeech''s "clean"
          and "other" test data following the code snippet in the Model card but I
          got a <code>TypeError</code> due to storing the transcriptions in the batch
          as wrapped in lists instead of as plain strings (e.g. ["transcription example"]
          instead of "transcription example") in the <code>map_to_pred</code> function.</p>

          <p><code>TypeError: expected string or bytes-like object</code></p>

          <p>After fixing the error I recomputed the WER and updated the scores without
          aproximating them. I think the same should be done for other wav2vec2 based
          models (e.g. facebook/wav2vec2-large-960h-lv60).</p>

          '
        raw: 'Hi, I was trying to evaluate the model on LibriSpeech''s "clean" and
          "other" test data following the code snippet in the Model card but I got
          a `TypeError` due to storing the transcriptions in the batch as wrapped
          in lists instead of as plain strings (e.g. ["transcription example"] instead
          of "transcription example") in the `map_to_pred` function.


          ``TypeError: expected string or bytes-like object``


          After fixing the error I recomputed the WER and updated the scores without
          aproximating them. I think the same should be done for other wav2vec2 based
          models (e.g. facebook/wav2vec2-large-960h-lv60).'
        updatedAt: '2022-07-25T11:26:01.890Z'
      numEdits: 1
      reactions: []
    id: 62de7da0f958caa02e86d0b0
    type: comment
  author: andreagasparini
  content: 'Hi, I was trying to evaluate the model on LibriSpeech''s "clean" and "other"
    test data following the code snippet in the Model card but I got a `TypeError`
    due to storing the transcriptions in the batch as wrapped in lists instead of
    as plain strings (e.g. ["transcription example"] instead of "transcription example")
    in the `map_to_pred` function.


    ``TypeError: expected string or bytes-like object``


    After fixing the error I recomputed the WER and updated the scores without aproximating
    them. I think the same should be done for other wav2vec2 based models (e.g. facebook/wav2vec2-large-960h-lv60).'
  created_at: 2022-07-25 10:25:20+00:00
  edited: true
  hidden: false
  id: 62de7da0f958caa02e86d0b0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
      fullname: Andrea Gasparini
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: andreagasparini
      type: user
    createdAt: '2022-07-25T11:25:20.000Z'
    data:
      oid: d02ba4febcdce20e9ab6fbd40c0015ed2fb7b1a6
      parents:
      - 54074b1c16f4de6a5ad59affb4caa8f2ea03a119
      subject: Fixes evaluation instructions and updates WER scores
    id: 62de7da00000000000000000
    type: commit
  author: andreagasparini
  created_at: 2022-07-25 10:25:20+00:00
  id: 62de7da00000000000000000
  oid: d02ba4febcdce20e9ab6fbd40c0015ed2fb7b1a6
  summary: Fixes evaluation instructions and updates WER scores
  type: commit
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
      fullname: Andrea Gasparini
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: andreagasparini
      type: user
    createdAt: '2022-07-25T11:29:26.000Z'
    data:
      oid: 25ca1d9d510188fd7de4af65fe767c3059001903
      parents:
      - d02ba4febcdce20e9ab6fbd40c0015ed2fb7b1a6
      subject: Fixes typo
    id: 62de7e960000000000000000
    type: commit
  author: andreagasparini
  created_at: 2022-07-25 10:29:26+00:00
  id: 62de7e960000000000000000
  oid: 25ca1d9d510188fd7de4af65fe767c3059001903
  summary: Fixes typo
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
      fullname: Lysandre
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: lysandre
      type: user
    createdAt: '2022-07-28T15:13:48.000Z'
    data:
      edited: false
      editors:
      - lysandre
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
          fullname: Lysandre
          isHf: true
          isPro: false
          name: lysandre
          type: user
        html: "<p>cc <span data-props=\"{&quot;user&quot;:&quot;sanchit-gandhi&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/sanchit-gandhi\"\
          >@<span class=\"underline\">sanchit-gandhi</span></a></span>\n\n\t</span></span></p>\n"
        raw: cc @sanchit-gandhi
        updatedAt: '2022-07-28T15:13:48.344Z'
      numEdits: 0
      reactions: []
    id: 62e2a7ac3a616d16e2f6bbf3
    type: comment
  author: lysandre
  content: cc @sanchit-gandhi
  created_at: 2022-07-28 14:13:48+00:00
  edited: false
  hidden: false
  id: 62e2a7ac3a616d16e2f6bbf3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2022-07-28T16:20:30.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: "<p>Thanks for the catch <span data-props=\"{&quot;user&quot;:&quot;andreagasparini&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/andreagasparini\"\
          >@<span class=\"underline\">andreagasparini</span></a></span>\n\n\t</span></span>!\
          \ I'll run the updated script to verify the results. If they match we can\
          \ merge \U0001F4AA I'll also look into updating the other W2V2-based models\
          \ that share this example script bug.</p>\n"
        raw: "Thanks for the catch @andreagasparini! I'll run the updated script to\
          \ verify the results. If they match we can merge \U0001F4AA I'll also look\
          \ into updating the other W2V2-based models that share this example script\
          \ bug."
        updatedAt: '2022-07-28T16:20:30.564Z'
      numEdits: 0
      reactions: []
    id: 62e2b74e3a616d16e2f73fe1
    type: comment
  author: sanchit-gandhi
  content: "Thanks for the catch @andreagasparini! I'll run the updated script to\
    \ verify the results. If they match we can merge \U0001F4AA I'll also look into\
    \ updating the other W2V2-based models that share this example script bug."
  created_at: 2022-07-28 15:20:30+00:00
  edited: false
  hidden: false
  id: 62e2b74e3a616d16e2f73fe1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2022-07-28T17:28:53.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: '<p>Thanks for the bug fix - I can verify that the script works and
          that I get the same results. I would advocate for keeping the change in
          the evaluation script (fixing the <code>TypeError</code> in L113) but discarding
          the ones that update the WER metrics (L27, 41, 116). The reason being that
          the Wav2Vec2 paper and "official" results are two 1 decimal place (1.9/3.9),
          and it is the convention in speech literature is to quote WER results to
          1 decimal place (WERs of 1.9/3.9 vs 1.86/3.88). Keeping the results to 1
          dp. Note that by quoting to 1 d.p., we leave at most a 0.05% uncertainty
          in our WER metrics, which is tiny for all intensive purposes!</p>

          <p>Hope that makes sense! Let me know if you have any questions!</p>

          '
        raw: 'Thanks for the bug fix - I can verify that the script works and that
          I get the same results. I would advocate for keeping the change in the evaluation
          script (fixing the `TypeError` in L113) but discarding the ones that update
          the WER metrics (L27, 41, 116). The reason being that the Wav2Vec2 paper
          and "official" results are two 1 decimal place (1.9/3.9), and it is the
          convention in speech literature is to quote WER results to 1 decimal place
          (WERs of 1.9/3.9 vs 1.86/3.88). Keeping the results to 1 dp. Note that by
          quoting to 1 d.p., we leave at most a 0.05% uncertainty in our WER metrics,
          which is tiny for all intensive purposes!


          Hope that makes sense! Let me know if you have any questions!'
        updatedAt: '2022-07-28T17:28:53.372Z'
      numEdits: 0
      reactions: []
    id: 62e2c755fb4a692673b60d28
    type: comment
  author: sanchit-gandhi
  content: 'Thanks for the bug fix - I can verify that the script works and that I
    get the same results. I would advocate for keeping the change in the evaluation
    script (fixing the `TypeError` in L113) but discarding the ones that update the
    WER metrics (L27, 41, 116). The reason being that the Wav2Vec2 paper and "official"
    results are two 1 decimal place (1.9/3.9), and it is the convention in speech
    literature is to quote WER results to 1 decimal place (WERs of 1.9/3.9 vs 1.86/3.88).
    Keeping the results to 1 dp. Note that by quoting to 1 d.p., we leave at most
    a 0.05% uncertainty in our WER metrics, which is tiny for all intensive purposes!


    Hope that makes sense! Let me know if you have any questions!'
  created_at: 2022-07-28 16:28:53+00:00
  edited: false
  hidden: false
  id: 62e2c755fb4a692673b60d28
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
      fullname: Andrea Gasparini
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: andreagasparini
      type: user
    createdAt: '2022-08-09T15:45:20.000Z'
    data:
      edited: true
      editors:
      - andreagasparini
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1bb1f9cea617fbdee67e1f559c2a632f.svg
          fullname: Andrea Gasparini
          isHf: false
          isPro: false
          name: andreagasparini
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;sanchit-gandhi&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/sanchit-gandhi\"\
          >@<span class=\"underline\">sanchit-gandhi</span></a></span>\n\n\t</span></span>,\
          \ I agree with your reasons on keeping the results to 1 decimal place, but\
          \ at the same time it seems that on the <a href=\"https://huggingface.co/spaces/huggingface/hf-speech-bench\"\
          >Speech Bench</a> quite all the other models do not follow the same convention\
          \ for approximation (they seem to be quoted to 2 d.p.).</p>\n<p>Should we\
          \ change all the others or just this one, that's my dilemma \U0001F602</p>\n"
        raw: "Hi @sanchit-gandhi, I agree with your reasons on keeping the results\
          \ to 1 decimal place, but at the same time it seems that on the [Speech\
          \ Bench](https://huggingface.co/spaces/huggingface/hf-speech-bench) quite\
          \ all the other models do not follow the same convention for approximation\
          \ (they seem to be quoted to 2 d.p.).\n\nShould we change all the others\
          \ or just this one, that's my dilemma \U0001F602"
        updatedAt: '2022-08-09T15:47:24.937Z'
      numEdits: 5
      reactions: []
    id: 62f28110ab2853085b7ea745
    type: comment
  author: andreagasparini
  content: "Hi @sanchit-gandhi, I agree with your reasons on keeping the results to\
    \ 1 decimal place, but at the same time it seems that on the [Speech Bench](https://huggingface.co/spaces/huggingface/hf-speech-bench)\
    \ quite all the other models do not follow the same convention for approximation\
    \ (they seem to be quoted to 2 d.p.).\n\nShould we change all the others or just\
    \ this one, that's my dilemma \U0001F602"
  created_at: 2022-08-09 14:45:20+00:00
  edited: true
  hidden: false
  id: 62f28110ab2853085b7ea745
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2022-08-12T17:02:30.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: '<p>I see your point! I''d be in favour of quoting to 1 d.p. on the
          Speech Bench. We can open this as a discussion!</p>

          '
        raw: I see your point! I'd be in favour of quoting to 1 d.p. on the Speech
          Bench. We can open this as a discussion!
        updatedAt: '2022-08-12T17:02:30.517Z'
      numEdits: 0
      reactions: []
    id: 62f687a68465979f627b6dcc
    type: comment
  author: sanchit-gandhi
  content: I see your point! I'd be in favour of quoting to 1 d.p. on the Speech Bench.
    We can open this as a discussion!
  created_at: 2022-08-12 16:02:30+00:00
  edited: false
  hidden: false
  id: 62f687a68465979f627b6dcc
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2022-08-12T17:06:41.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: '<p>Speech bench discussion: <a href="https://huggingface.co/spaces/huggingface/hf-speech-bench/discussions/1">https://huggingface.co/spaces/huggingface/hf-speech-bench/discussions/1</a></p>

          '
        raw: 'Speech bench discussion: https://huggingface.co/spaces/huggingface/hf-speech-bench/discussions/1'
        updatedAt: '2022-08-12T17:06:41.648Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - andreagasparini
    id: 62f688a104e5e02f82ae26a6
    type: comment
  author: sanchit-gandhi
  content: 'Speech bench discussion: https://huggingface.co/spaces/huggingface/hf-speech-bench/discussions/1'
  created_at: 2022-08-12 16:06:41+00:00
  edited: false
  hidden: false
  id: 62f688a104e5e02f82ae26a6
  type: comment
is_pull_request: true
merge_commit_oid: null
num: 2
repo_id: facebook/wav2vec2-large-960h-lv60-self
repo_type: model
status: open
target_branch: refs/heads/main
title: Fixes evaluation instructions and updates WER scores
