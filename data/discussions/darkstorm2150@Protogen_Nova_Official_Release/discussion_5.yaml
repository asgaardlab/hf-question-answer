!!python/object:huggingface_hub.community.DiscussionWithDetails
author: KappaPrime
conflicting_files: null
created_at: 2023-04-05 16:53:58+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/916d3f2df9312cfbcd0f4e93b18fcdef.svg
      fullname: Kappa
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: KappaPrime
      type: user
    createdAt: '2023-04-05T17:53:58.000Z'
    data:
      edited: false
      editors:
      - KappaPrime
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/916d3f2df9312cfbcd0f4e93b18fcdef.svg
          fullname: Kappa
          isHf: false
          isPro: false
          name: KappaPrime
          type: user
        html: '<p>Got this error while trying to load the model</p>

          <p>Error verifying pickled file from G:...\models\Stable-diffusion\model-nova.ckpt:<br>Traceback
          (most recent call last):<br>  File "G:...\modules\safe.py", line 83, in
          check_pt<br>    with zipfile.ZipFile(filename) as z:<br>  File "C:\Users...\AppData\Local\Programs\Python\Python310\lib\zipfile.py",
          line 1267, in <strong>init</strong><br>    self._RealGetContents()<br>  File
          "C:\Users...\AppData\Local\Programs\Python\Python310\lib\zipfile.py", line
          1334, in _RealGetContents<br>    raise BadZipFile("File is not a zip file")<br>zipfile.BadZipFile:
          File is not a zip file</p>

          <p>During handling of the above exception, another exception occurred:</p>

          <p>Traceback (most recent call last):<br>  File "G:...\modules\safe.py",
          line 131, in load_with_extra<br>    check_pt(filename, extra_handler)<br>  File
          "G:...\modules\safe.py", line 98, in check_pt<br>    unpickler.load()<br>_pickle.UnpicklingError:
          could not find MARK</p>

          <p>-----&gt; !!!! The file is most likely corrupted !!!! &lt;-----<br>You
          can skip this check with --disable-safe-unpickle commandline argument, but
          that is not going to help you.</p>

          <p>Traceback (most recent call last):<br>  File "G:...\venv\lib\site-packages\gradio\routes.py",
          line 284, in run_predict<br>    output = await app.blocks.process_api(<br>  File
          "G:...\venv\lib\site-packages\gradio\blocks.py", line 982, in process_api<br>    result
          = await self.call_function(fn_index, inputs, iterator)<br>  File "G:...\venv\lib\site-packages\gradio\blocks.py",
          line 824, in call_function<br>    prediction = await anyio.to_thread.run_sync(<br>  File
          "G:...\venv\lib\site-packages\anyio\to_thread.py", line 31, in run_sync<br>    return
          await get_asynclib().run_sync_in_worker_thread(<br>  File "G:...\venv\lib\site-packages\anyio_backends_asyncio.py",
          line 937, in run_sync_in_worker_thread<br>    return await future<br>  File
          "G:...\venv\lib\site-packages\anyio_backends_asyncio.py", line 867, in run<br>    result
          = context.run(func, *args)<br>  File "G:...\modules\ui.py", line 1662, in
          <br>    fn=lambda value, k=k: run_settings_single(value, key=k),<br>  File
          "G:...\modules\ui.py", line 1504, in run_settings_single<br>    opts.data_labels[key].onchange()<br>  File
          "G:...\webui.py", line 41, in f<br>    res = func(*args, **kwargs)<br>  File
          "G:...\webui.py", line 83, in <br>    shared.opts.onchange("sd_model_checkpoint",
          wrap_queued_call(lambda: modules.sd_models.reload_model_weights()))<br>  File
          "G:...\modules\sd_models.py", line 295, in reload_model_weights<br>    load_model_weights(sd_model,
          checkpoint_info)<br>  File "G:...\modules\sd_models.py", line 184, in load_model_weights<br>    if
          "global_step" in pl_sd:<br>TypeError: argument of type ''NoneType'' is not
          iterable</p>

          <p>Is it because of recent changes to vae config?</p>

          '
        raw: "Got this error while trying to load the model\r\n\r\nError verifying\
          \ pickled file from G:\\...\\models\\Stable-diffusion\\model-nova.ckpt:\r\
          \nTraceback (most recent call last):\r\n  File \"G:\\...\\modules\\safe.py\"\
          , line 83, in check_pt\r\n    with zipfile.ZipFile(filename) as z:\r\n \
          \ File \"C:\\Users\\...\\AppData\\Local\\Programs\\Python\\Python310\\lib\\\
          zipfile.py\", line 1267, in __init__\r\n    self._RealGetContents()\r\n\
          \  File \"C:\\Users\\...\\AppData\\Local\\Programs\\Python\\Python310\\\
          lib\\zipfile.py\", line 1334, in _RealGetContents\r\n    raise BadZipFile(\"\
          File is not a zip file\")\r\nzipfile.BadZipFile: File is not a zip file\r\
          \n\r\nDuring handling of the above exception, another exception occurred:\r\
          \n\r\nTraceback (most recent call last):\r\n  File \"G:\\...\\modules\\\
          safe.py\", line 131, in load_with_extra\r\n    check_pt(filename, extra_handler)\r\
          \n  File \"G:\\...\\modules\\safe.py\", line 98, in check_pt\r\n    unpickler.load()\r\
          \n_pickle.UnpicklingError: could not find MARK\r\n\r\n-----> !!!! The file\
          \ is most likely corrupted !!!! <-----\r\nYou can skip this check with --disable-safe-unpickle\
          \ commandline argument, but that is not going to help you.\r\n\r\n\r\nTraceback\
          \ (most recent call last):\r\n  File \"G:\\...\\venv\\lib\\site-packages\\\
          gradio\\routes.py\", line 284, in run_predict\r\n    output = await app.blocks.process_api(\r\
          \n  File \"G:\\...\\venv\\lib\\site-packages\\gradio\\blocks.py\", line\
          \ 982, in process_api\r\n    result = await self.call_function(fn_index,\
          \ inputs, iterator)\r\n  File \"G:\\...\\venv\\lib\\site-packages\\gradio\\\
          blocks.py\", line 824, in call_function\r\n    prediction = await anyio.to_thread.run_sync(\r\
          \n  File \"G:\\...\\venv\\lib\\site-packages\\anyio\\to_thread.py\", line\
          \ 31, in run_sync\r\n    return await get_asynclib().run_sync_in_worker_thread(\r\
          \n  File \"G:\\...\\venv\\lib\\site-packages\\anyio\\_backends\\_asyncio.py\"\
          , line 937, in run_sync_in_worker_thread\r\n    return await future\r\n\
          \  File \"G:\\...\\venv\\lib\\site-packages\\anyio\\_backends\\_asyncio.py\"\
          , line 867, in run\r\n    result = context.run(func, *args)\r\n  File \"\
          G:\\...\\modules\\ui.py\", line 1662, in <lambda>\r\n    fn=lambda value,\
          \ k=k: run_settings_single(value, key=k),\r\n  File \"G:\\...\\modules\\\
          ui.py\", line 1504, in run_settings_single\r\n    opts.data_labels[key].onchange()\r\
          \n  File \"G:\\...\\webui.py\", line 41, in f\r\n    res = func(*args, **kwargs)\r\
          \n  File \"G:\\...\\webui.py\", line 83, in <lambda>\r\n    shared.opts.onchange(\"\
          sd_model_checkpoint\", wrap_queued_call(lambda: modules.sd_models.reload_model_weights()))\r\
          \n  File \"G:\\...\\modules\\sd_models.py\", line 295, in reload_model_weights\r\
          \n    load_model_weights(sd_model, checkpoint_info)\r\n  File \"G:\\...\\\
          modules\\sd_models.py\", line 184, in load_model_weights\r\n    if \"global_step\"\
          \ in pl_sd:\r\nTypeError: argument of type 'NoneType' is not iterable\r\n\
          \r\nIs it because of recent changes to vae config?"
        updatedAt: '2023-04-05T17:53:58.800Z'
      numEdits: 0
      reactions: []
    id: 642db5b62a10ffb687cb09f6
    type: comment
  author: KappaPrime
  content: "Got this error while trying to load the model\r\n\r\nError verifying pickled\
    \ file from G:\\...\\models\\Stable-diffusion\\model-nova.ckpt:\r\nTraceback (most\
    \ recent call last):\r\n  File \"G:\\...\\modules\\safe.py\", line 83, in check_pt\r\
    \n    with zipfile.ZipFile(filename) as z:\r\n  File \"C:\\Users\\...\\AppData\\\
    Local\\Programs\\Python\\Python310\\lib\\zipfile.py\", line 1267, in __init__\r\
    \n    self._RealGetContents()\r\n  File \"C:\\Users\\...\\AppData\\Local\\Programs\\\
    Python\\Python310\\lib\\zipfile.py\", line 1334, in _RealGetContents\r\n    raise\
    \ BadZipFile(\"File is not a zip file\")\r\nzipfile.BadZipFile: File is not a\
    \ zip file\r\n\r\nDuring handling of the above exception, another exception occurred:\r\
    \n\r\nTraceback (most recent call last):\r\n  File \"G:\\...\\modules\\safe.py\"\
    , line 131, in load_with_extra\r\n    check_pt(filename, extra_handler)\r\n  File\
    \ \"G:\\...\\modules\\safe.py\", line 98, in check_pt\r\n    unpickler.load()\r\
    \n_pickle.UnpicklingError: could not find MARK\r\n\r\n-----> !!!! The file is\
    \ most likely corrupted !!!! <-----\r\nYou can skip this check with --disable-safe-unpickle\
    \ commandline argument, but that is not going to help you.\r\n\r\n\r\nTraceback\
    \ (most recent call last):\r\n  File \"G:\\...\\venv\\lib\\site-packages\\gradio\\\
    routes.py\", line 284, in run_predict\r\n    output = await app.blocks.process_api(\r\
    \n  File \"G:\\...\\venv\\lib\\site-packages\\gradio\\blocks.py\", line 982, in\
    \ process_api\r\n    result = await self.call_function(fn_index, inputs, iterator)\r\
    \n  File \"G:\\...\\venv\\lib\\site-packages\\gradio\\blocks.py\", line 824, in\
    \ call_function\r\n    prediction = await anyio.to_thread.run_sync(\r\n  File\
    \ \"G:\\...\\venv\\lib\\site-packages\\anyio\\to_thread.py\", line 31, in run_sync\r\
    \n    return await get_asynclib().run_sync_in_worker_thread(\r\n  File \"G:\\\
    ...\\venv\\lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 937, in run_sync_in_worker_thread\r\
    \n    return await future\r\n  File \"G:\\...\\venv\\lib\\site-packages\\anyio\\\
    _backends\\_asyncio.py\", line 867, in run\r\n    result = context.run(func, *args)\r\
    \n  File \"G:\\...\\modules\\ui.py\", line 1662, in <lambda>\r\n    fn=lambda\
    \ value, k=k: run_settings_single(value, key=k),\r\n  File \"G:\\...\\modules\\\
    ui.py\", line 1504, in run_settings_single\r\n    opts.data_labels[key].onchange()\r\
    \n  File \"G:\\...\\webui.py\", line 41, in f\r\n    res = func(*args, **kwargs)\r\
    \n  File \"G:\\...\\webui.py\", line 83, in <lambda>\r\n    shared.opts.onchange(\"\
    sd_model_checkpoint\", wrap_queued_call(lambda: modules.sd_models.reload_model_weights()))\r\
    \n  File \"G:\\...\\modules\\sd_models.py\", line 295, in reload_model_weights\r\
    \n    load_model_weights(sd_model, checkpoint_info)\r\n  File \"G:\\...\\modules\\\
    sd_models.py\", line 184, in load_model_weights\r\n    if \"global_step\" in pl_sd:\r\
    \nTypeError: argument of type 'NoneType' is not iterable\r\n\r\nIs it because\
    \ of recent changes to vae config?"
  created_at: 2023-04-05 16:53:58+00:00
  edited: false
  hidden: false
  id: 642db5b62a10ffb687cb09f6
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 5
repo_id: darkstorm2150/Protogen_Nova_Official_Release
repo_type: model
status: open
target_branch: null
title: Model not loading in automatic1111 ui
