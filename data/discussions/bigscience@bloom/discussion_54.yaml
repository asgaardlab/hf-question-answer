!!python/object:huggingface_hub.community.DiscussionWithDetails
author: mayank31398
conflicting_files: null
created_at: 2022-07-18 20:33:12+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
      fullname: Mayank Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mayank31398
      type: user
    createdAt: '2022-07-18T21:33:12.000Z'
    data:
      edited: false
      editors:
      - mayank31398
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
          fullname: Mayank Mishra
          isHf: false
          isPro: false
          name: mayank31398
          type: user
        html: "<p>I wanted to know where I can download the DeepSpeed checkpoints\
          \ for finetuning the BLOOM model.<br>As far as I know the model provided\
          \ in HuggingFace has been reshaped from (TP = 8 x PP = 6) to (TP = 8).<br>Even\
          \ if one could convert it to the original form from the HF checkpoint, having\
          \ the original optimizer would be really helpful.</p>\n<p>If anyone has\
          \ any idea where to find the DeepSpeed checkpoints, please point me to it.\
          \ \U0001F917</p>\n"
        raw: "I wanted to know where I can download the DeepSpeed checkpoints for\
          \ finetuning the BLOOM model.\r\nAs far as I know the model provided in\
          \ HuggingFace has been reshaped from (TP = 8 x PP = 6) to (TP = 8).\r\n\
          Even if one could convert it to the original form from the HF checkpoint,\
          \ having the original optimizer would be really helpful.\r\n\r\nIf anyone\
          \ has any idea where to find the DeepSpeed checkpoints, please point me\
          \ to it. \U0001F917"
        updatedAt: '2022-07-18T21:33:12.446Z'
      numEdits: 0
      reactions: []
    id: 62d5d19805461e9459d05a31
    type: comment
  author: mayank31398
  content: "I wanted to know where I can download the DeepSpeed checkpoints for finetuning\
    \ the BLOOM model.\r\nAs far as I know the model provided in HuggingFace has been\
    \ reshaped from (TP = 8 x PP = 6) to (TP = 8).\r\nEven if one could convert it\
    \ to the original form from the HF checkpoint, having the original optimizer would\
    \ be really helpful.\r\n\r\nIf anyone has any idea where to find the DeepSpeed\
    \ checkpoints, please point me to it. \U0001F917"
  created_at: 2022-07-18 20:33:12+00:00
  edited: false
  hidden: false
  id: 62d5d19805461e9459d05a31
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2022-07-20T07:34:43.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;mayank31398&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/mayank31398\"\
          >@<span class=\"underline\">mayank31398</span></a></span>\n\n\t</span></span><br>Thank\
          \ you for your message !<br>I have just uploaded the latest DeepSpeed checkpoints\
          \ here: <a href=\"https://huggingface.co/bigscience/bloom-optimizer-states\"\
          >https://huggingface.co/bigscience/bloom-optimizer-states</a>  (2.3 TB),\
          \ they are from the model we are using on the inference API (global step\
          \ 95000)<br>If you need more checkpoints, from early global steps please\
          \ do let us know by opening an issue on the mentioned repo so that we can\
          \ take care of that<br>Thanks a lot \U0001F917</p>\n"
        raw: "Hi @mayank31398 \nThank you for your message !\nI have just uploaded\
          \ the latest DeepSpeed checkpoints here: https://huggingface.co/bigscience/bloom-optimizer-states\
          \  (2.3 TB), they are from the model we are using on the inference API (global\
          \ step 95000)\nIf you need more checkpoints, from early global steps please\
          \ do let us know by opening an issue on the mentioned repo so that we can\
          \ take care of that\nThanks a lot \U0001F917"
        updatedAt: '2022-07-20T07:34:43.849Z'
      numEdits: 0
      reactions:
      - count: 3
        reaction: "\u2764\uFE0F"
        users:
        - cakiki
        - mayank31398
        - zsc
    id: 62d7b013720a579b3bd63f3c
    type: comment
  author: ybelkada
  content: "Hi @mayank31398 \nThank you for your message !\nI have just uploaded the\
    \ latest DeepSpeed checkpoints here: https://huggingface.co/bigscience/bloom-optimizer-states\
    \  (2.3 TB), they are from the model we are using on the inference API (global\
    \ step 95000)\nIf you need more checkpoints, from early global steps please do\
    \ let us know by opening an issue on the mentioned repo so that we can take care\
    \ of that\nThanks a lot \U0001F917"
  created_at: 2022-07-20 06:34:43+00:00
  edited: false
  hidden: false
  id: 62d7b013720a579b3bd63f3c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
      fullname: Mayank Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mayank31398
      type: user
    createdAt: '2022-07-20T10:12:42.000Z'
    data:
      edited: false
      editors:
      - mayank31398
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
          fullname: Mayank Mishra
          isHf: false
          isPro: false
          name: mayank31398
          type: user
        html: "<p>Thanks <span data-props=\"{&quot;user&quot;:&quot;ybelkada&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/ybelkada\"\
          >@<span class=\"underline\">ybelkada</span></a></span>\n\n\t</span></span>\
          \ , these checkpoints will be really helpful. Also, is there a way to convert\
          \ HF checkpoints to DeepSpeed?<br>I see that there is a script to convert\
          \ DeepSpeed checkpoints to HF on the Megatron-DeepSpeed repo. If there exists\
          \ a way to invert this, then that will be really helpful.</p>\n"
        raw: 'Thanks @ybelkada , these checkpoints will be really helpful. Also, is
          there a way to convert HF checkpoints to DeepSpeed?

          I see that there is a script to convert DeepSpeed checkpoints to HF on the
          Megatron-DeepSpeed repo. If there exists a way to invert this, then that
          will be really helpful.'
        updatedAt: '2022-07-20T10:12:42.544Z'
      numEdits: 0
      reactions: []
    id: 62d7d51af830483a7313fbb8
    type: comment
  author: mayank31398
  content: 'Thanks @ybelkada , these checkpoints will be really helpful. Also, is
    there a way to convert HF checkpoints to DeepSpeed?

    I see that there is a script to convert DeepSpeed checkpoints to HF on the Megatron-DeepSpeed
    repo. If there exists a way to invert this, then that will be really helpful.'
  created_at: 2022-07-20 09:12:42+00:00
  edited: false
  hidden: false
  id: 62d7d51af830483a7313fbb8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2022-07-20T10:22:19.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: '<p>No worries!<br>As far as I know <a rel="nofollow" href="https://github.com/bigscience-workshop/bigscience/blob/thomas/convert_opt_checkpoint_from_transformers_to_meg_ds/evaluation/results/opt/convert_transformers_checkpoint_to_meg_ds.py">there
          is a script</a> to convert HF model into DS format but the script is a bit
          hacky and you''ll need to adapt it for BLOOM (we tried it for OPT only).
          You can probably start from this script and just adapt it with the correct
          key names ;)<br>But the repo I have attached you already contains the DS
          converted models + optimizer states, just out of curiosity may I ask you
          why you would need to convert back the model into DS format?<br>Thanks a
          lot!</p>

          '
        raw: "No worries!\nAs far as I know [there is a script](https://github.com/bigscience-workshop/bigscience/blob/thomas/convert_opt_checkpoint_from_transformers_to_meg_ds/evaluation/results/opt/convert_transformers_checkpoint_to_meg_ds.py)\
          \ to convert HF model into DS format but the script is a bit hacky and you'll\
          \ need to adapt it for BLOOM (we tried it for OPT only). You can probably\
          \ start from this script and just adapt it with the correct key names ;)\
          \ \nBut the repo I have attached you already contains the DS converted models\
          \ + optimizer states, just out of curiosity may I ask you why you would\
          \ need to convert back the model into DS format? \nThanks a lot!"
        updatedAt: '2022-07-20T10:22:19.344Z'
      numEdits: 0
      reactions: []
    id: 62d7d75b63583ad7bf1e2533
    type: comment
  author: ybelkada
  content: "No worries!\nAs far as I know [there is a script](https://github.com/bigscience-workshop/bigscience/blob/thomas/convert_opt_checkpoint_from_transformers_to_meg_ds/evaluation/results/opt/convert_transformers_checkpoint_to_meg_ds.py)\
    \ to convert HF model into DS format but the script is a bit hacky and you'll\
    \ need to adapt it for BLOOM (we tried it for OPT only). You can probably start\
    \ from this script and just adapt it with the correct key names ;) \nBut the repo\
    \ I have attached you already contains the DS converted models + optimizer states,\
    \ just out of curiosity may I ask you why you would need to convert back the model\
    \ into DS format? \nThanks a lot!"
  created_at: 2022-07-20 09:22:19+00:00
  edited: false
  hidden: false
  id: 62d7d75b63583ad7bf1e2533
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
      fullname: Mayank Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mayank31398
      type: user
    createdAt: '2022-07-20T10:45:54.000Z'
    data:
      edited: true
      editors:
      - mayank31398
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
          fullname: Mayank Mishra
          isHf: false
          isPro: false
          name: mayank31398
          type: user
        html: "<p>No particular reason <span data-props=\"{&quot;user&quot;:&quot;ybelkada&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/ybelkada\"\
          >@<span class=\"underline\">ybelkada</span></a></span>\n\n\t</span></span>\
          \ . I just wanted to know if one wanted to convert HF to DS. Then how would\
          \ one do it.<br>Also, I had a question: any particular reason why BigScience\
          \ uses ZeRO-DP instead of FSDP in PyTorch?<br>Is the reason just that, Megatron-DeepSpeed\
          \ is readily available from Microsoft?</p>\n<p>Also, thanks a lot for providing\
          \ the full model checkpoints. This would be really helpful to the folks\
          \ looking at finetuning BLOOM 175B</p>\n"
        raw: 'No particular reason @ybelkada . I just wanted to know if one wanted
          to convert HF to DS. Then how would one do it.

          Also, I had a question: any particular reason why BigScience uses ZeRO-DP
          instead of FSDP in PyTorch?

          Is the reason just that, Megatron-DeepSpeed is readily available from Microsoft?


          Also, thanks a lot for providing the full model checkpoints. This would
          be really helpful to the folks looking at finetuning BLOOM 175B'
        updatedAt: '2022-07-20T10:49:18.201Z'
      numEdits: 1
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - ybelkada
    id: 62d7dce243df7719860b5336
    type: comment
  author: mayank31398
  content: 'No particular reason @ybelkada . I just wanted to know if one wanted to
    convert HF to DS. Then how would one do it.

    Also, I had a question: any particular reason why BigScience uses ZeRO-DP instead
    of FSDP in PyTorch?

    Is the reason just that, Megatron-DeepSpeed is readily available from Microsoft?


    Also, thanks a lot for providing the full model checkpoints. This would be really
    helpful to the folks looking at finetuning BLOOM 175B'
  created_at: 2022-07-20 09:45:54+00:00
  edited: true
  hidden: false
  id: 62d7dce243df7719860b5336
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2022-07-20T10:49:02.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: "<p>Okay got it thanks !<br>I think that it would be a nice contribution\
          \ indeed, but the since HF models have very different key names across different\
          \ models (for eg OPT has very different key names than BLOOM) we would maybe\
          \ need a single script per model class.<br>Regarding your second question\
          \ I will probably let <span data-props=\"{&quot;user&quot;:&quot;stas&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/stas\"\
          >@<span class=\"underline\">stas</span></a></span>\n\n\t</span></span> answer\
          \ that one ;)<br>Thanks again!</p>\n"
        raw: "Okay got it thanks ! \nI think that it would be a nice contribution\
          \ indeed, but the since HF models have very different key names across different\
          \ models (for eg OPT has very different key names than BLOOM) we would maybe\
          \ need a single script per model class.\nRegarding your second question\
          \ I will probably let @stas answer that one ;) \nThanks again!"
        updatedAt: '2022-07-20T10:49:02.470Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\u2764\uFE0F"
        users:
        - mayank31398
    id: 62d7dd9e4c44cb22510c59ad
    type: comment
  author: ybelkada
  content: "Okay got it thanks ! \nI think that it would be a nice contribution indeed,\
    \ but the since HF models have very different key names across different models\
    \ (for eg OPT has very different key names than BLOOM) we would maybe need a single\
    \ script per model class.\nRegarding your second question I will probably let\
    \ @stas answer that one ;) \nThanks again!"
  created_at: 2022-07-20 09:49:02+00:00
  edited: false
  hidden: false
  id: 62d7dd9e4c44cb22510c59ad
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
      fullname: Mayank Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mayank31398
      type: user
    createdAt: '2022-07-20T10:49:26.000Z'
    data:
      edited: false
      editors:
      - mayank31398
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
          fullname: Mayank Mishra
          isHf: false
          isPro: false
          name: mayank31398
          type: user
        html: '<p>Closing this issue.</p>

          '
        raw: Closing this issue.
        updatedAt: '2022-07-20T10:49:26.351Z'
      numEdits: 0
      reactions: []
    id: 62d7ddb69ccca9c822d1d9ce
    type: comment
  author: mayank31398
  content: Closing this issue.
  created_at: 2022-07-20 09:49:26+00:00
  edited: false
  hidden: false
  id: 62d7ddb69ccca9c822d1d9ce
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62cd5057674cdb524450093d/Kc2vqHdAc96lAJjkLf1gB.jpeg?w=200&h=200&f=face
      fullname: Mayank Mishra
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mayank31398
      type: user
    createdAt: '2022-07-20T10:49:29.000Z'
    data:
      status: closed
    id: 62d7ddb9f6e8ba66107c2e40
    type: status-change
  author: mayank31398
  created_at: 2022-07-20 09:49:29+00:00
  id: 62d7ddb9f6e8ba66107c2e40
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 54
repo_id: bigscience/bloom
repo_type: model
status: closed
target_branch: null
title: Finetuning BLOOM 175-B
