!!python/object:huggingface_hub.community.DiscussionWithDetails
author: BlenderSushi
conflicting_files: null
created_at: 2023-12-21 00:27:58+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/4701d41ae065f8c54618b843ae9bc669.svg
      fullname: Jimmy Gunawan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: BlenderSushi
      type: user
    createdAt: '2023-12-21T00:27:58.000Z'
    data:
      edited: false
      editors:
      - BlenderSushi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3466651141643524
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/4701d41ae065f8c54618b843ae9bc669.svg
          fullname: Jimmy Gunawan
          isHf: false
          isPro: false
          name: BlenderSushi
          type: user
        html: '<p>/Users/myname/MLX/mlx-examples/zephyr-7b-beta<br>[INFO] Loading
          model from disk.<br>[INFO] Starting generation...<br>My name islibc++abi:
          terminating due to uncaught exception of type std::runtime_error: [malloc_or_wait]
          Unable to allocate 524288000 bytes.<br>zsh: abort      python llms/mistral/mistral.py
          --model_path zephyr-7b-beta --prompt</p>

          '
        raw: "/Users/myname/MLX/mlx-examples/zephyr-7b-beta\r\n[INFO] Loading model\
          \ from disk.\r\n[INFO] Starting generation...\r\nMy name islibc++abi: terminating\
          \ due to uncaught exception of type std::runtime_error: [malloc_or_wait]\
          \ Unable to allocate 524288000 bytes.\r\nzsh: abort      python llms/mistral/mistral.py\
          \ --model_path zephyr-7b-beta --prompt"
        updatedAt: '2023-12-21T00:27:58.824Z'
      numEdits: 0
      reactions: []
    id: 6583868eee15e3c7fcdf51ed
    type: comment
  author: BlenderSushi
  content: "/Users/myname/MLX/mlx-examples/zephyr-7b-beta\r\n[INFO] Loading model\
    \ from disk.\r\n[INFO] Starting generation...\r\nMy name islibc++abi: terminating\
    \ due to uncaught exception of type std::runtime_error: [malloc_or_wait] Unable\
    \ to allocate 524288000 bytes.\r\nzsh: abort      python llms/mistral/mistral.py\
    \ --model_path zephyr-7b-beta --prompt"
  created_at: 2023-12-21 00:27:58+00:00
  edited: false
  hidden: false
  id: 6583868eee15e3c7fcdf51ed
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
      fullname: Alvaro Bartolome
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: alvarobartt
      type: user
    createdAt: '2023-12-21T07:40:03.000Z'
    data:
      edited: false
      editors:
      - alvarobartt
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9153813719749451
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
          fullname: Alvaro Bartolome
          isHf: false
          isPro: false
          name: alvarobartt
          type: user
        html: "<p>Hmm weird it\u2019s crashing with 32GB are you monitoring the MPS\
          \ usage?</p>\n"
        raw: "Hmm weird it\u2019s crashing with 32GB are you monitoring the MPS usage?"
        updatedAt: '2023-12-21T07:40:03.700Z'
      numEdits: 0
      reactions: []
    id: 6583ebd36b60651e010d1728
    type: comment
  author: alvarobartt
  content: "Hmm weird it\u2019s crashing with 32GB are you monitoring the MPS usage?"
  created_at: 2023-12-21 07:40:03+00:00
  edited: false
  hidden: false
  id: 6583ebd36b60651e010d1728
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
      fullname: Alvaro Bartolome
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: alvarobartt
      type: user
    createdAt: '2023-12-21T08:57:10.000Z'
    data:
      edited: false
      editors:
      - alvarobartt
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9000682830810547
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
          fullname: Alvaro Bartolome
          isHf: false
          isPro: false
          name: alvarobartt
          type: user
        html: "<p>I've doubled checked in a Mac with M2 Pro and 32GB and it's also\
          \ crashing apparently, while <a href=\"https://huggingface.co/mlx-community/Mistral-7B-Instruct-v0.2\"\
          >https://huggingface.co/mlx-community/Mistral-7B-Instruct-v0.2</a> works\
          \ fine, the issue is while generating the response, as the model does fit\
          \ but the generation fails due to missing memory, not sure if there is any\
          \ quick fix for it? I could reproduce the same issue using <a href=\"https://huggingface.co/mlx-community/mistral-7B-v0.1/tree/main\"\
          >https://huggingface.co/mlx-community/mistral-7B-v0.1/tree/main</a> in M2\
          \ Pro 32GB</p>\n<p>cc <span data-props=\"{&quot;user&quot;:&quot;pcuenq&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/pcuenq\"\
          >@<span class=\"underline\">pcuenq</span></a></span>\n\n\t</span></span>\
          \ </p>\n"
        raw: 'I''ve doubled checked in a Mac with M2 Pro and 32GB and it''s also crashing
          apparently, while https://huggingface.co/mlx-community/Mistral-7B-Instruct-v0.2
          works fine, the issue is while generating the response, as the model does
          fit but the generation fails due to missing memory, not sure if there is
          any quick fix for it? I could reproduce the same issue using https://huggingface.co/mlx-community/mistral-7B-v0.1/tree/main
          in M2 Pro 32GB


          cc @pcuenq '
        updatedAt: '2023-12-21T08:57:10.996Z'
      numEdits: 0
      reactions: []
    id: 6583fde6aa85c512dad26138
    type: comment
  author: alvarobartt
  content: 'I''ve doubled checked in a Mac with M2 Pro and 32GB and it''s also crashing
    apparently, while https://huggingface.co/mlx-community/Mistral-7B-Instruct-v0.2
    works fine, the issue is while generating the response, as the model does fit
    but the generation fails due to missing memory, not sure if there is any quick
    fix for it? I could reproduce the same issue using https://huggingface.co/mlx-community/mistral-7B-v0.1/tree/main
    in M2 Pro 32GB


    cc @pcuenq '
  created_at: 2023-12-21 08:57:10+00:00
  edited: false
  hidden: false
  id: 6583fde6aa85c512dad26138
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
      fullname: Alvaro Bartolome
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: alvarobartt
      type: user
    createdAt: '2023-12-28T08:52:57.000Z'
    data:
      edited: false
      editors:
      - alvarobartt
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9917517900466919
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
          fullname: Alvaro Bartolome
          isHf: false
          isPro: false
          name: alvarobartt
          type: user
        html: "<p>It's already solved <span data-props=\"{&quot;user&quot;:&quot;BlenderSushi&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/BlenderSushi\"\
          >@<span class=\"underline\">BlenderSushi</span></a></span>\n\n\t</span></span>,\
          \ I think it was due to an issue with the key mapping when converting the\
          \ weights, but that should be resolved now! </p>\n"
        raw: 'It''s already solved @BlenderSushi, I think it was due to an issue with
          the key mapping when converting the weights, but that should be resolved
          now! '
        updatedAt: '2023-12-28T08:52:57.819Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\u2764\uFE0F"
        users:
        - pcuenq
      relatedEventId: 658d37691260e506f1844394
    id: 658d37691260e506f1844390
    type: comment
  author: alvarobartt
  content: 'It''s already solved @BlenderSushi, I think it was due to an issue with
    the key mapping when converting the weights, but that should be resolved now! '
  created_at: 2023-12-28 08:52:57+00:00
  edited: false
  hidden: false
  id: 658d37691260e506f1844390
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
      fullname: Alvaro Bartolome
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: alvarobartt
      type: user
    createdAt: '2023-12-28T08:52:57.000Z'
    data:
      status: closed
    id: 658d37691260e506f1844394
    type: status-change
  author: alvarobartt
  created_at: 2023-12-28 08:52:57+00:00
  id: 658d37691260e506f1844394
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: mlx-community/zephyr-7b-beta
repo_type: model
status: closed
target_branch: null
title: M2 32 GB keeps crashing unfortunately. Not sure why.
