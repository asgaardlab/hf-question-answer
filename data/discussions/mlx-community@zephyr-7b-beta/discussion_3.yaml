!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Klaatu
conflicting_files: null
created_at: 2023-12-21 02:17:14+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/7bf3ad2ea4d0ef7b07489d03e05ca73b.svg
      fullname: Eric Suchanek
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: Klaatu
      type: user
    createdAt: '2023-12-21T02:17:14.000Z'
    data:
      edited: false
      editors:
      - Klaatu
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.49954620003700256
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/7bf3ad2ea4d0ef7b07489d03e05ca73b.svg
          fullname: Eric Suchanek
          isHf: false
          isPro: false
          name: Klaatu
          type: user
        html: '<p>Hi all,</p>

          <h1 id="love-the-mlx-work-and-have-been-getting-it-running-on-my-m3-max-im-getting-some-strange-results-though-heres-the-testpy-run">Love
          the MLX work and have been getting it running on my M3 Max. I''m getting
          some strange results though. Here''s the test.py run:</h1>

          <h2 id="fail-test_generate-maintestmistral">FAIL: test_generate (<strong>main</strong>.TestMistral)</h2>

          <p>Traceback (most recent call last):<br>  File "/Users/egs/repos/mlx-examples/llms/mistral/test.py",
          line 75, in test_generate<br>    self.assertEqual(tokens, expected)<br>AssertionError:
          Lists differ: [302, 272, 16762, 9588, 12807, 2867, 2135, 28723, 851[116
          chars] 297] != [302, 272, 11843, 11837, 1587, 28723, 851, 349, 865, [108
          chars], 13]</p>

          <p>First differing element 2:<br>16762<br>11843</p>

          <p>  [302,<br>   272,</p>

          <ul>

          <li>16762,</li>

          <li>9588,</li>

          </ul>

          <ul>

          <li>11843,</li>

          <li>11837,</li>

          </ul>

          <ul>

          <li>12807,<br>?   ^ -</li>

          </ul>

          <ul>

          <li>1587,<br>?   ^</li>

          </ul>

          <ul>

          <li>2867,</li>

          <li>2135,<br>28723,<br>851,<br>349,<br>865,<br>264,<br>1369,<br>28723,<br>13,<br>13,</li>

          </ul>

          <ul>

          <li>3381,</li>

          <li>456,</li>

          <li>654,</li>

          </ul>

          <ul>

          <li>1014,</li>

          <li>16762,</li>

          <li>9588,</li>

          <li>12807,</li>

          <li>2867,</li>

          <li>2135,</li>

          <li>325,</li>

          <li>28749,</li>

          <li>8340,</li>

          <li>28731,</li>

          <li>403,<br>264,</li>

          <li>1587,</li>

          <li>297]</li>

          </ul>

          <ul>

          <li>1353,</li>

          <li>11843,</li>

          <li>28725,</li>

          <li>368,</li>

          <li>682,</li>

          <li>347,</li>

          <li>2240,</li>

          <li>767,</li>

          <li>298,</li>

          <li>511,</li>

          <li>28723,</li>

          <li>13]</li>

          </ul>

          <hr>

          <p>Ran 2 tests in 7.400s</p>

          <p>FAILED (failures=1)</p>

          <p>Any thoughts?</p>

          '
        raw: "Hi all,\r\n\r\nLove the MLX work and have been getting it running on\
          \ my M3 Max. I'm getting some strange results though. Here's the test.py\
          \ run:\r\n======================================================================\r\
          \nFAIL: test_generate (__main__.TestMistral)\r\n----------------------------------------------------------------------\r\
          \nTraceback (most recent call last):\r\n  File \"/Users/egs/repos/mlx-examples/llms/mistral/test.py\"\
          , line 75, in test_generate\r\n    self.assertEqual(tokens, expected)\r\n\
          AssertionError: Lists differ: [302, 272, 16762, 9588, 12807, 2867, 2135,\
          \ 28723, 851[116 chars] 297] != [302, 272, 11843, 11837, 1587, 28723, 851,\
          \ 349, 865, [108 chars], 13]\r\n\r\nFirst differing element 2:\r\n16762\r\
          \n11843\r\n\r\n  [302,\r\n   272,\r\n-  16762,\r\n-  9588,\r\n+  11843,\r\
          \n+  11837,\r\n-  12807,\r\n?   ^ -\r\n\r\n+  1587,\r\n?   ^\r\n\r\n-  2867,\r\
          \n-  2135,\r\n   28723,\r\n   851,\r\n   349,\r\n   865,\r\n   264,\r\n\
          \   1369,\r\n   28723,\r\n   13,\r\n   13,\r\n+  3381,\r\n+  456,\r\n+ \
          \ 654,\r\n-  1014,\r\n-  16762,\r\n-  9588,\r\n-  12807,\r\n-  2867,\r\n\
          -  2135,\r\n-  325,\r\n-  28749,\r\n-  8340,\r\n-  28731,\r\n-  403,\r\n\
          \   264,\r\n-  1587,\r\n-  297]\r\n+  1353,\r\n+  11843,\r\n+  28725,\r\n\
          +  368,\r\n+  682,\r\n+  347,\r\n+  2240,\r\n+  767,\r\n+  298,\r\n+  511,\r\
          \n+  28723,\r\n+  13]\r\n\r\n----------------------------------------------------------------------\r\
          \nRan 2 tests in 7.400s\r\n\r\nFAILED (failures=1)\r\n\r\nAny thoughts?"
        updatedAt: '2023-12-21T02:17:14.795Z'
      numEdits: 0
      reactions: []
    id: 6583a02a039e9e2f0ed96cc8
    type: comment
  author: Klaatu
  content: "Hi all,\r\n\r\nLove the MLX work and have been getting it running on my\
    \ M3 Max. I'm getting some strange results though. Here's the test.py run:\r\n\
    ======================================================================\r\nFAIL:\
    \ test_generate (__main__.TestMistral)\r\n----------------------------------------------------------------------\r\
    \nTraceback (most recent call last):\r\n  File \"/Users/egs/repos/mlx-examples/llms/mistral/test.py\"\
    , line 75, in test_generate\r\n    self.assertEqual(tokens, expected)\r\nAssertionError:\
    \ Lists differ: [302, 272, 16762, 9588, 12807, 2867, 2135, 28723, 851[116 chars]\
    \ 297] != [302, 272, 11843, 11837, 1587, 28723, 851, 349, 865, [108 chars], 13]\r\
    \n\r\nFirst differing element 2:\r\n16762\r\n11843\r\n\r\n  [302,\r\n   272,\r\
    \n-  16762,\r\n-  9588,\r\n+  11843,\r\n+  11837,\r\n-  12807,\r\n?   ^ -\r\n\r\
    \n+  1587,\r\n?   ^\r\n\r\n-  2867,\r\n-  2135,\r\n   28723,\r\n   851,\r\n  \
    \ 349,\r\n   865,\r\n   264,\r\n   1369,\r\n   28723,\r\n   13,\r\n   13,\r\n\
    +  3381,\r\n+  456,\r\n+  654,\r\n-  1014,\r\n-  16762,\r\n-  9588,\r\n-  12807,\r\
    \n-  2867,\r\n-  2135,\r\n-  325,\r\n-  28749,\r\n-  8340,\r\n-  28731,\r\n- \
    \ 403,\r\n   264,\r\n-  1587,\r\n-  297]\r\n+  1353,\r\n+  11843,\r\n+  28725,\r\
    \n+  368,\r\n+  682,\r\n+  347,\r\n+  2240,\r\n+  767,\r\n+  298,\r\n+  511,\r\
    \n+  28723,\r\n+  13]\r\n\r\n----------------------------------------------------------------------\r\
    \nRan 2 tests in 7.400s\r\n\r\nFAILED (failures=1)\r\n\r\nAny thoughts?"
  created_at: 2023-12-21 02:17:14+00:00
  edited: false
  hidden: false
  id: 6583a02a039e9e2f0ed96cc8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
      fullname: Alvaro Bartolome
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: alvarobartt
      type: user
    createdAt: '2023-12-21T08:03:09.000Z'
    data:
      edited: false
      editors:
      - alvarobartt
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9181064367294312
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/60f0608166e5701b80ed3f02/ZSIRRZgthYnTinV1wGE1N.jpeg?w=200&h=200&f=face
          fullname: Alvaro Bartolome
          isHf: false
          isPro: false
          name: alvarobartt
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;Klaatu&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/Klaatu\">@<span class=\"\
          underline\">Klaatu</span></a></span>\n\n\t</span></span> I'm afraid this\
          \ may have to do with the M3 chip itself as pointed out by <span data-props=\"\
          {&quot;user&quot;:&quot;awni&quot;}\" data-target=\"UserMention\" class=\"\
          SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"inline-block\"><span\
          \ class=\"contents\"><a href=\"/awni\">@<span class=\"underline\">awni</span></a></span>\n\
          \n\t</span></span> at <a rel=\"nofollow\" href=\"https://github.com/ml-explore/mlx-examples/issues/58\"\
          >https://github.com/ml-explore/mlx-examples/issues/58</a></p>\n<p>Does it\
          \ just fail when using Mistral-based models or with the rest of the examples\
          \ too?</p>\n"
        raw: 'Hi @Klaatu I''m afraid this may have to do with the M3 chip itself as
          pointed out by @awni at https://github.com/ml-explore/mlx-examples/issues/58


          Does it just fail when using Mistral-based models or with the rest of the
          examples too?'
        updatedAt: '2023-12-21T08:03:09.908Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - pcuenq
    id: 6583f13da4f176a57fa89a00
    type: comment
  author: alvarobartt
  content: 'Hi @Klaatu I''m afraid this may have to do with the M3 chip itself as
    pointed out by @awni at https://github.com/ml-explore/mlx-examples/issues/58


    Does it just fail when using Mistral-based models or with the rest of the examples
    too?'
  created_at: 2023-12-21 08:03:09+00:00
  edited: false
  hidden: false
  id: 6583f13da4f176a57fa89a00
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: mlx-community/zephyr-7b-beta
repo_type: model
status: open
target_branch: null
title: Mistral test.py fails
