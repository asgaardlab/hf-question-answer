!!python/object:huggingface_hub.community.DiscussionWithDetails
author: 3374760a
conflicting_files: null
created_at: 2023-04-02 10:20:26+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/96873c38ad51422dc04c4952c5adc70a.svg
      fullname: zy
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: 3374760a
      type: user
    createdAt: '2023-04-02T11:20:26.000Z'
    data:
      edited: false
      editors:
      - 3374760a
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/96873c38ad51422dc04c4952c5adc70a.svg
          fullname: zy
          isHf: false
          isPro: false
          name: 3374760a
          type: user
        html: '<p>changing setting sd_model_checkpoint to sd21-unclip-h.ckpt [4124cbcf39]:
          RuntimeError<br>Traceback (most recent call last):<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\shared.py",
          line 568, in set<br>    self.data_labels[key].onchange()<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\call_queue.py",
          line 15, in f<br>    res = func(*args, **kwargs)<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\webui.py",
          line 146, in <br>    shared.opts.onchange("sd_model_checkpoint", wrap_queued_call(lambda:
          modules.sd_models.reload_model_weights()))<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\sd_models.py",
          line 490, in reload_model_weights<br>    checkpoint_config = sd_models_config.find_checkpoint_config(state_dict,
          checkpoint_info)<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\sd_models_config.py",
          line 100, in find_checkpoint_config<br>    return guess_model_config_from_state_dict(state_dict,
          info.filename)<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\sd_models_config.py",
          line 75, in guess_model_config_from_state_dict<br>    elif is_using_v_parameterization_for_sd2(sd):<br>  File
          "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\modules\sd_models_config.py",
          line 33, in is_using_v_parameterization_for_sd2<br>    unet = ldm.modules.diffusionmodules.openaimodel.UNetModel(<br>  File
          "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\repositories\stable-diffusion-stability-ai\ldm\modules\diffusionmodules\openaimodel.py",
          line 667, in <strong>init</strong><br>    ResBlock(<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\repositories\stable-diffusion-stability-ai\ldm\modules\diffusionmodules\openaimodel.py",
          line 229, in <strong>init</strong><br>    conv_nd(dims, self.out_channels,
          self.out_channels, 3, padding=1)<br>  File "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\repositories\stable-diffusion-stability-ai\ldm\modules\diffusionmodules\util.py",
          line 228, in conv_nd<br>    return nn.Conv2d(*args, **kwargs)<br>  File
          "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\py310\lib\site-packages\torch\nn\modules\conv.py",
          line 450, in <strong>init</strong><br>    super(Conv2d, self).<strong>init</strong>(<br>  File
          "D:\BaiduNetdiskDownload\novelai-webui\novelai-webui-aki-v3\py310\lib\site-packages\torch\nn\modules\conv.py",
          line 137, in <strong>init</strong><br>    self.weight = Parameter(torch.empty(<br>RuntimeError:
          [enforce fail at ..\c10\core\impl\alloc_cpu.cpp:72] data. DefaultCPUAllocator:
          not enough memory: you tried to allocate 14745600 bytes.</p>

          '
        raw: "changing setting sd_model_checkpoint to sd21-unclip-h.ckpt [4124cbcf39]:\
          \ RuntimeError\r\nTraceback (most recent call last):\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\modules\\shared.py\", line 568, in\
          \ set\r\n    self.data_labels[key].onchange()\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\modules\\call_queue.py\", line 15,\
          \ in f\r\n    res = func(*args, **kwargs)\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\webui.py\", line 146, in <lambda>\r\
          \n    shared.opts.onchange(\"sd_model_checkpoint\", wrap_queued_call(lambda:\
          \ modules.sd_models.reload_model_weights()))\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\modules\\sd_models.py\", line 490,\
          \ in reload_model_weights\r\n    checkpoint_config = sd_models_config.find_checkpoint_config(state_dict,\
          \ checkpoint_info)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\\
          novelai-webui-aki-v3\\modules\\sd_models_config.py\", line 100, in find_checkpoint_config\r\
          \n    return guess_model_config_from_state_dict(state_dict, info.filename)\r\
          \n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
          modules\\sd_models_config.py\", line 75, in guess_model_config_from_state_dict\r\
          \n    elif is_using_v_parameterization_for_sd2(sd):\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\modules\\sd_models_config.py\", line\
          \ 33, in is_using_v_parameterization_for_sd2\r\n    unet = ldm.modules.diffusionmodules.openaimodel.UNetModel(\r\
          \n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
          repositories\\stable-diffusion-stability-ai\\ldm\\modules\\diffusionmodules\\\
          openaimodel.py\", line 667, in __init__\r\n    ResBlock(\r\n  File \"D:\\\
          BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\repositories\\\
          stable-diffusion-stability-ai\\ldm\\modules\\diffusionmodules\\openaimodel.py\"\
          , line 229, in __init__\r\n    conv_nd(dims, self.out_channels, self.out_channels,\
          \ 3, padding=1)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
          repositories\\stable-diffusion-stability-ai\\ldm\\modules\\diffusionmodules\\\
          util.py\", line 228, in conv_nd\r\n    return nn.Conv2d(*args, **kwargs)\r\
          \n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
          py310\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 450, in __init__\r\
          \n    super(Conv2d, self).__init__(\r\n  File \"D:\\BaiduNetdiskDownload\\\
          novelai-webui\\novelai-webui-aki-v3\\py310\\lib\\site-packages\\torch\\\
          nn\\modules\\conv.py\", line 137, in __init__\r\n    self.weight = Parameter(torch.empty(\r\
          \nRuntimeError: [enforce fail at ..\\c10\\core\\impl\\alloc_cpu.cpp:72]\
          \ data. DefaultCPUAllocator: not enough memory: you tried to allocate 14745600\
          \ bytes."
        updatedAt: '2023-04-02T11:20:26.509Z'
      numEdits: 0
      reactions: []
    id: 642964fae5f33939cf39dec9
    type: comment
  author: 3374760a
  content: "changing setting sd_model_checkpoint to sd21-unclip-h.ckpt [4124cbcf39]:\
    \ RuntimeError\r\nTraceback (most recent call last):\r\n  File \"D:\\BaiduNetdiskDownload\\\
    novelai-webui\\novelai-webui-aki-v3\\modules\\shared.py\", line 568, in set\r\n\
    \    self.data_labels[key].onchange()\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\\
    novelai-webui-aki-v3\\modules\\call_queue.py\", line 15, in f\r\n    res = func(*args,\
    \ **kwargs)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
    webui.py\", line 146, in <lambda>\r\n    shared.opts.onchange(\"sd_model_checkpoint\"\
    , wrap_queued_call(lambda: modules.sd_models.reload_model_weights()))\r\n  File\
    \ \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\modules\\sd_models.py\"\
    , line 490, in reload_model_weights\r\n    checkpoint_config = sd_models_config.find_checkpoint_config(state_dict,\
    \ checkpoint_info)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
    modules\\sd_models_config.py\", line 100, in find_checkpoint_config\r\n    return\
    \ guess_model_config_from_state_dict(state_dict, info.filename)\r\n  File \"D:\\\
    BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\modules\\sd_models_config.py\"\
    , line 75, in guess_model_config_from_state_dict\r\n    elif is_using_v_parameterization_for_sd2(sd):\r\
    \n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\modules\\\
    sd_models_config.py\", line 33, in is_using_v_parameterization_for_sd2\r\n   \
    \ unet = ldm.modules.diffusionmodules.openaimodel.UNetModel(\r\n  File \"D:\\\
    BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\repositories\\stable-diffusion-stability-ai\\\
    ldm\\modules\\diffusionmodules\\openaimodel.py\", line 667, in __init__\r\n  \
    \  ResBlock(\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
    repositories\\stable-diffusion-stability-ai\\ldm\\modules\\diffusionmodules\\\
    openaimodel.py\", line 229, in __init__\r\n    conv_nd(dims, self.out_channels,\
    \ self.out_channels, 3, padding=1)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\\
    novelai-webui-aki-v3\\repositories\\stable-diffusion-stability-ai\\ldm\\modules\\\
    diffusionmodules\\util.py\", line 228, in conv_nd\r\n    return nn.Conv2d(*args,\
    \ **kwargs)\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\novelai-webui-aki-v3\\\
    py310\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 450, in __init__\r\
    \n    super(Conv2d, self).__init__(\r\n  File \"D:\\BaiduNetdiskDownload\\novelai-webui\\\
    novelai-webui-aki-v3\\py310\\lib\\site-packages\\torch\\nn\\modules\\conv.py\"\
    , line 137, in __init__\r\n    self.weight = Parameter(torch.empty(\r\nRuntimeError:\
    \ [enforce fail at ..\\c10\\core\\impl\\alloc_cpu.cpp:72] data. DefaultCPUAllocator:\
    \ not enough memory: you tried to allocate 14745600 bytes."
  created_at: 2023-04-02 10:20:26+00:00
  edited: false
  hidden: false
  id: 642964fae5f33939cf39dec9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/96873c38ad51422dc04c4952c5adc70a.svg
      fullname: zy
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: 3374760a
      type: user
    createdAt: '2023-04-02T11:35:02.000Z'
    data:
      edited: false
      editors:
      - 3374760a
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/96873c38ad51422dc04c4952c5adc70a.svg
          fullname: zy
          isHf: false
          isPro: false
          name: 3374760a
          type: user
        html: '<p>Unexpected key(s) in state_dict: "label_emb.0.0.weight", "label_emb.0.0.bias",
          "label_emb.0.2.weight", "label_emb.0.2.bias".</p>

          '
        raw: 'Unexpected key(s) in state_dict: "label_emb.0.0.weight", "label_emb.0.0.bias",
          "label_emb.0.2.weight", "label_emb.0.2.bias".'
        updatedAt: '2023-04-02T11:35:02.790Z'
      numEdits: 0
      reactions: []
    id: 642968667baf833870e73b9a
    type: comment
  author: 3374760a
  content: 'Unexpected key(s) in state_dict: "label_emb.0.0.weight", "label_emb.0.0.bias",
    "label_emb.0.2.weight", "label_emb.0.2.bias".'
  created_at: 2023-04-02 10:35:02+00:00
  edited: false
  hidden: false
  id: 642968667baf833870e73b9a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ec19a37e779b6d4c2ab286afcaaf4d44.svg
      fullname: junshi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: linjunshi
      type: user
    createdAt: '2023-04-10T13:53:09.000Z'
    data:
      edited: false
      editors:
      - linjunshi
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ec19a37e779b6d4c2ab286afcaaf4d44.svg
          fullname: junshi
          isHf: false
          isPro: false
          name: linjunshi
          type: user
        html: '<p>Same issue here!</p>

          '
        raw: Same issue here!
        updatedAt: '2023-04-10T13:53:09.886Z'
      numEdits: 0
      reactions: []
    id: 643414c51a1ba6b55b172774
    type: comment
  author: linjunshi
  content: Same issue here!
  created_at: 2023-04-10 12:53:09+00:00
  edited: false
  hidden: false
  id: 643414c51a1ba6b55b172774
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 4
repo_id: stabilityai/stable-diffusion-2-1-unclip
repo_type: model
status: open
target_branch: null
title: Problem
