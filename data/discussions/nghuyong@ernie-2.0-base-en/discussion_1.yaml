!!python/object:huggingface_hub.community.DiscussionWithDetails
author: dhairyadalal
conflicting_files: null
created_at: 2022-09-12 09:45:16+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9f5b6fa6a4bc3bea409b789d194b6451.svg
      fullname: Dhairya Dalal
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: dhairyadalal
      type: user
    createdAt: '2022-09-12T10:45:16.000Z'
    data:
      edited: false
      editors:
      - dhairyadalal
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9f5b6fa6a4bc3bea409b789d194b6451.svg
          fullname: Dhairya Dalal
          isHf: false
          isPro: false
          name: dhairyadalal
          type: user
        html: "<p>The latest config change (<a href=\"https://huggingface.co/nghuyong/ernie-2.0-base-en/commit/2c22755178879588695a30d68a4d9e861237db7b\"\
          >https://huggingface.co/nghuyong/ernie-2.0-base-en/commit/2c22755178879588695a30d68a4d9e861237db7b</a>)\
          \ where the BertModel is changed to ErnieModel under architecture is causing\
          \ issues for loading all the models. The pretrained method from Transformers\
          \ doesn't have ERNIE configs and so you get the following error when trying\
          \ to load the both the tokenizer and model using the transformers automethods:</p>\n\
          <pre><code>Traceback (most recent call last):\n  File \"prepro_std_fin.py\"\
          , line 297, in &lt;module&gt;\n    main(args)\n  File \"prepro_std_fin.py\"\
          , line 266, in main\n    tokenizer = AutoTokenizer.from_pretrained(\"nghuyong/ernie-1.0-base-zh\"\
          )\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/tokenization_auto.py\"\
          , line 402, in from_pretrained\n    config = AutoConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/configuration_auto.py\"\
          , line 432, in from_pretrained\n    config_class = CONFIG_MAPPING[config_dict[\"\
          model_type\"]]\nKeyError: 'ernie'\n</code></pre>\n"
        raw: "The latest config change (https://huggingface.co/nghuyong/ernie-2.0-base-en/commit/2c22755178879588695a30d68a4d9e861237db7b)\
          \ where the BertModel is changed to ErnieModel under architecture is causing\
          \ issues for loading all the models. The pretrained method from Transformers\
          \ doesn't have ERNIE configs and so you get the following error when trying\
          \ to load the both the tokenizer and model using the transformers automethods:\r\
          \n\r\n```\r\nTraceback (most recent call last):\r\n  File \"prepro_std_fin.py\"\
          , line 297, in <module>\r\n    main(args)\r\n  File \"prepro_std_fin.py\"\
          , line 266, in main\r\n    tokenizer = AutoTokenizer.from_pretrained(\"\
          nghuyong/ernie-1.0-base-zh\")\r\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/tokenization_auto.py\"\
          , line 402, in from_pretrained\r\n    config = AutoConfig.from_pretrained(pretrained_model_name_or_path,\
          \ **kwargs)\r\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/configuration_auto.py\"\
          , line 432, in from_pretrained\r\n    config_class = CONFIG_MAPPING[config_dict[\"\
          model_type\"]]\r\nKeyError: 'ernie'\r\n```"
        updatedAt: '2022-09-12T10:45:16.729Z'
      numEdits: 0
      reactions: []
    id: 631f0dbcb6628770f6ee2afb
    type: comment
  author: dhairyadalal
  content: "The latest config change (https://huggingface.co/nghuyong/ernie-2.0-base-en/commit/2c22755178879588695a30d68a4d9e861237db7b)\
    \ where the BertModel is changed to ErnieModel under architecture is causing issues\
    \ for loading all the models. The pretrained method from Transformers doesn't\
    \ have ERNIE configs and so you get the following error when trying to load the\
    \ both the tokenizer and model using the transformers automethods:\r\n\r\n```\r\
    \nTraceback (most recent call last):\r\n  File \"prepro_std_fin.py\", line 297,\
    \ in <module>\r\n    main(args)\r\n  File \"prepro_std_fin.py\", line 266, in\
    \ main\r\n    tokenizer = AutoTokenizer.from_pretrained(\"nghuyong/ernie-1.0-base-zh\"\
    )\r\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/tokenization_auto.py\"\
    , line 402, in from_pretrained\r\n    config = AutoConfig.from_pretrained(pretrained_model_name_or_path,\
    \ **kwargs)\r\n  File \"/opt/conda/lib/python3.6/site-packages/transformers/models/auto/configuration_auto.py\"\
    , line 432, in from_pretrained\r\n    config_class = CONFIG_MAPPING[config_dict[\"\
    model_type\"]]\r\nKeyError: 'ernie'\r\n```"
  created_at: 2022-09-12 09:45:16+00:00
  edited: false
  hidden: false
  id: 631f0dbcb6628770f6ee2afb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ba561d9d660273c78e5bcc8cd037e412.svg
      fullname: HuYong
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: nghuyong
      type: user
    createdAt: '2022-09-12T13:48:55.000Z'
    data:
      edited: true
      editors:
      - nghuyong
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ba561d9d660273c78e5bcc8cd037e412.svg
          fullname: HuYong
          isHf: false
          isPro: false
          name: nghuyong
          type: user
        html: '<p>you could install transformers by :</p>

          <p><code>pip install git+https://github.com/huggingface/transformers.git@main</code></p>

          '
        raw: 'you could install transformers by :


          `pip install git+https://github.com/huggingface/transformers.git@main`'
        updatedAt: '2022-09-14T18:00:06.720Z'
      numEdits: 2
      reactions: []
    id: 631f38c7daa9591e523127fb
    type: comment
  author: nghuyong
  content: 'you could install transformers by :


    `pip install git+https://github.com/huggingface/transformers.git@main`'
  created_at: 2022-09-12 12:48:55+00:00
  edited: true
  hidden: false
  id: 631f38c7daa9591e523127fb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9f5b6fa6a4bc3bea409b789d194b6451.svg
      fullname: Dhairya Dalal
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: dhairyadalal
      type: user
    createdAt: '2022-09-12T17:04:12.000Z'
    data:
      edited: true
      editors:
      - dhairyadalal
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9f5b6fa6a4bc3bea409b789d194b6451.svg
          fullname: Dhairya Dalal
          isHf: false
          isPro: false
          name: dhairyadalal
          type: user
        html: '<p>that doesn''t resolve the issue. I get this error by trying to load
          Ernie using the standard AutoModel calls</p>

          <p>e.g.</p>

          <pre><code>from transformers import AutoTokenizer, AutoModel

          tokenizer = AutoTokenizer.from_pretrained("nghuyong/ernie-2.0-base-en")

          model = AutoModel.from_pretrained("nghuyong/ernie-2.0-base-en")

          </code></pre>

          <p>For example see this colab: <a rel="nofollow" href="https://colab.research.google.com/drive/1axnSZON454snEBFl8sYZQBNWsOwo-rtj?usp=sharing">https://colab.research.google.com/drive/1axnSZON454snEBFl8sYZQBNWsOwo-rtj?usp=sharing</a></p>

          '
        raw: 'that doesn''t resolve the issue. I get this error by trying to load
          Ernie using the standard AutoModel calls


          e.g.

          ```

          from transformers import AutoTokenizer, AutoModel

          tokenizer = AutoTokenizer.from_pretrained("nghuyong/ernie-2.0-base-en")

          model = AutoModel.from_pretrained("nghuyong/ernie-2.0-base-en")

          ```


          For example see this colab: https://colab.research.google.com/drive/1axnSZON454snEBFl8sYZQBNWsOwo-rtj?usp=sharing'
        updatedAt: '2022-09-12T17:06:32.514Z'
      numEdits: 1
      reactions: []
    id: 631f668cb6628770f6f117f1
    type: comment
  author: dhairyadalal
  content: 'that doesn''t resolve the issue. I get this error by trying to load Ernie
    using the standard AutoModel calls


    e.g.

    ```

    from transformers import AutoTokenizer, AutoModel

    tokenizer = AutoTokenizer.from_pretrained("nghuyong/ernie-2.0-base-en")

    model = AutoModel.from_pretrained("nghuyong/ernie-2.0-base-en")

    ```


    For example see this colab: https://colab.research.google.com/drive/1axnSZON454snEBFl8sYZQBNWsOwo-rtj?usp=sharing'
  created_at: 2022-09-12 16:04:12+00:00
  edited: true
  hidden: false
  id: 631f668cb6628770f6f117f1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
      fullname: Lysandre
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: lysandre
      type: user
    createdAt: '2022-09-14T17:54:58.000Z'
    data:
      edited: false
      editors:
      - lysandre
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
          fullname: Lysandre
          isHf: true
          isPro: false
          name: lysandre
          type: user
        html: "<p>Hey @dhairydalal, it was recently merged on the <code>main</code>\
          \ branch. Reinstalling it as <span data-props=\"{&quot;user&quot;:&quot;nghuyong&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/nghuyong\"\
          >@<span class=\"underline\">nghuyong</span></a></span>\n\n\t</span></span>\
          \ shows should work.</p>\n<p>We'll be releasing v4.22.0 later today or tomorrow,\
          \ so upgrading version then will fix this.</p>\n"
        raw: 'Hey @dhairydalal, it was recently merged on the `main` branch. Reinstalling
          it as @nghuyong shows should work.


          We''ll be releasing v4.22.0 later today or tomorrow, so upgrading version
          then will fix this.'
        updatedAt: '2022-09-14T17:54:58.346Z'
      numEdits: 0
      reactions: []
    id: 63221572e4399dd61399dc79
    type: comment
  author: lysandre
  content: 'Hey @dhairydalal, it was recently merged on the `main` branch. Reinstalling
    it as @nghuyong shows should work.


    We''ll be releasing v4.22.0 later today or tomorrow, so upgrading version then
    will fix this.'
  created_at: 2022-09-14 16:54:58+00:00
  edited: false
  hidden: false
  id: 63221572e4399dd61399dc79
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: nghuyong/ernie-2.0-base-en
repo_type: model
status: open
target_branch: null
title: Key Error with Latest Change
