!!python/object:huggingface_hub.community.DiscussionWithDetails
author: cromz22
conflicting_files: null
created_at: 2023-11-04 10:32:38+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/7ec5b8b24097c4d2f62269b5bbc63b91.svg
      fullname: Shuichiro Shimizu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: cromz22
      type: user
    createdAt: '2023-11-04T11:32:38.000Z'
    data:
      edited: false
      editors:
      - cromz22
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8514035940170288
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/7ec5b8b24097c4d2f62269b5bbc63b91.svg
          fullname: Shuichiro Shimizu
          isHf: false
          isPro: false
          name: cromz22
          type: user
        html: '<p>Here''s the current example of loading audio dataset:</p>

          <pre><code># let''s load an audio sample from an Arabic speech corpus

          from datasets import load_dataset

          dataset = load_dataset("arabic_speech_corpus", split="test", streaming=True)

          audio_sample = next(iter(dataset))["audio"]


          # now, process it

          audio_inputs = processor(audios=audio_sample["array"], return_tensors="pt")

          </code></pre>

          <p>The processor is meant to be used with <code>sampling_rate</code> argument.
          Therfore, the code produces the following warning: "It is strongly recommended
          to pass the <code>sampling_rate</code> argument to this function. Failing
          to do so can result in silent errors that might be hard to debug." In this
          example, the error that is "hard to debug" is actually happening.</p>

          <p>The example uses <code>arabic_speech_corpus</code>. The default sampling
          rate of this corpus is 48000, whereas the SeamlessM4T model was trained
          with audio of 16000 Hz. Therefore, the following code throws a ValueError
          that ends with "Please make sure that the provided <code>raw_speech</code>
          input was sampled with 16000 and not 48000."</p>

          <pre><code>audio_inputs = processor(audios=audio_sample["array"], sampling_rate=audio_sample["sampling_rate"],
          return_tensors="pt")

          </code></pre>

          <p>Of course we can resample audio to 16000 so that it is suitable as model
          input (I actually tried translating the Arabic speech to English text, and
          it generated "The sea is the sea of the sea of the sea of the sea of the
          sea of the sea of the sea of the sea". After resampling the audio, it generated
          "It allowed the traveling salesman to be attractive to the low-income citizen.",
          which seems OK although I don''t know Arabic.), but as an example it should
          not contain such complications.</p>

          <p>Please consider rewriting the example using some dataset with default
          sampling rate of 16000 (e.g., "hf-internal-testing/librispeech_asr_dummy")
          and passing the <code>sampling_rate</code> argument to the processor. (Examples
          in <code>seamless-m4t-large</code> model card and SeamlessM4T model document
          should also be changed.)</p>

          '
        raw: "Here's the current example of loading audio dataset:\r\n```\r\n# let's\
          \ load an audio sample from an Arabic speech corpus\r\nfrom datasets import\
          \ load_dataset\r\ndataset = load_dataset(\"arabic_speech_corpus\", split=\"\
          test\", streaming=True)\r\naudio_sample = next(iter(dataset))[\"audio\"\
          ]\r\n\r\n# now, process it\r\naudio_inputs = processor(audios=audio_sample[\"\
          array\"], return_tensors=\"pt\")\r\n```\r\nThe processor is meant to be\
          \ used with `sampling_rate` argument. Therfore, the code produces the following\
          \ warning: \"It is strongly recommended to pass the `sampling_rate` argument\
          \ to this function. Failing to do so can result in silent errors that might\
          \ be hard to debug.\" In this example, the error that is \"hard to debug\"\
          \ is actually happening.\r\n\r\nThe example uses `arabic_speech_corpus`.\
          \ The default sampling rate of this corpus is 48000, whereas the SeamlessM4T\
          \ model was trained with audio of 16000 Hz. Therefore, the following code\
          \ throws a ValueError that ends with \"Please make sure that the provided\
          \ `raw_speech` input was sampled with 16000 and not 48000.\"\r\n```\r\n\
          audio_inputs = processor(audios=audio_sample[\"array\"], sampling_rate=audio_sample[\"\
          sampling_rate\"], return_tensors=\"pt\")\r\n```\r\n\r\nOf course we can\
          \ resample audio to 16000 so that it is suitable as model input (I actually\
          \ tried translating the Arabic speech to English text, and it generated\
          \ \"The sea is the sea of the sea of the sea of the sea of the sea of the\
          \ sea of the sea of the sea\". After resampling the audio, it generated\
          \ \"It allowed the traveling salesman to be attractive to the low-income\
          \ citizen.\", which seems OK although I don't know Arabic.), but as an example\
          \ it should not contain such complications.\r\n\r\nPlease consider rewriting\
          \ the example using some dataset with default sampling rate of 16000 (e.g.,\
          \ \"hf-internal-testing/librispeech_asr_dummy\") and passing the `sampling_rate`\
          \ argument to the processor. (Examples in `seamless-m4t-large` model card\
          \ and SeamlessM4T model document should also be changed.)\r\n"
        updatedAt: '2023-11-04T11:32:38.309Z'
      numEdits: 0
      reactions: []
    id: 65462bd6cf50edb69fd2b242
    type: comment
  author: cromz22
  content: "Here's the current example of loading audio dataset:\r\n```\r\n# let's\
    \ load an audio sample from an Arabic speech corpus\r\nfrom datasets import load_dataset\r\
    \ndataset = load_dataset(\"arabic_speech_corpus\", split=\"test\", streaming=True)\r\
    \naudio_sample = next(iter(dataset))[\"audio\"]\r\n\r\n# now, process it\r\naudio_inputs\
    \ = processor(audios=audio_sample[\"array\"], return_tensors=\"pt\")\r\n```\r\n\
    The processor is meant to be used with `sampling_rate` argument. Therfore, the\
    \ code produces the following warning: \"It is strongly recommended to pass the\
    \ `sampling_rate` argument to this function. Failing to do so can result in silent\
    \ errors that might be hard to debug.\" In this example, the error that is \"\
    hard to debug\" is actually happening.\r\n\r\nThe example uses `arabic_speech_corpus`.\
    \ The default sampling rate of this corpus is 48000, whereas the SeamlessM4T model\
    \ was trained with audio of 16000 Hz. Therefore, the following code throws a ValueError\
    \ that ends with \"Please make sure that the provided `raw_speech` input was sampled\
    \ with 16000 and not 48000.\"\r\n```\r\naudio_inputs = processor(audios=audio_sample[\"\
    array\"], sampling_rate=audio_sample[\"sampling_rate\"], return_tensors=\"pt\"\
    )\r\n```\r\n\r\nOf course we can resample audio to 16000 so that it is suitable\
    \ as model input (I actually tried translating the Arabic speech to English text,\
    \ and it generated \"The sea is the sea of the sea of the sea of the sea of the\
    \ sea of the sea of the sea of the sea\". After resampling the audio, it generated\
    \ \"It allowed the traveling salesman to be attractive to the low-income citizen.\"\
    , which seems OK although I don't know Arabic.), but as an example it should not\
    \ contain such complications.\r\n\r\nPlease consider rewriting the example using\
    \ some dataset with default sampling rate of 16000 (e.g., \"hf-internal-testing/librispeech_asr_dummy\"\
    ) and passing the `sampling_rate` argument to the processor. (Examples in `seamless-m4t-large`\
    \ model card and SeamlessM4T model document should also be changed.)\r\n"
  created_at: 2023-11-04 10:32:38+00:00
  edited: false
  hidden: false
  id: 65462bd6cf50edb69fd2b242
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 10
repo_id: facebook/seamless-m4t-medium
repo_type: model
status: open
target_branch: null
title: Error-prone audio example
