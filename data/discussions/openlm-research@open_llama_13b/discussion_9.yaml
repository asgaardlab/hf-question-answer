!!python/object:huggingface_hub.community.DiscussionWithDetails
author: smshr
conflicting_files: null
created_at: 2023-07-14 04:32:56+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/97c68715cfbc534025d705e1f4a83857.svg
      fullname: Safi Haider
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: smshr
      type: user
    createdAt: '2023-07-14T05:32:56.000Z'
    data:
      edited: false
      editors:
      - smshr
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6391685605049133
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/97c68715cfbc534025d705e1f4a83857.svg
          fullname: Safi Haider
          isHf: false
          isPro: false
          name: smshr
          type: user
        html: '<p>I used the following code to load the model:<br>`import torch<br>from
          transformers import LlamaTokenizer, LlamaForCausalLM</p>

          <p>device = torch.device(''cuda'')</p>

          <p>model_path = ''openlm-research/open_llama_3b''<br>#model_path = ''openlm-research/open_llama_7b''<br>#model_path
          = ''openlm-research/open_llama_13b''</p>

          <p>tokenizer = LlamaTokenizer.from_pretrained(model_path)<br>model = LlamaForCausalLM.from_pretrained(<br>    model_path,
          torch_dtype=torch.float16, device_map=''auto''<br>)<br>`<br>but when generating
          output it gives the following error:<br>RuntimeError: Expected all tensors
          to be on the same device, but found at least two devices, cuda:0 and cpu!
          (when checking argument for argument index in method wrapper_CUDA__index_select)</p>

          <p>Any leads on how to solve it</p>

          '
        raw: "I used the following code to load the model:\r\n`import torch\r\nfrom\
          \ transformers import LlamaTokenizer, LlamaForCausalLM\r\n\r\ndevice = torch.device('cuda')\r\
          \n\r\nmodel_path = 'openlm-research/open_llama_3b'\r\n#model_path = 'openlm-research/open_llama_7b'\r\
          \n#model_path = 'openlm-research/open_llama_13b'\r\n\r\ntokenizer = LlamaTokenizer.from_pretrained(model_path)\r\
          \nmodel = LlamaForCausalLM.from_pretrained(\r\n    model_path, torch_dtype=torch.float16,\
          \ device_map='auto'\r\n)\r\n`\r\nbut when generating output it gives the\
          \ following error:\r\nRuntimeError: Expected all tensors to be on the same\
          \ device, but found at least two devices, cuda:0 and cpu! (when checking\
          \ argument for argument index in method wrapper_CUDA__index_select)\r\n\r\
          \nAny leads on how to solve it"
        updatedAt: '2023-07-14T05:32:56.871Z'
      numEdits: 0
      reactions: []
    id: 64b0de0814b3c5479eecc985
    type: comment
  author: smshr
  content: "I used the following code to load the model:\r\n`import torch\r\nfrom\
    \ transformers import LlamaTokenizer, LlamaForCausalLM\r\n\r\ndevice = torch.device('cuda')\r\
    \n\r\nmodel_path = 'openlm-research/open_llama_3b'\r\n#model_path = 'openlm-research/open_llama_7b'\r\
    \n#model_path = 'openlm-research/open_llama_13b'\r\n\r\ntokenizer = LlamaTokenizer.from_pretrained(model_path)\r\
    \nmodel = LlamaForCausalLM.from_pretrained(\r\n    model_path, torch_dtype=torch.float16,\
    \ device_map='auto'\r\n)\r\n`\r\nbut when generating output it gives the following\
    \ error:\r\nRuntimeError: Expected all tensors to be on the same device, but found\
    \ at least two devices, cuda:0 and cpu! (when checking argument for argument index\
    \ in method wrapper_CUDA__index_select)\r\n\r\nAny leads on how to solve it"
  created_at: 2023-07-14 04:32:56+00:00
  edited: false
  hidden: false
  id: 64b0de0814b3c5479eecc985
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9ed245023bcbf9fb266519c22ec9aa89.svg
      fullname: solesschong
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: solesschong
      type: user
    createdAt: '2023-07-15T14:39:15.000Z'
    data:
      edited: false
      editors:
      - solesschong
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.31397101283073425
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9ed245023bcbf9fb266519c22ec9aa89.svg
          fullname: solesschong
          isHf: false
          isPro: false
          name: solesschong
          type: user
        html: '<pre><code>device = torch.device(''cuda'')

          input_ids = tokenizer(prompt, return_tensors="pt").input_ids.to(device)

          </code></pre>

          <p>This moves input onto GPU.</p>

          '
        raw: '```

          device = torch.device(''cuda'')

          input_ids = tokenizer(prompt, return_tensors="pt").input_ids.to(device)

          ```

          This moves input onto GPU.'
        updatedAt: '2023-07-15T14:39:15.685Z'
      numEdits: 0
      reactions: []
    id: 64b2af939df48bad816492cd
    type: comment
  author: solesschong
  content: '```

    device = torch.device(''cuda'')

    input_ids = tokenizer(prompt, return_tensors="pt").input_ids.to(device)

    ```

    This moves input onto GPU.'
  created_at: 2023-07-15 13:39:15+00:00
  edited: false
  hidden: false
  id: 64b2af939df48bad816492cd
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 9
repo_id: openlm-research/open_llama_13b
repo_type: model
status: open
target_branch: null
title: Expected all tensors to be on the same device, but found at least two devices,
  cuda:0 and cpu!
