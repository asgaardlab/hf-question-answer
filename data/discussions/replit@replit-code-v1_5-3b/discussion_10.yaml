!!python/object:huggingface_hub.community.DiscussionWithDetails
author: alonsosilva
conflicting_files: null
created_at: 2023-11-12 18:46:26+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62c4244ab9045dabfc4b2cc0/jRFsYSfqUBKqEEr0ZgcS7.jpeg?w=200&h=200&f=face
      fullname: Alonso Silva Allende
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: alonsosilva
      type: user
    createdAt: '2023-11-12T18:46:26.000Z'
    data:
      edited: false
      editors:
      - alonsosilva
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.51719069480896
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/62c4244ab9045dabfc4b2cc0/jRFsYSfqUBKqEEr0ZgcS7.jpeg?w=200&h=200&f=face
          fullname: Alonso Silva Allende
          isHf: false
          isPro: false
          name: alonsosilva
          type: user
        html: "<p>There is an error with this model with the new version of transformers\
          \ v4.35.0.<br>To reproduce:</p>\n<pre><code class=\"language-python\"><span\
          \ class=\"hljs-keyword\">from</span> accelerate <span class=\"hljs-keyword\"\
          >import</span> init_empty_weights\n<span class=\"hljs-keyword\">from</span>\
          \ transformers <span class=\"hljs-keyword\">import</span> AutoModelForCausalLM,\
          \ AutoConfig\n\nmodel_id = <span class=\"hljs-string\">\"replit/replit-code-v1_5-3b\"\
          </span>\nconfig = AutoConfig.from_pretrained(\n    model_id, trust_remote_code=<span\
          \ class=\"hljs-literal\">True</span>, revision=<span class=\"hljs-string\"\
          >\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"</span>\n)\n<span class=\"\
          hljs-keyword\">with</span> init_empty_weights():\n    model = AutoModelForCausalLM.from_config(\n\
          \        config, trust_remote_code=<span class=\"hljs-literal\">True</span>,\
          \ code_revision=<span class=\"hljs-string\">\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"\
          </span>\n    )\n</code></pre>\n<p>Or run the following <a rel=\"nofollow\"\
          \ href=\"https://gist.github.com/alonsosilvaallende/c9b78954492e1b38f33941831479822e\"\
          >colab</a>.<br>There is no error with the previous version of transformers\
          \ v4.34.1.</p>\n"
        raw: "There is an error with this model with the new version of transformers\
          \ v4.35.0.\r\nTo reproduce:\r\n```python\r\nfrom accelerate import init_empty_weights\r\
          \nfrom transformers import AutoModelForCausalLM, AutoConfig\r\n\r\nmodel_id\
          \ = \"replit/replit-code-v1_5-3b\"\r\nconfig = AutoConfig.from_pretrained(\r\
          \n    model_id, trust_remote_code=True, revision=\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"\
          \r\n)\r\nwith init_empty_weights():\r\n    model = AutoModelForCausalLM.from_config(\r\
          \n        config, trust_remote_code=True, code_revision=\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"\
          \r\n    )\r\n```\r\nOr run the following [colab](https://gist.github.com/alonsosilvaallende/c9b78954492e1b38f33941831479822e).\r\
          \nThere is no error with the previous version of transformers v4.34.1.\r\
          \n"
        updatedAt: '2023-11-12T18:46:26.442Z'
      numEdits: 0
      reactions: []
    id: 65511d82a12178dd75d90b6c
    type: comment
  author: alonsosilva
  content: "There is an error with this model with the new version of transformers\
    \ v4.35.0.\r\nTo reproduce:\r\n```python\r\nfrom accelerate import init_empty_weights\r\
    \nfrom transformers import AutoModelForCausalLM, AutoConfig\r\n\r\nmodel_id =\
    \ \"replit/replit-code-v1_5-3b\"\r\nconfig = AutoConfig.from_pretrained(\r\n \
    \   model_id, trust_remote_code=True, revision=\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"\
    \r\n)\r\nwith init_empty_weights():\r\n    model = AutoModelForCausalLM.from_config(\r\
    \n        config, trust_remote_code=True, code_revision=\"b85a5dd28ef6053ad095bf5113dd740a86a67597\"\
    \r\n    )\r\n```\r\nOr run the following [colab](https://gist.github.com/alonsosilvaallende/c9b78954492e1b38f33941831479822e).\r\
    \nThere is no error with the previous version of transformers v4.34.1.\r\n"
  created_at: 2023-11-12 18:46:26+00:00
  edited: false
  hidden: false
  id: 65511d82a12178dd75d90b6c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
      fullname: luke newey
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: lmnewey
      type: user
    createdAt: '2023-12-14T08:25:15.000Z'
    data:
      edited: true
      editors:
      - lmnewey
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5652753710746765
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
          fullname: luke newey
          isHf: false
          isPro: false
          name: lmnewey
          type: user
        html: '<p>I was having a similar issue, is the replit tokenizer issue ? </p>

          '
        raw: "I was having a similar issue, is the replit tokenizer issue ? \n"
        updatedAt: '2023-12-14T08:25:59.295Z'
      numEdits: 2
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - alonsosilva
    id: 657abbebafbb0117ba2114ac
    type: comment
  author: lmnewey
  content: "I was having a similar issue, is the replit tokenizer issue ? \n"
  created_at: 2023-12-14 08:25:15+00:00
  edited: true
  hidden: false
  id: 657abbebafbb0117ba2114ac
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/7865ac39276762682d8e20a33ff9f257.svg
      fullname: Mike Ravkine
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: mike-ravkine
      type: user
    createdAt: '2023-12-29T17:04:50.000Z'
    data:
      edited: false
      editors:
      - mike-ravkine
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7968869209289551
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/7865ac39276762682d8e20a33ff9f257.svg
          fullname: Mike Ravkine
          isHf: false
          isPro: false
          name: mike-ravkine
          type: user
        html: '<p>I can confirm this model no longer works with transformers past
          4.34.1</p>

          <p>The issue is this commit <a rel="nofollow" href="https://github.com/huggingface/transformers/commit/ac5893756bafcd745d93a442cf36f984545dbad8">https://github.com/huggingface/transformers/commit/ac5893756bafcd745d93a442cf36f984545dbad8</a>
          moving a bunch of code around and <a href="https://huggingface.co/replit/replit-code-v1_5-3b/blob/main/hf_prefixlm_converter.py">https://huggingface.co/replit/replit-code-v1_5-3b/blob/main/hf_prefixlm_converter.py</a>
          relying on it''s old location.</p>

          '
        raw: 'I can confirm this model no longer works with transformers past 4.34.1


          The issue is this commit https://github.com/huggingface/transformers/commit/ac5893756bafcd745d93a442cf36f984545dbad8
          moving a bunch of code around and https://huggingface.co/replit/replit-code-v1_5-3b/blob/main/hf_prefixlm_converter.py
          relying on it''s old location.'
        updatedAt: '2023-12-29T17:04:50.068Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - alonsosilva
    id: 658efc321adf6d577e57ae37
    type: comment
  author: mike-ravkine
  content: 'I can confirm this model no longer works with transformers past 4.34.1


    The issue is this commit https://github.com/huggingface/transformers/commit/ac5893756bafcd745d93a442cf36f984545dbad8
    moving a bunch of code around and https://huggingface.co/replit/replit-code-v1_5-3b/blob/main/hf_prefixlm_converter.py
    relying on it''s old location.'
  created_at: 2023-12-29 17:04:50+00:00
  edited: false
  hidden: false
  id: 658efc321adf6d577e57ae37
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 10
repo_id: replit/replit-code-v1_5-3b
repo_type: model
status: open
target_branch: null
title: Error with new version of transformers v4.35.0
