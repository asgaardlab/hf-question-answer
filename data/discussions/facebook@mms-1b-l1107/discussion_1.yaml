!!python/object:huggingface_hub.community.DiscussionWithDetails
author: komlankedji
conflicting_files: null
created_at: 2023-06-08 14:09:53+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/af3c2bed2942878f5df23e75ddd21f14.svg
      fullname: Komlan KEDJI
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: komlankedji
      type: user
    createdAt: '2023-06-08T15:09:53.000Z'
    data:
      edited: false
      editors:
      - komlankedji
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7987704873085022
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/af3c2bed2942878f5df23e75ddd21f14.svg
          fullname: Komlan KEDJI
          isHf: false
          isPro: false
          name: komlankedji
          type: user
        html: "<p>Demo notebook: <a rel=\"nofollow\" href=\"https://colab.research.google.com/drive/1YmABsYKCk39Z7GF390G316ZsEWH7GkqT?usp=sharing\"\
          >https://colab.research.google.com/drive/1YmABsYKCk39Z7GF390G316ZsEWH7GkqT?usp=sharing</a></p>\n\
          <p>Basically:</p>\n<p><code>pipe = pipeline(model=\"facebook/mms-1b-l1107\"\
          , model_kwargs={\"target_lang\":\"fra\"})</code></p>\n<p>Fails with a size\
          \ mismatch issue. Ignoring it seems to load the english adapter, as the\
          \ result is poor and doesn\u2019t match the demo on the official space (<a\
          \ href=\"https://huggingface.co/spaces/facebook/MMS\">https://huggingface.co/spaces/facebook/MMS</a>).</p>\n\
          <p>It looks like this line inside the transformers library is supposed to\
          \ load the target_lang passed to the pipeline:<br><a rel=\"nofollow\" href=\"\
          https://github.com/huggingface/transformers/commit/5dfd407b37ac683dc91637e9913b0ae9205d2acd#diff-fde96a141d70737bff942cb61341f3b4b87729c9a066ecee4bfc86dfe590a8e6R1864\"\
          >https://github.com/huggingface/transformers/commit/5dfd407b37ac683dc91637e9913b0ae9205d2acd#diff-fde96a141d70737bff942cb61341f3b4b87729c9a066ecee4bfc86dfe590a8e6R1864</a></p>\n\
          <p>Is this model supposed to work with pipelines initialized with a non-default\
          \ language?<br>Thanks.</p>\n"
        raw: "Demo notebook: https://colab.research.google.com/drive/1YmABsYKCk39Z7GF390G316ZsEWH7GkqT?usp=sharing\r\
          \n\r\nBasically:\r\n\r\n```pipe = pipeline(model=\"facebook/mms-1b-l1107\"\
          , model_kwargs={\"target_lang\":\"fra\"})```\r\n\r\nFails with a size mismatch\
          \ issue. Ignoring it seems to load the english adapter, as the result is\
          \ poor and doesn\u2019t match the demo on the official space (https://huggingface.co/spaces/facebook/MMS).\r\
          \n\r\nIt looks like this line inside the transformers library is supposed\
          \ to load the target_lang passed to the pipeline:\r\nhttps://github.com/huggingface/transformers/commit/5dfd407b37ac683dc91637e9913b0ae9205d2acd#diff-fde96a141d70737bff942cb61341f3b4b87729c9a066ecee4bfc86dfe590a8e6R1864\r\
          \n\r\nIs this model supposed to work with pipelines initialized with a non-default\
          \ language?\r\nThanks."
        updatedAt: '2023-06-08T15:09:53.225Z'
      numEdits: 0
      reactions: []
    id: 6481ef412c8bd07d820b75cc
    type: comment
  author: komlankedji
  content: "Demo notebook: https://colab.research.google.com/drive/1YmABsYKCk39Z7GF390G316ZsEWH7GkqT?usp=sharing\r\
    \n\r\nBasically:\r\n\r\n```pipe = pipeline(model=\"facebook/mms-1b-l1107\", model_kwargs={\"\
    target_lang\":\"fra\"})```\r\n\r\nFails with a size mismatch issue. Ignoring it\
    \ seems to load the english adapter, as the result is poor and doesn\u2019t match\
    \ the demo on the official space (https://huggingface.co/spaces/facebook/MMS).\r\
    \n\r\nIt looks like this line inside the transformers library is supposed to load\
    \ the target_lang passed to the pipeline:\r\nhttps://github.com/huggingface/transformers/commit/5dfd407b37ac683dc91637e9913b0ae9205d2acd#diff-fde96a141d70737bff942cb61341f3b4b87729c9a066ecee4bfc86dfe590a8e6R1864\r\
    \n\r\nIs this model supposed to work with pipelines initialized with a non-default\
    \ language?\r\nThanks."
  created_at: 2023-06-08 14:09:53+00:00
  edited: false
  hidden: false
  id: 6481ef412c8bd07d820b75cc
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2023-06-14T16:21:53.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8325946927070618
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: "<p>Hey <span data-props=\"{&quot;user&quot;:&quot;komlankedji&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/komlankedji\"\
          >@<span class=\"underline\">komlankedji</span></a></span>\n\n\t</span></span>,</p>\n\
          <p>We actually have not checked this yet</p>\n"
        raw: 'Hey @komlankedji,


          We actually have not checked this yet'
        updatedAt: '2023-06-14T16:21:53.175Z'
      numEdits: 0
      reactions: []
    id: 6489e9211441602453980ef2
    type: comment
  author: patrickvonplaten
  content: 'Hey @komlankedji,


    We actually have not checked this yet'
  created_at: 2023-06-14 15:21:53+00:00
  edited: false
  hidden: false
  id: 6489e9211441602453980ef2
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2023-06-22T17:10:47.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8501464128494263
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: "<p>Thanks for flagging <span data-props=\"{&quot;user&quot;:&quot;komlankedji&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/komlankedji\"\
          >@<span class=\"underline\">komlankedji</span></a></span>\n\n\t</span></span>\
          \ - this is now resolved on main following <a rel=\"nofollow\" href=\"https://github.com/huggingface/transformers/pull/24335\"\
          >https://github.com/huggingface/transformers/pull/24335</a></p>\n"
        raw: Thanks for flagging @komlankedji - this is now resolved on main following
          https://github.com/huggingface/transformers/pull/24335
        updatedAt: '2023-06-22T17:10:47.062Z'
      numEdits: 0
      reactions: []
    id: 649480975a40d767bdcfe1c8
    type: comment
  author: sanchit-gandhi
  content: Thanks for flagging @komlankedji - this is now resolved on main following
    https://github.com/huggingface/transformers/pull/24335
  created_at: 2023-06-22 16:10:47+00:00
  edited: false
  hidden: false
  id: 649480975a40d767bdcfe1c8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2023-06-22T17:10:55.000Z'
    data:
      status: closed
    id: 6494809f3c7e34b6d3335314
    type: status-change
  author: sanchit-gandhi
  created_at: 2023-06-22 16:10:55+00:00
  id: 6494809f3c7e34b6d3335314
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/af3c2bed2942878f5df23e75ddd21f14.svg
      fullname: Komlan KEDJI
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: komlankedji
      type: user
    createdAt: '2023-06-23T16:39:24.000Z'
    data:
      edited: false
      editors:
      - komlankedji
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8015949726104736
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/af3c2bed2942878f5df23e75ddd21f14.svg
          fullname: Komlan KEDJI
          isHf: false
          isPro: false
          name: komlankedji
          type: user
        html: '<p>Nice, thanks!</p>

          '
        raw: Nice, thanks!
        updatedAt: '2023-06-23T16:39:24.599Z'
      numEdits: 0
      reactions: []
    id: 6495cabcffedd4836d4fb7b0
    type: comment
  author: komlankedji
  content: Nice, thanks!
  created_at: 2023-06-23 15:39:24+00:00
  edited: false
  hidden: false
  id: 6495cabcffedd4836d4fb7b0
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: facebook/mms-1b-l1107
repo_type: model
status: closed
target_branch: null
title: target_lang=fra in pipeline() leads to "Size mismatch for lm_head.weight/bias
  when loading state_dict for Wav2Vec2ForCTC"
