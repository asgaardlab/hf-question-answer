!!python/object:huggingface_hub.community.DiscussionWithDetails
author: lmnewey
conflicting_files: null
created_at: 2023-12-14 05:20:45+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
      fullname: luke newey
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: lmnewey
      type: user
    createdAt: '2023-12-14T05:20:45.000Z'
    data:
      edited: false
      editors:
      - lmnewey
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.36620381474494934
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
          fullname: luke newey
          isHf: false
          isPro: false
          name: lmnewey
          type: user
        html: '<p>Hey guys, this might be a noob question but Im struggling to run
          this model. getting the following error </p>

          <p>Exception has occurred: AttributeError<br>''ReplitLMTokenizer'' object
          has no attribute ''sp_model''<br>  File "/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py",
          line 85, in vocab_size<br>    return self.sp_model.get_piece_size()<br>  File
          "/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py",
          line 88, in get_vocab<br>    vocab = {self.convert_ids_to_tokens(i): i for
          i in range(self.vocab_size)}<br>  File "/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py",
          line 78, in <strong>init</strong><br>    super().<strong>init</strong>(bos_token=bos_token,
          eos_token=eos_token, unk_token=unk_token, pad_token=pad_token, sep_token=sep_token,
          sp_model_kwargs=self.sp_model_kwargs, **kwargs)<br>  File "/LocalStorage/ScratchPad/vllmtest.py",
          line 14, in <br>    llm = LLM(model="glaiveai/glaive-function-calling-v2-small",trust_remote_code=True)<br>AttributeError:
          ''ReplitLMTokenizer'' object has no attribute ''sp_model''</p>

          '
        raw: "Hey guys, this might be a noob question but Im struggling to run this\
          \ model. getting the following error \r\n\r\nException has occurred: AttributeError\r\
          \n'ReplitLMTokenizer' object has no attribute 'sp_model'\r\n  File \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
          , line 85, in vocab_size\r\n    return self.sp_model.get_piece_size()\r\n\
          \  File \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
          , line 88, in get_vocab\r\n    vocab = {self.convert_ids_to_tokens(i): i\
          \ for i in range(self.vocab_size)}\r\n  File \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
          , line 78, in __init__\r\n    super().__init__(bos_token=bos_token, eos_token=eos_token,\
          \ unk_token=unk_token, pad_token=pad_token, sep_token=sep_token, sp_model_kwargs=self.sp_model_kwargs,\
          \ **kwargs)\r\n  File \"/LocalStorage/ScratchPad/vllmtest.py\", line 14,\
          \ in <module>\r\n    llm = LLM(model=\"glaiveai/glaive-function-calling-v2-small\"\
          ,trust_remote_code=True)\r\nAttributeError: 'ReplitLMTokenizer' object has\
          \ no attribute 'sp_model'"
        updatedAt: '2023-12-14T05:20:45.800Z'
      numEdits: 0
      reactions: []
    id: 657a90ad893b13b8f4348724
    type: comment
  author: lmnewey
  content: "Hey guys, this might be a noob question but Im struggling to run this\
    \ model. getting the following error \r\n\r\nException has occurred: AttributeError\r\
    \n'ReplitLMTokenizer' object has no attribute 'sp_model'\r\n  File \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
    , line 85, in vocab_size\r\n    return self.sp_model.get_piece_size()\r\n  File\
    \ \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
    , line 88, in get_vocab\r\n    vocab = {self.convert_ids_to_tokens(i): i for i\
    \ in range(self.vocab_size)}\r\n  File \"/home/../.cache/huggingface/modules/transformers_modules/glaiveai/glaive-function-calling-v2-small/ee756352b27602951abdc7618c9139f1bb8e5031/replit_lm_tokenizer.py\"\
    , line 78, in __init__\r\n    super().__init__(bos_token=bos_token, eos_token=eos_token,\
    \ unk_token=unk_token, pad_token=pad_token, sep_token=sep_token, sp_model_kwargs=self.sp_model_kwargs,\
    \ **kwargs)\r\n  File \"/LocalStorage/ScratchPad/vllmtest.py\", line 14, in <module>\r\
    \n    llm = LLM(model=\"glaiveai/glaive-function-calling-v2-small\",trust_remote_code=True)\r\
    \nAttributeError: 'ReplitLMTokenizer' object has no attribute 'sp_model'"
  created_at: 2023-12-14 05:20:45+00:00
  edited: false
  hidden: false
  id: 657a90ad893b13b8f4348724
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
      fullname: luke newey
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: lmnewey
      type: user
    createdAt: '2023-12-14T08:55:21.000Z'
    data:
      edited: false
      editors:
      - lmnewey
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6250790357589722
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1c2f0ef71477678d46fb8bccd1aa4f1b.svg
          fullname: luke newey
          isHf: false
          isPro: false
          name: lmnewey
          type: user
        html: '<p>I got to the bottom of this, it seems like the recent update to
          replit tokenizer has something messed up. </p>

          <p>You need to swap some lines around in def <strong>init</strong><br>You
          need to set self.sp_model before calling super().<strong>init</strong> </p>

          <p>Also there is some lines in hf_prefixlm that needed commenting out. </p>

          <p>Adjust the lines of replit_lm_tokenizer after line 64 to look like this<br>        self.sp_model_kwargs
          = {} if sp_model_kwargs is None else sp_model_kwargs<br>        self.vocab_file
          = vocab_file<br>        self.sp_model = spm.SentencePieceProcessor(**self.sp_model_kwargs)<br>        self.sp_model.Load(vocab_file)<br>        super().<strong>init</strong>(bos_token=bos_token,
          eos_token=eos_token, unk_token=unk_token, pad_token=pad_token, sep_token=sep_token,
          sp_model_kwargs=self.sp_model_kwargs, **kwargs)</p>

          '
        raw: "I got to the bottom of this, it seems like the recent update to replit\
          \ tokenizer has something messed up. \n\nYou need to swap some lines around\
          \ in def __init__ \nYou need to set self.sp_model before calling super().__init__\
          \ \n\nAlso there is some lines in hf_prefixlm that needed commenting out.\
          \ \n\nAdjust the lines of replit_lm_tokenizer after line 64 to look like\
          \ this\n        self.sp_model_kwargs = {} if sp_model_kwargs is None else\
          \ sp_model_kwargs\n        self.vocab_file = vocab_file\n        self.sp_model\
          \ = spm.SentencePieceProcessor(**self.sp_model_kwargs)\n        self.sp_model.Load(vocab_file)\n\
          \        super().__init__(bos_token=bos_token, eos_token=eos_token, unk_token=unk_token,\
          \ pad_token=pad_token, sep_token=sep_token, sp_model_kwargs=self.sp_model_kwargs,\
          \ **kwargs)"
        updatedAt: '2023-12-14T08:55:21.041Z'
      numEdits: 0
      reactions: []
    id: 657ac2f9270ef0b785f4a566
    type: comment
  author: lmnewey
  content: "I got to the bottom of this, it seems like the recent update to replit\
    \ tokenizer has something messed up. \n\nYou need to swap some lines around in\
    \ def __init__ \nYou need to set self.sp_model before calling super().__init__\
    \ \n\nAlso there is some lines in hf_prefixlm that needed commenting out. \n\n\
    Adjust the lines of replit_lm_tokenizer after line 64 to look like this\n    \
    \    self.sp_model_kwargs = {} if sp_model_kwargs is None else sp_model_kwargs\n\
    \        self.vocab_file = vocab_file\n        self.sp_model = spm.SentencePieceProcessor(**self.sp_model_kwargs)\n\
    \        self.sp_model.Load(vocab_file)\n        super().__init__(bos_token=bos_token,\
    \ eos_token=eos_token, unk_token=unk_token, pad_token=pad_token, sep_token=sep_token,\
    \ sp_model_kwargs=self.sp_model_kwargs, **kwargs)"
  created_at: 2023-12-14 08:55:21+00:00
  edited: false
  hidden: false
  id: 657ac2f9270ef0b785f4a566
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: glaiveai/glaive-function-calling-v2-small
repo_type: model
status: open
target_branch: null
title: Cant run the model
