!!python/object:huggingface_hub.community.DiscussionWithDetails
author: EnesDS
conflicting_files: null
created_at: 2022-06-10 13:43:44+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c90807a9241bf6df04df8f11dc3c99b4.svg
      fullname: Enes Gokce
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: EnesDS
      type: user
    createdAt: '2022-06-10T14:43:44.000Z'
    data:
      edited: true
      editors:
      - EnesDS
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c90807a9241bf6df04df8f11dc3c99b4.svg
          fullname: Enes Gokce
          isHf: false
          isPro: false
          name: EnesDS
          type: user
        html: "<p>I wanted to get scores for each question I asked. When I followed\
          \ the suggested method here <a href=\"https://huggingface.co/docs/transformers/v4.19.3/en/internal/generation_utils#transformers.generation_utils.GreedySearchEncoderDecoderOutput.scores\"\
          >https://huggingface.co/docs/transformers/v4.19.3/en/internal/generation_utils#transformers.generation_utils.GreedySearchEncoderDecoderOutput.scores</a></p>\n\
          <p>I get this error:</p>\n<pre><code>/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_fast.py\
          \ in _decode(self, token_ids, skip_special_tokens, clean_up_tokenization_spaces,\
          \ **kwargs)\n    545         if isinstance(token_ids, int):\n    546   \
          \          token_ids = [token_ids]\n--&gt; 547         text = self._tokenizer.decode(token_ids,\
          \ skip_special_tokens=skip_special_tokens)\n    548 \n    549         if\
          \ clean_up_tokenization_spaces:\n\nTypeError: Can't convert {'sequences':\
          \ [[0, 25439, 1]], 'scores': [[[-84.4974365234375, -35.67204284667969, -44.91609573364258,\
          \ -27.592676162719727, -38.73073196411133, -37.58429718017578, -32.03908920288086,\
          \ -41.34073257446289, -37.01685333251953, -38.45159149169922, -37.466190338134766,\
          \ -32.51167297363281, -35.718780517578125, ... \n</code></pre>\n<p>As I\
          \ understand, scores should be an integer. But the decoder can't decode\
          \ if it's not an integer value.<br>Any advice? </p>\n"
        raw: "I wanted to get scores for each question I asked. When I followed the\
          \ suggested method here https://huggingface.co/docs/transformers/v4.19.3/en/internal/generation_utils#transformers.generation_utils.GreedySearchEncoderDecoderOutput.scores\n\
          \nI get this error:\n```\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_fast.py\
          \ in _decode(self, token_ids, skip_special_tokens, clean_up_tokenization_spaces,\
          \ **kwargs)\n    545         if isinstance(token_ids, int):\n    546   \
          \          token_ids = [token_ids]\n--> 547         text = self._tokenizer.decode(token_ids,\
          \ skip_special_tokens=skip_special_tokens)\n    548 \n    549         if\
          \ clean_up_tokenization_spaces:\n\nTypeError: Can't convert {'sequences':\
          \ [[0, 25439, 1]], 'scores': [[[-84.4974365234375, -35.67204284667969, -44.91609573364258,\
          \ -27.592676162719727, -38.73073196411133, -37.58429718017578, -32.03908920288086,\
          \ -41.34073257446289, -37.01685333251953, -38.45159149169922, -37.466190338134766,\
          \ -32.51167297363281, -35.718780517578125, ... \n```\n\nAs I understand,\
          \ scores should be an integer. But the decoder can't decode if it's not\
          \ an integer value. \nAny advice? "
        updatedAt: '2022-06-10T14:48:48.903Z'
      numEdits: 2
      reactions: []
    id: 62a358a0caf61b6a606b7d7b
    type: comment
  author: EnesDS
  content: "I wanted to get scores for each question I asked. When I followed the\
    \ suggested method here https://huggingface.co/docs/transformers/v4.19.3/en/internal/generation_utils#transformers.generation_utils.GreedySearchEncoderDecoderOutput.scores\n\
    \nI get this error:\n```\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_fast.py\
    \ in _decode(self, token_ids, skip_special_tokens, clean_up_tokenization_spaces,\
    \ **kwargs)\n    545         if isinstance(token_ids, int):\n    546         \
    \    token_ids = [token_ids]\n--> 547         text = self._tokenizer.decode(token_ids,\
    \ skip_special_tokens=skip_special_tokens)\n    548 \n    549         if clean_up_tokenization_spaces:\n\
    \nTypeError: Can't convert {'sequences': [[0, 25439, 1]], 'scores': [[[-84.4974365234375,\
    \ -35.67204284667969, -44.91609573364258, -27.592676162719727, -38.73073196411133,\
    \ -37.58429718017578, -32.03908920288086, -41.34073257446289, -37.01685333251953,\
    \ -38.45159149169922, -37.466190338134766, -32.51167297363281, -35.718780517578125,\
    \ ... \n```\n\nAs I understand, scores should be an integer. But the decoder can't\
    \ decode if it's not an integer value. \nAny advice? "
  created_at: 2022-06-10 13:43:44+00:00
  edited: true
  hidden: false
  id: 62a358a0caf61b6a606b7d7b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
      fullname: Patrick von Platen
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: patrickvonplaten
      type: user
    createdAt: '2022-06-10T17:29:07.000Z'
    data:
      edited: false
      editors:
      - patrickvonplaten
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1584435275418-5dfcb1aada6d0311fd3d5448.jpeg?w=200&h=200&f=face
          fullname: Patrick von Platen
          isHf: true
          isPro: false
          name: patrickvonplaten
          type: user
        html: "<p>Hey <span data-props=\"{&quot;user&quot;:&quot;EnesDS&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/EnesDS\">@<span class=\"\
          underline\">EnesDS</span></a></span>\n\n\t</span></span>, I think you simply\
          \ need to replace <code>token_ids</code> simply by <code>token_ids.sequences</code>in\
          \ <code>self._tokenizer.decode(...)</code> - could you try this maybe?</p>\n"
        raw: Hey @EnesDS, I think you simply need to replace `token_ids` simply by
          `token_ids.sequences`in `self._tokenizer.decode(...)` - could you try this
          maybe?
        updatedAt: '2022-06-10T17:29:07.108Z'
      numEdits: 0
      reactions: []
    id: 62a37f6386968c944925b52f
    type: comment
  author: patrickvonplaten
  content: Hey @EnesDS, I think you simply need to replace `token_ids` simply by `token_ids.sequences`in
    `self._tokenizer.decode(...)` - could you try this maybe?
  created_at: 2022-06-10 16:29:07+00:00
  edited: false
  hidden: false
  id: 62a37f6386968c944925b52f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c90807a9241bf6df04df8f11dc3c99b4.svg
      fullname: Enes Gokce
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: EnesDS
      type: user
    createdAt: '2022-06-17T19:41:04.000Z'
    data:
      edited: true
      editors:
      - EnesDS
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c90807a9241bf6df04df8f11dc3c99b4.svg
          fullname: Enes Gokce
          isHf: false
          isPro: false
          name: EnesDS
          type: user
        html: '<p>Thank you, Patrick!<br>I tried this, but it still didn''t work.<br>Here
          is the part where I made the change from the file <strong>transformers/token_utils_fast.py</strong>:<br><a
          rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/1655494662177-61269dfe46cc6aab1f590ba3.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1655494662177-61269dfe46cc6aab1f590ba3.png"></a></p>

          <p>Here is the output after the change of the issue:<br><a rel="nofollow"
          href="https://cdn-uploads.huggingface.co/production/uploads/1655494717808-61269dfe46cc6aab1f590ba3.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/1655494717808-61269dfe46cc6aab1f590ba3.png"></a></p>

          <p>This is such a great abstractive QA model! To be able to obtain the confidence
          score would open a door to a great ways of usage.</p>

          '
        raw: "Thank you, Patrick! \nI tried this, but it still didn't work. \nHere\
          \ is the part where I made the change from the file **transformers/token_utils_fast.py**:\n\
          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1655494662177-61269dfe46cc6aab1f590ba3.png)\n\
          \n\nHere is the output after the change of the issue:\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1655494717808-61269dfe46cc6aab1f590ba3.png)\n\
          \nThis is such a great abstractive QA model! To be able to obtain the confidence\
          \ score would open a door to a great ways of usage."
        updatedAt: '2022-06-17T19:44:05.529Z'
      numEdits: 1
      reactions: []
    id: 62acd8d07bd21e09d02438b9
    type: comment
  author: EnesDS
  content: "Thank you, Patrick! \nI tried this, but it still didn't work. \nHere is\
    \ the part where I made the change from the file **transformers/token_utils_fast.py**:\n\
    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/1655494662177-61269dfe46cc6aab1f590ba3.png)\n\
    \n\nHere is the output after the change of the issue:\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/1655494717808-61269dfe46cc6aab1f590ba3.png)\n\
    \nThis is such a great abstractive QA model! To be able to obtain the confidence\
    \ score would open a door to a great ways of usage."
  created_at: 2022-06-17 18:41:04+00:00
  edited: true
  hidden: false
  id: 62acd8d07bd21e09d02438b9
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: google/t5-3b-ssm-nq
repo_type: model
status: open
target_branch: null
title: How to obtain 'score' outputs?
