!!python/object:huggingface_hub.community.DiscussionWithDetails
author: twwch
conflicting_files: null
created_at: 2023-10-13 04:18:04+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/645c8cb5a03f3ebb0bdd2dc6/Htb9kqX6jj9468IPYRzjS.png?w=200&h=200&f=face
      fullname: chenhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: twwch
      type: user
    createdAt: '2023-10-13T05:18:04.000Z'
    data:
      edited: false
      editors:
      - twwch
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.3379089832305908
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/645c8cb5a03f3ebb0bdd2dc6/Htb9kqX6jj9468IPYRzjS.png?w=200&h=200&f=face
          fullname: chenhao
          isHf: false
          isPro: false
          name: twwch
          type: user
        html: '<p>Traceback (most recent call last):<br>  File "/data/chenhao/codes/kmai-model/src/test.py",
          line 7, in <br>    tokenizer = PegasusTokenizer.from_pretrained("/data/models/kmai/IDEA-CCNL/Randeng-Pegasus-523M-Summary-Chinese")<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py",
          line 2045, in from_pretrained<br>    return cls._from_pretrained(<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py",
          line 2256, in _from_pretrained<br>    tokenizer = cls(*init_inputs, **init_kwargs)<br>  File
          "/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py", line 154, in
          <strong>init</strong><br>    super().<strong>init</strong>(<br>  File "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py",
          line 366, in <strong>init</strong><br>    self._add_tokens(self.all_special_tokens_extended,
          special_tokens=True)<br>  File "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py",
          line 462, in _add_tokens<br>    current_vocab = self.get_vocab().copy()<br>  File
          "/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py", line 207, in
          get_vocab<br>    return dict(self.vocab, **self.added_tokens_encoder)<br>AttributeError:
          ''PegasusTokenizer'' object has no attribute ''vocab''</p>

          <p>Traceback (most recent call last):<br>  File "/data/chenhao/codes/kmai-model/src/test.py",
          line 12, in <br>    summary_ids = model.generate(inputs["input_ids"])<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/utils/_contextlib.py",
          line 115, in decorate_context<br>    return func(*args, **kwargs)<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py",
          line 1496, in generate<br>    model_kwargs = self._prepare_encoder_decoder_kwargs_for_generation(<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py",
          line 661, in _prepare_encoder_decoder_kwargs_for_generation<br>    model_kwargs["encoder_outputs"]:
          ModelOutput = encoder(**encoder_kwargs)<br>  File "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 1518, in _wrapped_call_impl<br>    return self._call_impl(*args, **kwargs)<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 1527, in _call_impl<br>    return forward_call(*args, **kwargs)<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/models/pegasus/modeling_pegasus.py",
          line 769, in forward<br>    inputs_embeds = self.embed_tokens(input_ids)
          * self.embed_scale<br>  File "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 1518, in _wrapped_call_impl<br>    return self._call_impl(*args, **kwargs)<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 1527, in _call_impl<br>    return forward_call(*args, **kwargs)<br>  File
          "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/sparse.py",
          line 162, in forward<br>    return F.embedding(<br>  File "/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/functional.py",
          line 2233, in embedding<br>    return torch.embedding(weight, input, padding_idx,
          scale_grad_by_freq, sparse)<br>IndexError: index out of range in self</p>

          '
        raw: "Traceback (most recent call last):\r\n  File \"/data/chenhao/codes/kmai-model/src/test.py\"\
          , line 7, in <module>\r\n    tokenizer = PegasusTokenizer.from_pretrained(\"\
          /data/models/kmai/IDEA-CCNL/Randeng-Pegasus-523M-Summary-Chinese\")\r\n\
          \  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py\"\
          , line 2045, in from_pretrained\r\n    return cls._from_pretrained(\r\n\
          \  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py\"\
          , line 2256, in _from_pretrained\r\n    tokenizer = cls(*init_inputs, **init_kwargs)\r\
          \n  File \"/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py\", line\
          \ 154, in __init__\r\n    super().__init__(\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py\"\
          , line 366, in __init__\r\n    self._add_tokens(self.all_special_tokens_extended,\
          \ special_tokens=True)\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py\"\
          , line 462, in _add_tokens\r\n    current_vocab = self.get_vocab().copy()\r\
          \n  File \"/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py\", line\
          \ 207, in get_vocab\r\n    return dict(self.vocab, **self.added_tokens_encoder)\r\
          \nAttributeError: 'PegasusTokenizer' object has no attribute 'vocab'\r\n\
          \r\n\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"/data/chenhao/codes/kmai-model/src/test.py\"\
          , line 12, in <module>\r\n    summary_ids = model.generate(inputs[\"input_ids\"\
          ])\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/utils/_contextlib.py\"\
          , line 115, in decorate_context\r\n    return func(*args, **kwargs)\r\n\
          \  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py\"\
          , line 1496, in generate\r\n    model_kwargs = self._prepare_encoder_decoder_kwargs_for_generation(\r\
          \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py\"\
          , line 661, in _prepare_encoder_decoder_kwargs_for_generation\r\n    model_kwargs[\"\
          encoder_outputs\"]: ModelOutput = encoder(**encoder_kwargs)\r\n  File \"\
          /data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 1518, in _wrapped_call_impl\r\n    return self._call_impl(*args,\
          \ **kwargs)\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 1527, in _call_impl\r\n    return forward_call(*args, **kwargs)\r\
          \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/models/pegasus/modeling_pegasus.py\"\
          , line 769, in forward\r\n    inputs_embeds = self.embed_tokens(input_ids)\
          \ * self.embed_scale\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 1518, in _wrapped_call_impl\r\n    return self._call_impl(*args,\
          \ **kwargs)\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 1527, in _call_impl\r\n    return forward_call(*args, **kwargs)\r\
          \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/sparse.py\"\
          , line 162, in forward\r\n    return F.embedding(\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/functional.py\"\
          , line 2233, in embedding\r\n    return torch.embedding(weight, input, padding_idx,\
          \ scale_grad_by_freq, sparse)\r\nIndexError: index out of range in self"
        updatedAt: '2023-10-13T05:18:04.994Z'
      numEdits: 0
      reactions: []
    id: 6528d30c7d6f8e0bf0d64f5d
    type: comment
  author: twwch
  content: "Traceback (most recent call last):\r\n  File \"/data/chenhao/codes/kmai-model/src/test.py\"\
    , line 7, in <module>\r\n    tokenizer = PegasusTokenizer.from_pretrained(\"/data/models/kmai/IDEA-CCNL/Randeng-Pegasus-523M-Summary-Chinese\"\
    )\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py\"\
    , line 2045, in from_pretrained\r\n    return cls._from_pretrained(\r\n  File\
    \ \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils_base.py\"\
    , line 2256, in _from_pretrained\r\n    tokenizer = cls(*init_inputs, **init_kwargs)\r\
    \n  File \"/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py\", line 154,\
    \ in __init__\r\n    super().__init__(\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py\"\
    , line 366, in __init__\r\n    self._add_tokens(self.all_special_tokens_extended,\
    \ special_tokens=True)\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/tokenization_utils.py\"\
    , line 462, in _add_tokens\r\n    current_vocab = self.get_vocab().copy()\r\n\
    \  File \"/data/chenhao/codes/kmai-model/src/tokenizers_pegasus.py\", line 207,\
    \ in get_vocab\r\n    return dict(self.vocab, **self.added_tokens_encoder)\r\n\
    AttributeError: 'PegasusTokenizer' object has no attribute 'vocab'\r\n\r\n\r\n\
    \r\n\r\nTraceback (most recent call last):\r\n  File \"/data/chenhao/codes/kmai-model/src/test.py\"\
    , line 12, in <module>\r\n    summary_ids = model.generate(inputs[\"input_ids\"\
    ])\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/utils/_contextlib.py\"\
    , line 115, in decorate_context\r\n    return func(*args, **kwargs)\r\n  File\
    \ \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py\"\
    , line 1496, in generate\r\n    model_kwargs = self._prepare_encoder_decoder_kwargs_for_generation(\r\
    \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/generation/utils.py\"\
    , line 661, in _prepare_encoder_decoder_kwargs_for_generation\r\n    model_kwargs[\"\
    encoder_outputs\"]: ModelOutput = encoder(**encoder_kwargs)\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 1518, in _wrapped_call_impl\r\n    return self._call_impl(*args, **kwargs)\r\
    \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 1527, in _call_impl\r\n    return forward_call(*args, **kwargs)\r\n  File\
    \ \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/transformers/models/pegasus/modeling_pegasus.py\"\
    , line 769, in forward\r\n    inputs_embeds = self.embed_tokens(input_ids) * self.embed_scale\r\
    \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 1518, in _wrapped_call_impl\r\n    return self._call_impl(*args, **kwargs)\r\
    \n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 1527, in _call_impl\r\n    return forward_call(*args, **kwargs)\r\n  File\
    \ \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/modules/sparse.py\"\
    , line 162, in forward\r\n    return F.embedding(\r\n  File \"/data/chenhao/anaconda/envs/kmai/lib/python3.10/site-packages/torch/nn/functional.py\"\
    , line 2233, in embedding\r\n    return torch.embedding(weight, input, padding_idx,\
    \ scale_grad_by_freq, sparse)\r\nIndexError: index out of range in self"
  created_at: 2023-10-13 04:18:04+00:00
  edited: false
  hidden: false
  id: 6528d30c7d6f8e0bf0d64f5d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/645c8cb5a03f3ebb0bdd2dc6/Htb9kqX6jj9468IPYRzjS.png?w=200&h=200&f=face
      fullname: chenhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: twwch
      type: user
    createdAt: '2023-10-13T05:18:40.000Z'
    data:
      from: "\u63A8\u7406\u4EE3\u7801\u6709\u4E24\u4E2A\u95EE\u9898\uFF0C"
      to: "\u63A8\u7406\u4EE3\u7801\u6709\u4E24\u4E2A\u95EE\u9898\uFF0Cself.vocab\
        \ \u548C model.generate"
    id: 6528d3309903f7a1c905f18e
    type: title-change
  author: twwch
  created_at: 2023-10-13 04:18:40+00:00
  id: 6528d3309903f7a1c905f18e
  new_title: "\u63A8\u7406\u4EE3\u7801\u6709\u4E24\u4E2A\u95EE\u9898\uFF0Cself.vocab\
    \ \u548C model.generate"
  old_title: "\u63A8\u7406\u4EE3\u7801\u6709\u4E24\u4E2A\u95EE\u9898\uFF0C"
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/002ed2218cda651fb8dacaf38a8fd5a2.svg
      fullname: yhy
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: idFishWithCat
      type: user
    createdAt: '2023-10-24T12:59:39.000Z'
    data:
      edited: false
      editors:
      - idFishWithCat
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.998167872428894
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/002ed2218cda651fb8dacaf38a8fd5a2.svg
          fullname: yhy
          isHf: false
          isPro: false
          name: idFishWithCat
          type: user
        html: "<p>\u6211\u4E5F\u4E0D\u884C\uFF0C\u8FD9\u4E2A\u6A21\u578B\u5230\u5E95\
          \u80FD\u4E0D\u80FD\u8DD1\u7684\u901A\uFF1F\uFF1F\uFF1F</p>\n"
        raw: "\u6211\u4E5F\u4E0D\u884C\uFF0C\u8FD9\u4E2A\u6A21\u578B\u5230\u5E95\u80FD\
          \u4E0D\u80FD\u8DD1\u7684\u901A\uFF1F\uFF1F\uFF1F"
        updatedAt: '2023-10-24T12:59:39.819Z'
      numEdits: 0
      reactions: []
    id: 6537bfbb62dd8126cfa030d0
    type: comment
  author: idFishWithCat
  content: "\u6211\u4E5F\u4E0D\u884C\uFF0C\u8FD9\u4E2A\u6A21\u578B\u5230\u5E95\u80FD\
    \u4E0D\u80FD\u8DD1\u7684\u901A\uFF1F\uFF1F\uFF1F"
  created_at: 2023-10-24 11:59:39+00:00
  edited: false
  hidden: false
  id: 6537bfbb62dd8126cfa030d0
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e0618826d65fe96ca345da3328a779ae.svg
      fullname: neobytes
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: neobytes
      type: user
    createdAt: '2023-11-06T06:38:12.000Z'
    data:
      edited: true
      editors: []
      hidden: true
      hiddenBy: ''
      latest:
        author:
          avatarUrl: /avatars/e0618826d65fe96ca345da3328a779ae.svg
          fullname: neobytes
          isHf: false
          isPro: false
          name: neobytes
          type: user
        html: This comment has been hidden
        raw: This comment has been hidden
        updatedAt: '2023-11-06T06:39:05.109Z'
      numEdits: 1
      reactions: []
    id: 654889d4c6dadd513f592d9d
    type: comment
  author: neobytes
  content: This comment has been hidden
  created_at: 2023-11-06 06:38:12+00:00
  edited: true
  hidden: true
  id: 654889d4c6dadd513f592d9d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e0618826d65fe96ca345da3328a779ae.svg
      fullname: neobytes
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: neobytes
      type: user
    createdAt: '2023-11-06T06:39:26.000Z'
    data:
      edited: false
      editors:
      - neobytes
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4714124798774719
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e0618826d65fe96ca345da3328a779ae.svg
          fullname: neobytes
          isHf: false
          isPro: false
          name: neobytes
          type: user
        html: '<p>Same issue,<br>Either<br>File "/opt/homebrew/lib/python3.8/site-packages/sentencepiece/init.py",
          line 310, in LoadFromFile<br>return _sentencepiece.SentencePieceProcessor_LoadFromFile(self,
          arg)<br>TypeError: not a string</p>

          <p>or</p>

          <p>File "/Users/username/Path.../tokenizers_pegasus.py", line 209, in get_vocab<br>return
          dict(self.vocab, **self.added_tokens_encoder)<br>AttributeError: ''PegasusTokenizer''
          object has no attribute ''vocab''</p>

          <p>The model is not runnable ?</p>

          '
        raw: 'Same issue,

          Either

          File "/opt/homebrew/lib/python3.8/site-packages/sentencepiece/init.py",
          line 310, in LoadFromFile

          return _sentencepiece.SentencePieceProcessor_LoadFromFile(self, arg)

          TypeError: not a string


          or


          File "/Users/username/Path.../tokenizers_pegasus.py", line 209, in get_vocab

          return dict(self.vocab, **self.added_tokens_encoder)

          AttributeError: ''PegasusTokenizer'' object has no attribute ''vocab''


          The model is not runnable ?'
        updatedAt: '2023-11-06T06:39:26.158Z'
      numEdits: 0
      reactions: []
    id: 65488a1e08568852409befd9
    type: comment
  author: neobytes
  content: 'Same issue,

    Either

    File "/opt/homebrew/lib/python3.8/site-packages/sentencepiece/init.py", line 310,
    in LoadFromFile

    return _sentencepiece.SentencePieceProcessor_LoadFromFile(self, arg)

    TypeError: not a string


    or


    File "/Users/username/Path.../tokenizers_pegasus.py", line 209, in get_vocab

    return dict(self.vocab, **self.added_tokens_encoder)

    AttributeError: ''PegasusTokenizer'' object has no attribute ''vocab''


    The model is not runnable ?'
  created_at: 2023-11-06 06:39:26+00:00
  edited: false
  hidden: false
  id: 65488a1e08568852409befd9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/002ed2218cda651fb8dacaf38a8fd5a2.svg
      fullname: yhy
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: idFishWithCat
      type: user
    createdAt: '2023-11-06T06:43:12.000Z'
    data:
      edited: false
      editors:
      - idFishWithCat
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9789928793907166
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/002ed2218cda651fb8dacaf38a8fd5a2.svg
          fullname: yhy
          isHf: false
          isPro: false
          name: idFishWithCat
          type: user
        html: '<p>yes, can''t run!</p>

          '
        raw: yes, can't run!
        updatedAt: '2023-11-06T06:43:12.200Z'
      numEdits: 0
      reactions: []
    id: 65488b0028b7019eae5d5ddb
    type: comment
  author: idFishWithCat
  content: yes, can't run!
  created_at: 2023-11-06 06:43:12+00:00
  edited: false
  hidden: false
  id: 65488b0028b7019eae5d5ddb
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 6
repo_id: IDEA-CCNL/Randeng-Pegasus-523M-Summary-Chinese
repo_type: model
status: open
target_branch: null
title: "\u63A8\u7406\u4EE3\u7801\u6709\u4E24\u4E2A\u95EE\u9898\uFF0Cself.vocab \u548C\
  \ model.generate"
