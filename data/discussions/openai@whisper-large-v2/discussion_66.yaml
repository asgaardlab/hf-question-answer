!!python/object:huggingface_hub.community.DiscussionWithDetails
author: wangxuanqi333
conflicting_files: null
created_at: 2023-09-11 04:48:30+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/9721dd949dcb3285436b2a5aebe8f249.svg
      fullname: wangxuanqi333
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: wangxuanqi333
      type: user
    createdAt: '2023-09-11T05:48:30.000Z'
    data:
      edited: false
      editors:
      - wangxuanqi333
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.85526442527771
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/9721dd949dcb3285436b2a5aebe8f249.svg
          fullname: wangxuanqi333
          isHf: false
          isPro: false
          name: wangxuanqi333
          type: user
        html: '<p>Hello everyone,</p>

          <p>I am working on an Automatic Speech Recognition (ASR) task for the Chinese
          language and I''ve encountered some inconsistencies between two different
          approaches. My goal is to understand why the results are different and how
          to debug or compare them in detail.</p>

          <h4 id="code-1">Code 1:</h4>

          <pre><code class="language-python">prediction1 = pipe(channel_waveform_np,
          batch_size=<span class="hljs-number">8</span>)[<span class="hljs-string">"text"</span>]

          </code></pre>

          <h4 id="code-2">Code 2:</h4>

          <pre><code class="language-python">prediction2 = pipe(channel_waveform_np,
          batch_size=<span class="hljs-number">8</span>, generate_kwargs={<span class="hljs-string">"language"</span>:
          <span class="hljs-string">""</span>, <span class="hljs-string">"task"</span>:
          <span class="hljs-string">"transcribe"</span>})[<span class="hljs-string">"text"</span>]

          </code></pre>

          <h4 id="observations">Observations:</h4>

          <ol>

          <li>Code 1 produces English text as output, whereas Code 2 produces Chinese
          text.</li>

          <li>The content of the outputs from Code 1 and Code 2 are also different.</li>

          <li>Surprisingly, the quality of the output from Code 1 is better than that
          from Code 2.</li>

          </ol>

          <p>The only noticeable difference between these two pieces of code is the
          <code>generate_kwargs</code> parameter.</p>

          <p>I am keen to understand:</p>

          <ul>

          <li>What exactly happens inside the <code>pipe()</code> function in both
          cases?</li>

          <li>Why is <code>generate_kwargs</code> affecting the output quality and
          language?</li>

          <li>Is there a way to compare the internal workings of these two approaches?</li>

          </ul>

          <p>Any guidance or suggestions would be greatly appreciated!</p>

          <p>Thank you!</p>

          '
        raw: "Hello everyone,\r\n\r\nI am working on an Automatic Speech Recognition\
          \ (ASR) task for the Chinese language and I've encountered some inconsistencies\
          \ between two different approaches. My goal is to understand why the results\
          \ are different and how to debug or compare them in detail.\r\n\r\n####\
          \ Code 1:\r\n```python\r\nprediction1 = pipe(channel_waveform_np, batch_size=8)[\"\
          text\"]\r\n```\r\n\r\n#### Code 2:\r\n```python\r\nprediction2 = pipe(channel_waveform_np,\
          \ batch_size=8, generate_kwargs={\"language\": \"\", \"task\": \"transcribe\"\
          })[\"text\"]\r\n```\r\n\r\n#### Observations:\r\n\r\n1. Code 1 produces\
          \ English text as output, whereas Code 2 produces Chinese text.\r\n2. The\
          \ content of the outputs from Code 1 and Code 2 are also different.\r\n\
          3. Surprisingly, the quality of the output from Code 1 is better than that\
          \ from Code 2.\r\n\r\nThe only noticeable difference between these two pieces\
          \ of code is the `generate_kwargs` parameter.\r\n\r\nI am keen to understand:\r\
          \n\r\n- What exactly happens inside the `pipe()` function in both cases?\r\
          \n- Why is `generate_kwargs` affecting the output quality and language?\r\
          \n- Is there a way to compare the internal workings of these two approaches?\r\
          \n\r\nAny guidance or suggestions would be greatly appreciated!\r\n\r\n\
          Thank you!\r\n"
        updatedAt: '2023-09-11T05:48:30.267Z'
      numEdits: 0
      reactions: []
    id: 64feaa2ee0dc35986b003009
    type: comment
  author: wangxuanqi333
  content: "Hello everyone,\r\n\r\nI am working on an Automatic Speech Recognition\
    \ (ASR) task for the Chinese language and I've encountered some inconsistencies\
    \ between two different approaches. My goal is to understand why the results are\
    \ different and how to debug or compare them in detail.\r\n\r\n#### Code 1:\r\n\
    ```python\r\nprediction1 = pipe(channel_waveform_np, batch_size=8)[\"text\"]\r\
    \n```\r\n\r\n#### Code 2:\r\n```python\r\nprediction2 = pipe(channel_waveform_np,\
    \ batch_size=8, generate_kwargs={\"language\": \"\", \"task\": \"transcribe\"\
    })[\"text\"]\r\n```\r\n\r\n#### Observations:\r\n\r\n1. Code 1 produces English\
    \ text as output, whereas Code 2 produces Chinese text.\r\n2. The content of the\
    \ outputs from Code 1 and Code 2 are also different.\r\n3. Surprisingly, the quality\
    \ of the output from Code 1 is better than that from Code 2.\r\n\r\nThe only noticeable\
    \ difference between these two pieces of code is the `generate_kwargs` parameter.\r\
    \n\r\nI am keen to understand:\r\n\r\n- What exactly happens inside the `pipe()`\
    \ function in both cases?\r\n- Why is `generate_kwargs` affecting the output quality\
    \ and language?\r\n- Is there a way to compare the internal workings of these\
    \ two approaches?\r\n\r\nAny guidance or suggestions would be greatly appreciated!\r\
    \n\r\nThank you!\r\n"
  created_at: 2023-09-11 04:48:30+00:00
  edited: false
  hidden: false
  id: 64feaa2ee0dc35986b003009
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/9721dd949dcb3285436b2a5aebe8f249.svg
      fullname: wangxuanqi333
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: wangxuanqi333
      type: user
    createdAt: '2023-09-12T08:54:52.000Z'
    data:
      status: closed
    id: 6500275c3587d3ebfd8d75cc
    type: status-change
  author: wangxuanqi333
  created_at: 2023-09-12 07:54:52+00:00
  id: 6500275c3587d3ebfd8d75cc
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
      fullname: Arthur Zucker
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ArthurZ
      type: user
    createdAt: '2023-09-14T16:56:15.000Z'
    data:
      edited: false
      editors:
      - ArthurZ
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7683528065681458
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1674683851722-62441cb7456803e95009a08f.jpeg?w=200&h=200&f=face
          fullname: Arthur Zucker
          isHf: true
          isPro: false
          name: ArthurZ
          type: user
        html: '<p>Hey! You should take a look at the modeling file of <code>whisper</code>
          <a rel="nofollow" href="https://github.com/huggingface/transformers/issues/26165">here</a>:</p>

          '
        raw: 'Hey! You should take a look at the modeling file of `whisper` [here](https://github.com/huggingface/transformers/issues/26165):'
        updatedAt: '2023-09-14T16:56:15.724Z'
      numEdits: 0
      reactions: []
    id: 65033b2f54b03500128e6951
    type: comment
  author: ArthurZ
  content: 'Hey! You should take a look at the modeling file of `whisper` [here](https://github.com/huggingface/transformers/issues/26165):'
  created_at: 2023-09-14 15:56:15+00:00
  edited: false
  hidden: false
  id: 65033b2f54b03500128e6951
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: false
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2023-09-28T18:38:12.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7886815667152405
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: '<p>There''s a very extensive guide on what these parameters do in the
          Audio Transformers Course: <a href="https://huggingface.co/learn/audio-course/chapter5/asr_models#graduation-to-seq2seq">https://huggingface.co/learn/audio-course/chapter5/asr_models#graduation-to-seq2seq</a></p>

          <p>Feel free to ask here if you have any further questions!</p>

          '
        raw: 'There''s a very extensive guide on what these parameters do in the Audio
          Transformers Course: https://huggingface.co/learn/audio-course/chapter5/asr_models#graduation-to-seq2seq


          Feel free to ask here if you have any further questions!'
        updatedAt: '2023-09-28T18:38:12.439Z'
      numEdits: 0
      reactions: []
    id: 6515c8141e7e8096c65d2dc4
    type: comment
  author: sanchit-gandhi
  content: 'There''s a very extensive guide on what these parameters do in the Audio
    Transformers Course: https://huggingface.co/learn/audio-course/chapter5/asr_models#graduation-to-seq2seq


    Feel free to ask here if you have any further questions!'
  created_at: 2023-09-28 17:38:12+00:00
  edited: false
  hidden: false
  id: 6515c8141e7e8096c65d2dc4
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 66
repo_id: openai/whisper-large-v2
repo_type: model
status: closed
target_branch: null
title: Discrepancies Between Two Approaches in Chinese ASR Task Using Transformers
  Pipeline
