!!python/object:huggingface_hub.community.DiscussionWithDetails
author: palloo
conflicting_files: null
created_at: 2023-09-11 14:50:08+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
      fullname: pranshuranjan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: palloo
      type: user
    createdAt: '2023-09-11T15:50:08.000Z'
    data:
      edited: false
      editors:
      - palloo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.4707184135913849
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
          fullname: pranshuranjan
          isHf: false
          isPro: false
          name: palloo
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;IfanSnek&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/IfanSnek\"\
          >@<span class=\"underline\">IfanSnek</span></a></span>\n\n\t</span></span>\
          \ I tried  , google cloab example provided in the model card.<br>on the\
          \ second cell of the code , i get below error:</p>\n<p>`---------------------------------------------------------------------------<br>ValueError\
          \                                Traceback (most recent call last)<br> in\
          \ &lt;cell line: 8&gt;()<br>      6 import colorama<br>      7<br>----&gt;\
          \ 8 base_model = AutoPeftModelForCausalLM.from_pretrained(<br>      9  \
          \   \"IfanSnek/bleat-adapter\",<br>     10     torch_dtype=torch.float16,</p>\n\
          <p>3 frames<br>/usr/local/lib/python3.10/dist-packages/accelerate/big_modeling.py\
          \ in dispatch_model(model, device_map, main_device, state_dict, offload_dir,\
          \ offload_index, offload_buffers, skip_keys, preload_module_classes)<br>\
          \    361         disk_modules = [name for name, device in device_map.items()\
          \ if device == \"disk\"]<br>    362         if offload_dir is None and offload_index\
          \ is None and len(disk_modules) &gt; 0:<br>--&gt; 363             raise\
          \ ValueError(<br>    364                 \"We need an <code>offload_dir</code>\
          \ to dispatch this model according to this <code>device_map</code>, the\
          \ following submodules \"<br>    365                 f\"need to be offloaded:\
          \ {', '.join(disk_modules)}.\"</p>\n<p>ValueError: We need an <code>offload_dir</code>\
          \ to dispatch this model according to this <code>device_map</code>, the\
          \ following submodules need to be offloaded: base_model.model.model.layers.24,\
          \ base_model.model.model.layers.25, base_model.model.model.layers.26, base_model.model.model.layers.27,\
          \ base_model.model.model.layers.28, base_model.model.model.layers.29, base_model.model.model.layers.30,\
          \ base_model.model.model.layers.31, base_model.model.model.norm, base_model.model.lm_head.`</p>\n"
        raw: "Hi @IfanSnek I tried  , google cloab example provided in the model card.\r\
          \non the second cell of the code , i get below error:\r\n\r\n`---------------------------------------------------------------------------\r\
          \nValueError                                Traceback (most recent call\
          \ last)\r\n<ipython-input-2-fe08f5381f34> in <cell line: 8>()\r\n      6\
          \ import colorama\r\n      7 \r\n----> 8 base_model = AutoPeftModelForCausalLM.from_pretrained(\r\
          \n      9     \"IfanSnek/bleat-adapter\",\r\n     10     torch_dtype=torch.float16,\r\
          \n\r\n3 frames\r\n/usr/local/lib/python3.10/dist-packages/accelerate/big_modeling.py\
          \ in dispatch_model(model, device_map, main_device, state_dict, offload_dir,\
          \ offload_index, offload_buffers, skip_keys, preload_module_classes)\r\n\
          \    361         disk_modules = [name for name, device in device_map.items()\
          \ if device == \"disk\"]\r\n    362         if offload_dir is None and offload_index\
          \ is None and len(disk_modules) > 0:\r\n--> 363             raise ValueError(\r\
          \n    364                 \"We need an `offload_dir` to dispatch this model\
          \ according to this `device_map`, the following submodules \"\r\n    365\
          \                 f\"need to be offloaded: {', '.join(disk_modules)}.\"\r\
          \n\r\nValueError: We need an `offload_dir` to dispatch this model according\
          \ to this `device_map`, the following submodules need to be offloaded: base_model.model.model.layers.24,\
          \ base_model.model.model.layers.25, base_model.model.model.layers.26, base_model.model.model.layers.27,\
          \ base_model.model.model.layers.28, base_model.model.model.layers.29, base_model.model.model.layers.30,\
          \ base_model.model.model.layers.31, base_model.model.model.norm, base_model.model.lm_head.`"
        updatedAt: '2023-09-11T15:50:08.424Z'
      numEdits: 0
      reactions: []
    id: 64ff3730c7fee6b556f30629
    type: comment
  author: palloo
  content: "Hi @IfanSnek I tried  , google cloab example provided in the model card.\r\
    \non the second cell of the code , i get below error:\r\n\r\n`---------------------------------------------------------------------------\r\
    \nValueError                                Traceback (most recent call last)\r\
    \n<ipython-input-2-fe08f5381f34> in <cell line: 8>()\r\n      6 import colorama\r\
    \n      7 \r\n----> 8 base_model = AutoPeftModelForCausalLM.from_pretrained(\r\
    \n      9     \"IfanSnek/bleat-adapter\",\r\n     10     torch_dtype=torch.float16,\r\
    \n\r\n3 frames\r\n/usr/local/lib/python3.10/dist-packages/accelerate/big_modeling.py\
    \ in dispatch_model(model, device_map, main_device, state_dict, offload_dir, offload_index,\
    \ offload_buffers, skip_keys, preload_module_classes)\r\n    361         disk_modules\
    \ = [name for name, device in device_map.items() if device == \"disk\"]\r\n  \
    \  362         if offload_dir is None and offload_index is None and len(disk_modules)\
    \ > 0:\r\n--> 363             raise ValueError(\r\n    364                 \"\
    We need an `offload_dir` to dispatch this model according to this `device_map`,\
    \ the following submodules \"\r\n    365                 f\"need to be offloaded:\
    \ {', '.join(disk_modules)}.\"\r\n\r\nValueError: We need an `offload_dir` to\
    \ dispatch this model according to this `device_map`, the following submodules\
    \ need to be offloaded: base_model.model.model.layers.24, base_model.model.model.layers.25,\
    \ base_model.model.model.layers.26, base_model.model.model.layers.27, base_model.model.model.layers.28,\
    \ base_model.model.model.layers.29, base_model.model.model.layers.30, base_model.model.model.layers.31,\
    \ base_model.model.model.norm, base_model.model.lm_head.`"
  created_at: 2023-09-11 14:50:08+00:00
  edited: false
  hidden: false
  id: 64ff3730c7fee6b556f30629
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
      fullname: IfanSnek
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: IfanSnek
      type: user
    createdAt: '2023-09-11T16:07:08.000Z'
    data:
      edited: false
      editors:
      - IfanSnek
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9909694790840149
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
          fullname: IfanSnek
          isHf: false
          isPro: false
          name: IfanSnek
          type: user
        html: '<p>They probably changed something in the API since I made the model.
          I''ll take a look later, I''m busy until this afternoon </p>

          '
        raw: 'They probably changed something in the API since I made the model. I''ll
          take a look later, I''m busy until this afternoon '
        updatedAt: '2023-09-11T16:07:08.767Z'
      numEdits: 0
      reactions: []
    id: 64ff3b2c416b2a83cf4b7f96
    type: comment
  author: IfanSnek
  content: 'They probably changed something in the API since I made the model. I''ll
    take a look later, I''m busy until this afternoon '
  created_at: 2023-09-11 15:07:08+00:00
  edited: false
  hidden: false
  id: 64ff3b2c416b2a83cf4b7f96
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
      fullname: pranshuranjan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: palloo
      type: user
    createdAt: '2023-09-11T16:23:17.000Z'
    data:
      edited: false
      editors:
      - palloo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6204224824905396
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
          fullname: pranshuranjan
          isHf: false
          isPro: false
          name: palloo
          type: user
        html: '<p>Alright , take your time!</p>

          '
        raw: Alright , take your time!
        updatedAt: '2023-09-11T16:23:17.758Z'
      numEdits: 0
      reactions: []
    id: 64ff3ef5217ac677bef00b9b
    type: comment
  author: palloo
  content: Alright , take your time!
  created_at: 2023-09-11 15:23:17+00:00
  edited: false
  hidden: false
  id: 64ff3ef5217ac677bef00b9b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
      fullname: pranshuranjan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: palloo
      type: user
    createdAt: '2023-09-12T16:16:10.000Z'
    data:
      edited: false
      editors:
      - palloo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9701071977615356
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
          fullname: pranshuranjan
          isHf: false
          isPro: false
          name: palloo
          type: user
        html: "<blockquote>\n<p>They probably changed something in the API since I\
          \ made the model. I'll take a look later, I'm busy until this afternoon</p>\n\
          </blockquote>\n<p>Any update <span data-props=\"{&quot;user&quot;:&quot;IfanSnek&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/IfanSnek\"\
          >@<span class=\"underline\">IfanSnek</span></a></span>\n\n\t</span></span>\
          \ ?</p>\n"
        raw: '> They probably changed something in the API since I made the model.
          I''ll take a look later, I''m busy until this afternoon


          Any update @IfanSnek ?'
        updatedAt: '2023-09-12T16:16:10.079Z'
      numEdits: 0
      reactions: []
    id: 65008eca1800b9cba2777ca8
    type: comment
  author: palloo
  content: '> They probably changed something in the API since I made the model. I''ll
    take a look later, I''m busy until this afternoon


    Any update @IfanSnek ?'
  created_at: 2023-09-12 15:16:10+00:00
  edited: false
  hidden: false
  id: 65008eca1800b9cba2777ca8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
      fullname: IfanSnek
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: IfanSnek
      type: user
    createdAt: '2023-09-12T17:29:11.000Z'
    data:
      edited: false
      editors:
      - IfanSnek
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5587722659111023
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
          fullname: IfanSnek
          isHf: false
          isPro: false
          name: IfanSnek
          type: user
        html: '<p>I fixed the notebook. Bleat.py will be updated soon. Just add offload_folder="./offload"
          if you need it</p>

          '
        raw: I fixed the notebook. Bleat.py will be updated soon. Just add offload_folder="./offload"
          if you need it
        updatedAt: '2023-09-12T17:29:11.316Z'
      numEdits: 0
      reactions: []
    id: 65009fe787b370a56ab74887
    type: comment
  author: IfanSnek
  content: I fixed the notebook. Bleat.py will be updated soon. Just add offload_folder="./offload"
    if you need it
  created_at: 2023-09-12 16:29:11+00:00
  edited: false
  hidden: false
  id: 65009fe787b370a56ab74887
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
      fullname: pranshuranjan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: palloo
      type: user
    createdAt: '2023-09-12T17:33:02.000Z'
    data:
      edited: false
      editors:
      - palloo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5150739550590515
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
          fullname: pranshuranjan
          isHf: false
          isPro: false
          name: palloo
          type: user
        html: '<p>Alright!</p>

          '
        raw: 'Alright!

          '
        updatedAt: '2023-09-12T17:33:02.662Z'
      numEdits: 0
      reactions: []
    id: 6500a0ce35ec97176299cea4
    type: comment
  author: palloo
  content: 'Alright!

    '
  created_at: 2023-09-12 16:33:02+00:00
  edited: false
  hidden: false
  id: 6500a0ce35ec97176299cea4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
      fullname: pranshuranjan
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: palloo
      type: user
    createdAt: '2023-09-12T18:03:55.000Z'
    data:
      edited: false
      editors:
      - palloo
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9192019104957581
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6451897a938967fd069f41b9/VPbAWifzVOviYWYbo3R_U.jpeg?w=200&h=200&f=face
          fullname: pranshuranjan
          isHf: false
          isPro: false
          name: palloo
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;IfanSnek&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/IfanSnek\">@<span class=\"\
          underline\">IfanSnek</span></a></span>\n\n\t</span></span>  it works relly\
          \ good, The results are awesome for having straight forward functions calls.</p>\n\
          <p>Can you share training script for further training along with used data\
          \ set, and if possible can you tell , can we train the 13B or 70B model\
          \ too with your script ?</p>\n"
        raw: '@IfanSnek  it works relly good, The results are awesome for having straight
          forward functions calls.


          Can you share training script for further training along with used data
          set, and if possible can you tell , can we train the 13B or 70B model too
          with your script ?'
        updatedAt: '2023-09-12T18:03:55.401Z'
      numEdits: 0
      reactions: []
    id: 6500a80b96ec8a521879f4b5
    type: comment
  author: palloo
  content: '@IfanSnek  it works relly good, The results are awesome for having straight
    forward functions calls.


    Can you share training script for further training along with used data set, and
    if possible can you tell , can we train the 13B or 70B model too with your script
    ?'
  created_at: 2023-09-12 17:03:55+00:00
  edited: false
  hidden: false
  id: 6500a80b96ec8a521879f4b5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
      fullname: IfanSnek
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: IfanSnek
      type: user
    createdAt: '2023-09-12T18:48:15.000Z'
    data:
      edited: false
      editors:
      - IfanSnek
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9430479407310486
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3515d667fe3880ce58139605abec4a72.svg
          fullname: IfanSnek
          isHf: false
          isPro: false
          name: IfanSnek
          type: user
        html: '<p>See train.py in files, and datasets used in the model card. I haven''t
          touched it in a while but it should work with any size. You will need access
          to the base model, I just used someone''s reupload in the example. Please
          open a new issue for any further questions, as I will close this one after
          fixing the bleat.py file</p>

          '
        raw: See train.py in files, and datasets used in the model card. I haven't
          touched it in a while but it should work with any size. You will need access
          to the base model, I just used someone's reupload in the example. Please
          open a new issue for any further questions, as I will close this one after
          fixing the bleat.py file
        updatedAt: '2023-09-12T18:48:15.184Z'
      numEdits: 0
      reactions: []
    id: 6500b26f6a230e55a6747322
    type: comment
  author: IfanSnek
  content: See train.py in files, and datasets used in the model card. I haven't touched
    it in a while but it should work with any size. You will need access to the base
    model, I just used someone's reupload in the example. Please open a new issue
    for any further questions, as I will close this one after fixing the bleat.py
    file
  created_at: 2023-09-12 17:48:15+00:00
  edited: false
  hidden: false
  id: 6500b26f6a230e55a6747322
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: IfanSnek/bleat-adapter
repo_type: model
status: open
target_branch: null
title: ValueError in colab example code!!
