!!python/object:huggingface_hub.community.DiscussionWithDetails
author: urbanfarmer22
conflicting_files: null
created_at: 2023-04-26 19:11:22+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
      fullname: urban farmer
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: urbanfarmer22
      type: user
    createdAt: '2023-04-26T20:11:22.000Z'
    data:
      edited: true
      editors:
      - urbanfarmer22
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
          fullname: urban farmer
          isHf: false
          isPro: false
          name: urbanfarmer22
          type: user
        html: '<p>Hey, </p>

          <p>I am using the SD2.1 model im combinatiotion with ControlNet v1.1.112,
          I downloaded all the safetensor models, put them in the right folder, changed
          the .YAML to the cldm_v21.yaml in the controlnet settings. enabled controlnet
          in text2image, used a scribble 2.1 model, it renders but it does not seem
          to be affected by controlnet, and I get these errors.. : (I included an
          image) Another another remarkable thing is that i don''t get the controlnet
          "mask" side to side next to the output, where the 1.5 model does this right.</p>

          <p>I tried everything but I really don''t know what to do :(</p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/sMXySaQIaIkLt-a0pr8m2.png"><img
          alt="Screenshot 2023-04-26 220607.png" src="https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/sMXySaQIaIkLt-a0pr8m2.png"></a></p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/f8H7B5H5NracHZY-fKUon.png"><img
          alt="Screenshot 2023-04-26 221315.png" src="https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/f8H7B5H5NracHZY-fKUon.png"></a></p>

          '
        raw: "Hey, \n\nI am using the SD2.1 model im combinatiotion with ControlNet\
          \ v1.1.112, I downloaded all the safetensor models, put them in the right\
          \ folder, changed the .YAML to the cldm_v21.yaml in the controlnet settings.\
          \ enabled controlnet in text2image, used a scribble 2.1 model, it renders\
          \ but it does not seem to be affected by controlnet, and I get these errors..\
          \ : (I included an image) Another another remarkable thing is that i don't\
          \ get the controlnet \"mask\" side to side next to the output, where the\
          \ 1.5 model does this right.\n\nI tried everything but I really don't know\
          \ what to do :(\n\n![Screenshot 2023-04-26 220607.png](https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/sMXySaQIaIkLt-a0pr8m2.png)\n\
          \n\n\n![Screenshot 2023-04-26 221315.png](https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/f8H7B5H5NracHZY-fKUon.png)"
        updatedAt: '2023-04-26T20:13:23.876Z'
      numEdits: 1
      reactions: []
    id: 6449856ab69e9ef0e5ea60e6
    type: comment
  author: urbanfarmer22
  content: "Hey, \n\nI am using the SD2.1 model im combinatiotion with ControlNet\
    \ v1.1.112, I downloaded all the safetensor models, put them in the right folder,\
    \ changed the .YAML to the cldm_v21.yaml in the controlnet settings. enabled controlnet\
    \ in text2image, used a scribble 2.1 model, it renders but it does not seem to\
    \ be affected by controlnet, and I get these errors.. : (I included an image)\
    \ Another another remarkable thing is that i don't get the controlnet \"mask\"\
    \ side to side next to the output, where the 1.5 model does this right.\n\nI tried\
    \ everything but I really don't know what to do :(\n\n![Screenshot 2023-04-26\
    \ 220607.png](https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/sMXySaQIaIkLt-a0pr8m2.png)\n\
    \n\n\n![Screenshot 2023-04-26 221315.png](https://cdn-uploads.huggingface.co/production/uploads/6370ff3b3434f2764ce673f6/f8H7B5H5NracHZY-fKUon.png)"
  created_at: 2023-04-26 19:11:22+00:00
  edited: true
  hidden: false
  id: 6449856ab69e9ef0e5ea60e6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661628312160-noauth.png?w=200&h=200&f=face
      fullname: Vladimir
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: vdruts
      type: user
    createdAt: '2023-04-26T20:35:56.000Z'
    data:
      edited: false
      editors:
      - vdruts
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661628312160-noauth.png?w=200&h=200&f=face
          fullname: Vladimir
          isHf: false
          isPro: false
          name: vdruts
          type: user
        html: '<p>You have the same error we''re all experiencing. Thibaud says he
          cannot replicate it.<br>Same issue &gt; <a href="https://huggingface.co/thibaud/controlnet-sd21/discussions/35">https://huggingface.co/thibaud/controlnet-sd21/discussions/35</a></p>

          '
        raw: "You have the same error we're all experiencing. Thibaud says he cannot\
          \ replicate it. \nSame issue > https://huggingface.co/thibaud/controlnet-sd21/discussions/35"
        updatedAt: '2023-04-26T20:35:56.886Z'
      numEdits: 0
      reactions: []
    id: 64498b2ca281f51a62b16035
    type: comment
  author: vdruts
  content: "You have the same error we're all experiencing. Thibaud says he cannot\
    \ replicate it. \nSame issue > https://huggingface.co/thibaud/controlnet-sd21/discussions/35"
  created_at: 2023-04-26 19:35:56+00:00
  edited: false
  hidden: false
  id: 64498b2ca281f51a62b16035
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/643cb43e6eeb746f5ad81c26/_DUtzHpNtpTeDw7u0oYyX.png?w=200&h=200&f=face
      fullname: Jaret Burkett
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ostris
      type: user
    createdAt: '2023-04-27T16:28:40.000Z'
    data:
      edited: false
      editors:
      - ostris
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/643cb43e6eeb746f5ad81c26/_DUtzHpNtpTeDw7u0oYyX.png?w=200&h=200&f=face
          fullname: Jaret Burkett
          isHf: false
          isPro: false
          name: ostris
          type: user
        html: '<p>I have not tested all models, but I did do depth and control net.
          People are alluding to this, but not being clear, at least to me. </p>

          <p>What worked is replace the content of every .yaml file from these models
          to the content of <a href="https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml">https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml</a>
          . </p>

          <p>Again, some may be different, but not that I can tell.</p>

          '
        raw: "I have not tested all models, but I did do depth and control net. People\
          \ are alluding to this, but not being clear, at least to me. \n\nWhat worked\
          \ is replace the content of every .yaml file from these models to the content\
          \ of https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml\
          \ . \n\nAgain, some may be different, but not that I can tell."
        updatedAt: '2023-04-27T16:28:40.593Z'
      numEdits: 0
      reactions:
      - count: 7
        reaction: "\U0001F44D"
        users:
        - hwnwhd4
        - rafaared
        - tomstsai
        - neilsonks
        - Kaamalauppias
        - RB-stla
        - Bellyny
      - count: 4
        reaction: "\U0001F917"
        users:
        - raztar
        - tomstsai
        - neilsonks
        - Kaamalauppias
      - count: 4
        reaction: "\u2764\uFE0F"
        users:
        - tomstsai
        - carlitoselmago
        - neilsonks
        - Kaamalauppias
    id: 644aa2b8cb45734dfd439fa3
    type: comment
  author: ostris
  content: "I have not tested all models, but I did do depth and control net. People\
    \ are alluding to this, but not being clear, at least to me. \n\nWhat worked is\
    \ replace the content of every .yaml file from these models to the content of\
    \ https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml\
    \ . \n\nAgain, some may be different, but not that I can tell."
  created_at: 2023-04-27 15:28:40+00:00
  edited: false
  hidden: false
  id: 644aa2b8cb45734dfd439fa3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
      fullname: urban farmer
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: urbanfarmer22
      type: user
    createdAt: '2023-04-27T23:23:20.000Z'
    data:
      edited: false
      editors:
      - urbanfarmer22
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
          fullname: urban farmer
          isHf: false
          isPro: false
          name: urbanfarmer22
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;jaret&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/jaret\">@<span class=\"\
          underline\">jaret</span></a></span>\n\n\t</span></span> Thanks dude amazing!!\
          \ It works!! You are a hero my man \U0001F64F\U0001F64F</p>\n"
        raw: "@jaret Thanks dude amazing!! It works!! You are a hero my man \U0001F64F\
          \U0001F64F"
        updatedAt: '2023-04-27T23:23:20.553Z'
      numEdits: 0
      reactions: []
    id: 644b03e8af97dfd24c158feb
    type: comment
  author: urbanfarmer22
  content: "@jaret Thanks dude amazing!! It works!! You are a hero my man \U0001F64F\
    \U0001F64F"
  created_at: 2023-04-27 22:23:20+00:00
  edited: false
  hidden: false
  id: 644b03e8af97dfd24c158feb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/640a355696aae649741681a5/DrxgdFpbL80gjOW3SZnYe.png?w=200&h=200&f=face
      fullname: Neilson Koerner-Safrata
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: neilsonks
      type: user
    createdAt: '2023-05-10T18:45:51.000Z'
    data:
      edited: false
      editors:
      - neilsonks
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/640a355696aae649741681a5/DrxgdFpbL80gjOW3SZnYe.png?w=200&h=200&f=face
          fullname: Neilson Koerner-Safrata
          isHf: false
          isPro: false
          name: neilsonks
          type: user
        html: '<p>Worked for me too, replaced the .yaml of canny, scribble, and depth
          and they all are good now</p>

          '
        raw: Worked for me too, replaced the .yaml of canny, scribble, and depth and
          they all are good now
        updatedAt: '2023-05-10T18:45:51.397Z'
      numEdits: 0
      reactions: []
    id: 645be65fb396a40a8493101e
    type: comment
  author: neilsonks
  content: Worked for me too, replaced the .yaml of canny, scribble, and depth and
    they all are good now
  created_at: 2023-05-10 17:45:51+00:00
  edited: false
  hidden: false
  id: 645be65fb396a40a8493101e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d75ead3bb20127147b43ff9fa1f22d12.svg
      fullname: windwolfx23
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: windwolfx23
      type: user
    createdAt: '2023-05-22T06:45:19.000Z'
    data:
      edited: false
      editors:
      - windwolfx23
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d75ead3bb20127147b43ff9fa1f22d12.svg
          fullname: windwolfx23
          isHf: false
          isPro: false
          name: windwolfx23
          type: user
        html: '<p>worked for me, have to rename them to "control_v11p_sd21_canny.yaml"
          "control_v11p_sd21_openpose.yaml" and so on, but where can we find yamal
          file for scribble mode?</p>

          '
        raw: worked for me, have to rename them to "control_v11p_sd21_canny.yaml"
          "control_v11p_sd21_openpose.yaml" and so on, but where can we find yamal
          file for scribble mode?
        updatedAt: '2023-05-22T06:45:19.727Z'
      numEdits: 0
      reactions: []
    id: 646b0f7fed228272131c1cf9
    type: comment
  author: windwolfx23
  content: worked for me, have to rename them to "control_v11p_sd21_canny.yaml" "control_v11p_sd21_openpose.yaml"
    and so on, but where can we find yamal file for scribble mode?
  created_at: 2023-05-22 05:45:19+00:00
  edited: false
  hidden: false
  id: 646b0f7fed228272131c1cf9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1673702870443-noauth.jpeg?w=200&h=200&f=face
      fullname: Pieter-Schalk Botha
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Piscabo
      type: user
    createdAt: '2023-05-23T12:51:14.000Z'
    data:
      edited: false
      editors:
      - Piscabo
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1673702870443-noauth.jpeg?w=200&h=200&f=face
          fullname: Pieter-Schalk Botha
          isHf: false
          isPro: false
          name: Piscabo
          type: user
        html: '<p>No matter what I do, I get this error. Have had no luck with using
          the 2.1 models at all. 1.5 works fine... Any new fixes? Or corrected yaml
          files that I can download and don''t need to rename other files, because
          I tried that and did not work for me, not everything I want to use is there
          anyway. I also tried Yaml files from Huggingface and the ones from GitHub.
          No luck. It renders but looks nothing like the control image. PLS a fix?<br>Loading
          model: control_v11p_sd21_canny [4ac9f628]<br>Loaded state_dict from [C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\models\control_v11p_sd21_canny.safetensors]<br>Loading
          config: C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\models\control_v11p_sd21_canny.yaml<br>Error
          running process: C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\scripts\controlnet.py<br>Traceback
          (most recent call last):<br>  File "C:\AI_Files\stable-diffusion-webui\modules\scripts.py",
          line 418, in process<br>    script.process(p, *script_args)<br>  File "C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\scripts\controlnet.py",
          line 1036, in process<br>    model_net = self.load_control_model(p, unet,
          unit.model, unit.low_vram)<br>  File "C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\scripts\controlnet.py",
          line 699, in load_control_model<br>    model_net = self.build_control_model(p,
          unet, model, lowvram)<br>  File "C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\scripts\controlnet.py",
          line 779, in build_control_model<br>    network = network_module(<br>  File
          "C:\AI_Files\stable-diffusion-webui\extensions\sd-webui-controlnet\scripts\cldm.py",
          line 91, in <strong>init</strong><br>    self.control_model.load_state_dict(state_dict)<br>  File
          "C:\AI_Files\stable-diffusion-webui\venv\lib\site-packages\torch\nn\modules\module.py",
          line 2041, in load_state_dict<br>    raise RuntimeError(''Error(s) in loading
          state_dict for {}:\n\t{}''.format(<br>RuntimeError: Error(s) in loading
          state_dict for ControlNet:</p>

          '
        raw: "No matter what I do, I get this error. Have had no luck with using the\
          \ 2.1 models at all. 1.5 works fine... Any new fixes? Or corrected yaml\
          \ files that I can download and don't need to rename other files, because\
          \ I tried that and did not work for me, not everything I want to use is\
          \ there anyway. I also tried Yaml files from Huggingface and the ones from\
          \ GitHub. No luck. It renders but looks nothing like the control image.\
          \ PLS a fix?\nLoading model: control_v11p_sd21_canny [4ac9f628]\nLoaded\
          \ state_dict from [C:\\AI_Files\\stable-diffusion-webui\\extensions\\sd-webui-controlnet\\\
          models\\control_v11p_sd21_canny.safetensors]\nLoading config: C:\\AI_Files\\\
          stable-diffusion-webui\\extensions\\sd-webui-controlnet\\models\\control_v11p_sd21_canny.yaml\n\
          Error running process: C:\\AI_Files\\stable-diffusion-webui\\extensions\\\
          sd-webui-controlnet\\scripts\\controlnet.py\nTraceback (most recent call\
          \ last):\n  File \"C:\\AI_Files\\stable-diffusion-webui\\modules\\scripts.py\"\
          , line 418, in process\n    script.process(p, *script_args)\n  File \"C:\\\
          AI_Files\\stable-diffusion-webui\\extensions\\sd-webui-controlnet\\scripts\\\
          controlnet.py\", line 1036, in process\n    model_net = self.load_control_model(p,\
          \ unet, unit.model, unit.low_vram)\n  File \"C:\\AI_Files\\stable-diffusion-webui\\\
          extensions\\sd-webui-controlnet\\scripts\\controlnet.py\", line 699, in\
          \ load_control_model\n    model_net = self.build_control_model(p, unet,\
          \ model, lowvram)\n  File \"C:\\AI_Files\\stable-diffusion-webui\\extensions\\\
          sd-webui-controlnet\\scripts\\controlnet.py\", line 779, in build_control_model\n\
          \    network = network_module(\n  File \"C:\\AI_Files\\stable-diffusion-webui\\\
          extensions\\sd-webui-controlnet\\scripts\\cldm.py\", line 91, in __init__\n\
          \    self.control_model.load_state_dict(state_dict)\n  File \"C:\\AI_Files\\\
          stable-diffusion-webui\\venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\"\
          , line 2041, in load_state_dict\n    raise RuntimeError('Error(s) in loading\
          \ state_dict for {}:\\n\\t{}'.format(\nRuntimeError: Error(s) in loading\
          \ state_dict for ControlNet:"
        updatedAt: '2023-05-23T12:51:14.467Z'
      numEdits: 0
      reactions: []
    id: 646cb6c2c23858f1392f5e98
    type: comment
  author: Piscabo
  content: "No matter what I do, I get this error. Have had no luck with using the\
    \ 2.1 models at all. 1.5 works fine... Any new fixes? Or corrected yaml files\
    \ that I can download and don't need to rename other files, because I tried that\
    \ and did not work for me, not everything I want to use is there anyway. I also\
    \ tried Yaml files from Huggingface and the ones from GitHub. No luck. It renders\
    \ but looks nothing like the control image. PLS a fix?\nLoading model: control_v11p_sd21_canny\
    \ [4ac9f628]\nLoaded state_dict from [C:\\AI_Files\\stable-diffusion-webui\\extensions\\\
    sd-webui-controlnet\\models\\control_v11p_sd21_canny.safetensors]\nLoading config:\
    \ C:\\AI_Files\\stable-diffusion-webui\\extensions\\sd-webui-controlnet\\models\\\
    control_v11p_sd21_canny.yaml\nError running process: C:\\AI_Files\\stable-diffusion-webui\\\
    extensions\\sd-webui-controlnet\\scripts\\controlnet.py\nTraceback (most recent\
    \ call last):\n  File \"C:\\AI_Files\\stable-diffusion-webui\\modules\\scripts.py\"\
    , line 418, in process\n    script.process(p, *script_args)\n  File \"C:\\AI_Files\\\
    stable-diffusion-webui\\extensions\\sd-webui-controlnet\\scripts\\controlnet.py\"\
    , line 1036, in process\n    model_net = self.load_control_model(p, unet, unit.model,\
    \ unit.low_vram)\n  File \"C:\\AI_Files\\stable-diffusion-webui\\extensions\\\
    sd-webui-controlnet\\scripts\\controlnet.py\", line 699, in load_control_model\n\
    \    model_net = self.build_control_model(p, unet, model, lowvram)\n  File \"\
    C:\\AI_Files\\stable-diffusion-webui\\extensions\\sd-webui-controlnet\\scripts\\\
    controlnet.py\", line 779, in build_control_model\n    network = network_module(\n\
    \  File \"C:\\AI_Files\\stable-diffusion-webui\\extensions\\sd-webui-controlnet\\\
    scripts\\cldm.py\", line 91, in __init__\n    self.control_model.load_state_dict(state_dict)\n\
    \  File \"C:\\AI_Files\\stable-diffusion-webui\\venv\\lib\\site-packages\\torch\\\
    nn\\modules\\module.py\", line 2041, in load_state_dict\n    raise RuntimeError('Error(s)\
    \ in loading state_dict for {}:\\n\\t{}'.format(\nRuntimeError: Error(s) in loading\
    \ state_dict for ControlNet:"
  created_at: 2023-05-23 11:51:14+00:00
  edited: false
  hidden: false
  id: 646cb6c2c23858f1392f5e98
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b7ef3e50079efa5a3ad412507a1f0e3c.svg
      fullname: Kormoran
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: korronald
      type: user
    createdAt: '2023-05-25T09:14:09.000Z'
    data:
      edited: false
      editors:
      - korronald
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b7ef3e50079efa5a3ad412507a1f0e3c.svg
          fullname: Kormoran
          isHf: false
          isPro: false
          name: korronald
          type: user
        html: '<blockquote>

          <p>I have not tested all models, but I did do depth and control net. People
          are alluding to this, but not being clear, at least to me. </p>

          <p>What worked is replace the content of every .yaml file from these models
          to the content of <a href="https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml">https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml</a>
          . </p>

          <p>Again, some may be different, but not that I can tell.</p>

          </blockquote>

          <p>Unfortunately this did not help in my case. I got the same error I had,
          when I used yaml 15 files:<br>RuntimeError: linear(): input and weight.T
          shapes cannot be multiplied (77x768 and 1024x320)</p>

          <p>Any idea what might be the cause?</p>

          '
        raw: "> I have not tested all models, but I did do depth and control net.\
          \ People are alluding to this, but not being clear, at least to me. \n>\
          \ \n> What worked is replace the content of every .yaml file from these\
          \ models to the content of https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml\
          \ . \n> \n> Again, some may be different, but not that I can tell.\n\nUnfortunately\
          \ this did not help in my case. I got the same error I had, when I used\
          \ yaml 15 files: \nRuntimeError: linear(): input and weight.T shapes cannot\
          \ be multiplied (77x768 and 1024x320)\n\nAny idea what might be the cause?"
        updatedAt: '2023-05-25T09:14:09.779Z'
      numEdits: 0
      reactions: []
    id: 646f26e1e2a72c647b656974
    type: comment
  author: korronald
  content: "> I have not tested all models, but I did do depth and control net. People\
    \ are alluding to this, but not being clear, at least to me. \n> \n> What worked\
    \ is replace the content of every .yaml file from these models to the content\
    \ of https://huggingface.co/furusu/ControlNet/blob/main/diff_control_wd15beta2_depth.yaml\
    \ . \n> \n> Again, some may be different, but not that I can tell.\n\nUnfortunately\
    \ this did not help in my case. I got the same error I had, when I used yaml 15\
    \ files: \nRuntimeError: linear(): input and weight.T shapes cannot be multiplied\
    \ (77x768 and 1024x320)\n\nAny idea what might be the cause?"
  created_at: 2023-05-25 08:14:09+00:00
  edited: false
  hidden: false
  id: 646f26e1e2a72c647b656974
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b7ef3e50079efa5a3ad412507a1f0e3c.svg
      fullname: Kormoran
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: korronald
      type: user
    createdAt: '2023-05-25T10:21:12.000Z'
    data:
      edited: false
      editors:
      - korronald
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b7ef3e50079efa5a3ad412507a1f0e3c.svg
          fullname: Kormoran
          isHf: false
          isPro: false
          name: korronald
          type: user
        html: '<p>I have similar issue.<br>I described it on GitHub: </p>

          <p><a rel="nofollow" href="https://github.com/Mikubill/sd-webui-controlnet/issues/1418">https://github.com/Mikubill/sd-webui-controlnet/issues/1418</a></p>

          <p>System version, webui version, CN version, and screenshots are there.<br>At
          this point I''m not sure if this is more ControlNet thing, models thing
          or yaml files thing.</p>

          <p>It all comes down to some size mismatch:<br>Error running process: /Users/rw/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/controlnet.py<br>File
          "/Users/rw/stable-diffusion-webui/venv-torch-nightly/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 2056, in load_state_dict<br>    raise RuntimeError(''Error(s) in loading
          state_dict for {}:\n\t{}''.format(<br>RuntimeError: Error(s) in loading
          state_dict for ControlNet:<br>    size mismatch for input_blocks.1.1.proj_in.weight:
          copying a param with shape torch.Size([320, 320]) from checkpoint, the shape
          in current model is torch.Size([320, 320, 1, 1]).</p>

          '
        raw: "I have similar issue. \nI described it on GitHub: \n\nhttps://github.com/Mikubill/sd-webui-controlnet/issues/1418\n\
          \nSystem version, webui version, CN version, and screenshots are there.\n\
          At this point I'm not sure if this is more ControlNet thing, models thing\
          \ or yaml files thing.\n\nIt all comes down to some size mismatch:\nError\
          \ running process: /Users/rw/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/controlnet.py\n\
          File \"/Users/rw/stable-diffusion-webui/venv-torch-nightly/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 2056, in load_state_dict\n    raise RuntimeError('Error(s) in loading\
          \ state_dict for {}:\\n\\t{}'.format(\nRuntimeError: Error(s) in loading\
          \ state_dict for ControlNet:\n\tsize mismatch for input_blocks.1.1.proj_in.weight:\
          \ copying a param with shape torch.Size([320, 320]) from checkpoint, the\
          \ shape in current model is torch.Size([320, 320, 1, 1])."
        updatedAt: '2023-05-25T10:21:12.638Z'
      numEdits: 0
      reactions: []
    id: 646f3698fa9253f3ae7a5fc9
    type: comment
  author: korronald
  content: "I have similar issue. \nI described it on GitHub: \n\nhttps://github.com/Mikubill/sd-webui-controlnet/issues/1418\n\
    \nSystem version, webui version, CN version, and screenshots are there.\nAt this\
    \ point I'm not sure if this is more ControlNet thing, models thing or yaml files\
    \ thing.\n\nIt all comes down to some size mismatch:\nError running process: /Users/rw/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/controlnet.py\n\
    File \"/Users/rw/stable-diffusion-webui/venv-torch-nightly/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 2056, in load_state_dict\n    raise RuntimeError('Error(s) in loading state_dict\
    \ for {}:\\n\\t{}'.format(\nRuntimeError: Error(s) in loading state_dict for ControlNet:\n\
    \tsize mismatch for input_blocks.1.1.proj_in.weight: copying a param with shape\
    \ torch.Size([320, 320]) from checkpoint, the shape in current model is torch.Size([320,\
    \ 320, 1, 1])."
  created_at: 2023-05-25 09:21:12+00:00
  edited: false
  hidden: false
  id: 646f3698fa9253f3ae7a5fc9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
      fullname: urban farmer
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: urbanfarmer22
      type: user
    createdAt: '2023-05-25T11:13:50.000Z'
    data:
      edited: false
      editors:
      - urbanfarmer22
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/e659adeb62feb356207b6f42ddc75cd7.svg
          fullname: urban farmer
          isHf: false
          isPro: false
          name: urbanfarmer22
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;korronald&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/korronald\">@<span class=\"\
          underline\">korronald</span></a></span>\n\n\t</span></span> in your case,\
          \ looking at the error, it looks like you are using a 1.5 or 2.1 controlnet\
          \ model with the opposite sd model (so for example a 1.5 controlnet model\
          \ with a 2.1 sd model)</p>\n"
        raw: '@korronald in your case, looking at the error, it looks like you are
          using a 1.5 or 2.1 controlnet model with the opposite sd model (so for example
          a 1.5 controlnet model with a 2.1 sd model)'
        updatedAt: '2023-05-25T11:13:50.083Z'
      numEdits: 0
      reactions: []
    id: 646f42eede1b1c1780b52cb3
    type: comment
  author: urbanfarmer22
  content: '@korronald in your case, looking at the error, it looks like you are using
    a 1.5 or 2.1 controlnet model with the opposite sd model (so for example a 1.5
    controlnet model with a 2.1 sd model)'
  created_at: 2023-05-25 10:13:50+00:00
  edited: false
  hidden: false
  id: 646f42eede1b1c1780b52cb3
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5046b4e57d9cf460b9cf9f88f4aa8389.svg
      fullname: LingGuo
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Hylixen
      type: user
    createdAt: '2023-05-26T03:25:07.000Z'
    data:
      edited: false
      editors:
      - Hylixen
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5046b4e57d9cf460b9cf9f88f4aa8389.svg
          fullname: LingGuo
          isHf: false
          isPro: false
          name: Hylixen
          type: user
        html: '<p>Hey, guys! Hope this will be helpful to using  2.1 controlnet model:</p>

          <ol>

          <li>The checkpoint model in stable-diffusion-webui should be SD2.1 (<a href="https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt">https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt</a>)
          not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.</li>

          <li>Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml for
          sd-webui-controlnet to load the model,  just copy from the official repository
          (<a rel="nofollow" href="https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml">https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml</a>)
          and rename it in the directory of control_v11e_sd21_xxx.pth.</li>

          </ol>

          '
        raw: 'Hey, guys! Hope this will be helpful to using  2.1 controlnet model:


          1. The checkpoint model in stable-diffusion-webui should be SD2.1 (https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt)
          not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.

          2. Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml for
          sd-webui-controlnet to load the model,  just copy from the official repository
          (https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml)
          and rename it in the directory of control_v11e_sd21_xxx.pth.'
        updatedAt: '2023-05-26T03:25:07.729Z'
      numEdits: 0
      reactions:
      - count: 2
        reaction: "\U0001F44D"
        users:
        - Astroboy
        - Piscabo
    id: 647026936098ee820fc524c6
    type: comment
  author: Hylixen
  content: 'Hey, guys! Hope this will be helpful to using  2.1 controlnet model:


    1. The checkpoint model in stable-diffusion-webui should be SD2.1 (https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt)
    not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.

    2. Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml for sd-webui-controlnet
    to load the model,  just copy from the official repository (https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml)
    and rename it in the directory of control_v11e_sd21_xxx.pth.'
  created_at: 2023-05-26 02:25:07+00:00
  edited: false
  hidden: false
  id: 647026936098ee820fc524c6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1673702870443-noauth.jpeg?w=200&h=200&f=face
      fullname: Pieter-Schalk Botha
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Piscabo
      type: user
    createdAt: '2023-05-26T21:55:39.000Z'
    data:
      edited: false
      editors:
      - Piscabo
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1673702870443-noauth.jpeg?w=200&h=200&f=face
          fullname: Pieter-Schalk Botha
          isHf: false
          isPro: false
          name: Piscabo
          type: user
        html: '<blockquote>

          <p>Hey, guys! Hope this will be helpful to using  2.1 controlnet model:</p>

          <ol>

          <li>The checkpoint model in stable-diffusion-webui should be SD2.1 (<a href="https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt">https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt</a>)
          not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.</li>

          <li>Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml for
          sd-webui-controlnet to load the model,  just copy from the official repository
          (<a rel="nofollow" href="https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml">https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml</a>)
          and rename it in the directory of control_v11e_sd21_xxx.pth.</li>

          </ol>

          </blockquote>

          <p>This does work, but makes everything look like a sketch. I don''t think
          it is the right way to address a YAML file unique to its name. Why would
          non-working YAML files be uploaded for public use? Beats me.</p>

          '
        raw: "> Hey, guys! Hope this will be helpful to using  2.1 controlnet model:\n\
          > \n> 1. The checkpoint model in stable-diffusion-webui should be SD2.1\
          \ (https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt)\
          \ not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.\n\
          > 2. Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml\
          \ for sd-webui-controlnet to load the model,  just copy from the official\
          \ repository (https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml)\
          \ and rename it in the directory of control_v11e_sd21_xxx.pth.\n\nThis does\
          \ work, but makes everything look like a sketch. I don't think it is the\
          \ right way to address a YAML file unique to its name. Why would non-working\
          \ YAML files be uploaded for public use? Beats me."
        updatedAt: '2023-05-26T21:55:39.412Z'
      numEdits: 0
      reactions: []
    id: 64712adb1c2bfd5b7bfb2616
    type: comment
  author: Piscabo
  content: "> Hey, guys! Hope this will be helpful to using  2.1 controlnet model:\n\
    > \n> 1. The checkpoint model in stable-diffusion-webui should be SD2.1 (https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.ckpt)\
    \ not SD1.5 when using 2.1 controlnet model , or it would cause shapes error.\n\
    > 2. Every control_v11e_sd21_xxx.pth needs a control_v11e_sd21_xxx.yaml for sd-webui-controlnet\
    \ to load the model,  just copy from the official repository (https://github.com/lllyasviel/ControlNet/blob/main/models/cldm_v21.yaml)\
    \ and rename it in the directory of control_v11e_sd21_xxx.pth.\n\nThis does work,\
    \ but makes everything look like a sketch. I don't think it is the right way to\
    \ address a YAML file unique to its name. Why would non-working YAML files be\
    \ uploaded for public use? Beats me."
  created_at: 2023-05-26 20:55:39+00:00
  edited: false
  hidden: false
  id: 64712adb1c2bfd5b7bfb2616
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/58b1a3288250f4f269ad522126967ab7.svg
      fullname: Zeyu Cai
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Co2y
      type: user
    createdAt: '2023-09-04T02:00:15.000Z'
    data:
      edited: false
      editors:
      - Co2y
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8669756054878235
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/58b1a3288250f4f269ad522126967ab7.svg
          fullname: Zeyu Cai
          isHf: false
          isPro: false
          name: Co2y
          type: user
        html: '<p>The main reason is the param <code>user_linear_in_transformer</code>,  just
          set it as <code>True</code>. When doing self-Attention, the model will use
          <code>nn.linear</code>, otherwise the model will use convolution, making
          the weight shape not match.</p>

          '
        raw: The main reason is the param `user_linear_in_transformer`,  just set
          it as `True`. When doing self-Attention, the model will use `nn.linear`,
          otherwise the model will use convolution, making the weight shape not match.
        updatedAt: '2023-09-04T02:00:15.121Z'
      numEdits: 0
      reactions: []
    id: 64f53a2f9ee58d48e85d02b4
    type: comment
  author: Co2y
  content: The main reason is the param `user_linear_in_transformer`,  just set it
    as `True`. When doing self-Attention, the model will use `nn.linear`, otherwise
    the model will use convolution, making the weight shape not match.
  created_at: 2023-09-04 01:00:15+00:00
  edited: false
  hidden: false
  id: 64f53a2f9ee58d48e85d02b4
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 37
repo_id: thibaud/controlnet-sd21
repo_type: model
status: open
target_branch: null
title: Controlnet SD2.1 does not seem to do anything, even though it's enabled...
