!!python/object:huggingface_hub.community.DiscussionWithDetails
author: lucascassiano
conflicting_files: null
created_at: 2023-03-24 03:56:12+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/94de2346ae2aa762a246ca5c1fe68964.svg
      fullname: Lucas Cassiano
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: lucascassiano
      type: user
    createdAt: '2023-03-24T04:56:12.000Z'
    data:
      edited: false
      editors:
      - lucascassiano
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/94de2346ae2aa762a246ca5c1fe68964.svg
          fullname: Lucas Cassiano
          isHf: false
          isPro: false
          name: lucascassiano
          type: user
        html: "<p>I got the following error</p>\n<pre><code class=\"language-sh\"\
          >TypeError: natten2dqkrpb() missing 1 required positional argument: <span\
          \ class=\"hljs-string\">'dilation'</span>\n</code></pre>\n<p>This is how\
          \ I installed Natten:</p>\n<pre><code class=\"language-sh\">pipenv run pip\
          \ install natten -f https://shi-labs.com/natten/wheels/cu118/torch2.0.0/index.html\n\
          </code></pre>\n<p>And here is the code I'm running:</p>\n<pre><code class=\"\
          language-py\"><span class=\"hljs-keyword\">from</span> transformers <span\
          \ class=\"hljs-keyword\">import</span> OneFormerProcessor, OneFormerForUniversalSegmentation\n\
          <span class=\"hljs-keyword\">from</span> PIL <span class=\"hljs-keyword\"\
          >import</span> Image\n<span class=\"hljs-keyword\">import</span> requests\n\
          url = <span class=\"hljs-string\">\"https://huggingface.co/datasets/shi-labs/oneformer_demo/resolve/main/coco.jpeg\"\
          </span>\nimage = Image.<span class=\"hljs-built_in\">open</span>(requests.get(url,\
          \ stream=<span class=\"hljs-literal\">True</span>).raw)\n\n<span class=\"\
          hljs-comment\"># Loading a single model for all three tasks</span>\nprocessor\
          \ = OneFormerProcessor.from_pretrained(\n    <span class=\"hljs-string\"\
          >\"shi-labs/oneformer_coco_dinat_large\"</span>)\nmodel = OneFormerForUniversalSegmentation.from_pretrained(\n\
          \    <span class=\"hljs-string\">\"shi-labs/oneformer_coco_dinat_large\"\
          </span>)\n\n<span class=\"hljs-comment\"># Semantic Segmentation</span>\n\
          semantic_inputs = processor(images=image, task_inputs=[\n              \
          \              <span class=\"hljs-string\">\"semantic\"</span>], return_tensors=<span\
          \ class=\"hljs-string\">\"pt\"</span>)\nsemantic_outputs = model(**semantic_inputs)\n\
          </code></pre>\n<p>Any ideas on how to fix this issue?<br>many thanks!</p>\n"
        raw: "I got the following error\r\n\r\n```sh\r\nTypeError: natten2dqkrpb()\
          \ missing 1 required positional argument: 'dilation'\r\n```\r\n\r\nThis\
          \ is how I installed Natten:\r\n```sh\r\npipenv run pip install natten -f\
          \ https://shi-labs.com/natten/wheels/cu118/torch2.0.0/index.html\r\n```\r\
          \nAnd here is the code I'm running:\r\n```py\r\nfrom transformers import\
          \ OneFormerProcessor, OneFormerForUniversalSegmentation\r\nfrom PIL import\
          \ Image\r\nimport requests\r\nurl = \"https://huggingface.co/datasets/shi-labs/oneformer_demo/resolve/main/coco.jpeg\"\
          \r\nimage = Image.open(requests.get(url, stream=True).raw)\r\n\r\n# Loading\
          \ a single model for all three tasks\r\nprocessor = OneFormerProcessor.from_pretrained(\r\
          \n    \"shi-labs/oneformer_coco_dinat_large\")\r\nmodel = OneFormerForUniversalSegmentation.from_pretrained(\r\
          \n    \"shi-labs/oneformer_coco_dinat_large\")\r\n\r\n# Semantic Segmentation\r\
          \nsemantic_inputs = processor(images=image, task_inputs=[\r\n          \
          \                  \"semantic\"], return_tensors=\"pt\")\r\nsemantic_outputs\
          \ = model(**semantic_inputs)\r\n```\r\n\r\nAny ideas on how to fix this\
          \ issue?\r\nmany thanks!"
        updatedAt: '2023-03-24T04:56:12.081Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - hihell
    id: 641d2d6c45487810d137d666
    type: comment
  author: lucascassiano
  content: "I got the following error\r\n\r\n```sh\r\nTypeError: natten2dqkrpb() missing\
    \ 1 required positional argument: 'dilation'\r\n```\r\n\r\nThis is how I installed\
    \ Natten:\r\n```sh\r\npipenv run pip install natten -f https://shi-labs.com/natten/wheels/cu118/torch2.0.0/index.html\r\
    \n```\r\nAnd here is the code I'm running:\r\n```py\r\nfrom transformers import\
    \ OneFormerProcessor, OneFormerForUniversalSegmentation\r\nfrom PIL import Image\r\
    \nimport requests\r\nurl = \"https://huggingface.co/datasets/shi-labs/oneformer_demo/resolve/main/coco.jpeg\"\
    \r\nimage = Image.open(requests.get(url, stream=True).raw)\r\n\r\n# Loading a\
    \ single model for all three tasks\r\nprocessor = OneFormerProcessor.from_pretrained(\r\
    \n    \"shi-labs/oneformer_coco_dinat_large\")\r\nmodel = OneFormerForUniversalSegmentation.from_pretrained(\r\
    \n    \"shi-labs/oneformer_coco_dinat_large\")\r\n\r\n# Semantic Segmentation\r\
    \nsemantic_inputs = processor(images=image, task_inputs=[\r\n                \
    \            \"semantic\"], return_tensors=\"pt\")\r\nsemantic_outputs = model(**semantic_inputs)\r\
    \n```\r\n\r\nAny ideas on how to fix this issue?\r\nmany thanks!"
  created_at: 2023-03-24 03:56:12+00:00
  edited: false
  hidden: false
  id: 641d2d6c45487810d137d666
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/ba97a695be78f1917cf101f99b172b54.svg
      fullname: jiusi
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: hihell
      type: user
    createdAt: '2023-03-24T15:18:37.000Z'
    data:
      edited: false
      editors:
      - hihell
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/ba97a695be78f1917cf101f99b172b54.svg
          fullname: jiusi
          isHf: false
          isPro: false
          name: hihell
          type: user
        html: '<p>open file ~/path_to_python/site-packages/transformers/models/dinat/modeling_dinat.py<br>goto
          "def forward", around line 350 you will find "attention_scores = natten2dqkrpb"<br>change
          to: "attention_scores = natten2dqkrpb(query_layer, key_layer, self.rpb,
          dilation=self.dilation, kernel_size=self.kernel_size)"</p>

          '
        raw: 'open file ~/path_to_python/site-packages/transformers/models/dinat/modeling_dinat.py

          goto "def forward", around line 350 you will find "attention_scores = natten2dqkrpb"

          change to: "attention_scores = natten2dqkrpb(query_layer, key_layer, self.rpb,
          dilation=self.dilation, kernel_size=self.kernel_size)"'
        updatedAt: '2023-03-24T15:18:37.809Z'
      numEdits: 0
      reactions: []
    id: 641dbf4de1ad0a9d49678826
    type: comment
  author: hihell
  content: 'open file ~/path_to_python/site-packages/transformers/models/dinat/modeling_dinat.py

    goto "def forward", around line 350 you will find "attention_scores = natten2dqkrpb"

    change to: "attention_scores = natten2dqkrpb(query_layer, key_layer, self.rpb,
    dilation=self.dilation, kernel_size=self.kernel_size)"'
  created_at: 2023-03-24 14:18:37+00:00
  edited: false
  hidden: false
  id: 641dbf4de1ad0a9d49678826
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: shi-labs/oneformer_coco_dinat_large
repo_type: model
status: open
target_branch: null
title: 'TypeError: natten2dqkrpb() missing 1 required positional argument: ''dilation'''
