!!python/object:huggingface_hub.community.DiscussionWithDetails
author: ostegm
conflicting_files: null
created_at: 2023-11-08 00:25:04+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/a33926cbddd8f667728654a7bea83bbf.svg
      fullname: Otto Stegmaier
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ostegm
      type: user
    createdAt: '2023-11-08T00:25:04.000Z'
    data:
      edited: false
      editors:
      - ostegm
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8347928524017334
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/a33926cbddd8f667728654a7bea83bbf.svg
          fullname: Otto Stegmaier
          isHf: false
          isPro: false
          name: ostegm
          type: user
        html: '<p>When converting, I see the v2 model has specific <a rel="nofollow"
          href="https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L2017">alignment
          heads</a>. Did those need to be changed in v3?</p>

          '
        raw: When converting, I see the v2 model has specific [alignment heads](https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L2017).
          Did those need to be changed in v3?
        updatedAt: '2023-11-08T00:25:04.779Z'
      numEdits: 0
      reactions: []
    id: 654ad560718c1ebb7cd9f10b
    type: comment
  author: ostegm
  content: When converting, I see the v2 model has specific [alignment heads](https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L2017).
    Did those need to be changed in v3?
  created_at: 2023-11-08 00:25:04+00:00
  edited: false
  hidden: false
  id: 654ad560718c1ebb7cd9f10b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/872579c84fed9916bf4203ea23cc4a6f.svg
      fullname: baba booey
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: bababababooey
      type: user
    createdAt: '2023-11-08T04:52:56.000Z'
    data:
      edited: false
      editors:
      - bababababooey
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8062977194786072
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/872579c84fed9916bf4203ea23cc4a6f.svg
          fullname: baba booey
          isHf: false
          isPro: false
          name: bababababooey
          type: user
        html: '<p>good catch! i just copied them from over from generation_config.json</p>

          '
        raw: 'good catch! i just copied them from over from generation_config.json


          '
        updatedAt: '2023-11-08T04:52:56.462Z'
      numEdits: 0
      reactions: []
    id: 654b14282d2fcd6bf29e3f65
    type: comment
  author: bababababooey
  content: 'good catch! i just copied them from over from generation_config.json


    '
  created_at: 2023-11-08 04:52:56+00:00
  edited: false
  hidden: false
  id: 654b14282d2fcd6bf29e3f65
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/a33926cbddd8f667728654a7bea83bbf.svg
      fullname: Otto Stegmaier
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ostegm
      type: user
    createdAt: '2023-11-08T15:38:50.000Z'
    data:
      edited: true
      editors:
      - ostegm
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8681386113166809
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/a33926cbddd8f667728654a7bea83bbf.svg
          fullname: Otto Stegmaier
          isHf: false
          isPro: false
          name: ostegm
          type: user
        html: '<p>Im not super familiar with the ctranslate2 code base, but it seems
          the alignment heads also need to be set in <a rel="nofollow" href="https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L897">ctranslate2</a>?
          without adding alignment heads in the conversion script, do you expect the
          model to perform as expected?</p>

          <p>It looks like a PR is up on the ctranslate2 codebase:<br><a rel="nofollow"
          href="https://github.com/OpenNMT/CTranslate2/pull/1530">https://github.com/OpenNMT/CTranslate2/pull/1530</a></p>

          '
        raw: "Im not super familiar with the ctranslate2 code base, but it seems the\
          \ alignment heads also need to be set in [ctranslate2](https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L897)?\
          \ without adding alignment heads in the conversion script, do you expect\
          \ the model to perform as expected?\n\nIt looks like a PR is up on the ctranslate2\
          \ codebase: \nhttps://github.com/OpenNMT/CTranslate2/pull/1530"
        updatedAt: '2023-11-08T15:40:14.878Z'
      numEdits: 1
      reactions: []
    id: 654bab8a2772771fb269f6b1
    type: comment
  author: ostegm
  content: "Im not super familiar with the ctranslate2 code base, but it seems the\
    \ alignment heads also need to be set in [ctranslate2](https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L897)?\
    \ without adding alignment heads in the conversion script, do you expect the model\
    \ to perform as expected?\n\nIt looks like a PR is up on the ctranslate2 codebase:\
    \ \nhttps://github.com/OpenNMT/CTranslate2/pull/1530"
  created_at: 2023-11-08 15:38:50+00:00
  edited: true
  hidden: false
  id: 654bab8a2772771fb269f6b1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/872579c84fed9916bf4203ea23cc4a6f.svg
      fullname: baba booey
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: bababababooey
      type: user
    createdAt: '2023-11-08T18:11:33.000Z'
    data:
      edited: false
      editors:
      - bababababooey
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9498467445373535
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/872579c84fed9916bf4203ea23cc4a6f.svg
          fullname: baba booey
          isHf: false
          isPro: false
          name: bababababooey
          type: user
        html: '<p>oh yeah i am following that PR, looks like it just merged. also
          need the <code>is_multilingual</code> fix from the pr (which breaks language
          detection in this model). trying to update ct2 &amp; run a new conversion</p>

          <p>fwiw i didnt really test it much, but noticed timestamps were more accurate
          after updating config.json with the alignment heads post-conversion</p>

          '
        raw: 'oh yeah i am following that PR, looks like it just merged. also need
          the `is_multilingual` fix from the pr (which breaks language detection in
          this model). trying to update ct2 & run a new conversion


          fwiw i didnt really test it much, but noticed timestamps were more accurate
          after updating config.json with the alignment heads post-conversion'
        updatedAt: '2023-11-08T18:11:33.519Z'
      numEdits: 0
      reactions: []
    id: 654bcf55dde5f3d6c232a655
    type: comment
  author: bababababooey
  content: 'oh yeah i am following that PR, looks like it just merged. also need the
    `is_multilingual` fix from the pr (which breaks language detection in this model).
    trying to update ct2 & run a new conversion


    fwiw i didnt really test it much, but noticed timestamps were more accurate after
    updating config.json with the alignment heads post-conversion'
  created_at: 2023-11-08 18:11:33+00:00
  edited: false
  hidden: false
  id: 654bcf55dde5f3d6c232a655
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: bababababooey/faster-whisper-large-v3
repo_type: model
status: open
target_branch: null
title: Alignment heads?
