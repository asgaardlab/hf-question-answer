!!python/object:huggingface_hub.community.DiscussionWithDetails
author: elavneet
conflicting_files: null
created_at: 2022-06-15 15:12:33+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3f762934a66d324c6f016435183568b0.svg
      fullname: Lavneet Sharma
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: elavneet
      type: user
    createdAt: '2022-06-15T16:12:33.000Z'
    data:
      edited: false
      editors:
      - elavneet
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3f762934a66d324c6f016435183568b0.svg
          fullname: Lavneet Sharma
          isHf: false
          isPro: false
          name: elavneet
          type: user
        html: '<p>I''ve been trying to export the model to a torchscript - torch.jit.trace(mode,
          (args)). But, I''m unable to figure out the args.</p>

          <p>I tried following code: </p>

          <pre><code class="language-python">model = AutoModelForSeq2SeqLM.from_pretrained(<span
          class="hljs-string">"ramsrigouthamg/t5-large-paraphraser-diverse-high-quality"</span>,
          torchscript = <span class="hljs-literal">True</span>)

          tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">"ramsrigouthamg/t5-large-paraphraser-diverse-high-quality"</span>)


          input_ids = tokenizer(article, return_tensors=<span class="hljs-string">''pt''</span>).input_ids

          attention_mask = input_ids.ne(model.config.pad_token_id).long()

          decoder_input_ids = tokenizer(article, return_tensors=<span class="hljs-string">''pt''</span>).input_ids


          traced_model = torch.jit.trace(model, (input_ids, attention_mask, decoder_input_ids))

          </code></pre>

          <p>But it doesn''t work for the arguments. Here''s another git issue repo
          related to my post: <a rel="nofollow" href="https://github.com/huggingface/transformers/issues/5647">https://github.com/huggingface/transformers/issues/5647</a></p>

          <p>I appreciate any reply to this thread.</p>

          '
        raw: "I've been trying to export the model to a torchscript - torch.jit.trace(mode,\
          \ (args)). But, I'm unable to figure out the args.\r\n\r\nI tried following\
          \ code: \r\n\r\n```python\r\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"\
          ramsrigouthamg/t5-large-paraphraser-diverse-high-quality\", torchscript\
          \ = True)\r\ntokenizer = AutoTokenizer.from_pretrained(\"ramsrigouthamg/t5-large-paraphraser-diverse-high-quality\"\
          )\r\n\r\ninput_ids = tokenizer(article, return_tensors='pt').input_ids\r\
          \nattention_mask = input_ids.ne(model.config.pad_token_id).long()\r\ndecoder_input_ids\
          \ = tokenizer(article, return_tensors='pt').input_ids\r\n\r\ntraced_model\
          \ = torch.jit.trace(model, (input_ids, attention_mask, decoder_input_ids))\r\
          \n```\r\n\r\nBut it doesn't work for the arguments. Here's another git issue\
          \ repo related to my post: https://github.com/huggingface/transformers/issues/5647\r\
          \n\r\nI appreciate any reply to this thread."
        updatedAt: '2022-06-15T16:12:33.722Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - ndvb
    id: 62aa04f1eab21ac91b95eda5
    type: comment
  author: elavneet
  content: "I've been trying to export the model to a torchscript - torch.jit.trace(mode,\
    \ (args)). But, I'm unable to figure out the args.\r\n\r\nI tried following code:\
    \ \r\n\r\n```python\r\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"ramsrigouthamg/t5-large-paraphraser-diverse-high-quality\"\
    , torchscript = True)\r\ntokenizer = AutoTokenizer.from_pretrained(\"ramsrigouthamg/t5-large-paraphraser-diverse-high-quality\"\
    )\r\n\r\ninput_ids = tokenizer(article, return_tensors='pt').input_ids\r\nattention_mask\
    \ = input_ids.ne(model.config.pad_token_id).long()\r\ndecoder_input_ids = tokenizer(article,\
    \ return_tensors='pt').input_ids\r\n\r\ntraced_model = torch.jit.trace(model,\
    \ (input_ids, attention_mask, decoder_input_ids))\r\n```\r\n\r\nBut it doesn't\
    \ work for the arguments. Here's another git issue repo related to my post: https://github.com/huggingface/transformers/issues/5647\r\
    \n\r\nI appreciate any reply to this thread."
  created_at: 2022-06-15 15:12:33+00:00
  edited: false
  hidden: false
  id: 62aa04f1eab21ac91b95eda5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/3f762934a66d324c6f016435183568b0.svg
      fullname: Lavneet Sharma
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: elavneet
      type: user
    createdAt: '2022-06-16T16:58:21.000Z'
    data:
      status: closed
    id: 62ab612daff249e2abba5d1f
    type: status-change
  author: elavneet
  created_at: 2022-06-16 15:58:21+00:00
  id: 62ab612daff249e2abba5d1f
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c15b16a9adbabe2ca7a0fe747851449f.svg
      fullname: Hayden Wolff
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: hwolff
      type: user
    createdAt: '2022-09-28T00:19:58.000Z'
    data:
      edited: false
      editors:
      - hwolff
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c15b16a9adbabe2ca7a0fe747851449f.svg
          fullname: Hayden Wolff
          isHf: false
          isPro: false
          name: hwolff
          type: user
        html: '<p>What was the solution to this?</p>

          '
        raw: What was the solution to this?
        updatedAt: '2022-09-28T00:19:58.186Z'
      numEdits: 0
      reactions: []
    id: 6333932e1503d8234453a84d
    type: comment
  author: hwolff
  content: What was the solution to this?
  created_at: 2022-09-27 23:19:58+00:00
  edited: false
  hidden: false
  id: 6333932e1503d8234453a84d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1676059263877-6372b836e8cea56fa061ac72.jpeg?w=200&h=200&f=face
      fullname: nb
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: ndvb
      type: user
    createdAt: '2023-02-08T21:02:06.000Z'
    data:
      edited: false
      editors:
      - ndvb
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1676059263877-6372b836e8cea56fa061ac72.jpeg?w=200&h=200&f=face
          fullname: nb
          isHf: false
          isPro: false
          name: ndvb
          type: user
        html: '<p>Any solution?</p>

          '
        raw: Any solution?
        updatedAt: '2023-02-08T21:02:06.083Z'
      numEdits: 0
      reactions: []
    id: 63e40dce8de575a15a6994a5
    type: comment
  author: ndvb
  content: Any solution?
  created_at: 2023-02-08 21:02:06+00:00
  edited: false
  hidden: false
  id: 63e40dce8de575a15a6994a5
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 2
repo_id: ramsrigouthamg/t5-large-paraphraser-diverse-high-quality
repo_type: model
status: closed
target_branch: null
title: How do I export it to torchscript?
