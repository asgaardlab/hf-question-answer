!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Manish1903
conflicting_files: null
created_at: 2023-08-17 12:52:04+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/baec1dc0a43386fafaf16555b633f320.svg
      fullname: Manish Pathak
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Manish1903
      type: user
    createdAt: '2023-08-17T13:52:04.000Z'
    data:
      edited: false
      editors:
      - Manish1903
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.800234854221344
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/baec1dc0a43386fafaf16555b633f320.svg
          fullname: Manish Pathak
          isHf: false
          isPro: false
          name: Manish1903
          type: user
        html: '<p>I am trying to load the model in a controlled environment (firewall
          blocked) by downloading the model weights manually from this repository.</p>

          <p><code>   import layoutparser as lp</code><br><code>model = lp.AutoLayoutModel(config_path
          = "models/PubLayNet/tf_efficientdet_d1/publaynet-tf_efficientdet_d1.pth.tar")</code></p>

          <p>gives  "ValueError: Invalid model config_path. Please suggest how to
          resolve this."</p>

          <p>Thanks</p>

          '
        raw: "I am trying to load the model in a controlled environment (firewall\
          \ blocked) by downloading the model weights manually from this repository.\r\
          \n\r\n`    import layoutparser as lp `\r\n`model = lp.AutoLayoutModel(config_path\
          \ = \"models/PubLayNet/tf_efficientdet_d1/publaynet-tf_efficientdet_d1.pth.tar\"\
          )`\r\n\r\ngives  \"ValueError: Invalid model config_path. Please suggest\
          \ how to resolve this.\"\r\n\r\nThanks"
        updatedAt: '2023-08-17T13:52:04.443Z'
      numEdits: 0
      reactions: []
    id: 64de260460bbabf0d58e91eb
    type: comment
  author: Manish1903
  content: "I am trying to load the model in a controlled environment (firewall blocked)\
    \ by downloading the model weights manually from this repository.\r\n\r\n`   \
    \ import layoutparser as lp `\r\n`model = lp.AutoLayoutModel(config_path = \"\
    models/PubLayNet/tf_efficientdet_d1/publaynet-tf_efficientdet_d1.pth.tar\")`\r\
    \n\r\ngives  \"ValueError: Invalid model config_path. Please suggest how to resolve\
    \ this.\"\r\n\r\nThanks"
  created_at: 2023-08-17 12:52:04+00:00
  edited: false
  hidden: false
  id: 64de260460bbabf0d58e91eb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/1dda726ddb632f4d2d04d0a78e778d66.svg
      fullname: Clovis Nyu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: clovisnyu
      type: user
    createdAt: '2023-08-31T01:57:17.000Z'
    data:
      edited: true
      editors:
      - clovisnyu
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8498366475105286
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/1dda726ddb632f4d2d04d0a78e778d66.svg
          fullname: Clovis Nyu
          isHf: false
          isPro: false
          name: clovisnyu
          type: user
        html: '<p>I believe it should be </p>

          <pre><code>import layoutparser as lp

          model = lp.models.effdet.layoutmodel.EfficientDetLayoutModel(''tf_efficientdet_d1'',
          model_path=''path_to_model_file'', label_map={0: "Text", 1: "Title", 2:
          "List", 3:"Table", 4:"Figure"})

          </code></pre>

          <p>There also seems to be a weird bug with either the <code>layoutparser</code>
          package or the <code>effdet</code> package where the head doesn''t reset
          when loading the model, resulting in the following error</p>

          <pre><code>size mismatch for class_net.predict.conv_pw.weight: copying a
          param with shape torch.Size([810, 88, 1, 1]) from checkpoint, the shape
          in current model is torch.Size([45, 88, 1, 1]).

          </code></pre>

          <p>This stems from the <code>effdet</code> library not resetting the head
          before loading the pretrained model. You can fix this in your <code>effdet</code>
          library by editing the <code>factory.py</code> file.</p>

          '
        raw: "I believe it should be \n\n```\nimport layoutparser as lp\nmodel = lp.models.effdet.layoutmodel.EfficientDetLayoutModel('tf_efficientdet_d1',\
          \ model_path='path_to_model_file', label_map={0: \"Text\", 1: \"Title\"\
          , 2: \"List\", 3:\"Table\", 4:\"Figure\"})\n```\n\nThere also seems to be\
          \ a weird bug with either the `layoutparser` package or the `effdet` package\
          \ where the head doesn't reset when loading the model, resulting in the\
          \ following error\n```\nsize mismatch for class_net.predict.conv_pw.weight:\
          \ copying a param with shape torch.Size([810, 88, 1, 1]) from checkpoint,\
          \ the shape in current model is torch.Size([45, 88, 1, 1]).\n```\n\nThis\
          \ stems from the `effdet` library not resetting the head before loading\
          \ the pretrained model. You can fix this in your `effdet` library by editing\
          \ the `factory.py` file.\n"
        updatedAt: '2023-08-31T03:06:41.798Z'
      numEdits: 3
      reactions: []
    id: 64eff37d0eff514fcd1f0e9b
    type: comment
  author: clovisnyu
  content: "I believe it should be \n\n```\nimport layoutparser as lp\nmodel = lp.models.effdet.layoutmodel.EfficientDetLayoutModel('tf_efficientdet_d1',\
    \ model_path='path_to_model_file', label_map={0: \"Text\", 1: \"Title\", 2: \"\
    List\", 3:\"Table\", 4:\"Figure\"})\n```\n\nThere also seems to be a weird bug\
    \ with either the `layoutparser` package or the `effdet` package where the head\
    \ doesn't reset when loading the model, resulting in the following error\n```\n\
    size mismatch for class_net.predict.conv_pw.weight: copying a param with shape\
    \ torch.Size([810, 88, 1, 1]) from checkpoint, the shape in current model is torch.Size([45,\
    \ 88, 1, 1]).\n```\n\nThis stems from the `effdet` library not resetting the head\
    \ before loading the pretrained model. You can fix this in your `effdet` library\
    \ by editing the `factory.py` file.\n"
  created_at: 2023-08-31 00:57:17+00:00
  edited: true
  hidden: false
  id: 64eff37d0eff514fcd1f0e9b
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: layoutparser/efficientdet
repo_type: model
status: open
target_branch: null
title: 'Are config files required for efficientdet models ? '
