!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Shilpil
conflicting_files: null
created_at: 2023-06-07 12:06:59+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/07c36f146a4aa43c6ebc50073daf0353.svg
      fullname: Suresh
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Shilpil
      type: user
    createdAt: '2023-06-07T13:06:59.000Z'
    data:
      edited: false
      editors:
      - Shilpil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.39108866453170776
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/07c36f146a4aa43c6ebc50073daf0353.svg
          fullname: Suresh
          isHf: false
          isPro: false
          name: Shilpil
          type: user
        html: '<p>Here is a sample code that I am using for embeddings:</p>

          <p>from transformers import (<br>    AutoTokenizer,<br>    AutoModelForCausalLM,<br>    AutoConfig)</p>

          <p>config = AutoConfig.from_pretrained("tiiuae/falcon-7b", output_hidden_states=False,
          trust_remote_code=True)<br>#config.init_device = ''cuda:0''<br>tokenizer
          = AutoTokenizer.from_pretrained("tiiuae/falcon-7b")<br>model = AutoModelForCausalLM.from_pretrained("tiiuae/falcon-7b",
          device_map=''auto'',config=config, trust_remote_code=True)<br>print(model)</p>

          <p>inputs = tokenizer(["Today is"], return_tensors="pt")</p>

          <p>output = model(**inputs)</p>

          <p>hidden_states = output[2]</p>

          <p>embedding_output = hidden_states[0]</p>

          <p>I am getting the following error:</p>

          <p>Traceback (most recent call last):<br>  File "/home/ubuntu/compliance/exp.py",
          line 15, in <br>    output = model(**inputs)<br>  File "/home/ubuntu/compliance/env/lib/python3.10/site-packages/torch/nn/modules/module.py",
          line 1194, in _call_impl<br>    return forward_call(*input, **kwargs)<br>  File
          "/home/ubuntu/compliance/env/lib/python3.10/site-packages/accelerate/hooks.py",
          line 165, in new_forward<br>    output = old_forward(*args, **kwargs)<br>  File
          "/home/ubuntu/.cache/huggingface/modules/transformers_modules/tiiuae/falcon-7b-instruct/8281cc02a66b7e15ad7afc18b16e9f683d8316c2/modelling_RW.py",
          line 749, in forward<br>    raise ValueError(f"Got unexpected arguments:
          {deprecated_arguments}")<br>ValueError: Got unexpected arguments: {''token_type_ids'':
          tensor([[0, 0]], device=''cuda:0'')}</p>

          <p>Please help solve the error</p>

          '
        raw: "Here is a sample code that I am using for embeddings:\r\n\r\nfrom transformers\
          \ import (\r\n    AutoTokenizer,\r\n    AutoModelForCausalLM,\r\n    AutoConfig)\r\
          \n\r\n\r\nconfig = AutoConfig.from_pretrained(\"tiiuae/falcon-7b\", output_hidden_states=False,\
          \ trust_remote_code=True)\r\n#config.init_device = 'cuda:0'\r\ntokenizer\
          \ = AutoTokenizer.from_pretrained(\"tiiuae/falcon-7b\")\r\nmodel = AutoModelForCausalLM.from_pretrained(\"\
          tiiuae/falcon-7b\", device_map='auto',config=config, trust_remote_code=True)\r\
          \nprint(model)\r\n\r\ninputs = tokenizer([\"Today is\"], return_tensors=\"\
          pt\")\r\n\r\noutput = model(**inputs)\r\n\r\nhidden_states = output[2]\r\
          \n\r\nembedding_output = hidden_states[0]\r\n\r\nI am getting the following\
          \ error:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/compliance/exp.py\"\
          , line 15, in <module>\r\n    output = model(**inputs)\r\n  File \"/home/ubuntu/compliance/env/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
          , line 1194, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\
          \n  File \"/home/ubuntu/compliance/env/lib/python3.10/site-packages/accelerate/hooks.py\"\
          , line 165, in new_forward\r\n    output = old_forward(*args, **kwargs)\r\
          \n  File \"/home/ubuntu/.cache/huggingface/modules/transformers_modules/tiiuae/falcon-7b-instruct/8281cc02a66b7e15ad7afc18b16e9f683d8316c2/modelling_RW.py\"\
          , line 749, in forward\r\n    raise ValueError(f\"Got unexpected arguments:\
          \ {deprecated_arguments}\")\r\nValueError: Got unexpected arguments: {'token_type_ids':\
          \ tensor([[0, 0]], device='cuda:0')}\r\n\r\nPlease help solve the error"
        updatedAt: '2023-06-07T13:06:59.411Z'
      numEdits: 0
      reactions: []
    id: 648080f33fb124fc984bf788
    type: comment
  author: Shilpil
  content: "Here is a sample code that I am using for embeddings:\r\n\r\nfrom transformers\
    \ import (\r\n    AutoTokenizer,\r\n    AutoModelForCausalLM,\r\n    AutoConfig)\r\
    \n\r\n\r\nconfig = AutoConfig.from_pretrained(\"tiiuae/falcon-7b\", output_hidden_states=False,\
    \ trust_remote_code=True)\r\n#config.init_device = 'cuda:0'\r\ntokenizer = AutoTokenizer.from_pretrained(\"\
    tiiuae/falcon-7b\")\r\nmodel = AutoModelForCausalLM.from_pretrained(\"tiiuae/falcon-7b\"\
    , device_map='auto',config=config, trust_remote_code=True)\r\nprint(model)\r\n\
    \r\ninputs = tokenizer([\"Today is\"], return_tensors=\"pt\")\r\n\r\noutput =\
    \ model(**inputs)\r\n\r\nhidden_states = output[2]\r\n\r\nembedding_output = hidden_states[0]\r\
    \n\r\nI am getting the following error:\r\n\r\nTraceback (most recent call last):\r\
    \n  File \"/home/ubuntu/compliance/exp.py\", line 15, in <module>\r\n    output\
    \ = model(**inputs)\r\n  File \"/home/ubuntu/compliance/env/lib/python3.10/site-packages/torch/nn/modules/module.py\"\
    , line 1194, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File\
    \ \"/home/ubuntu/compliance/env/lib/python3.10/site-packages/accelerate/hooks.py\"\
    , line 165, in new_forward\r\n    output = old_forward(*args, **kwargs)\r\n  File\
    \ \"/home/ubuntu/.cache/huggingface/modules/transformers_modules/tiiuae/falcon-7b-instruct/8281cc02a66b7e15ad7afc18b16e9f683d8316c2/modelling_RW.py\"\
    , line 749, in forward\r\n    raise ValueError(f\"Got unexpected arguments: {deprecated_arguments}\"\
    )\r\nValueError: Got unexpected arguments: {'token_type_ids': tensor([[0, 0]],\
    \ device='cuda:0')}\r\n\r\nPlease help solve the error"
  created_at: 2023-06-07 12:06:59+00:00
  edited: false
  hidden: false
  id: 648080f33fb124fc984bf788
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6471c2c76facfb01d8ac3278/ii7e_5o4jBoK3pS8WMaWK.png?w=200&h=200&f=face
      fullname: Falcon LLM TII UAE
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: FalconLLM
      type: user
    createdAt: '2023-06-09T14:06:29.000Z'
    data:
      edited: false
      editors:
      - FalconLLM
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6121485829353333
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6471c2c76facfb01d8ac3278/ii7e_5o4jBoK3pS8WMaWK.png?w=200&h=200&f=face
          fullname: Falcon LLM TII UAE
          isHf: false
          isPro: false
          name: FalconLLM
          type: user
        html: '<p>See <a href="https://huggingface.co/tiiuae/falcon-7b-instruct/discussions/2">this
          discussion</a> for a solution :) </p>

          '
        raw: 'See [this discussion](https://huggingface.co/tiiuae/falcon-7b-instruct/discussions/2)
          for a solution :) '
        updatedAt: '2023-06-09T14:06:29.312Z'
      numEdits: 0
      reactions: []
      relatedEventId: 648331e58bfd740d4e0c0443
    id: 648331e58bfd740d4e0c0441
    type: comment
  author: FalconLLM
  content: 'See [this discussion](https://huggingface.co/tiiuae/falcon-7b-instruct/discussions/2)
    for a solution :) '
  created_at: 2023-06-09 13:06:29+00:00
  edited: false
  hidden: false
  id: 648331e58bfd740d4e0c0441
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6471c2c76facfb01d8ac3278/ii7e_5o4jBoK3pS8WMaWK.png?w=200&h=200&f=face
      fullname: Falcon LLM TII UAE
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: FalconLLM
      type: user
    createdAt: '2023-06-09T14:06:29.000Z'
    data:
      status: closed
    id: 648331e58bfd740d4e0c0443
    type: status-change
  author: FalconLLM
  created_at: 2023-06-09 13:06:29+00:00
  id: 648331e58bfd740d4e0c0443
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 25
repo_id: tiiuae/falcon-7b
repo_type: model
status: closed
target_branch: null
title: Error when using falcon-7b model for embeddings
