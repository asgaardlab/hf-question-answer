!!python/object:huggingface_hub.community.DiscussionWithDetails
author: bmot
conflicting_files: null
created_at: 2023-01-18 18:43:20+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/14c5f44e07807f6f9642e519bc28ca88.svg
      fullname: Thomas Berg
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: bmot
      type: user
    createdAt: '2023-01-18T18:43:20.000Z'
    data:
      edited: false
      editors:
      - bmot
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/14c5f44e07807f6f9642e519bc28ca88.svg
          fullname: Thomas Berg
          isHf: false
          isPro: false
          name: bmot
          type: user
        html: '<p>The other bloom tokenizers seem to set that, and running generation
          with 7b1 shows this message:</p>

          <pre><code>A decoder-only architecture is being used, but right-padding
          was detected! For correct generation results, please set `padding_side=''left''`
          when initializing the tokenizer.

          </code></pre>

          '
        raw: "The other bloom tokenizers seem to set that, and running generation\
          \ with 7b1 shows this message:\r\n\r\n```\r\nA decoder-only architecture\
          \ is being used, but right-padding was detected! For correct generation\
          \ results, please set `padding_side='left'` when initializing the tokenizer.\r\
          \n```"
        updatedAt: '2023-01-18T18:43:20.413Z'
      numEdits: 0
      reactions: []
    id: 63c83dc8814338722a63b048
    type: comment
  author: bmot
  content: "The other bloom tokenizers seem to set that, and running generation with\
    \ 7b1 shows this message:\r\n\r\n```\r\nA decoder-only architecture is being used,\
    \ but right-padding was detected! For correct generation results, please set `padding_side='left'`\
    \ when initializing the tokenizer.\r\n```"
  created_at: 2023-01-18 18:43:20+00:00
  edited: false
  hidden: false
  id: 63c83dc8814338722a63b048
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2023-01-19T09:18:44.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;bmot&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/bmot\">@<span class=\"\
          underline\">bmot</span></a></span>\n\n\t</span></span>,<br>This is correct,\
          \ cc-ing <span data-props=\"{&quot;user&quot;:&quot;Muennighoff&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/Muennighoff\"\
          >@<span class=\"underline\">Muennighoff</span></a></span>\n\n\t</span></span>\
          \ to be sure but one should open a PR to fix that? Do you want to open it?\
          \ Otherwise I can do it</p>\n"
        raw: 'Hi @bmot,

          This is correct, cc-ing @Muennighoff to be sure but one should open a PR
          to fix that? Do you want to open it? Otherwise I can do it'
        updatedAt: '2023-01-19T09:18:44.709Z'
      numEdits: 0
      reactions: []
    id: 63c90af4988796b9db51a0bb
    type: comment
  author: ybelkada
  content: 'Hi @bmot,

    This is correct, cc-ing @Muennighoff to be sure but one should open a PR to fix
    that? Do you want to open it? Otherwise I can do it'
  created_at: 2023-01-19 09:18:44+00:00
  edited: false
  hidden: false
  id: 63c90af4988796b9db51a0bb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1659799717718-5f1eb362eec0ad2a071ad6e2.jpeg?w=200&h=200&f=face
      fullname: Niklas Muennighoff
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: Muennighoff
      type: user
    createdAt: '2023-01-19T09:30:32.000Z'
    data:
      edited: false
      editors:
      - Muennighoff
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1659799717718-5f1eb362eec0ad2a071ad6e2.jpeg?w=200&h=200&f=face
          fullname: Niklas Muennighoff
          isHf: false
          isPro: false
          name: Muennighoff
          type: user
        html: "<p>Yeah good point, would be great if you could do it <span data-props=\"\
          {&quot;user&quot;:&quot;ybelkada&quot;}\" data-target=\"UserMention\" class=\"\
          SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"inline-block\"><span\
          \ class=\"contents\"><a href=\"/ybelkada\">@<span class=\"underline\">ybelkada</span></a></span>\n\
          \n\t</span></span> \U0001F917</p>\n"
        raw: "Yeah good point, would be great if you could do it @ybelkada \U0001F917"
        updatedAt: '2023-01-19T09:30:32.931Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F91D"
        users:
        - ybelkada
    id: 63c90db8988796b9db51e624
    type: comment
  author: Muennighoff
  content: "Yeah good point, would be great if you could do it @ybelkada \U0001F917"
  created_at: 2023-01-19 09:30:32+00:00
  edited: false
  hidden: false
  id: 63c90db8988796b9db51e624
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2023-01-19T10:13:17.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: '<p>Closing as <a href="https://huggingface.co/bigscience/bloomz-7b1/discussions/7">https://huggingface.co/bigscience/bloomz-7b1/discussions/7</a>
          being merged</p>

          '
        raw: Closing as https://huggingface.co/bigscience/bloomz-7b1/discussions/7
          being merged
        updatedAt: '2023-01-19T10:13:17.288Z'
      numEdits: 0
      reactions: []
    id: 63c917bd8afd58b4409591fd
    type: comment
  author: ybelkada
  content: Closing as https://huggingface.co/bigscience/bloomz-7b1/discussions/7 being
    merged
  created_at: 2023-01-19 10:13:17+00:00
  edited: false
  hidden: false
  id: 63c917bd8afd58b4409591fd
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2023-01-19T10:15:48.000Z'
    data:
      edited: false
      editors:
      - ybelkada
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
          fullname: Younes Belkada
          isHf: true
          isPro: false
          name: ybelkada
          type: user
        html: "<p>FYI why we use <code>padding=\"left\"</code> (from <span data-props=\"\
          {&quot;user&quot;:&quot;patrickvonplaten&quot;}\" data-target=\"UserMention\"\
          \ class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"inline-block\"\
          ><span class=\"contents\"><a href=\"/patrickvonplaten\">@<span class=\"\
          underline\">patrickvonplaten</span></a></span>\n\n\t</span></span> ):</p>\n\
          <blockquote>\n<p>In short if you generate you always take the last token\
          \ to predict the next one. However if you generate in batches, the last\
          \ token (if padding is \"right\") might be a padding token which would then\
          \ incorrectly be taken in our generate method.</p>\n</blockquote>\n<blockquote>\n\
          <p>Imagine the batch: <code>[\"hello my name is\", \"hey &lt;pad&gt; &lt;pad&gt;\
          \ &lt;pad&gt;\"]</code> For the first input the correct token will be sampled\
          \ from \"is\" - however for the second input, generate would incorrectly\
          \ sample from \"\" where as it should sample from \"hey\".<br>Making sure\
          \ everything is batched on the left circumvents this problem</p>\n</blockquote>\n"
        raw: 'FYI why we use `padding="left"` (from @patrickvonplaten ):


          > In short if you generate you always take the last token to predict the
          next one. However if you generate in batches, the last token (if padding
          is "right") might be a padding token which would then incorrectly be taken
          in our generate method.


          > Imagine the batch: `["hello my name is", "hey <pad> <pad> <pad>"]` For
          the first input the correct token will be sampled from "is" - however for
          the second input, generate would incorrectly sample from "<pad>" where as
          it should sample from "hey".

          > Making sure everything is batched on the left circumvents this problem'
        updatedAt: '2023-01-19T10:15:48.974Z'
      numEdits: 0
      reactions: []
    id: 63c91854988796b9db52eeb8
    type: comment
  author: ybelkada
  content: 'FYI why we use `padding="left"` (from @patrickvonplaten ):


    > In short if you generate you always take the last token to predict the next
    one. However if you generate in batches, the last token (if padding is "right")
    might be a padding token which would then incorrectly be taken in our generate
    method.


    > Imagine the batch: `["hello my name is", "hey <pad> <pad> <pad>"]` For the first
    input the correct token will be sampled from "is" - however for the second input,
    generate would incorrectly sample from "<pad>" where as it should sample from
    "hey".

    > Making sure everything is batched on the left circumvents this problem'
  created_at: 2023-01-19 10:15:48+00:00
  edited: false
  hidden: false
  id: 63c91854988796b9db52eeb8
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1648631057413-noauth.png?w=200&h=200&f=face
      fullname: Younes Belkada
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: ybelkada
      type: user
    createdAt: '2023-01-19T10:15:51.000Z'
    data:
      status: closed
    id: 63c918571e3e1bf4a2c24ca1
    type: status-change
  author: ybelkada
  created_at: 2023-01-19 10:15:51+00:00
  id: 63c918571e3e1bf4a2c24ca1
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 6
repo_id: bigscience/bloomz-7b1
repo_type: model
status: closed
target_branch: null
title: Should the bloomz-7b1 tokenizer_config.json have padding_side="left"?
