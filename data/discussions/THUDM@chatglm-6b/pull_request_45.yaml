!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Xipotzzz
conflicting_files: []
created_at: 2023-04-18 09:39:03+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/2a96abc003dc9b50ef8fb792407b36db.svg
      fullname: Shuhui Wu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Xipotzzz
      type: user
    createdAt: '2023-04-18T10:39:03.000Z'
    data:
      edited: false
      editors:
      - Xipotzzz
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/2a96abc003dc9b50ef8fb792407b36db.svg
          fullname: Shuhui Wu
          isHf: false
          isPro: false
          name: Xipotzzz
          type: user
        html: "<p>\u5728\u8BAD\u7EC3blip2\u7B49\u6A21\u578B\u65F6\u9700\u8981\u4EE5\
          inputs_embeds\u4F5C\u4E3A\u8F93\u5165\u800C\u4E0D\u662Finput_ids\uFF0C\u4F46\
          \u662F\u73B0\u5728\u7684\u5B9E\u73B0\u4F3C\u4E4E\u4E0D\u652F\u6301\u8FD9\
          \u4E2A\u529F\u80FD\u3002<br>\u6211\u4FEE\u6539\u4E86\u4E00\u90E8\u5206\u4EE3\
          \u7801\u4EE5\u652F\u6301inputs_embeds\u3002\u4F9D\u7136\u9700\u8981\u540C\
          \u65F6\u8F93\u5165input_ids\u4EE5\u6784\u5EFAattention_mask\u548Cposition_ids\uFF0C\
          \u4F46\u662F\u9001\u5165transformer\u7684\u662F\u8F93\u5165\u7684inputs_embeds\u800C\
          \u4E0D\u662F\u7528input_ids\u5F97\u5230\u7684\u3002<br>\u5DF2\u6D4B\u8BD5\
          \uFF0C\u4E0D\u5F71\u54CD\u539F\u6709\u7684\u4EC5\u4F7F\u7528input_ids\u7684\
          \u751F\u6210\u65B9\u5F0F\u3002</p>\n"
        raw: "\u5728\u8BAD\u7EC3blip2\u7B49\u6A21\u578B\u65F6\u9700\u8981\u4EE5inputs_embeds\u4F5C\
          \u4E3A\u8F93\u5165\u800C\u4E0D\u662Finput_ids\uFF0C\u4F46\u662F\u73B0\u5728\
          \u7684\u5B9E\u73B0\u4F3C\u4E4E\u4E0D\u652F\u6301\u8FD9\u4E2A\u529F\u80FD\
          \u3002\n\u6211\u4FEE\u6539\u4E86\u4E00\u90E8\u5206\u4EE3\u7801\u4EE5\u652F\
          \u6301inputs_embeds\u3002\u4F9D\u7136\u9700\u8981\u540C\u65F6\u8F93\u5165\
          input_ids\u4EE5\u6784\u5EFAattention_mask\u548Cposition_ids\uFF0C\u4F46\u662F\
          \u9001\u5165transformer\u7684\u662F\u8F93\u5165\u7684inputs_embeds\u800C\
          \u4E0D\u662F\u7528input_ids\u5F97\u5230\u7684\u3002\n\u5DF2\u6D4B\u8BD5\uFF0C\
          \u4E0D\u5F71\u54CD\u539F\u6709\u7684\u4EC5\u4F7F\u7528input_ids\u7684\u751F\
          \u6210\u65B9\u5F0F\u3002"
        updatedAt: '2023-04-18T10:39:03.992Z'
      numEdits: 0
      reactions: []
    id: 643e734752885f3d3f529a2a
    type: comment
  author: Xipotzzz
  content: "\u5728\u8BAD\u7EC3blip2\u7B49\u6A21\u578B\u65F6\u9700\u8981\u4EE5inputs_embeds\u4F5C\
    \u4E3A\u8F93\u5165\u800C\u4E0D\u662Finput_ids\uFF0C\u4F46\u662F\u73B0\u5728\u7684\
    \u5B9E\u73B0\u4F3C\u4E4E\u4E0D\u652F\u6301\u8FD9\u4E2A\u529F\u80FD\u3002\n\u6211\
    \u4FEE\u6539\u4E86\u4E00\u90E8\u5206\u4EE3\u7801\u4EE5\u652F\u6301inputs_embeds\u3002\
    \u4F9D\u7136\u9700\u8981\u540C\u65F6\u8F93\u5165input_ids\u4EE5\u6784\u5EFAattention_mask\u548C\
    position_ids\uFF0C\u4F46\u662F\u9001\u5165transformer\u7684\u662F\u8F93\u5165\u7684\
    inputs_embeds\u800C\u4E0D\u662F\u7528input_ids\u5F97\u5230\u7684\u3002\n\u5DF2\
    \u6D4B\u8BD5\uFF0C\u4E0D\u5F71\u54CD\u539F\u6709\u7684\u4EC5\u4F7F\u7528input_ids\u7684\
    \u751F\u6210\u65B9\u5F0F\u3002"
  created_at: 2023-04-18 09:39:03+00:00
  edited: false
  hidden: false
  id: 643e734752885f3d3f529a2a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/2a96abc003dc9b50ef8fb792407b36db.svg
      fullname: Shuhui Wu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Xipotzzz
      type: user
    createdAt: '2023-04-18T10:39:03.000Z'
    data:
      oid: 3118bcb598963d4b9104853f3c624f80f703c829
      parents:
      - 0829959f96d95c9b21126bcd5de123b4c68e7a8e
      subject: Update modeling_chatglm.py for inputs_embeds
    id: 643e73470000000000000000
    type: commit
  author: Xipotzzz
  created_at: 2023-04-18 09:39:03+00:00
  id: 643e73470000000000000000
  oid: 3118bcb598963d4b9104853f3c624f80f703c829
  summary: Update modeling_chatglm.py for inputs_embeds
  type: commit
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661157784937-63033dc4e1e7f0e03a5e1a31.jpeg?w=200&h=200&f=face
      fullname: Zhengxiao Du
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: zxdu20
      type: user
    createdAt: '2023-04-18T12:48:30.000Z'
    data:
      oid: 34a7f8298608b5b7c9e836e85de58430d5883c4d
      parents:
      - 3118bcb598963d4b9104853f3c624f80f703c829
      - 35ca52301fbedee885b0838da5d15b7b47faa37c
      subject: Merge branch 'main' into pr/45
    id: 643e919e0000000000000000
    type: commit
  author: zxdu20
  created_at: 2023-04-18 11:48:30+00:00
  id: 643e919e0000000000000000
  oid: 34a7f8298608b5b7c9e836e85de58430d5883c4d
  summary: Merge branch 'main' into pr/45
  type: commit
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661157784937-63033dc4e1e7f0e03a5e1a31.jpeg?w=200&h=200&f=face
      fullname: Zhengxiao Du
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: zxdu20
      type: user
    createdAt: '2023-04-18T12:57:19.000Z'
    data:
      oid: 29868f403943fc48e854b3cfbb660cecc790a0c6
      parents:
      - 34a7f8298608b5b7c9e836e85de58430d5883c4d
      subject: Add warning
    id: 643e93af0000000000000000
    type: commit
  author: zxdu20
  created_at: 2023-04-18 11:57:19+00:00
  id: 643e93af0000000000000000
  oid: 29868f403943fc48e854b3cfbb660cecc790a0c6
  summary: Add warning
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661157784937-63033dc4e1e7f0e03a5e1a31.jpeg?w=200&h=200&f=face
      fullname: Zhengxiao Du
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: zxdu20
      type: user
    createdAt: '2023-04-18T13:13:24.000Z'
    data:
      edited: false
      editors:
      - zxdu20
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661157784937-63033dc4e1e7f0e03a5e1a31.jpeg?w=200&h=200&f=face
          fullname: Zhengxiao Du
          isHf: false
          isPro: false
          name: zxdu20
          type: user
        html: "<pre><code class=\"language-python\">        <span class=\"hljs-comment\"\
          ># set to None as prepare_inputs_for_generation use past for input embeds</span>\n\
          \        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\"\
          >\"inputs_embeds\"</span> <span class=\"hljs-keyword\">in</span> model_kwargs:\n\
          \            model_kwargs[<span class=\"hljs-string\">\"inputs_embeds\"\
          </span>] = <span class=\"hljs-literal\">None</span>\n</code></pre>\n<p>\u8FD9\
          \u4E2A\u6709\u5FC5\u8981\u5417\uFF1F\u5728 <code>prepare_inputs_for_generation</code>\
          \ \u91CC\u9762 <code>past</code> \u4E0D\u4E3A None \u7684\u65F6\u5019\u672C\
          \u6765\u5C31\u662F\u4E0D\u4F1A\u4F20 <code>inputs_embeds</code>\u7684</p>\n"
        raw: "```python\n        # set to None as prepare_inputs_for_generation use\
          \ past for input embeds\n        if \"inputs_embeds\" in model_kwargs:\n\
          \            model_kwargs[\"inputs_embeds\"] = None\n```\n\n\u8FD9\u4E2A\
          \u6709\u5FC5\u8981\u5417\uFF1F\u5728 `prepare_inputs_for_generation` \u91CC\
          \u9762 `past` \u4E0D\u4E3A None \u7684\u65F6\u5019\u672C\u6765\u5C31\u662F\
          \u4E0D\u4F1A\u4F20 `inputs_embeds`\u7684"
        updatedAt: '2023-04-18T13:13:24.008Z'
      numEdits: 0
      reactions: []
    id: 643e9774ab725487d8ea8f56
    type: comment
  author: zxdu20
  content: "```python\n        # set to None as prepare_inputs_for_generation use\
    \ past for input embeds\n        if \"inputs_embeds\" in model_kwargs:\n     \
    \       model_kwargs[\"inputs_embeds\"] = None\n```\n\n\u8FD9\u4E2A\u6709\u5FC5\
    \u8981\u5417\uFF1F\u5728 `prepare_inputs_for_generation` \u91CC\u9762 `past` \u4E0D\
    \u4E3A None \u7684\u65F6\u5019\u672C\u6765\u5C31\u662F\u4E0D\u4F1A\u4F20 `inputs_embeds`\u7684"
  created_at: 2023-04-18 12:13:24+00:00
  edited: false
  hidden: false
  id: 643e9774ab725487d8ea8f56
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1661157784937-63033dc4e1e7f0e03a5e1a31.jpeg?w=200&h=200&f=face
      fullname: Zhengxiao Du
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: zxdu20
      type: user
    createdAt: '2023-04-18T13:43:18.000Z'
    data:
      oid: 238dc29cd8916667b12eda64e92a3aeb27272a01
      parents:
      - 29868f403943fc48e854b3cfbb660cecc790a0c6
      subject: Remove delete inputs_embeds in _update_model_kwargs_for_generation
    id: 643e9e760000000000000000
    type: commit
  author: zxdu20
  created_at: 2023-04-18 12:43:18+00:00
  id: 643e9e760000000000000000
  oid: 238dc29cd8916667b12eda64e92a3aeb27272a01
  summary: Remove delete inputs_embeds in _update_model_kwargs_for_generation
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/2a96abc003dc9b50ef8fb792407b36db.svg
      fullname: Shuhui Wu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Xipotzzz
      type: user
    createdAt: '2023-04-18T15:40:06.000Z'
    data:
      edited: false
      editors:
      - Xipotzzz
      hidden: false
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/2a96abc003dc9b50ef8fb792407b36db.svg
          fullname: Shuhui Wu
          isHf: false
          isPro: false
          name: Xipotzzz
          type: user
        html: "<blockquote>\n<pre><code class=\"language-python\">        <span class=\"\
          hljs-comment\"># set to None as prepare_inputs_for_generation use past for\
          \ input embeds</span>\n        <span class=\"hljs-keyword\">if</span> <span\
          \ class=\"hljs-string\">\"inputs_embeds\"</span> <span class=\"hljs-keyword\"\
          >in</span> model_kwargs:\n            model_kwargs[<span class=\"hljs-string\"\
          >\"inputs_embeds\"</span>] = <span class=\"hljs-literal\">None</span>\n\
          </code></pre>\n<p>\u8FD9\u4E2A\u6709\u5FC5\u8981\u5417\uFF1F\u5728 <code>prepare_inputs_for_generation</code>\
          \ \u91CC\u9762 <code>past</code> \u4E0D\u4E3A None \u7684\u65F6\u5019\u672C\
          \u6765\u5C31\u662F\u4E0D\u4F1A\u4F20 <code>inputs_embeds</code>\u7684</p>\n\
          </blockquote>\n<p>\u786E\u5B9E\u5E94\u8BE5\u662F\u4E0D\u9700\u8981\u7684\
          \uFF0C\u53EF\u4EE5\u5220\u9664</p>\n"
        raw: "> ```python\n>         # set to None as prepare_inputs_for_generation\
          \ use past for input embeds\n>         if \"inputs_embeds\" in model_kwargs:\n\
          >             model_kwargs[\"inputs_embeds\"] = None\n> ```\n> \n> \u8FD9\
          \u4E2A\u6709\u5FC5\u8981\u5417\uFF1F\u5728 `prepare_inputs_for_generation`\
          \ \u91CC\u9762 `past` \u4E0D\u4E3A None \u7684\u65F6\u5019\u672C\u6765\u5C31\
          \u662F\u4E0D\u4F1A\u4F20 `inputs_embeds`\u7684\n\n\u786E\u5B9E\u5E94\u8BE5\
          \u662F\u4E0D\u9700\u8981\u7684\uFF0C\u53EF\u4EE5\u5220\u9664"
        updatedAt: '2023-04-18T15:40:06.416Z'
      numEdits: 0
      reactions: []
    id: 643eb9d67c6ac292f57ac9e5
    type: comment
  author: Xipotzzz
  content: "> ```python\n>         # set to None as prepare_inputs_for_generation\
    \ use past for input embeds\n>         if \"inputs_embeds\" in model_kwargs:\n\
    >             model_kwargs[\"inputs_embeds\"] = None\n> ```\n> \n> \u8FD9\u4E2A\
    \u6709\u5FC5\u8981\u5417\uFF1F\u5728 `prepare_inputs_for_generation` \u91CC\u9762\
    \ `past` \u4E0D\u4E3A None \u7684\u65F6\u5019\u672C\u6765\u5C31\u662F\u4E0D\u4F1A\
    \u4F20 `inputs_embeds`\u7684\n\n\u786E\u5B9E\u5E94\u8BE5\u662F\u4E0D\u9700\u8981\
    \u7684\uFF0C\u53EF\u4EE5\u5220\u9664"
  created_at: 2023-04-18 14:40:06+00:00
  edited: false
  hidden: false
  id: 643eb9d67c6ac292f57ac9e5
  type: comment
is_pull_request: true
merge_commit_oid: null
num: 45
repo_id: THUDM/chatglm-6b
repo_type: model
status: open
target_branch: refs/heads/main
title: Update modeling_chatglm.py for inputs_embeds
