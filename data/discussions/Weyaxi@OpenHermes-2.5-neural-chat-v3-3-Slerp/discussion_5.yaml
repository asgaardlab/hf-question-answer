!!python/object:huggingface_hub.community.DiscussionWithDetails
author: brlambert
conflicting_files: null
created_at: 2024-01-16 20:00:56+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
      fullname: Brian Lambert
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: brlambert
      type: user
    createdAt: '2024-01-16T20:00:56.000Z'
    data:
      edited: true
      editors:
      - brlambert
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9040908813476562
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
          fullname: Brian Lambert
          isHf: false
          isPro: false
          name: brlambert
          type: user
        html: '<p>Hey, thanks for this model, the performance is great! </p>

          <p>I noticed that the tokenizer config files are missing the ChatML special
          tokens like im_end - is this intentional?</p>

          '
        raw: "Hey, thanks for this model, the performance is great! \n\nI noticed\
          \ that the tokenizer config files are missing the ChatML special tokens\
          \ like im_end - is this intentional?"
        updatedAt: '2024-01-16T20:01:33.011Z'
      numEdits: 2
      reactions: []
    id: 65a6e078da9f6df141359a15
    type: comment
  author: brlambert
  content: "Hey, thanks for this model, the performance is great! \n\nI noticed that\
    \ the tokenizer config files are missing the ChatML special tokens like im_end\
    \ - is this intentional?"
  created_at: 2024-01-16 20:00:56+00:00
  edited: true
  hidden: false
  id: 65a6e078da9f6df141359a15
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6468ce47e134d050a58aa89c/ApFcPlOzgI6Cjr0SYPpk6.png?w=200&h=200&f=face
      fullname: "Ya\u011F\u0131z \xC7al\u0131k"
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: Weyaxi
      type: user
    createdAt: '2024-01-16T21:16:37.000Z'
    data:
      edited: false
      editors:
      - Weyaxi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8238772749900818
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6468ce47e134d050a58aa89c/ApFcPlOzgI6Cjr0SYPpk6.png?w=200&h=200&f=face
          fullname: "Ya\u011F\u0131z \xC7al\u0131k"
          isHf: false
          isPro: false
          name: Weyaxi
          type: user
        html: "<p>Hi <span data-props=\"{&quot;user&quot;:&quot;brlambert&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/brlambert\"\
          >@<span class=\"underline\">brlambert</span></a></span>\n\n\t</span></span>\
          \ ,</p>\n<p>If you want to use chatml, you can just change the related tokenizer\
          \ files and it should work fine.</p>\n"
        raw: 'Hi @brlambert ,


          If you want to use chatml, you can just change the related tokenizer files
          and it should work fine.'
        updatedAt: '2024-01-16T21:16:37.704Z'
      numEdits: 0
      reactions: []
    id: 65a6f235d6e5c1ed6c471fe6
    type: comment
  author: Weyaxi
  content: 'Hi @brlambert ,


    If you want to use chatml, you can just change the related tokenizer files and
    it should work fine.'
  created_at: 2024-01-16 21:16:37+00:00
  edited: false
  hidden: false
  id: 65a6f235d6e5c1ed6c471fe6
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
      fullname: Brian Lambert
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: brlambert
      type: user
    createdAt: '2024-01-16T21:46:49.000Z'
    data:
      edited: false
      editors:
      - brlambert
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9408096075057983
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
          fullname: Brian Lambert
          isHf: false
          isPro: false
          name: brlambert
          type: user
        html: "<blockquote>\n<p>Hi <span data-props=\"{&quot;user&quot;:&quot;brlambert&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/brlambert\"\
          >@<span class=\"underline\">brlambert</span></a></span>\n\n\t</span></span>\
          \ ,</p>\n<p>If you want to use chatml, you can just change the related tokenizer\
          \ files and it should work fine.</p>\n</blockquote>\n<p>Nice, I was hoping\
          \ you'd say that! Thanks!</p>\n"
        raw: "> Hi @brlambert ,\n> \n> If you want to use chatml, you can just change\
          \ the related tokenizer files and it should work fine.\n\nNice, I was hoping\
          \ you'd say that! Thanks!"
        updatedAt: '2024-01-16T21:46:49.693Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - Weyaxi
    id: 65a6f9495c58475cf9f3eb26
    type: comment
  author: brlambert
  content: "> Hi @brlambert ,\n> \n> If you want to use chatml, you can just change\
    \ the related tokenizer files and it should work fine.\n\nNice, I was hoping you'd\
    \ say that! Thanks!"
  created_at: 2024-01-16 21:46:49+00:00
  edited: false
  hidden: false
  id: 65a6f9495c58475cf9f3eb26
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6468ce47e134d050a58aa89c/ApFcPlOzgI6Cjr0SYPpk6.png?w=200&h=200&f=face
      fullname: "Ya\u011F\u0131z \xC7al\u0131k"
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: Weyaxi
      type: user
    createdAt: '2024-01-16T22:09:31.000Z'
    data:
      status: closed
    id: 65a6fe9b3088b44cbb080d62
    type: status-change
  author: Weyaxi
  created_at: 2024-01-16 22:09:31+00:00
  id: 65a6fe9b3088b44cbb080d62
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
      fullname: Brian Lambert
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: brlambert
      type: user
    createdAt: '2024-01-16T22:15:38.000Z'
    data:
      edited: false
      editors:
      - brlambert
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7703936696052551
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
          fullname: Brian Lambert
          isHf: false
          isPro: false
          name: brlambert
          type: user
        html: '<p>So I modified the files but I''m getting this error because of the
          addition of the <code>&lt;|im_start|&gt;</code> and <code>&lt;|im_end|&gt;</code>
          tokens<br><code>ValueError: Parameter model.embed_tokens.q_weight has shape
          (32000, 512), but expected (32002, 512)</code> </p>

          '
        raw: 'So I modified the files but I''m getting this error because of the addition
          of the `<|im_start|>` and `<|im_end|>` tokens

          `ValueError: Parameter model.embed_tokens.q_weight has shape (32000, 512),
          but expected (32002, 512)` '
        updatedAt: '2024-01-16T22:15:38.828Z'
      numEdits: 0
      reactions: []
    id: 65a7000a12a69b973731e386
    type: comment
  author: brlambert
  content: 'So I modified the files but I''m getting this error because of the addition
    of the `<|im_start|>` and `<|im_end|>` tokens

    `ValueError: Parameter model.embed_tokens.q_weight has shape (32000, 512), but
    expected (32002, 512)` '
  created_at: 2024-01-16 22:15:38+00:00
  edited: false
  hidden: false
  id: 65a7000a12a69b973731e386
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6468ce47e134d050a58aa89c/ApFcPlOzgI6Cjr0SYPpk6.png?w=200&h=200&f=face
      fullname: "Ya\u011F\u0131z \xC7al\u0131k"
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: Weyaxi
      type: user
    createdAt: '2024-01-18T10:13:22.000Z'
    data:
      edited: false
      editors:
      - Weyaxi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8267025947570801
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/6468ce47e134d050a58aa89c/ApFcPlOzgI6Cjr0SYPpk6.png?w=200&h=200&f=face
          fullname: "Ya\u011F\u0131z \xC7al\u0131k"
          isHf: false
          isPro: false
          name: Weyaxi
          type: user
        html: '<p>Have you changed all tokenizer related files to match chatml?</p>

          '
        raw: Have you changed all tokenizer related files to match chatml?
        updatedAt: '2024-01-18T10:13:22.477Z'
      numEdits: 0
      reactions: []
    id: 65a8f9c2c0e51d82e6e6224f
    type: comment
  author: Weyaxi
  content: Have you changed all tokenizer related files to match chatml?
  created_at: 2024-01-18 10:13:22+00:00
  edited: false
  hidden: false
  id: 65a8f9c2c0e51d82e6e6224f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
      fullname: Brian Lambert
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: brlambert
      type: user
    createdAt: '2024-01-18T14:20:14.000Z'
    data:
      edited: false
      editors:
      - brlambert
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9047185778617859
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d1a311a5e9b8e2435360cd010d0cd7dc.svg
          fullname: Brian Lambert
          isHf: false
          isPro: false
          name: brlambert
          type: user
        html: '<p>Yes I believe so, but adding these new special tokens seems to be
          imcompatible with the model. I tried to fix this by editing the problematic
          layer shape with <code>model.resize_token_embeddings(32002)</code> and I
          am able to generate outputs with this new model but it''s all gibberish</p>

          '
        raw: Yes I believe so, but adding these new special tokens seems to be imcompatible
          with the model. I tried to fix this by editing the problematic layer shape
          with `model.resize_token_embeddings(32002)` and I am able to generate outputs
          with this new model but it's all gibberish
        updatedAt: '2024-01-18T14:20:14.146Z'
      numEdits: 0
      reactions: []
    id: 65a9339e344c987527ba0aa5
    type: comment
  author: brlambert
  content: Yes I believe so, but adding these new special tokens seems to be imcompatible
    with the model. I tried to fix this by editing the problematic layer shape with
    `model.resize_token_embeddings(32002)` and I am able to generate outputs with
    this new model but it's all gibberish
  created_at: 2024-01-18 14:20:14+00:00
  edited: false
  hidden: false
  id: 65a9339e344c987527ba0aa5
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 5
repo_id: Weyaxi/OpenHermes-2.5-neural-chat-v3-3-Slerp
repo_type: model
status: closed
target_branch: null
title: Missing ChatML special tokens
