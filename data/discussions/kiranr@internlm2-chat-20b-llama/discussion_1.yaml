!!python/object:huggingface_hub.community.DiscussionWithDetails
author: dafen
conflicting_files: null
created_at: 2024-01-25 03:52:38+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5d3e8c861245d0e48324a4bcb7921158.svg
      fullname: fenjun
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: dafen
      type: user
    createdAt: '2024-01-25T03:52:38.000Z'
    data:
      edited: false
      editors:
      - dafen
      hidden: false
      identifiedLanguage:
        language: zh
        probability: 0.6744692921638489
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5d3e8c861245d0e48324a4bcb7921158.svg
          fullname: fenjun
          isHf: false
          isPro: false
          name: dafen
          type: user
        html: "<p>from vllm import LLM, SamplingParams<br>llm = LLM(<br>    model=\"\
          kiranr/internlm2-chat-20b-llama\",<br>    gpu_memory_utilization=.85,<br>\
          \    max_model_len=20000 ,<br>    trust_remote_code=True<br>)<br>prompt=['\u5C0F\
          \u660E\u7684\u7238\u7238\u6709\u4E09\u4E2A\u513F\u5B50\uFF0C\u5C0F\u660E\
          1992\u5E74\u51FA\u751F\uFF0C\u5927\u513F\u5B50\u53EB\u5927\u6BDB\uFF0C\u4E8C\
          \u513F\u5B50\u53EB\u4E8C\u6BDB\uFF0C\u4ECA\u5E74\u662F2023\u5E74\uFF0C\u8BF7\
          \u95EE\u4E09\u513F\u5B50\u4ECA\u5E74\u591A\u5927\u4E86?']<br>sampling_params\
          \ = SamplingParams(temperature=0.01, top_p=0.01,repetition_penalty=1.0,\
          \ max_tokens=300)<br>output = llm.generate(prompt, sampling_params)<br>print(output[0].outputs[0].text)</p>\n\
          <p>\u8F93\u51FA\uFF1A<br> &lt;|im_end|&gt;<br>\u8FD9\u662F\u4E00\u4E2A\u8111\
          \u7B4B\u6025\u8F6C\u5F2F\u95EE\u9898\uFF0C\u5B9E\u9645\u4E0A\u5E76\u4E0D\
          \u9700\u8981\u8BA1\u7B97\u3002\u6839\u636E\u9898\u76EE\u63CF\u8FF0\uFF0C\
          \u5C0F\u660E\u7684\u7238\u7238\u6709\u4E09\u4E2A\u513F\u5B50\uFF0C\u4F46\
          \u662F\u5C0F\u660E\u662F1992\u5E74\u51FA\u751F\u7684\uFF0C\u6240\u4EE5\u5C0F\
          \u660E\u662F\u7B2C\u4E09\u4E2A\u513F\u5B50\uFF0C\u800C\u4E0D\u662F\u5927\
          \u513F\u5B50\u6216\u4E8C\u513F\u5B50\u3002\u56E0\u6B64\uFF0C\u4E09\u513F\
          \u5B50\u5C31\u662F\u5C0F\u660E\u81EA\u5DF1\uFF0C\u4ED6\u4ECA\u5E74\u5E94\
          \u8BE5\u662F2023\u5E74\u51CF\u53BB1992\u5E74\uFF0C\u537331\u5C81\u3002\u6240\
          \u4EE5\uFF0C\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br>\
          \ &lt;|im_end|&gt;<br>2023-1992=31\uFF08\u5C81\uFF09<br> &lt;|im_end|&gt;<br>\
          \ &lt;|im_end|&gt;<br>\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br>\
          \ &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\u513F\u5B50\u4ECA\u5E74\
          31\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 &lt;|im_end|&gt;<br> &lt;|im_end|&gt;<br>\u4E09\
          \u513F\u5B50\u4ECA\u5E7431</p>\n"
        raw: "from vllm import LLM, SamplingParams \r\nllm = LLM( \r\n    model=\"\
          kiranr/internlm2-chat-20b-llama\",  \r\n    gpu_memory_utilization=.85,\
          \ \r\n    max_model_len=20000 ,\r\n    trust_remote_code=True\r\n)\r\nprompt=['\u5C0F\
          \u660E\u7684\u7238\u7238\u6709\u4E09\u4E2A\u513F\u5B50\uFF0C\u5C0F\u660E\
          1992\u5E74\u51FA\u751F\uFF0C\u5927\u513F\u5B50\u53EB\u5927\u6BDB\uFF0C\u4E8C\
          \u513F\u5B50\u53EB\u4E8C\u6BDB\uFF0C\u4ECA\u5E74\u662F2023\u5E74\uFF0C\u8BF7\
          \u95EE\u4E09\u513F\u5B50\u4ECA\u5E74\u591A\u5927\u4E86?']\r\nsampling_params\
          \ = SamplingParams(temperature=0.01, top_p=0.01,repetition_penalty=1.0,\
          \ max_tokens=300)\r\noutput = llm.generate(prompt, sampling_params) \r\n\
          print(output[0].outputs[0].text)\r\n\r\n\u8F93\u51FA\uFF1A\r\n <|im_end|>\
          \ \r\n\u8FD9\u662F\u4E00\u4E2A\u8111\u7B4B\u6025\u8F6C\u5F2F\u95EE\u9898\
          \uFF0C\u5B9E\u9645\u4E0A\u5E76\u4E0D\u9700\u8981\u8BA1\u7B97\u3002\u6839\
          \u636E\u9898\u76EE\u63CF\u8FF0\uFF0C\u5C0F\u660E\u7684\u7238\u7238\u6709\
          \u4E09\u4E2A\u513F\u5B50\uFF0C\u4F46\u662F\u5C0F\u660E\u662F1992\u5E74\u51FA\
          \u751F\u7684\uFF0C\u6240\u4EE5\u5C0F\u660E\u662F\u7B2C\u4E09\u4E2A\u513F\
          \u5B50\uFF0C\u800C\u4E0D\u662F\u5927\u513F\u5B50\u6216\u4E8C\u513F\u5B50\
          \u3002\u56E0\u6B64\uFF0C\u4E09\u513F\u5B50\u5C31\u662F\u5C0F\u660E\u81EA\
          \u5DF1\uFF0C\u4ED6\u4ECA\u5E74\u5E94\u8BE5\u662F2023\u5E74\u51CF\u53BB1992\u5E74\
          \uFF0C\u537331\u5C81\u3002\u6240\u4EE5\uFF0C\u4E09\u513F\u5B50\u4ECA\u5E74\
          31\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n2023-1992=31\uFF08\u5C81\uFF09\
          \r\n <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\
          \u3002 <|im_end|> \r\n <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431\u5C81\u3002 <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\
          \u4ECA\u5E7431"
        updatedAt: '2024-01-25T03:52:38.104Z'
      numEdits: 0
      reactions: []
    id: 65b1db06c9a9a5676e874325
    type: comment
  author: dafen
  content: "from vllm import LLM, SamplingParams \r\nllm = LLM( \r\n    model=\"kiranr/internlm2-chat-20b-llama\"\
    ,  \r\n    gpu_memory_utilization=.85, \r\n    max_model_len=20000 ,\r\n    trust_remote_code=True\r\
    \n)\r\nprompt=['\u5C0F\u660E\u7684\u7238\u7238\u6709\u4E09\u4E2A\u513F\u5B50\uFF0C\
    \u5C0F\u660E1992\u5E74\u51FA\u751F\uFF0C\u5927\u513F\u5B50\u53EB\u5927\u6BDB\uFF0C\
    \u4E8C\u513F\u5B50\u53EB\u4E8C\u6BDB\uFF0C\u4ECA\u5E74\u662F2023\u5E74\uFF0C\u8BF7\
    \u95EE\u4E09\u513F\u5B50\u4ECA\u5E74\u591A\u5927\u4E86?']\r\nsampling_params =\
    \ SamplingParams(temperature=0.01, top_p=0.01,repetition_penalty=1.0, max_tokens=300)\r\
    \noutput = llm.generate(prompt, sampling_params) \r\nprint(output[0].outputs[0].text)\r\
    \n\r\n\u8F93\u51FA\uFF1A\r\n <|im_end|> \r\n\u8FD9\u662F\u4E00\u4E2A\u8111\u7B4B\
    \u6025\u8F6C\u5F2F\u95EE\u9898\uFF0C\u5B9E\u9645\u4E0A\u5E76\u4E0D\u9700\u8981\
    \u8BA1\u7B97\u3002\u6839\u636E\u9898\u76EE\u63CF\u8FF0\uFF0C\u5C0F\u660E\u7684\
    \u7238\u7238\u6709\u4E09\u4E2A\u513F\u5B50\uFF0C\u4F46\u662F\u5C0F\u660E\u662F\
    1992\u5E74\u51FA\u751F\u7684\uFF0C\u6240\u4EE5\u5C0F\u660E\u662F\u7B2C\u4E09\u4E2A\
    \u513F\u5B50\uFF0C\u800C\u4E0D\u662F\u5927\u513F\u5B50\u6216\u4E8C\u513F\u5B50\
    \u3002\u56E0\u6B64\uFF0C\u4E09\u513F\u5B50\u5C31\u662F\u5C0F\u660E\u81EA\u5DF1\
    \uFF0C\u4ED6\u4ECA\u5E74\u5E94\u8BE5\u662F2023\u5E74\u51CF\u53BB1992\u5E74\uFF0C\
    \u537331\u5C81\u3002\u6240\u4EE5\uFF0C\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n2023-1992=31\uFF08\u5C81\uFF09\r\n <|im_end|>\
    \ \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002 <|im_end|>\
    \ \r\n <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431\u5C81\u3002\
    \ <|im_end|> \r\n <|im_end|> \r\n\u4E09\u513F\u5B50\u4ECA\u5E7431"
  created_at: 2024-01-25 03:52:38+00:00
  edited: false
  hidden: false
  id: 65b1db06c9a9a5676e874325
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/56ccef10a8426d7160ef3586a771bd63.svg
      fullname: Kiran Kamble
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: kiranr
      type: user
    createdAt: '2024-01-25T07:38:04.000Z'
    data:
      edited: false
      editors:
      - kiranr
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6706475615501404
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/56ccef10a8426d7160ef3586a771bd63.svg
          fullname: Kiran Kamble
          isHf: false
          isPro: false
          name: kiranr
          type: user
        html: '<p>In the s SamplingParams, please use <code>stop_token_ids</code>
          and set it to <code>[92542, 2]</code></p>

          <p>so, in your code it should look like this </p>

          <pre><code class="language-py">sampling_params = SamplingParams(temperature=<span
          class="hljs-number">0.01</span>, top_p=<span class="hljs-number">0.01</span>,repetition_penalty=<span
          class="hljs-number">1.0</span>, max_tokens=<span class="hljs-number">300</span>,
          stop_token_ids=[<span class="hljs-number">92542</span>, <span class="hljs-number">2</span>])

          </code></pre>

          <p><code>[92542, 2] are token ids for &lt;|im_end|&gt;,  &lt;/s&gt;</code>
          respectively</p>

          '
        raw: "In the s SamplingParams, please use `stop_token_ids` and set it to `[92542,\
          \ 2]`\n\nso, in your code it should look like this \n```py\nsampling_params\
          \ = SamplingParams(temperature=0.01, top_p=0.01,repetition_penalty=1.0,\
          \ max_tokens=300, stop_token_ids=[92542, 2])\n```\n\n`[92542, 2] are token\
          \ ids for <|im_end|>,  </s>` respectively\n\n"
        updatedAt: '2024-01-25T07:38:04.258Z'
      numEdits: 0
      reactions: []
    id: 65b20fdc04eec72abf102ac4
    type: comment
  author: kiranr
  content: "In the s SamplingParams, please use `stop_token_ids` and set it to `[92542,\
    \ 2]`\n\nso, in your code it should look like this \n```py\nsampling_params =\
    \ SamplingParams(temperature=0.01, top_p=0.01,repetition_penalty=1.0, max_tokens=300,\
    \ stop_token_ids=[92542, 2])\n```\n\n`[92542, 2] are token ids for <|im_end|>,\
    \  </s>` respectively\n\n"
  created_at: 2024-01-25 07:38:04+00:00
  edited: false
  hidden: false
  id: 65b20fdc04eec72abf102ac4
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/5d3e8c861245d0e48324a4bcb7921158.svg
      fullname: fenjun
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: dafen
      type: user
    createdAt: '2024-01-25T10:43:31.000Z'
    data:
      edited: false
      editors:
      - dafen
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6714476943016052
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/5d3e8c861245d0e48324a4bcb7921158.svg
          fullname: fenjun
          isHf: false
          isPro: false
          name: dafen
          type: user
        html: '<p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/63f857a3127c8f03fc219721/xx7hp94lh2Fz6ajRrEEdo.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/63f857a3127c8f03fc219721/xx7hp94lh2Fz6ajRrEEdo.png"></a><br>don''t
          work</p>

          '
        raw: '

          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/63f857a3127c8f03fc219721/xx7hp94lh2Fz6ajRrEEdo.png)

          don''t work'
        updatedAt: '2024-01-25T10:43:31.516Z'
      numEdits: 0
      reactions: []
    id: 65b23b5365f85a0d878bfdc6
    type: comment
  author: dafen
  content: '

    ![image.png](https://cdn-uploads.huggingface.co/production/uploads/63f857a3127c8f03fc219721/xx7hp94lh2Fz6ajRrEEdo.png)

    don''t work'
  created_at: 2024-01-25 10:43:31+00:00
  edited: false
  hidden: false
  id: 65b23b5365f85a0d878bfdc6
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: kiranr/internlm2-chat-20b-llama
repo_type: model
status: open
target_branch: null
title: "vllm\u8F93\u51FA\u6709 <|im_end|> \u4E4B\u7C7B\u7684\u60C5\u51B5"
