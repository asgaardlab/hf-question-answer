!!python/object:huggingface_hub.community.DiscussionWithDetails
author: josephykwang
conflicting_files: null
created_at: 2023-11-15 17:36:33+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/cf46f72987b6c13b1c193bfbdb960a60.svg
      fullname: Joseph Wang
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: josephykwang
      type: user
    createdAt: '2023-11-15T17:36:33.000Z'
    data:
      edited: false
      editors:
      - josephykwang
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8722046613693237
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/cf46f72987b6c13b1c193bfbdb960a60.svg
          fullname: Joseph Wang
          isHf: false
          isPro: false
          name: josephykwang
          type: user
        html: '<p>we want to train a model using different prompt. wondering if training
          code is available?</p>

          '
        raw: we want to train a model using different prompt. wondering if training
          code is available?
        updatedAt: '2023-11-15T17:36:33.017Z'
      numEdits: 0
      reactions: []
    id: 655501a187dac33c9bf9267d
    type: comment
  author: josephykwang
  content: we want to train a model using different prompt. wondering if training
    code is available?
  created_at: 2023-11-15 17:36:33+00:00
  edited: false
  hidden: false
  id: 655501a187dac33c9bf9267d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
      fullname: Simon Hughes
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: simonhughes22
      type: user
    createdAt: '2023-11-15T18:40:01.000Z'
    data:
      edited: false
      editors:
      - simonhughes22
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8653739094734192
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
          fullname: Simon Hughes
          isHf: false
          isPro: false
          name: simonhughes22
          type: user
        html: '<p>We are still discussing whether we want to share the training data
          and logic more publicly. There is no ''prompt'' per se for the model we
          trained, only for when we call the LLMs like GPT 4 we used the prompt which
          we shared (see our Github here for details - <a rel="nofollow" href="https://github.com/vectara/hallucination-leaderboard/tree/main">https://github.com/vectara/hallucination-leaderboard/tree/main</a>).
          I will try and add some snippets soon that explain how to call the model.
          You basically just train using sentence transformers but modify the output
          to be a single label.</p>

          '
        raw: We are still discussing whether we want to share the training data and
          logic more publicly. There is no 'prompt' per se for the model we trained,
          only for when we call the LLMs like GPT 4 we used the prompt which we shared
          (see our Github here for details - https://github.com/vectara/hallucination-leaderboard/tree/main).
          I will try and add some snippets soon that explain how to call the model.
          You basically just train using sentence transformers but modify the output
          to be a single label.
        updatedAt: '2023-11-15T18:40:01.173Z'
      numEdits: 0
      reactions: []
    id: 655510811c523d26013329eb
    type: comment
  author: simonhughes22
  content: We are still discussing whether we want to share the training data and
    logic more publicly. There is no 'prompt' per se for the model we trained, only
    for when we call the LLMs like GPT 4 we used the prompt which we shared (see our
    Github here for details - https://github.com/vectara/hallucination-leaderboard/tree/main).
    I will try and add some snippets soon that explain how to call the model. You
    basically just train using sentence transformers but modify the output to be a
    single label.
  created_at: 2023-11-15 18:40:01+00:00
  edited: false
  hidden: false
  id: 655510811c523d26013329eb
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
      fullname: Simon Hughes
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: simonhughes22
      type: user
    createdAt: '2023-11-15T20:19:08.000Z'
    data:
      edited: true
      editors:
      - simonhughes22
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6482760310173035
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
          fullname: Simon Hughes
          isHf: false
          isPro: false
          name: simonhughes22
          type: user
        html: "<p>So if you want to load our model you don't need this but if you\
          \ want to use a different cross encoder you need to load it as follows:</p>\n\
          <pre><code class=\"language-model\">\n# Then load some training examples\
          \ as such:\ntrain_examples = []\nfor i, row in df_td_train.iterrows():\n\
          \    train_examples.append(InputExample(texts=[row['grounding'], row['generated_text']],\
          \ label=int(row['label'])))\n\n# Then train the model as such as per the\
          \ Cross Encoder API:\ntrain_dataloader = DataLoader(train_examples, shuffle=True,\
          \ batch_size=train_batch_size)\nwarmup_steps = math.ceil(len(train_dataloader)\
          \ * num_epochs * 0.1) #10% of train data for warm-up\nmodel.fit(train_dataloader=train_dataloader,\n\
          \          evaluator=test_evaluator,\n          epochs=num_epochs,\n   \
          \       evaluation_steps=14_000,\n          warmup_steps=warmup_steps,\n\
          \          output_path=model_save_path,\n          show_progress_bar=True)\n\
          </code></pre>\n"
        raw: "So if you want to load our model you don't need this but if you want\
          \ to use a different cross encoder you need to load it as follows:\n\n```model\
          \ = CrossEncoder(model_name, num_labels=1, automodel_args={'ignore_mismatched_sizes':True})\n\
          \n# Then load some training examples as such:\ntrain_examples = []\nfor\
          \ i, row in df_td_train.iterrows():\n    train_examples.append(InputExample(texts=[row['grounding'],\
          \ row['generated_text']], label=int(row['label'])))\n\n# Then train the\
          \ model as such as per the Cross Encoder API:\ntrain_dataloader = DataLoader(train_examples,\
          \ shuffle=True, batch_size=train_batch_size)\nwarmup_steps = math.ceil(len(train_dataloader)\
          \ * num_epochs * 0.1) #10% of train data for warm-up\nmodel.fit(train_dataloader=train_dataloader,\n\
          \          evaluator=test_evaluator,\n          epochs=num_epochs,\n   \
          \       evaluation_steps=14_000,\n          warmup_steps=warmup_steps,\n\
          \          output_path=model_save_path,\n          show_progress_bar=True)\n\
          \n```"
        updatedAt: '2023-11-15T20:20:41.301Z'
      numEdits: 1
      reactions: []
    id: 655527bce2a7cd9b84e116a1
    type: comment
  author: simonhughes22
  content: "So if you want to load our model you don't need this but if you want to\
    \ use a different cross encoder you need to load it as follows:\n\n```model =\
    \ CrossEncoder(model_name, num_labels=1, automodel_args={'ignore_mismatched_sizes':True})\n\
    \n# Then load some training examples as such:\ntrain_examples = []\nfor i, row\
    \ in df_td_train.iterrows():\n    train_examples.append(InputExample(texts=[row['grounding'],\
    \ row['generated_text']], label=int(row['label'])))\n\n# Then train the model\
    \ as such as per the Cross Encoder API:\ntrain_dataloader = DataLoader(train_examples,\
    \ shuffle=True, batch_size=train_batch_size)\nwarmup_steps = math.ceil(len(train_dataloader)\
    \ * num_epochs * 0.1) #10% of train data for warm-up\nmodel.fit(train_dataloader=train_dataloader,\n\
    \          evaluator=test_evaluator,\n          epochs=num_epochs,\n         \
    \ evaluation_steps=14_000,\n          warmup_steps=warmup_steps,\n          output_path=model_save_path,\n\
    \          show_progress_bar=True)\n\n```"
  created_at: 2023-11-15 20:19:08+00:00
  edited: true
  hidden: false
  id: 655527bce2a7cd9b84e116a1
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
      fullname: Simon Hughes
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: simonhughes22
      type: user
    createdAt: '2023-11-15T20:26:34.000Z'
    data:
      edited: false
      editors:
      - simonhughes22
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9823017120361328
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
          fullname: Simon Hughes
          isHf: false
          isPro: false
          name: simonhughes22
          type: user
        html: '<p>Added to the readme.md. We are not looking to share the training
          data at this time, however.</p>

          '
        raw: Added to the readme.md. We are not looking to share the training data
          at this time, however.
        updatedAt: '2023-11-15T20:26:34.571Z'
      numEdits: 0
      reactions: []
      relatedEventId: 6555297a89fd41f8afdfbc4d
    id: 6555297a89fd41f8afdfbc49
    type: comment
  author: simonhughes22
  content: Added to the readme.md. We are not looking to share the training data at
    this time, however.
  created_at: 2023-11-15 20:26:34+00:00
  edited: false
  hidden: false
  id: 6555297a89fd41f8afdfbc49
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/18121a7dd880020a0a4413c7c9acc451.svg
      fullname: Simon Hughes
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: simonhughes22
      type: user
    createdAt: '2023-11-15T20:26:34.000Z'
    data:
      status: closed
    id: 6555297a89fd41f8afdfbc4d
    type: status-change
  author: simonhughes22
  created_at: 2023-11-15 20:26:34+00:00
  id: 6555297a89fd41f8afdfbc4d
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 1
repo_id: vectara/hallucination_evaluation_model
repo_type: model
status: closed
target_branch: null
title: training code availability
