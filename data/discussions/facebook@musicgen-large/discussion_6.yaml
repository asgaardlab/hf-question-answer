!!python/object:huggingface_hub.community.DiscussionWithDetails
author: epinnock
conflicting_files: null
created_at: 2023-07-16 03:16:23+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/d60353d874fe385fc8d44b4cd2d58169.svg
      fullname: Ejiroghene Pinnock
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: epinnock
      type: user
    createdAt: '2023-07-16T04:16:23.000Z'
    data:
      edited: false
      editors:
      - epinnock
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8153262734413147
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/d60353d874fe385fc8d44b4cd2d58169.svg
          fullname: Ejiroghene Pinnock
          isHf: false
          isPro: false
          name: epinnock
          type: user
        html: '<p>Is is possible to use this to generate audio embeddings? If so is
          there any good documentation on this.</p>

          '
        raw: Is is possible to use this to generate audio embeddings? If so is there
          any good documentation on this.
        updatedAt: '2023-07-16T04:16:23.748Z'
      numEdits: 0
      reactions: []
    id: 64b36f1746dd1c352be7c9b7
    type: comment
  author: epinnock
  content: Is is possible to use this to generate audio embeddings? If so is there
    any good documentation on this.
  created_at: 2023-07-16 03:16:23+00:00
  edited: false
  hidden: false
  id: 64b36f1746dd1c352be7c9b7
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
      fullname: Sanchit Gandhi
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: sanchit-gandhi
      type: user
    createdAt: '2023-07-26T13:39:17.000Z'
    data:
      edited: false
      editors:
      - sanchit-gandhi
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7136030793190002
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653243468328-61f91cf54a8e5a275b2b3e7c.jpeg?w=200&h=200&f=face
          fullname: Sanchit Gandhi
          isHf: true
          isPro: false
          name: sanchit-gandhi
          type: user
        html: "<p>Yes - you can extract hidden states from the model by passing the\
          \ argument <code>output_hidden_states</code> to the forward call, see <a\
          \ href=\"https://huggingface.co/docs/transformers/main/en/model_doc/musicgen#transformers.MusicgenForConditionalGeneration.forward\"\
          >https://huggingface.co/docs/transformers/main/en/model_doc/musicgen#transformers.MusicgenForConditionalGeneration.forward</a></p>\n\
          <p>Or alternatively to the generate method:</p>\n<pre><code class=\"language-python\"\
          ><span class=\"hljs-keyword\">from</span> transformers <span class=\"hljs-keyword\"\
          >import</span> AutoProcessor, MusicgenForConditionalGeneration\n\nprocessor\
          \ = AutoProcessor.from_pretrained(<span class=\"hljs-string\">\"facebook/musicgen-small\"\
          </span>)\nmodel = MusicgenForConditionalGeneration.from_pretrained(<span\
          \ class=\"hljs-string\">\"facebook/musicgen-small\"</span>)\n\ninputs =\
          \ processor(\n    text=[<span class=\"hljs-string\">\"80s pop track with\
          \ bassy drums and synth\"</span>, <span class=\"hljs-string\">\"90s rock\
          \ song with loud guitars and heavy drums\"</span>],\n    padding=<span class=\"\
          hljs-literal\">True</span>,\n    return_tensors=<span class=\"hljs-string\"\
          >\"pt\"</span>,\n)\n\ngenerated_outputs = model.generate(**inputs, do_sample=<span\
          \ class=\"hljs-literal\">True</span>, guidance_scale=<span class=\"hljs-number\"\
          >3</span>, max_new_tokens=<span class=\"hljs-number\">256</span>, output_hidden_states=<span\
          \ class=\"hljs-literal\">True</span>, return_dict_in_generate=<span class=\"\
          hljs-literal\">True</span>)\n</code></pre>\n<p>Which embeddings are you\
          \ interested in particular? The audio codes from EnCodec? Or the hidden-states\
          \ from MusicGen?</p>\n"
        raw: "Yes - you can extract hidden states from the model by passing the argument\
          \ `output_hidden_states` to the forward call, see https://huggingface.co/docs/transformers/main/en/model_doc/musicgen#transformers.MusicgenForConditionalGeneration.forward\n\
          \nOr alternatively to the generate method:\n\n```python\nfrom transformers\
          \ import AutoProcessor, MusicgenForConditionalGeneration\n\nprocessor =\
          \ AutoProcessor.from_pretrained(\"facebook/musicgen-small\")\nmodel = MusicgenForConditionalGeneration.from_pretrained(\"\
          facebook/musicgen-small\")\n\ninputs = processor(\n    text=[\"80s pop track\
          \ with bassy drums and synth\", \"90s rock song with loud guitars and heavy\
          \ drums\"],\n    padding=True,\n    return_tensors=\"pt\",\n)\n\ngenerated_outputs\
          \ = model.generate(**inputs, do_sample=True, guidance_scale=3, max_new_tokens=256,\
          \ output_hidden_states=True, return_dict_in_generate=True)\n```\n\nWhich\
          \ embeddings are you interested in particular? The audio codes from EnCodec?\
          \ Or the hidden-states from MusicGen?"
        updatedAt: '2023-07-26T13:39:17.768Z'
      numEdits: 0
      reactions: []
    id: 64c12205b85ee9e422381bb5
    type: comment
  author: sanchit-gandhi
  content: "Yes - you can extract hidden states from the model by passing the argument\
    \ `output_hidden_states` to the forward call, see https://huggingface.co/docs/transformers/main/en/model_doc/musicgen#transformers.MusicgenForConditionalGeneration.forward\n\
    \nOr alternatively to the generate method:\n\n```python\nfrom transformers import\
    \ AutoProcessor, MusicgenForConditionalGeneration\n\nprocessor = AutoProcessor.from_pretrained(\"\
    facebook/musicgen-small\")\nmodel = MusicgenForConditionalGeneration.from_pretrained(\"\
    facebook/musicgen-small\")\n\ninputs = processor(\n    text=[\"80s pop track with\
    \ bassy drums and synth\", \"90s rock song with loud guitars and heavy drums\"\
    ],\n    padding=True,\n    return_tensors=\"pt\",\n)\n\ngenerated_outputs = model.generate(**inputs,\
    \ do_sample=True, guidance_scale=3, max_new_tokens=256, output_hidden_states=True,\
    \ return_dict_in_generate=True)\n```\n\nWhich embeddings are you interested in\
    \ particular? The audio codes from EnCodec? Or the hidden-states from MusicGen?"
  created_at: 2023-07-26 12:39:17+00:00
  edited: false
  hidden: false
  id: 64c12205b85ee9e422381bb5
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 6
repo_id: facebook/musicgen-large
repo_type: model
status: open
target_branch: null
title: Get audio embeddings
