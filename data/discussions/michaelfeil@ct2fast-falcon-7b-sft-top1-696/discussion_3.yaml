!!python/object:huggingface_hub.community.DiscussionWithDetails
author: nazimali
conflicting_files: null
created_at: 2023-06-25 10:40:50+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/2ecf7aba250b2cf2c85c0e8e26e4703d.svg
      fullname: Nazim Ali
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: nazimali
      type: user
    createdAt: '2023-06-25T11:40:50.000Z'
    data:
      edited: false
      editors:
      - nazimali
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5203287601470947
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/2ecf7aba250b2cf2c85c0e8e26e4703d.svg
          fullname: Nazim Ali
          isHf: false
          isPro: false
          name: nazimali
          type: user
        html: "<p>When I run the ct2 converter command mentioned in the README, it\
          \ results in a vocabulary size error. Since you ran the converter command\
          \ on <code>2023-06-06</code>, I checked the original model <a href=\"https://huggingface.co/OpenAssistant/falcon-7b-sft-top1-696/commits/main\"\
          >commit history </a> and there hasn't been new commits since <code>2023-06-06</code>.\
          \ Can anyone reproduce this or have any insights as to what causes it? Thanks\
          \ in advance.</p>\n<pre><code>ct2-transformers-converter --model OpenAssistant/falcon-7b-sft-top1-696\
          \ --output_dir ~/tmp-ct2fast-falcon-7b-sft-top1-696 --force --copy_files\
          \ tokenizer.json README.md tokenizer_config.json generation_config.json\
          \ special_tokens_map.json .gitattributes --quantization int8_float16 --trust_remote_code\n\
          </code></pre>\n<p>Traceback:</p>\n<pre><code class=\"language-python\">Traceback\
          \ (most recent call last):\n  File <span class=\"hljs-string\">\"/home/user/.pyenv/versions/llm/bin/ct2-transformers-converter\"\
          </span>, line <span class=\"hljs-number\">8</span>, <span class=\"hljs-keyword\"\
          >in</span> &lt;module&gt;\n    sys.exit(main())\n  File <span class=\"hljs-string\"\
          >\"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/transformers.py\"\
          </span>, line <span class=\"hljs-number\">1577</span>, <span class=\"hljs-keyword\"\
          >in</span> main\n    converter.convert_from_args(args)\n  File <span class=\"\
          hljs-string\">\"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
          </span>, line <span class=\"hljs-number\">50</span>, <span class=\"hljs-keyword\"\
          >in</span> convert_from_args\n    <span class=\"hljs-keyword\">return</span>\
          \ self.convert(\n  File <span class=\"hljs-string\">\"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
          </span>, line <span class=\"hljs-number\">97</span>, <span class=\"hljs-keyword\"\
          >in</span> convert\n    model_spec.validate()\n  File <span class=\"hljs-string\"\
          >\"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/specs/model_spec.py\"\
          </span>, line <span class=\"hljs-number\">561</span>, <span class=\"hljs-keyword\"\
          >in</span> validate\n    <span class=\"hljs-keyword\">raise</span> ValueError(\n\
          ValueError: Vocabulary has size <span class=\"hljs-number\">65029</span>\
          \ but the model expected a vocabulary of size <span class=\"hljs-number\"\
          >65040</span>\n</code></pre>\n<p>Library versions:</p>\n<pre><code>ctranslate2\
          \               3.16.0\nhf-hub-ctranslate2        2.12.0\ntransformers \
          \             4.30.2\ntorch                     2.0.1\n</code></pre>\n"
        raw: "When I run the ct2 converter command mentioned in the README, it results\
          \ in a vocabulary size error. Since you ran the converter command on `2023-06-06`,\
          \ I checked the original model [commit history ](https://huggingface.co/OpenAssistant/falcon-7b-sft-top1-696/commits/main)\
          \ and there hasn't been new commits since `2023-06-06`. Can anyone reproduce\
          \ this or have any insights as to what causes it? Thanks in advance.\r\n\
          \r\n```\r\nct2-transformers-converter --model OpenAssistant/falcon-7b-sft-top1-696\
          \ --output_dir ~/tmp-ct2fast-falcon-7b-sft-top1-696 --force --copy_files\
          \ tokenizer.json README.md tokenizer_config.json generation_config.json\
          \ special_tokens_map.json .gitattributes --quantization int8_float16 --trust_remote_code\r\
          \n```\r\n\r\nTraceback:\r\n```python\r\nTraceback (most recent call last):\r\
          \n  File \"/home/user/.pyenv/versions/llm/bin/ct2-transformers-converter\"\
          , line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/transformers.py\"\
          , line 1577, in main\r\n    converter.convert_from_args(args)\r\n  File\
          \ \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
          , line 50, in convert_from_args\r\n    return self.convert(\r\n  File \"\
          /home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
          , line 97, in convert\r\n    model_spec.validate()\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/specs/model_spec.py\"\
          , line 561, in validate\r\n    raise ValueError(\r\nValueError: Vocabulary\
          \ has size 65029 but the model expected a vocabulary of size 65040\r\n\r\
          \n```\r\n\r\nLibrary versions:\r\n```\r\nctranslate2               3.16.0\r\
          \nhf-hub-ctranslate2        2.12.0\r\ntransformers              4.30.2\r\
          \ntorch                     2.0.1\r\n```"
        updatedAt: '2023-06-25T11:40:50.417Z'
      numEdits: 0
      reactions: []
    id: 649827c23436cfb6bf5ccf8e
    type: comment
  author: nazimali
  content: "When I run the ct2 converter command mentioned in the README, it results\
    \ in a vocabulary size error. Since you ran the converter command on `2023-06-06`,\
    \ I checked the original model [commit history ](https://huggingface.co/OpenAssistant/falcon-7b-sft-top1-696/commits/main)\
    \ and there hasn't been new commits since `2023-06-06`. Can anyone reproduce this\
    \ or have any insights as to what causes it? Thanks in advance.\r\n\r\n```\r\n\
    ct2-transformers-converter --model OpenAssistant/falcon-7b-sft-top1-696 --output_dir\
    \ ~/tmp-ct2fast-falcon-7b-sft-top1-696 --force --copy_files tokenizer.json README.md\
    \ tokenizer_config.json generation_config.json special_tokens_map.json .gitattributes\
    \ --quantization int8_float16 --trust_remote_code\r\n```\r\n\r\nTraceback:\r\n\
    ```python\r\nTraceback (most recent call last):\r\n  File \"/home/user/.pyenv/versions/llm/bin/ct2-transformers-converter\"\
    , line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/transformers.py\"\
    , line 1577, in main\r\n    converter.convert_from_args(args)\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
    , line 50, in convert_from_args\r\n    return self.convert(\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/converters/converter.py\"\
    , line 97, in convert\r\n    model_spec.validate()\r\n  File \"/home/user/.pyenv/versions/3.10.11/envs/llm/lib/python3.10/site-packages/ctranslate2/specs/model_spec.py\"\
    , line 561, in validate\r\n    raise ValueError(\r\nValueError: Vocabulary has\
    \ size 65029 but the model expected a vocabulary of size 65040\r\n\r\n```\r\n\r\
    \nLibrary versions:\r\n```\r\nctranslate2               3.16.0\r\nhf-hub-ctranslate2\
    \        2.12.0\r\ntransformers              4.30.2\r\ntorch                 \
    \    2.0.1\r\n```"
  created_at: 2023-06-25 10:40:50+00:00
  edited: false
  hidden: false
  id: 649827c23436cfb6bf5ccf8e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-26T17:01:22.000Z'
    data:
      edited: false
      editors:
      - michaelfeil
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.7588004469871521
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
          fullname: Michael
          isHf: false
          isPro: false
          name: michaelfeil
          type: user
        html: '<p>You have to wait for ctranslate2  = 3.17.0 or build from source.
          See: <a rel="nofollow" href="https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L1275">https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L1275</a></p>

          '
        raw: 'You have to wait for ctranslate2  = 3.17.0 or build from source. See:
          https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L1275'
        updatedAt: '2023-06-26T17:01:22.625Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - nazimali
      relatedEventId: 6499c46249364579971a14a7
    id: 6499c46249364579971a14a5
    type: comment
  author: michaelfeil
  content: 'You have to wait for ctranslate2  = 3.17.0 or build from source. See:
    https://github.com/OpenNMT/CTranslate2/blob/master/python/ctranslate2/converters/transformers.py#L1275'
  created_at: 2023-06-26 16:01:22+00:00
  edited: false
  hidden: false
  id: 6499c46249364579971a14a5
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/644fac0ce1d7a97f3b653ab1/fottSAPFrJdKeMW2UJv_l.jpeg?w=200&h=200&f=face
      fullname: Michael
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: michaelfeil
      type: user
    createdAt: '2023-06-26T17:01:22.000Z'
    data:
      status: closed
    id: 6499c46249364579971a14a7
    type: status-change
  author: michaelfeil
  created_at: 2023-06-26 16:01:22+00:00
  id: 6499c46249364579971a14a7
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 3
repo_id: michaelfeil/ct2fast-falcon-7b-sft-top1-696
repo_type: model
status: closed
target_branch: null
title: ct2 converter command raises vocabular size error
