!!python/object:huggingface_hub.community.DiscussionWithDetails
author: kamisama0101
conflicting_files: null
created_at: 2023-08-11 02:19:58+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3a4c624068fc14088fb2375c1d9b890f.svg
      fullname: Account
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kamisama0101
      type: user
    createdAt: '2023-08-11T03:19:58.000Z'
    data:
      edited: false
      editors:
      - kamisama0101
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5660742521286011
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3a4c624068fc14088fb2375c1d9b890f.svg
          fullname: Account
          isHf: false
          isPro: false
          name: kamisama0101
          type: user
        html: '<p>Thank you for your great work in geneformer!<br>However, when I
          redid the disease classification, I found a series of problems: </p>

          <ol>

          <li>"File "/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/torch/serialization.py",
          line 166, in validate_cuda_device<br>raise RuntimeError(''Attempting to
          deserialize object on a CUDA ''<br>RuntimeError: Attempting to deserialize
          object on a CUDA device but torch.cuda.is_available() is False."<br>Another:<br>"File
          "/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/ray/worker.py",
          line 1833, in get<br>raise value<br> ray.exceptions.RaySystemError: System
          error: Attempting to deserialize object on a CUDA device but torch.cuda.is_available()
          is False. If you are running on a CPU-only machine, please use torch.load
          with map_location=torch.device(''cpu'') to map your storages to the CPU."</li>

          </ol>

          <p>It is really strange because I do have a CUDA device.</p>

          <p>"<br> +-----------------------------------------------------------------------------+<br>|
          NVIDIA-SMI 525.60.13    Driver Version: 525.60.13    CUDA Version: 12.0     |<br>|-------------------------------+----------------------+----------------------+<br>|
          GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr.
          ECC |<br>| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute
          M. |<br>|                               |                      |               MIG
          M. |<br>|===============================+======================+======================|<br>|   0  Tesla
          V100-SXM2...  On   | 00000000:3B:00.0 Off |                    0 |<br>|
          N/A   30C    P0    55W / 300W |    903MiB / 32768MiB |      0%      Default
          |<br>|                               |                      |                  N/A
          |<br>+-------------------------------+----------------------+----------------------+<br>|   1  Tesla
          V100-SXM2...  On   | 00000000:86:00.0 Off |                    0 |<br>|
          N/A   27C    P0    51W / 300W |     25MiB / 32768MiB |      0%      Default
          |<br>|                               |                      |                  N/A
          |<br>+-------------------------------+----------------------+----------------------+<br>+-----------------------------------------------------------------------------+<br>|
          Processes:                                                                  |<br>|  GPU   GI   CI        PID   Type   Process
          name                  GPU Memory |<br>|        ID   ID                                                   Usage      |<br>|=============================================================================|<br>|    0   N/A  N/A    196221      C   python                            900MiB
          |<br>|    1   N/A  N/A    196692      C   ray::ImplicitFunc.train()          24MiB
          |<br>+-----------------------------------------------------------------------------+<br>"</p>

          <ol start="2">

          <li><p>"During handling of the above exception, another exception occurred:<br>...<br>File
          "/home/.../envs/geneformer3/lib/python3.9/site-packages/transformers/configuration_utils.py",
          line 693, in _get_config_dict<br> raise EnvironmentError(<br>OSError: Can''t
          load the configuration of ''path/to/pretrained_model/''. If you were trying
          to load it from ''<a href="https://huggingface.co/models''">https://huggingface.co/models''</a>,
          make sure you don''t have a local directory with the same name. Otherwise,
          make sure ''path/to/pretrained_model/'' is the correct path to a directory
          containing a config.json file"<br>It''s also strange because I can load
          the pretrained_model in the cell classification and gene classification
          task by the same "path/to".</p>

          </li>

          <li><p>"File "/home/jdhan_pkuhpc/profiles/yeyaxuan/lustre2/anaconda3/envs/geneformer3/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py",
          line 158, in validate_repo_id<br>raise HFValidationError(<br>huggingface_hub.utils._validators.HFValidationError:
          Repo id must be in the form ''repo_name'' or ''namespace/repo_name'': ''path/to/pretrained_model/''.
          Use <code>repo_type</code> argument if needed."</p>

          </li>

          </ol>

          <p>I wonder whether it is caused by version conflict. I currently use the
          ray of version ''1.13.0''.<br>I would appreciate it if you can offer me
          some help!</p>

          '
        raw: "Thank you for your great work in geneformer!\r\nHowever, when I redid\
          \ the disease classification, I found a series of problems: \r\n\r\n\r\n\
          1. \"File \"/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/torch/serialization.py\"\
          , line 166, in validate_cuda_device\r\nraise RuntimeError('Attempting to\
          \ deserialize object on a CUDA '\r\nRuntimeError: Attempting to deserialize\
          \ object on a CUDA device but torch.cuda.is_available() is False.\"\r\n\
          Another: \r\n\"File \"/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/ray/worker.py\"\
          , line 1833, in get\r\nraise value\r\n ray.exceptions.RaySystemError: System\
          \ error: Attempting to deserialize object on a CUDA device but torch.cuda.is_available()\
          \ is False. If you are running on a CPU-only machine, please use torch.load\
          \ with map_location=torch.device('cpu') to map your storages to the CPU.\"\
          \r\n\r\nIt is really strange because I do have a CUDA device.\r\n\r\n\"\r\
          \n +-----------------------------------------------------------------------------+\r\
          \n| NVIDIA-SMI 525.60.13    Driver Version: 525.60.13    CUDA Version: 12.0\
          \     |\r\n|-------------------------------+----------------------+----------------------+\r\
          \n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr.\
          \ ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util\
          \  Compute M. |\r\n|                               |                   \
          \   |               MIG M. |\r\n|===============================+======================+======================|\r\
          \n|   0  Tesla V100-SXM2...  On   | 00000000:3B:00.0 Off |             \
          \       0 |\r\n| N/A   30C    P0    55W / 300W |    903MiB / 32768MiB |\
          \      0%      Default |\r\n|                               |          \
          \            |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\
          \n|   1  Tesla V100-SXM2...  On   | 00000000:86:00.0 Off |             \
          \       0 |\r\n| N/A   27C    P0    51W / 300W |     25MiB / 32768MiB |\
          \      0%      Default |\r\n|                               |          \
          \            |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\
          \n+-----------------------------------------------------------------------------+\r\
          \n| Processes:                                                         \
          \         |\r\n|  GPU   GI   CI        PID   Type   Process name       \
          \           GPU Memory |\r\n|        ID   ID                           \
          \                        Usage      |\r\n|=============================================================================|\r\
          \n|    0   N/A  N/A    196221      C   python                          \
          \  900MiB |\r\n|    1   N/A  N/A    196692      C   ray::ImplicitFunc.train()\
          \          24MiB |\r\n+-----------------------------------------------------------------------------+\r\
          \n\"\r\n\r\n2. \"During handling of the above exception, another exception\
          \ occurred:\r\n...\r\nFile \"/home/.../envs/geneformer3/lib/python3.9/site-packages/transformers/configuration_utils.py\"\
          , line 693, in _get_config_dict\r\n raise EnvironmentError(\r\nOSError:\
          \ Can't load the configuration of 'path/to/pretrained_model/'. If you were\
          \ trying to load it from 'https://huggingface.co/models', make sure you\
          \ don't have a local directory with the same name. Otherwise, make sure\
          \ 'path/to/pretrained_model/' is the correct path to a directory containing\
          \ a config.json file\"\r\nIt's also strange because I can load the pretrained_model\
          \ in the cell classification and gene classification task by the same \"\
          path/to\".\r\n\r\n3. \"File \"/home/jdhan_pkuhpc/profiles/yeyaxuan/lustre2/anaconda3/envs/geneformer3/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py\"\
          , line 158, in validate_repo_id\r\nraise HFValidationError(\r\nhuggingface_hub.utils._validators.HFValidationError:\
          \ Repo id must be in the form 'repo_name' or 'namespace/repo_name': 'path/to/pretrained_model/'.\
          \ Use `repo_type` argument if needed.\"\r\n\r\nI wonder whether it is caused\
          \ by version conflict. I currently use the ray of version '1.13.0'.\r\n\
          I would appreciate it if you can offer me some help!\r\n"
        updatedAt: '2023-08-11T03:19:58.705Z'
      numEdits: 0
      reactions: []
    id: 64d5a8de0d87929689e0a195
    type: comment
  author: kamisama0101
  content: "Thank you for your great work in geneformer!\r\nHowever, when I redid\
    \ the disease classification, I found a series of problems: \r\n\r\n\r\n1. \"\
    File \"/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/torch/serialization.py\"\
    , line 166, in validate_cuda_device\r\nraise RuntimeError('Attempting to deserialize\
    \ object on a CUDA '\r\nRuntimeError: Attempting to deserialize object on a CUDA\
    \ device but torch.cuda.is_available() is False.\"\r\nAnother: \r\n\"File \"/home/.../anaconda3/envs/geneformer3/lib/python3.9/site-packages/ray/worker.py\"\
    , line 1833, in get\r\nraise value\r\n ray.exceptions.RaySystemError: System error:\
    \ Attempting to deserialize object on a CUDA device but torch.cuda.is_available()\
    \ is False. If you are running on a CPU-only machine, please use torch.load with\
    \ map_location=torch.device('cpu') to map your storages to the CPU.\"\r\n\r\n\
    It is really strange because I do have a CUDA device.\r\n\r\n\"\r\n +-----------------------------------------------------------------------------+\r\
    \n| NVIDIA-SMI 525.60.13    Driver Version: 525.60.13    CUDA Version: 12.0  \
    \   |\r\n|-------------------------------+----------------------+----------------------+\r\
    \n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC\
    \ |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute\
    \ M. |\r\n|                               |                      |           \
    \    MIG M. |\r\n|===============================+======================+======================|\r\
    \n|   0  Tesla V100-SXM2...  On   | 00000000:3B:00.0 Off |                   \
    \ 0 |\r\n| N/A   30C    P0    55W / 300W |    903MiB / 32768MiB |      0%    \
    \  Default |\r\n|                               |                      |     \
    \             N/A |\r\n+-------------------------------+----------------------+----------------------+\r\
    \n|   1  Tesla V100-SXM2...  On   | 00000000:86:00.0 Off |                   \
    \ 0 |\r\n| N/A   27C    P0    51W / 300W |     25MiB / 32768MiB |      0%    \
    \  Default |\r\n|                               |                      |     \
    \             N/A |\r\n+-------------------------------+----------------------+----------------------+\r\
    \n+-----------------------------------------------------------------------------+\r\
    \n| Processes:                                                               \
    \   |\r\n|  GPU   GI   CI        PID   Type   Process name                  GPU\
    \ Memory |\r\n|        ID   ID                                               \
    \    Usage      |\r\n|=============================================================================|\r\
    \n|    0   N/A  N/A    196221      C   python                            900MiB\
    \ |\r\n|    1   N/A  N/A    196692      C   ray::ImplicitFunc.train()        \
    \  24MiB |\r\n+-----------------------------------------------------------------------------+\r\
    \n\"\r\n\r\n2. \"During handling of the above exception, another exception occurred:\r\
    \n...\r\nFile \"/home/.../envs/geneformer3/lib/python3.9/site-packages/transformers/configuration_utils.py\"\
    , line 693, in _get_config_dict\r\n raise EnvironmentError(\r\nOSError: Can't\
    \ load the configuration of 'path/to/pretrained_model/'. If you were trying to\
    \ load it from 'https://huggingface.co/models', make sure you don't have a local\
    \ directory with the same name. Otherwise, make sure 'path/to/pretrained_model/'\
    \ is the correct path to a directory containing a config.json file\"\r\nIt's also\
    \ strange because I can load the pretrained_model in the cell classification and\
    \ gene classification task by the same \"path/to\".\r\n\r\n3. \"File \"/home/jdhan_pkuhpc/profiles/yeyaxuan/lustre2/anaconda3/envs/geneformer3/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py\"\
    , line 158, in validate_repo_id\r\nraise HFValidationError(\r\nhuggingface_hub.utils._validators.HFValidationError:\
    \ Repo id must be in the form 'repo_name' or 'namespace/repo_name': 'path/to/pretrained_model/'.\
    \ Use `repo_type` argument if needed.\"\r\n\r\nI wonder whether it is caused by\
    \ version conflict. I currently use the ray of version '1.13.0'.\r\nI would appreciate\
    \ it if you can offer me some help!\r\n"
  created_at: 2023-08-11 02:19:58+00:00
  edited: false
  hidden: false
  id: 64d5a8de0d87929689e0a195
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-08-11T05:33:40.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9529814124107361
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for your interest in Geneformer! Raytune can be sensitive
          to various factors, especially when running jobs distributed on multiple
          GPUs, that are highly environment-specific. If you are able to load the
          model usually but are having trouble when loading with Raytune, it''s possible
          that the job being distributed to multiple GPUs is not replicating the environment
          correctly for each parallel job. This script was run with Raytune version
          1.9.2 (conda-forge) at the time. You could consider trialing that version
          or following up with Raytune to help troubleshoot by checking their documentation
          and prior closed issues/discussions or opening a new issue. </p>

          '
        raw: 'Thank you for your interest in Geneformer! Raytune can be sensitive
          to various factors, especially when running jobs distributed on multiple
          GPUs, that are highly environment-specific. If you are able to load the
          model usually but are having trouble when loading with Raytune, it''s possible
          that the job being distributed to multiple GPUs is not replicating the environment
          correctly for each parallel job. This script was run with Raytune version
          1.9.2 (conda-forge) at the time. You could consider trialing that version
          or following up with Raytune to help troubleshoot by checking their documentation
          and prior closed issues/discussions or opening a new issue. '
        updatedAt: '2023-08-11T05:33:40.325Z'
      numEdits: 0
      reactions: []
      relatedEventId: 64d5c8345f4814f7c3ebb280
    id: 64d5c8345f4814f7c3ebb27b
    type: comment
  author: ctheodoris
  content: 'Thank you for your interest in Geneformer! Raytune can be sensitive to
    various factors, especially when running jobs distributed on multiple GPUs, that
    are highly environment-specific. If you are able to load the model usually but
    are having trouble when loading with Raytune, it''s possible that the job being
    distributed to multiple GPUs is not replicating the environment correctly for
    each parallel job. This script was run with Raytune version 1.9.2 (conda-forge)
    at the time. You could consider trialing that version or following up with Raytune
    to help troubleshoot by checking their documentation and prior closed issues/discussions
    or opening a new issue. '
  created_at: 2023-08-11 04:33:40+00:00
  edited: false
  hidden: false
  id: 64d5c8345f4814f7c3ebb27b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-08-11T05:33:40.000Z'
    data:
      status: closed
    id: 64d5c8345f4814f7c3ebb280
    type: status-change
  author: ctheodoris
  created_at: 2023-08-11 04:33:40+00:00
  id: 64d5c8345f4814f7c3ebb280
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/3a4c624068fc14088fb2375c1d9b890f.svg
      fullname: Account
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: kamisama0101
      type: user
    createdAt: '2023-08-14T03:16:17.000Z'
    data:
      edited: false
      editors:
      - kamisama0101
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9183204174041748
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/3a4c624068fc14088fb2375c1d9b890f.svg
          fullname: Account
          isHf: false
          isPro: false
          name: kamisama0101
          type: user
        html: '<p>What''s the version of python you used?</p>

          '
        raw: What's the version of python you used?
        updatedAt: '2023-08-14T03:16:17.702Z'
      numEdits: 0
      reactions: []
    id: 64d99c81abf475a80804f20c
    type: comment
  author: kamisama0101
  content: What's the version of python you used?
  created_at: 2023-08-14 02:16:17+00:00
  edited: false
  hidden: false
  id: 64d99c81abf475a80804f20c
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 212
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: null
title: '"torch.cuda.is_available() is False", "Can''t load the configuration of ''path/to/pretrained_model/"
  and... in hyperparam_optimiz_for_disease_classifier.py'
