!!python/object:huggingface_hub.community.DiscussionWithDetails
author: giovp
conflicting_files:
- geneformer/tokenizer.py
created_at: 2023-07-07 17:39:28+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
      fullname: Giovanni Palla
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: giovp
      type: user
    createdAt: '2023-07-07T18:39:28.000Z'
    data:
      edited: true
      editors:
      - giovp
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.11044929921627045
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
          fullname: Giovanni Palla
          isHf: false
          isPro: false
          name: giovp
          type: user
        html: '<p>hi, I added a method to enable the tokenizer to also take anndata
          files as input. I tested it with the following:</p>

          <pre><code class="language-python">

          <span class="hljs-comment"># take any anndata file</span>

          <span class="hljs-comment"># ...</span>


          <span class="hljs-comment"># save it as loom and as h5ad</span>

          adata.write_loom(<span class="hljs-string">"/path/to/folder/temp_files/temp.loom"</span>)

          adata.write(<span class="hljs-string">"/path/to/folder/temp_files/temp.h5ad"</span>)


          <span class="hljs-comment"># tokenize data</span>

          <span class="hljs-keyword">from</span> geneformer <span class="hljs-keyword">import</span>
          TranscriptomeTokenizer


          tk = TranscriptomeTokenizer({<span class="hljs-string">"tissue"</span>:<span
          class="hljs-string">"tissue"</span>}, nproc=<span class="hljs-number">4</span>)
          <span class="hljs-comment"># some annotation</span>

          tk.tokenize_data(<span class="hljs-string">"/path/to/folder/temp_files/temp.h5ad"</span>,
          <span class="hljs-string">"/path/to/folder/temp_files"</span>, <span class="hljs-string">"dataset_h5ad"</span>,
          <span class="hljs-string">"h5ad"</span>)


          tk = TranscriptomeTokenizer({<span class="hljs-string">"tissue"</span>:<span
          class="hljs-string">"tissue"</span>}, nproc=<span class="hljs-number">4</span>)
          <span class="hljs-comment"># some annotation</span>

          tk.tokenize_data(<span class="hljs-string">"/path/to/folder/temp_files/temp.loom"</span>,
          <span class="hljs-string">"/path/to/folder/temp_files"</span>, <span class="hljs-string">"dataset_loom"</span>,
          <span class="hljs-string">"loom"</span>)

          </code></pre>

          <p>and test with e.g. <code>diff -r -q dataset_h5ad.dataset dataset_loom.dataset</code>
          or reading the arrow files etc.</p>

          <p>not sure if this is the best way to submit contributions via HF hub,
          diffs don''t look good. Any help on how to do this properly is appreciated,
          in case there is interest to have this contribution.</p>

          '
        raw: 'hi, I added a method to enable the tokenizer to also take anndata files
          as input. I tested it with the following:


          ```python


          # take any anndata file

          # ...


          # save it as loom and as h5ad

          adata.write_loom("/path/to/folder/temp_files/temp.loom")

          adata.write("/path/to/folder/temp_files/temp.h5ad")


          # tokenize data

          from geneformer import TranscriptomeTokenizer


          tk = TranscriptomeTokenizer({"tissue":"tissue"}, nproc=4) # some annotation

          tk.tokenize_data("/path/to/folder/temp_files/temp.h5ad", "/path/to/folder/temp_files",
          "dataset_h5ad", "h5ad")


          tk = TranscriptomeTokenizer({"tissue":"tissue"}, nproc=4) # some annotation

          tk.tokenize_data("/path/to/folder/temp_files/temp.loom", "/path/to/folder/temp_files",
          "dataset_loom", "loom")

          ```


          and test with e.g. `diff -r -q dataset_h5ad.dataset dataset_loom.dataset`
          or reading the arrow files etc.


          not sure if this is the best way to submit contributions via HF hub, diffs
          don''t look good. Any help on how to do this properly is appreciated, in
          case there is interest to have this contribution.'
        updatedAt: '2023-07-07T18:46:56.654Z'
      numEdits: 1
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - kzkedzierska
    id: 64a85be0a8e86b27d08793ec
    type: comment
  author: giovp
  content: 'hi, I added a method to enable the tokenizer to also take anndata files
    as input. I tested it with the following:


    ```python


    # take any anndata file

    # ...


    # save it as loom and as h5ad

    adata.write_loom("/path/to/folder/temp_files/temp.loom")

    adata.write("/path/to/folder/temp_files/temp.h5ad")


    # tokenize data

    from geneformer import TranscriptomeTokenizer


    tk = TranscriptomeTokenizer({"tissue":"tissue"}, nproc=4) # some annotation

    tk.tokenize_data("/path/to/folder/temp_files/temp.h5ad", "/path/to/folder/temp_files",
    "dataset_h5ad", "h5ad")


    tk = TranscriptomeTokenizer({"tissue":"tissue"}, nproc=4) # some annotation

    tk.tokenize_data("/path/to/folder/temp_files/temp.loom", "/path/to/folder/temp_files",
    "dataset_loom", "loom")

    ```


    and test with e.g. `diff -r -q dataset_h5ad.dataset dataset_loom.dataset` or reading
    the arrow files etc.


    not sure if this is the best way to submit contributions via HF hub, diffs don''t
    look good. Any help on how to do this properly is appreciated, in case there is
    interest to have this contribution.'
  created_at: 2023-07-07 17:39:28+00:00
  edited: true
  hidden: false
  id: 64a85be0a8e86b27d08793ec
  type: comment
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
      fullname: Giovanni Palla
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: giovp
      type: user
    createdAt: '2023-07-07T18:41:17.000Z'
    data:
      oid: b23ca9d04eb16fd78b6eb748cfe0f5b32aff4a38
      parents:
      - 77eb432430e05760c80cc931b0e17844fe18f391
      subject: add anndata tokenizer
    id: 64a85c4d0000000000000000
    type: commit
  author: giovp
  created_at: 2023-07-07 17:41:17+00:00
  id: 64a85c4d0000000000000000
  oid: b23ca9d04eb16fd78b6eb748cfe0f5b32aff4a38
  summary: add anndata tokenizer
  type: commit
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
      fullname: Giovanni Palla
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: giovp
      type: user
    createdAt: '2023-07-07T18:45:12.000Z'
    data:
      status: closed
    id: 64a85d38b76bfd863e6d81de
    type: status-change
  author: giovp
  created_at: 2023-07-07 17:45:12+00:00
  id: 64a85d38b76bfd863e6d81de
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
      fullname: Giovanni Palla
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: giovp
      type: user
    createdAt: '2023-07-07T18:45:44.000Z'
    data:
      status: open
    id: 64a85d5831f620201dba2879
    type: status-change
  author: giovp
  created_at: 2023-07-07 17:45:44+00:00
  id: 64a85d5831f620201dba2879
  new_status: open
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionCommit
  _event:
    author:
      avatarUrl: /avatars/6481e089ab49674d438403a5098fa35a.svg
      fullname: Giovanni Palla
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: giovp
      type: user
    createdAt: '2023-07-10T14:14:39.000Z'
    data:
      oid: 42acd1445e9e53a00a562642a338d9cff6018e75
      parents:
      - b23ca9d04eb16fd78b6eb748cfe0f5b32aff4a38
      subject: update tokenizer to use total counts
    id: 64ac124f0000000000000000
    type: commit
  author: giovp
  created_at: 2023-07-10 13:14:39+00:00
  id: 64ac124f0000000000000000
  oid: 42acd1445e9e53a00a562642a338d9cff6018e75
  summary: update tokenizer to use total counts
  type: commit
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-07-16T19:27:39.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8307186961174011
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for the pull request! The tokenization of loom files scans
          through chunks without loading the entire file into memory to allow for
          memory-efficient processing of large files. Have you tested the anndata
          version on anndata files on the order of a million cells?</p>

          '
        raw: Thank you for the pull request! The tokenization of loom files scans
          through chunks without loading the entire file into memory to allow for
          memory-efficient processing of large files. Have you tested the anndata
          version on anndata files on the order of a million cells?
        updatedAt: '2023-07-16T19:27:39.456Z'
      numEdits: 0
      reactions: []
    id: 64b444ab372d43407777bded
    type: comment
  author: ctheodoris
  content: Thank you for the pull request! The tokenization of loom files scans through
    chunks without loading the entire file into memory to allow for memory-efficient
    processing of large files. Have you tested the anndata version on anndata files
    on the order of a million cells?
  created_at: 2023-07-16 18:27:39+00:00
  edited: false
  hidden: false
  id: 64b444ab372d43407777bded
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-07-26T19:16:55.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8958245515823364
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: "<p><span data-props=\"{&quot;user&quot;:&quot;giovp&quot;}\" data-target=\"\
          UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\">\n\n<span class=\"\
          inline-block\"><span class=\"contents\"><a href=\"/giovp\">@<span class=\"\
          underline\">giovp</span></a></span>\n\n\t</span></span> I wanted to follow\
          \ up on whether you have tested this for large input files yet. Please let\
          \ me know! Thank you so much!</p>\n"
        raw: '@giovp I wanted to follow up on whether you have tested this for large
          input files yet. Please let me know! Thank you so much!'
        updatedAt: '2023-07-26T19:16:55.421Z'
      numEdits: 0
      reactions: []
    id: 64c17127b9d81735a11b825b
    type: comment
  author: ctheodoris
  content: '@giovp I wanted to follow up on whether you have tested this for large
    input files yet. Please let me know! Thank you so much!'
  created_at: 2023-07-26 18:16:55+00:00
  edited: false
  hidden: false
  id: 64c17127b9d81735a11b825b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-09-20T20:56:35.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.962371826171875
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you so much for initiating this contribution. It has now been
          modified and merged under PR 170.</p>

          '
        raw: Thank you so much for initiating this contribution. It has now been modified
          and merged under PR 170.
        updatedAt: '2023-09-20T20:56:35.071Z'
      numEdits: 0
      reactions: []
      relatedEventId: 650b5c83a84110ffe0606dc0
    id: 650b5c83a84110ffe0606dbd
    type: comment
  author: ctheodoris
  content: Thank you so much for initiating this contribution. It has now been modified
    and merged under PR 170.
  created_at: 2023-09-20 19:56:35+00:00
  edited: false
  hidden: false
  id: 650b5c83a84110ffe0606dbd
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-09-20T20:56:35.000Z'
    data:
      status: closed
    id: 650b5c83a84110ffe0606dc0
    type: status-change
  author: ctheodoris
  created_at: 2023-09-20 19:56:35+00:00
  id: 650b5c83a84110ffe0606dc0
  new_status: closed
  type: status-change
is_pull_request: true
merge_commit_oid: null
num: 102
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: refs/heads/main
title: anndata tokenizer
