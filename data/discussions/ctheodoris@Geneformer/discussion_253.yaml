!!python/object:huggingface_hub.community.DiscussionWithDetails
author: yanayrosen
conflicting_files: null
created_at: 2023-09-30 04:13:57+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/748c3e89a4e8b58c5a8817fcfee4a6f3.svg
      fullname: Yanay Rosen
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: yanayrosen
      type: user
    createdAt: '2023-09-30T05:13:57.000Z'
    data:
      edited: false
      editors:
      - yanayrosen
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6603517532348633
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/748c3e89a4e8b58c5a8817fcfee4a6f3.svg
          fullname: Yanay Rosen
          isHf: false
          isPro: false
          name: yanayrosen
          type: user
        html: '<p>Hello,</p>

          <p>I am trying to do a zero shot batch integration of the pbmcs 10k dataset.</p>

          <p>However, the 12L model is failing to form cell type clusters. It does
          seem to be mixing the batches a bit.</p>

          <p>Here is the data for one of the cells:</p>

          <pre><code>{''input_ids'': [1876, 1720, 6179, 17905, 19968, 14860, 449,
          16979, 9912, 5150, 4997, 17877, 2183, 1722, 3409, 5897, 12172, 17660, 12509,
          16436, 3242, 10862, 13139, 4603, 8487, 2250, 396, 11755, 4919, 6629, 2244,
          2710, 10178, 8761, 16445, 6382, 16322, 2211, 11640, 8447, 20031, 955, 16154,
          9786, 1

          </code></pre>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/LUbfBEEgFlrYxITv7tMWX.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/LUbfBEEgFlrYxITv7tMWX.png"></a></p>

          <p><a rel="nofollow" href="https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/ECSP-Kv1WgN4o9k_l2_Aq.png"><img
          alt="image.png" src="https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/ECSP-Kv1WgN4o9k_l2_Aq.png"></a></p>

          <p>The code I used follows the code from the tokenizer and extract_and_plot_cell_embeddings
          notebooks. </p>

          '
        raw: "Hello,\r\n\r\nI am trying to do a zero shot batch integration of the\
          \ pbmcs 10k dataset.\r\n\r\nHowever, the 12L model is failing to form cell\
          \ type clusters. It does seem to be mixing the batches a bit.\r\n\r\nHere\
          \ is the data for one of the cells:\r\n```\r\n{'input_ids': [1876, 1720,\
          \ 6179, 17905, 19968, 14860, 449, 16979, 9912, 5150, 4997, 17877, 2183,\
          \ 1722, 3409, 5897, 12172, 17660, 12509, 16436, 3242, 10862, 13139, 4603,\
          \ 8487, 2250, 396, 11755, 4919, 6629, 2244, 2710, 10178, 8761, 16445, 6382,\
          \ 16322, 2211, 11640, 8447, 20031, 955, 16154, 9786, 1\r\n```\r\n\r\n\r\n\
          ![image.png](https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/LUbfBEEgFlrYxITv7tMWX.png)\r\
          \n\r\n\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/ECSP-Kv1WgN4o9k_l2_Aq.png)\r\
          \n\r\nThe code I used follows the code from the tokenizer and extract_and_plot_cell_embeddings\
          \ notebooks. "
        updatedAt: '2023-09-30T05:13:57.791Z'
      numEdits: 0
      reactions: []
    id: 6517ae95a28f86d3e9cb4c9b
    type: comment
  author: yanayrosen
  content: "Hello,\r\n\r\nI am trying to do a zero shot batch integration of the pbmcs\
    \ 10k dataset.\r\n\r\nHowever, the 12L model is failing to form cell type clusters.\
    \ It does seem to be mixing the batches a bit.\r\n\r\nHere is the data for one\
    \ of the cells:\r\n```\r\n{'input_ids': [1876, 1720, 6179, 17905, 19968, 14860,\
    \ 449, 16979, 9912, 5150, 4997, 17877, 2183, 1722, 3409, 5897, 12172, 17660, 12509,\
    \ 16436, 3242, 10862, 13139, 4603, 8487, 2250, 396, 11755, 4919, 6629, 2244, 2710,\
    \ 10178, 8761, 16445, 6382, 16322, 2211, 11640, 8447, 20031, 955, 16154, 9786,\
    \ 1\r\n```\r\n\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/LUbfBEEgFlrYxITv7tMWX.png)\r\
    \n\r\n\r\n\r\n![image.png](https://cdn-uploads.huggingface.co/production/uploads/64797b31e504380e5c89b3ff/ECSP-Kv1WgN4o9k_l2_Aq.png)\r\
    \n\r\nThe code I used follows the code from the tokenizer and extract_and_plot_cell_embeddings\
    \ notebooks. "
  created_at: 2023-09-30 04:13:57+00:00
  edited: false
  hidden: false
  id: 6517ae95a28f86d3e9cb4c9b
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-09-30T11:26:36.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9692766070365906
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for your interest in Geneformer! In our experience, the
          zero-shot separation of cell types with the 12L model is definitely improved
          compared to what you are showing here. The mixing of cell types seems absolutely
          random, which concerns me that the labels have somehow been randomized.
          It is also unclear why there are 4 major clusters as it does not seem to
          be driven by the batch. It makes me think that the 4 clusters are actually
          related to the cell types, and somehow the labels have been corrupted, unless
          there is another explanation you may have for why there are 4 separate clusters.
          I would suggest double checking the labels. I would also suggest confirming
          you are using the 2nd to last layer embeddings for the pretrained model
          (emb_layer = -1), and not embeddings from the 1st layer prior to running
          through the model.</p>

          <p>Also, for the batch integration, I will note that fine-tuning will likely
          improve the batch integration even further. For example, if you fine-tuned
          this model to distinguish cell types, if that''s of interest, the batches
          should mix further.</p>

          '
        raw: 'Thank you for your interest in Geneformer! In our experience, the zero-shot
          separation of cell types with the 12L model is definitely improved compared
          to what you are showing here. The mixing of cell types seems absolutely
          random, which concerns me that the labels have somehow been randomized.
          It is also unclear why there are 4 major clusters as it does not seem to
          be driven by the batch. It makes me think that the 4 clusters are actually
          related to the cell types, and somehow the labels have been corrupted, unless
          there is another explanation you may have for why there are 4 separate clusters.
          I would suggest double checking the labels. I would also suggest confirming
          you are using the 2nd to last layer embeddings for the pretrained model
          (emb_layer = -1), and not embeddings from the 1st layer prior to running
          through the model.


          Also, for the batch integration, I will note that fine-tuning will likely
          improve the batch integration even further. For example, if you fine-tuned
          this model to distinguish cell types, if that''s of interest, the batches
          should mix further.'
        updatedAt: '2023-09-30T11:26:36.272Z'
      numEdits: 0
      reactions:
      - count: 1
        reaction: "\U0001F44D"
        users:
        - yanayrosen
      relatedEventId: 651805ec8a6d58d1d7ef3596
    id: 651805ec8a6d58d1d7ef358f
    type: comment
  author: ctheodoris
  content: 'Thank you for your interest in Geneformer! In our experience, the zero-shot
    separation of cell types with the 12L model is definitely improved compared to
    what you are showing here. The mixing of cell types seems absolutely random, which
    concerns me that the labels have somehow been randomized. It is also unclear why
    there are 4 major clusters as it does not seem to be driven by the batch. It makes
    me think that the 4 clusters are actually related to the cell types, and somehow
    the labels have been corrupted, unless there is another explanation you may have
    for why there are 4 separate clusters. I would suggest double checking the labels.
    I would also suggest confirming you are using the 2nd to last layer embeddings
    for the pretrained model (emb_layer = -1), and not embeddings from the 1st layer
    prior to running through the model.


    Also, for the batch integration, I will note that fine-tuning will likely improve
    the batch integration even further. For example, if you fine-tuned this model
    to distinguish cell types, if that''s of interest, the batches should mix further.'
  created_at: 2023-09-30 10:26:36+00:00
  edited: false
  hidden: false
  id: 651805ec8a6d58d1d7ef358f
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-09-30T11:26:36.000Z'
    data:
      status: closed
    id: 651805ec8a6d58d1d7ef3596
    type: status-change
  author: ctheodoris
  created_at: 2023-09-30 10:26:36+00:00
  id: 651805ec8a6d58d1d7ef3596
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 253
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: null
title: Zero Shot Embedding for Batch Integration for PBMCs
