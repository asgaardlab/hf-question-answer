!!python/object:huggingface_hub.community.DiscussionWithDetails
author: iLOVE2D
conflicting_files: null
created_at: 2023-12-23 23:58:23+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b2daf2bde31edab85e3d1bc0c0afbb5a.svg
      fullname: Tianyu
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: iLOVE2D
      type: user
    createdAt: '2023-12-23T23:58:23.000Z'
    data:
      edited: false
      editors:
      - iLOVE2D
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.47672298550605774
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b2daf2bde31edab85e3d1bc0c0afbb5a.svg
          fullname: Tianyu
          isHf: false
          isPro: false
          name: iLOVE2D
          type: user
        html: "<p>Hi, I found a bug when I tried to load the current gene embeddings\
          \ function:</p>\n<pre><code>TypeError                                 Traceback\
          \ (most recent call last)\nCell In[1], line 1\n----&gt; 1 from geneformer_new\
          \ import EmbExtractor\n\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/__init__.py:4\n\
          \      2 from . import pretrainer\n      3 from . import collator_for_classification\n\
          ----&gt; 4 from . import in_silico_perturber\n      5 from . import in_silico_perturber_stats\n\
          \      6 from .tokenizer import TranscriptomeTokenizer\n\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/in_silico_perturber.py:40\n\
          \     37 from datasets import Dataset\n     38 from tqdm.auto import trange\n\
          ---&gt; 40 from . import perturber_utils as pu\n     41 from .emb_extractor\
          \ import get_embs\n     42 from .tokenizer import TOKEN_DICTIONARY_FILE\n\
          \nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/perturber_utils.py:278\n\
          \    270     return torch.stack(output_batch_list_padded)\n    273 # removes\
          \ perturbed indices\n    274 # need to handle the various cases where a\
          \ set of genes is overexpressed\n    275 def remove_perturbed_indices_set(\n\
          \    276     emb,\n    277     perturb_type: str,\n--&gt; 278     indices_to_perturb:\
          \ list[list],\n    279     tokens_to_perturb: list[list],\n    280     original_lengths:\
          \ list[int],\n    281     input_ids=None,\n    282 ):\n    283     if perturb_type\
          \ == \"overexpress\":\n    284         num_perturbed = len(tokens_to_perturb)\n\
          \nTypeError: 'type' object is not subscriptable\n</code></pre>\n<p>Could\
          \ you please help me address it? Thanks.</p>\n"
        raw: "Hi, I found a bug when I tried to load the current gene embeddings function:\r\
          \n\r\n```\r\nTypeError                                 Traceback (most recent\
          \ call last)\r\nCell In[1], line 1\r\n----> 1 from geneformer_new import\
          \ EmbExtractor\r\n\r\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/__init__.py:4\r\
          \n      2 from . import pretrainer\r\n      3 from . import collator_for_classification\r\
          \n----> 4 from . import in_silico_perturber\r\n      5 from . import in_silico_perturber_stats\r\
          \n      6 from .tokenizer import TranscriptomeTokenizer\r\n\r\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/in_silico_perturber.py:40\r\
          \n     37 from datasets import Dataset\r\n     38 from tqdm.auto import\
          \ trange\r\n---> 40 from . import perturber_utils as pu\r\n     41 from\
          \ .emb_extractor import get_embs\r\n     42 from .tokenizer import TOKEN_DICTIONARY_FILE\r\
          \n\r\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/perturber_utils.py:278\r\
          \n    270     return torch.stack(output_batch_list_padded)\r\n    273 #\
          \ removes perturbed indices\r\n    274 # need to handle the various cases\
          \ where a set of genes is overexpressed\r\n    275 def remove_perturbed_indices_set(\r\
          \n    276     emb,\r\n    277     perturb_type: str,\r\n--> 278     indices_to_perturb:\
          \ list[list],\r\n    279     tokens_to_perturb: list[list],\r\n    280 \
          \    original_lengths: list[int],\r\n    281     input_ids=None,\r\n   \
          \ 282 ):\r\n    283     if perturb_type == \"overexpress\":\r\n    284 \
          \        num_perturbed = len(tokens_to_perturb)\r\n\r\nTypeError: 'type'\
          \ object is not subscriptable\r\n```\r\n\r\nCould you please help me address\
          \ it? Thanks."
        updatedAt: '2023-12-23T23:58:23.241Z'
      numEdits: 0
      reactions: []
    id: 6587741f991d8e7fb2f2c819
    type: comment
  author: iLOVE2D
  content: "Hi, I found a bug when I tried to load the current gene embeddings function:\r\
    \n\r\n```\r\nTypeError                                 Traceback (most recent\
    \ call last)\r\nCell In[1], line 1\r\n----> 1 from geneformer_new import EmbExtractor\r\
    \n\r\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/__init__.py:4\r\
    \n      2 from . import pretrainer\r\n      3 from . import collator_for_classification\r\
    \n----> 4 from . import in_silico_perturber\r\n      5 from . import in_silico_perturber_stats\r\
    \n      6 from .tokenizer import TranscriptomeTokenizer\r\n\r\nFile /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/in_silico_perturber.py:40\r\
    \n     37 from datasets import Dataset\r\n     38 from tqdm.auto import trange\r\
    \n---> 40 from . import perturber_utils as pu\r\n     41 from .emb_extractor import\
    \ get_embs\r\n     42 from .tokenizer import TOKEN_DICTIONARY_FILE\r\n\r\nFile\
    \ /gpfs/gibbs/pi/zhao/tl688/Geneformer/geneformer_new/perturber_utils.py:278\r\
    \n    270     return torch.stack(output_batch_list_padded)\r\n    273 # removes\
    \ perturbed indices\r\n    274 # need to handle the various cases where a set\
    \ of genes is overexpressed\r\n    275 def remove_perturbed_indices_set(\r\n \
    \   276     emb,\r\n    277     perturb_type: str,\r\n--> 278     indices_to_perturb:\
    \ list[list],\r\n    279     tokens_to_perturb: list[list],\r\n    280     original_lengths:\
    \ list[int],\r\n    281     input_ids=None,\r\n    282 ):\r\n    283     if perturb_type\
    \ == \"overexpress\":\r\n    284         num_perturbed = len(tokens_to_perturb)\r\
    \n\r\nTypeError: 'type' object is not subscriptable\r\n```\r\n\r\nCould you please\
    \ help me address it? Thanks."
  created_at: 2023-12-23 23:58:23+00:00
  edited: false
  hidden: false
  id: 6587741f991d8e7fb2f2c819
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-12-24T07:34:34.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8262135982513428
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for your interest in Geneformer! Python before 3.9 requires
          capitalized annotations from the typing library rather than the built-in
          collection types starting in 3.9: (<a rel="nofollow" href="https://docs.python.org/release/3.9.0/whatsnew/3.9.html#type-hinting-generics-in-standard-collections">https://docs.python.org/release/3.9.0/whatsnew/3.9.html#type-hinting-generics-in-standard-collections</a>).
          We would recommend updating to 3.9+ to avoid this issue.</p>

          '
        raw: 'Thank you for your interest in Geneformer! Python before 3.9 requires
          capitalized annotations from the typing library rather than the built-in
          collection types starting in 3.9: (https://docs.python.org/release/3.9.0/whatsnew/3.9.html#type-hinting-generics-in-standard-collections).
          We would recommend updating to 3.9+ to avoid this issue.


          '
        updatedAt: '2023-12-24T07:34:34.945Z'
      numEdits: 0
      reactions: []
      relatedEventId: 6587df0a438d7b1ccf215c80
    id: 6587df0a438d7b1ccf215c7d
    type: comment
  author: ctheodoris
  content: 'Thank you for your interest in Geneformer! Python before 3.9 requires
    capitalized annotations from the typing library rather than the built-in collection
    types starting in 3.9: (https://docs.python.org/release/3.9.0/whatsnew/3.9.html#type-hinting-generics-in-standard-collections).
    We would recommend updating to 3.9+ to avoid this issue.


    '
  created_at: 2023-12-24 07:34:34+00:00
  edited: false
  hidden: false
  id: 6587df0a438d7b1ccf215c7d
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-12-24T07:34:34.000Z'
    data:
      status: closed
    id: 6587df0a438d7b1ccf215c80
    type: status-change
  author: ctheodoris
  created_at: 2023-12-24 07:34:34+00:00
  id: 6587df0a438d7b1ccf215c80
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 284
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: null
title: A bug when loading the new gene embeddings extractor
