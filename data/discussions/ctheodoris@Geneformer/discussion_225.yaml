!!python/object:huggingface_hub.community.DiscussionWithDetails
author: AMCalejandro
conflicting_files: null
created_at: 2023-08-19 18:11:04+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/c9e531894ec4f570222edccc6fcce478.svg
      fullname: Martinez Carrasco
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AMCalejandro
      type: user
    createdAt: '2023-08-19T19:11:04.000Z'
    data:
      edited: true
      editors:
      - AMCalejandro
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.47019442915916443
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/c9e531894ec4f570222edccc6fcce478.svg
          fullname: Martinez Carrasco
          isHf: false
          isPro: false
          name: AMCalejandro
          type: user
        html: "<p>Hello,</p>\n<p>I am trying to fine the best hyperparameters for\
          \ a downstream task in which I want to do gene classification (distinguish\
          \ dosage sensitive versus insensitive) on cells coming from patients with\
          \ a specific phenotype.</p>\n<p>I followed the gene classification notebook\
          \ to modify the dataset so that my 'label' refers to dosage sensitive or\
          \ dosage insensitive.<br>Then, I split in train and validation, and finally\
          \ I get the trainer ( with a collator for Gene classification ) and then\
          \ start the hyperparameters search.</p>\n<p>This is the error message I\
          \ am getting:</p>\n<pre><code>Trial status: 12 ERROR | 4 RUNNING | 1 PENDING\n\
          Current time: 2023-08-20 12:02:51. Total running time: 1hr 22min 13s\nLogical\
          \ resource usage: 12.0/12 CPUs, 4.0/4 GPUs (0.0/1.0 accelerator_type:V100)\n\
          [martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$\n[martinezcarraa2@biowulf\
          \ DOSAGE_HYPERPARAMS]$ cat /home/martinezcarraa2/ray_results/_objective_2023-08-20_10-40-38/_objective_e8616145_12_learning_rate=0.0001,lr_scheduler_type=polynomial,num_train_epochs=1,per_device_train_batch_size=12,seed=29_2023-08-20_11-23-56/error.txt\n\
          Failure # 1 (occurred at 2023-08-20_11-45-01)\nray::ImplicitFunc.train()\
          \ (pid=2040340, ip=10.2.23.52, actor_id=d00ff41a94654f583dbbfb7a01000000,\
          \ repr=_objective)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/trainable.py\"\
          , line 375, in train\n    raise skipped from exception_cause(skipped)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
          , line 349, in entrypoint\n    return self._trainable_func(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
          , line 666, in _trainable_func\n    output = fn()\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
          , line 348, in dynamic_modules_import_trainable\n    return trainable(*args,\
          \ **kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/util.py\"\
          , line 324, in inner\n    return trainable(config, **fn_kwargs)\n  File\
          \ \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
          , line 249, in _objective\n    local_trainer.train(resume_from_checkpoint=checkpoint,\
          \ trial=trial)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 1539, in train\n    return inner_training_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 1901, in _inner_training_loop\n    self._maybe_log_save_evaluate(tr_loss,\
          \ model, trial, epoch, ignore_keys_for_eval)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 2226, in _maybe_log_save_evaluate\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 2934, in evaluate\n    output = eval_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 3222, in evaluation_loop\n    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds,\
          \ label_ids=all_labels))\n  File \"hyperparam_optimiz_for_disease_classifier.py\"\
          , line 178, in compute_metrics\n    acc = accuracy_score(labels, preds)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/utils/_param_validation.py\"\
          , line 211, in wrapper\n    return func(*args, **kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
          , line 220, in accuracy_score\n    y_type, y_true, y_pred = _check_targets(y_true,\
          \ y_pred)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
          , line 93, in _check_targets\n    raise ValueError(\nValueError: Classification\
          \ metrics can't handle a mix of multiclass-multioutput and multilabel-indicator\
          \ targets\n[martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$\n</code></pre>\n"
        raw: "Hello,\n\nI am trying to fine the best hyperparameters for a downstream\
          \ task in which I want to do gene classification (distinguish dosage sensitive\
          \ versus insensitive) on cells coming from patients with a specific phenotype.\n\
          \nI followed the gene classification notebook to modify the dataset so that\
          \ my 'label' refers to dosage sensitive or dosage insensitive.\nThen, I\
          \ split in train and validation, and finally I get the trainer ( with a\
          \ collator for Gene classification ) and then start the hyperparameters\
          \ search.\n\nThis is the error message I am getting:\n\n\n```\nTrial status:\
          \ 12 ERROR | 4 RUNNING | 1 PENDING\nCurrent time: 2023-08-20 12:02:51. Total\
          \ running time: 1hr 22min 13s\nLogical resource usage: 12.0/12 CPUs, 4.0/4\
          \ GPUs (0.0/1.0 accelerator_type:V100)\n[martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$\n\
          [martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$ cat /home/martinezcarraa2/ray_results/_objective_2023-08-20_10-40-38/_objective_e8616145_12_learning_rate=0.0001,lr_scheduler_type=polynomial,num_train_epochs=1,per_device_train_batch_size=12,seed=29_2023-08-20_11-23-56/error.txt\n\
          Failure # 1 (occurred at 2023-08-20_11-45-01)\nray::ImplicitFunc.train()\
          \ (pid=2040340, ip=10.2.23.52, actor_id=d00ff41a94654f583dbbfb7a01000000,\
          \ repr=_objective)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/trainable.py\"\
          , line 375, in train\n    raise skipped from exception_cause(skipped)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
          , line 349, in entrypoint\n    return self._trainable_func(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
          , line 666, in _trainable_func\n    output = fn()\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
          , line 348, in dynamic_modules_import_trainable\n    return trainable(*args,\
          \ **kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/util.py\"\
          , line 324, in inner\n    return trainable(config, **fn_kwargs)\n  File\
          \ \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
          , line 249, in _objective\n    local_trainer.train(resume_from_checkpoint=checkpoint,\
          \ trial=trial)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 1539, in train\n    return inner_training_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 1901, in _inner_training_loop\n    self._maybe_log_save_evaluate(tr_loss,\
          \ model, trial, epoch, ignore_keys_for_eval)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 2226, in _maybe_log_save_evaluate\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 2934, in evaluate\n    output = eval_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
          , line 3222, in evaluation_loop\n    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds,\
          \ label_ids=all_labels))\n  File \"hyperparam_optimiz_for_disease_classifier.py\"\
          , line 178, in compute_metrics\n    acc = accuracy_score(labels, preds)\n\
          \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/utils/_param_validation.py\"\
          , line 211, in wrapper\n    return func(*args, **kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
          , line 220, in accuracy_score\n    y_type, y_true, y_pred = _check_targets(y_true,\
          \ y_pred)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
          , line 93, in _check_targets\n    raise ValueError(\nValueError: Classification\
          \ metrics can't handle a mix of multiclass-multioutput and multilabel-indicator\
          \ targets\n[martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$\n\n```\n"
        updatedAt: '2023-08-20T21:58:56.788Z'
      numEdits: 1
      reactions: []
    id: 64e113c875fae2212e82922c
    type: comment
  author: AMCalejandro
  content: "Hello,\n\nI am trying to fine the best hyperparameters for a downstream\
    \ task in which I want to do gene classification (distinguish dosage sensitive\
    \ versus insensitive) on cells coming from patients with a specific phenotype.\n\
    \nI followed the gene classification notebook to modify the dataset so that my\
    \ 'label' refers to dosage sensitive or dosage insensitive.\nThen, I split in\
    \ train and validation, and finally I get the trainer ( with a collator for Gene\
    \ classification ) and then start the hyperparameters search.\n\nThis is the error\
    \ message I am getting:\n\n\n```\nTrial status: 12 ERROR | 4 RUNNING | 1 PENDING\n\
    Current time: 2023-08-20 12:02:51. Total running time: 1hr 22min 13s\nLogical\
    \ resource usage: 12.0/12 CPUs, 4.0/4 GPUs (0.0/1.0 accelerator_type:V100)\n[martinezcarraa2@biowulf\
    \ DOSAGE_HYPERPARAMS]$\n[martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$ cat /home/martinezcarraa2/ray_results/_objective_2023-08-20_10-40-38/_objective_e8616145_12_learning_rate=0.0001,lr_scheduler_type=polynomial,num_train_epochs=1,per_device_train_batch_size=12,seed=29_2023-08-20_11-23-56/error.txt\n\
    Failure # 1 (occurred at 2023-08-20_11-45-01)\nray::ImplicitFunc.train() (pid=2040340,\
    \ ip=10.2.23.52, actor_id=d00ff41a94654f583dbbfb7a01000000, repr=_objective)\n\
    \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/trainable.py\"\
    , line 375, in train\n    raise skipped from exception_cause(skipped)\n  File\
    \ \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
    , line 349, in entrypoint\n    return self._trainable_func(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/function_trainable.py\"\
    , line 666, in _trainable_func\n    output = fn()\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
    , line 348, in dynamic_modules_import_trainable\n    return trainable(*args, **kwargs)\n\
    \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/ray/tune/trainable/util.py\"\
    , line 324, in inner\n    return trainable(config, **fn_kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/integrations.py\"\
    , line 249, in _objective\n    local_trainer.train(resume_from_checkpoint=checkpoint,\
    \ trial=trial)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
    , line 1539, in train\n    return inner_training_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
    , line 1901, in _inner_training_loop\n    self._maybe_log_save_evaluate(tr_loss,\
    \ model, trial, epoch, ignore_keys_for_eval)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
    , line 2226, in _maybe_log_save_evaluate\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\n\
    \  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
    , line 2934, in evaluate\n    output = eval_loop(\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/transformers/trainer.py\"\
    , line 3222, in evaluation_loop\n    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds,\
    \ label_ids=all_labels))\n  File \"hyperparam_optimiz_for_disease_classifier.py\"\
    , line 178, in compute_metrics\n    acc = accuracy_score(labels, preds)\n  File\
    \ \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/utils/_param_validation.py\"\
    , line 211, in wrapper\n    return func(*args, **kwargs)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
    , line 220, in accuracy_score\n    y_type, y_true, y_pred = _check_targets(y_true,\
    \ y_pred)\n  File \"/gpfs/gsfs12/users/martinezcarraa2/conda/envs/hackgneformer/lib/python3.8/site-packages/sklearn/metrics/_classification.py\"\
    , line 93, in _check_targets\n    raise ValueError(\nValueError: Classification\
    \ metrics can't handle a mix of multiclass-multioutput and multilabel-indicator\
    \ targets\n[martinezcarraa2@biowulf DOSAGE_HYPERPARAMS]$\n\n```\n"
  created_at: 2023-08-19 18:11:04+00:00
  edited: true
  hidden: false
  id: 64e113c875fae2212e82922c
  type: comment
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: /avatars/c9e531894ec4f570222edccc6fcce478.svg
      fullname: Martinez Carrasco
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: AMCalejandro
      type: user
    createdAt: '2023-08-20T21:59:25.000Z'
    data:
      from: 'TypeError: forward() got an unexpected keyword argument ''label'''
      to: lassification metrics can't handle a mix of multiclass-multioutput and multilabel-indicator
        targets
    id: 64e28cbd623074ac85d29338
    type: title-change
  author: AMCalejandro
  created_at: 2023-08-20 20:59:25+00:00
  id: 64e28cbd623074ac85d29338
  new_title: lassification metrics can't handle a mix of multiclass-multioutput and
    multilabel-indicator targets
  old_title: 'TypeError: forward() got an unexpected keyword argument ''label'''
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionTitleChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-08-23T17:42:42.000Z'
    data:
      from: lassification metrics can't handle a mix of multiclass-multioutput and
        multilabel-indicator targets
      to: Classification metrics can't handle a mix of multiclass-multioutput and
        multilabel-indicator targets
    id: 64e64512a12333aea5f43130
    type: title-change
  author: ctheodoris
  created_at: 2023-08-23 16:42:42+00:00
  id: 64e64512a12333aea5f43130
  new_title: Classification metrics can't handle a mix of multiclass-multioutput and
    multilabel-indicator targets
  old_title: lassification metrics can't handle a mix of multiclass-multioutput and
    multilabel-indicator targets
  type: title-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-08-23T17:45:22.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8041089773178101
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for your interest in Geneformer! I have not encountered
          this error. Could you provide more specific information about the code you
          are running to elicit this error so we can help troubleshoot? This may be
          relevant: <a rel="nofollow" href="https://stackoverflow.com/questions/54589669/confusion-matrix-error-classification-metrics-cant-handle-a-mix-of-multilabel">https://stackoverflow.com/questions/54589669/confusion-matrix-error-classification-metrics-cant-handle-a-mix-of-multilabel</a></p>

          '
        raw: 'Thank you for your interest in Geneformer! I have not encountered this
          error. Could you provide more specific information about the code you are
          running to elicit this error so we can help troubleshoot? This may be relevant:
          https://stackoverflow.com/questions/54589669/confusion-matrix-error-classification-metrics-cant-handle-a-mix-of-multilabel'
        updatedAt: '2023-08-23T17:45:22.021Z'
      numEdits: 0
      reactions: []
    id: 64e645b23d04f30e3f4e7681
    type: comment
  author: ctheodoris
  content: 'Thank you for your interest in Geneformer! I have not encountered this
    error. Could you provide more specific information about the code you are running
    to elicit this error so we can help troubleshoot? This may be relevant: https://stackoverflow.com/questions/54589669/confusion-matrix-error-classification-metrics-cant-handle-a-mix-of-multilabel'
  created_at: 2023-08-23 16:45:22+00:00
  edited: false
  hidden: false
  id: 64e645b23d04f30e3f4e7681
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-09-13T07:58:43.000Z'
    data:
      status: closed
    id: 65016bb3b0de1665787bd3f2
    type: status-change
  author: ctheodoris
  created_at: 2023-09-13 06:58:43+00:00
  id: 65016bb3b0de1665787bd3f2
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 225
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: null
title: Classification metrics can't handle a mix of multiclass-multioutput and multilabel-indicator
  targets
