!!python/object:huggingface_hub.community.DiscussionWithDetails
author: jinbo1129
conflicting_files: null
created_at: 2023-07-12 07:34:54+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/979d5517514710ed6163619042dbf005.svg
      fullname: zhang
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jinbo1129
      type: user
    createdAt: '2023-07-12T08:34:54.000Z'
    data:
      edited: false
      editors:
      - jinbo1129
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8364481329917908
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/979d5517514710ed6163619042dbf005.svg
          fullname: zhang
          isHf: false
          isPro: false
          name: jinbo1129
          type: user
        html: "<p>Thanks for this great tool !!!<br>I am trying to do a new fine tuning\
          \ task: given a cell expression to predict mutiple lables.<br>These predicted\
          \ lables have fixed length, such as each cell have 23 labels:<br>[0, 1,\
          \ 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</p>\n<p>After\
          \ I prepared my dataset, I try to run just like the gene classification\
          \ notebook:</p>\n<pre><code class=\"language-python\">trainer = Trainer(\n\
          \    model=model,\n    args=training_args_init,\n    data_collator=DataCollatorForGeneClassification(),\n\
          \    train_dataset=labeled_train_split,\n    eval_dataset=labeled_eval_split\n\
          )\ntrainer.train()\n</code></pre>\n<p>There is a error:  ValueError: expected\
          \ sequence of length 23 at dim 1 (got 30)</p>\n<p>I noticed that : this\
          \ error happends at the second elements in the batch, since<br>the input_ids\
          \ of the second elements have been padded with additional 7 '0', then<br>the\
          \ 'labels' of the second elements also got additional 7 '-100'.</p>\n<p>So\
          \ if I could just  do the  padding for the features of 'input_ids' but not\
          \ for 'labels',  I think I will  solve this problem. Is that right? Please\
          \ could you give me some suggestions.</p>\n<p>Thanks !!!</p>\n"
        raw: "Thanks for this great tool !!!\r\nI am trying to do a new fine tuning\
          \ task: given a cell expression to predict mutiple lables.\r\nThese predicted\
          \ lables have fixed length, such as each cell have 23 labels:\r\n[0, 1,\
          \ 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n\r\n\
          After I prepared my dataset, I try to run just like the gene classification\
          \ notebook:\r\n```python\r\ntrainer = Trainer(\r\n    model=model,\r\n \
          \   args=training_args_init,\r\n    data_collator=DataCollatorForGeneClassification(),\r\
          \n    train_dataset=labeled_train_split,\r\n    eval_dataset=labeled_eval_split\r\
          \n)\r\ntrainer.train()\r\n```\r\n\r\nThere is a error:  ValueError: expected\
          \ sequence of length 23 at dim 1 (got 30)\r\n\r\nI noticed that : this error\
          \ happends at the second elements in the batch, since \r\nthe input_ids\
          \ of the second elements have been padded with additional 7 '0', then\r\n\
          the 'labels' of the second elements also got additional 7 '-100'.\r\n\r\n\
          So if I could just  do the  padding for the features of 'input_ids' but\
          \ not for 'labels',  I think I will  solve this problem. Is that right?\
          \ Please could you give me some suggestions.\r\n\r\nThanks !!!"
        updatedAt: '2023-07-12T08:34:54.742Z'
      numEdits: 0
      reactions: []
    id: 64ae65aecf90fe2755786152
    type: comment
  author: jinbo1129
  content: "Thanks for this great tool !!!\r\nI am trying to do a new fine tuning\
    \ task: given a cell expression to predict mutiple lables.\r\nThese predicted\
    \ lables have fixed length, such as each cell have 23 labels:\r\n[0, 1, 1, 0,\
    \ 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n\r\nAfter I prepared\
    \ my dataset, I try to run just like the gene classification notebook:\r\n```python\r\
    \ntrainer = Trainer(\r\n    model=model,\r\n    args=training_args_init,\r\n \
    \   data_collator=DataCollatorForGeneClassification(),\r\n    train_dataset=labeled_train_split,\r\
    \n    eval_dataset=labeled_eval_split\r\n)\r\ntrainer.train()\r\n```\r\n\r\nThere\
    \ is a error:  ValueError: expected sequence of length 23 at dim 1 (got 30)\r\n\
    \r\nI noticed that : this error happends at the second elements in the batch,\
    \ since \r\nthe input_ids of the second elements have been padded with additional\
    \ 7 '0', then\r\nthe 'labels' of the second elements also got additional 7 '-100'.\r\
    \n\r\nSo if I could just  do the  padding for the features of 'input_ids' but\
    \ not for 'labels',  I think I will  solve this problem. Is that right? Please\
    \ could you give me some suggestions.\r\n\r\nThanks !!!"
  created_at: 2023-07-12 07:34:54+00:00
  edited: false
  hidden: false
  id: 64ae65aecf90fe2755786152
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-07-16T13:04:58.000Z'
    data:
      edited: false
      editors:
      - ctheodoris
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8842488527297974
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
          fullname: Christina Theodoris
          isHf: false
          isPro: false
          name: ctheodoris
          type: user
        html: '<p>Thank you for your question and interest in Geneformer! Please note
          that if you are classification cells, you should use the DataCollatorForCellClassification
          and model your approach on the example notebook for cell classification
          or the disease classification example script which includes hyperparameter
          optimization that we highly recommend. The number of cells must match the
          number of labels so that each cell has a label, so that''s why they are
          padded together. Geneformer supports multiclass classification (as in the
          cell annotation application). However, I believe you are instead working
          on a problem that requires multi-task classification (multiple modes per
          cell). We are working on developing a framework for this, but in the meantime
          you could check out some of the examples of multi-task classification for
          NLP applications. Geneformer is integrated with Huggingface so you could
          use any of the Huggingface examples for sentence classification for your
          cell classification and any of the examples for token classification for
          gene classification. For example:<br><a rel="nofollow" href="https://colab.research.google.com/github/zphang/zphang.github.io/blob/master/files/notebooks/Multi_task_Training_with_Transformers_NLP.ipynb">https://colab.research.google.com/github/zphang/zphang.github.io/blob/master/files/notebooks/Multi_task_Training_with_Transformers_NLP.ipynb</a></p>

          '
        raw: 'Thank you for your question and interest in Geneformer! Please note
          that if you are classification cells, you should use the DataCollatorForCellClassification
          and model your approach on the example notebook for cell classification
          or the disease classification example script which includes hyperparameter
          optimization that we highly recommend. The number of cells must match the
          number of labels so that each cell has a label, so that''s why they are
          padded together. Geneformer supports multiclass classification (as in the
          cell annotation application). However, I believe you are instead working
          on a problem that requires multi-task classification (multiple modes per
          cell). We are working on developing a framework for this, but in the meantime
          you could check out some of the examples of multi-task classification for
          NLP applications. Geneformer is integrated with Huggingface so you could
          use any of the Huggingface examples for sentence classification for your
          cell classification and any of the examples for token classification for
          gene classification. For example:

          https://colab.research.google.com/github/zphang/zphang.github.io/blob/master/files/notebooks/Multi_task_Training_with_Transformers_NLP.ipynb'
        updatedAt: '2023-07-16T13:04:58.722Z'
      numEdits: 0
      reactions: []
      relatedEventId: 64b3eafad52d67c01cebd3ff
    id: 64b3eafad52d67c01cebd3fe
    type: comment
  author: ctheodoris
  content: 'Thank you for your question and interest in Geneformer! Please note that
    if you are classification cells, you should use the DataCollatorForCellClassification
    and model your approach on the example notebook for cell classification or the
    disease classification example script which includes hyperparameter optimization
    that we highly recommend. The number of cells must match the number of labels
    so that each cell has a label, so that''s why they are padded together. Geneformer
    supports multiclass classification (as in the cell annotation application). However,
    I believe you are instead working on a problem that requires multi-task classification
    (multiple modes per cell). We are working on developing a framework for this,
    but in the meantime you could check out some of the examples of multi-task classification
    for NLP applications. Geneformer is integrated with Huggingface so you could use
    any of the Huggingface examples for sentence classification for your cell classification
    and any of the examples for token classification for gene classification. For
    example:

    https://colab.research.google.com/github/zphang/zphang.github.io/blob/master/files/notebooks/Multi_task_Training_with_Transformers_NLP.ipynb'
  created_at: 2023-07-16 12:04:58+00:00
  edited: false
  hidden: false
  id: 64b3eafad52d67c01cebd3fe
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1671502872617-622d085c8d04fd29a9ccf169.png?w=200&h=200&f=face
      fullname: Christina Theodoris
      isHf: false
      isOrgMember: false
      isOwner: true
      isPro: false
      name: ctheodoris
      type: user
    createdAt: '2023-07-16T13:04:58.000Z'
    data:
      status: closed
    id: 64b3eafad52d67c01cebd3ff
    type: status-change
  author: ctheodoris
  created_at: 2023-07-16 12:04:58+00:00
  id: 64b3eafad52d67c01cebd3ff
  new_status: closed
  type: status-change
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/979d5517514710ed6163619042dbf005.svg
      fullname: zhang
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: jinbo1129
      type: user
    createdAt: '2023-07-17T01:26:52.000Z'
    data:
      edited: false
      editors:
      - jinbo1129
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.9859591126441956
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/979d5517514710ed6163619042dbf005.svg
          fullname: zhang
          isHf: false
          isPro: false
          name: jinbo1129
          type: user
        html: '<p>thanks very much !!! It is a great tool !!!</p>

          '
        raw: thanks very much !!! It is a great tool !!!
        updatedAt: '2023-07-17T01:26:52.240Z'
      numEdits: 0
      reactions: []
    id: 64b498dcf460afaefc516720
    type: comment
  author: jinbo1129
  content: thanks very much !!! It is a great tool !!!
  created_at: 2023-07-17 00:26:52+00:00
  edited: false
  hidden: false
  id: 64b498dcf460afaefc516720
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 114
repo_id: ctheodoris/Geneformer
repo_type: model
status: closed
target_branch: null
title: Suggestions for new DataCollator ???
