!!python/object:huggingface_hub.community.DiscussionWithDetails
author: Enning
conflicting_files: null
created_at: 2023-09-07 23:16:22+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/563c7b982b9102d6bcfa645ab2f210bb.svg
      fullname: Yang
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: Enning
      type: user
    createdAt: '2023-09-08T00:16:22.000Z'
    data:
      edited: false
      editors:
      - Enning
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.5203855037689209
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/563c7b982b9102d6bcfa645ab2f210bb.svg
          fullname: Yang
          isHf: false
          isPro: false
          name: Enning
          type: user
        html: '<p>When i try to deploy this model into sagemaker using the code provided,
          the endpoint can be created but when i try to predict,  i got this error
          from cloudwatch:</p>

          <p>KeyError: ''musicgen'' </p>

          <p>Traceback (most recent call last):<br>  File "/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py",
          line 219, in handle<br>    self.initialize(context)<br>  File "/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py",
          line 104, in load<br>    hf_pipeline = get_pipeline(task=os.environ["HF_TASK"],
          model_dir=model_dir, device=self.device)<br>  File "/opt/conda/lib/python3.9/site-packages/transformers/pipelines/<strong>init</strong>.py",
          line 675, in pipeline<br>    config = AutoConfig.from_pretrained(model,
          _from_pipeline=task, **hub_kwargs, **model_kwargs)<br>  File "/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py",
          line 873, in from_pretrained<br>    config_class = CONFIG_MAPPING[config_dict["model_type"]]<br>  File
          "/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py",
          line 579, in <strong>getitem</strong><br>    raise KeyError(key) </p>

          <p>During handling of the above exception, another exception occurred: </p>

          <p>Traceback (most recent call last):<br>  File "/opt/conda/lib/python3.9/site-packages/mms/service.py",
          line 108, in predict<br>    ret = self._entry_point(input_batch, self.context)<br>  File
          "/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py",
          line 243, in handle<br>    raise PredictionException(str(e), 400)<br>mms.service.PredictionException:
          ''musicgen'' : 400</p>

          '
        raw: "When i try to deploy this model into sagemaker using the code provided,\
          \ the endpoint can be created but when i try to predict,  i got this error\
          \ from cloudwatch:\r\n\r\nKeyError: 'musicgen' \r\n\r\nTraceback (most recent\
          \ call last): \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
          , line 219, in handle \r\n    self.initialize(context) \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
          , line 104, in load \r\n    hf_pipeline = get_pipeline(task=os.environ[\"\
          HF_TASK\"], model_dir=model_dir, device=self.device) \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/pipelines/__init__.py\"\
          , line 675, in pipeline \r\n    config = AutoConfig.from_pretrained(model,\
          \ _from_pipeline=task, **hub_kwargs, **model_kwargs) \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py\"\
          , line 873, in from_pretrained \r\n    config_class = CONFIG_MAPPING[config_dict[\"\
          model_type\"]] \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py\"\
          , line 579, in __getitem__ \r\n    raise KeyError(key) \r\n\r\nDuring handling\
          \ of the above exception, another exception occurred: \r\n\r\nTraceback\
          \ (most recent call last): \r\n  File \"/opt/conda/lib/python3.9/site-packages/mms/service.py\"\
          , line 108, in predict \r\n    ret = self._entry_point(input_batch, self.context)\
          \ \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
          , line 243, in handle \r\n    raise PredictionException(str(e), 400) \r\n\
          mms.service.PredictionException: 'musicgen' : 400\r\n"
        updatedAt: '2023-09-08T00:16:22.708Z'
      numEdits: 0
      reactions: []
    id: 64fa67d65ca946a010745fc9
    type: comment
  author: Enning
  content: "When i try to deploy this model into sagemaker using the code provided,\
    \ the endpoint can be created but when i try to predict,  i got this error from\
    \ cloudwatch:\r\n\r\nKeyError: 'musicgen' \r\n\r\nTraceback (most recent call\
    \ last): \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
    , line 219, in handle \r\n    self.initialize(context) \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
    , line 104, in load \r\n    hf_pipeline = get_pipeline(task=os.environ[\"HF_TASK\"\
    ], model_dir=model_dir, device=self.device) \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/pipelines/__init__.py\"\
    , line 675, in pipeline \r\n    config = AutoConfig.from_pretrained(model, _from_pipeline=task,\
    \ **hub_kwargs, **model_kwargs) \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py\"\
    , line 873, in from_pretrained \r\n    config_class = CONFIG_MAPPING[config_dict[\"\
    model_type\"]] \r\n  File \"/opt/conda/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py\"\
    , line 579, in __getitem__ \r\n    raise KeyError(key) \r\n\r\nDuring handling\
    \ of the above exception, another exception occurred: \r\n\r\nTraceback (most\
    \ recent call last): \r\n  File \"/opt/conda/lib/python3.9/site-packages/mms/service.py\"\
    , line 108, in predict \r\n    ret = self._entry_point(input_batch, self.context)\
    \ \r\n  File \"/opt/conda/lib/python3.9/site-packages/sagemaker_huggingface_inference_toolkit/handler_service.py\"\
    , line 243, in handle \r\n    raise PredictionException(str(e), 400) \r\nmms.service.PredictionException:\
    \ 'musicgen' : 400\r\n"
  created_at: 2023-09-07 23:16:22+00:00
  edited: false
  hidden: false
  id: 64fa67d65ca946a010745fc9
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
      fullname: Lysandre
      isHf: true
      isOrgMember: true
      isOwner: false
      isPro: false
      name: lysandre
      type: user
    createdAt: '2023-09-11T20:44:32.000Z'
    data:
      edited: false
      editors:
      - lysandre
      hidden: false
      identifiedLanguage:
        language: es
        probability: 0.17824403941631317
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1618450692745-5e3aec01f55e2b62848a5217.jpeg?w=200&h=200&f=face
          fullname: Lysandre
          isHf: true
          isPro: false
          name: lysandre
          type: user
        html: "<p>cc <span data-props=\"{&quot;user&quot;:&quot;philschmid&quot;}\"\
          \ data-target=\"UserMention\" class=\"SVELTE_PARTIAL_HYDRATER contents\"\
          >\n\n<span class=\"inline-block\"><span class=\"contents\"><a href=\"/philschmid\"\
          >@<span class=\"underline\">philschmid</span></a></span>\n\n\t</span></span>\
          \ </p>\n"
        raw: 'cc @philschmid '
        updatedAt: '2023-09-11T20:44:32.451Z'
      numEdits: 0
      reactions: []
    id: 64ff7c30e3201fff883f5ec8
    type: comment
  author: lysandre
  content: 'cc @philschmid '
  created_at: 2023-09-11 19:44:32+00:00
  edited: false
  hidden: false
  id: 64ff7c30e3201fff883f5ec8
  type: comment
is_pull_request: false
merge_commit_oid: null
num: 17
repo_id: facebook/musicgen-small
repo_type: model
status: open
target_branch: null
title: deploy to sagemkaer cannot predict
