!!python/object:huggingface_hub.community.DiscussionWithDetails
author: zhiminy
conflicting_files: null
created_at: 2023-10-17 23:13:39+00:00
diff: null
endpoint: https://huggingface.co
events:
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653468274869-628debe0ce274a882affe104.jpeg?w=200&h=200&f=face
      fullname: Zhimin Zhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zhiminy
      type: user
    createdAt: '2023-10-18T00:13:39.000Z'
    data:
      edited: false
      editors:
      - zhiminy
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6204304099082947
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653468274869-628debe0ce274a882affe104.jpeg?w=200&h=200&f=face
          fullname: Zhimin Zhao
          isHf: false
          isPro: false
          name: zhiminy
          type: user
        html: "<p>I tried to run the sentence transformer example but it encountered\
          \ loading error as follows:</p>\n<pre><code>TypeError                  \
          \               Traceback (most recent call last)\n/home/21zz42/temp/example.ipynb\
          \ Cell 3 line 1\n     10 repos = ['hkunlp/instructor-large', 'intfloat/e5-large']\n\
          \     12 for repo in repos:\n---&gt; 13     model = SentenceTransformer(repo)\n\
          \     14     model_time = 0\n     15     for _ in range(times):\n\nFile\
          \ ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:95,\
          \ in SentenceTransformer.__init__(self, model_name_or_path, modules, device,\
          \ cache_folder, use_auth_token)\n     87         snapshot_download(model_name_or_path,\n\
          \     88                             cache_dir=cache_folder,\n     89  \
          \                           library_name='sentence-transformers',\n    \
          \ 90                             library_version=__version__,\n     91 \
          \                            ignore_files=['flax_model.msgpack', 'rust_model.ot',\
          \ 'tf_model.h5'],\n     92                             use_auth_token=use_auth_token)\n\
          \     94 if os.path.exists(os.path.join(model_path, 'modules.json')):  \
          \  #Load as SentenceTransformer model\n---&gt; 95     modules = self._load_sbert_model(model_path)\n\
          \     96 else:   #Load with AutoModel\n     97     modules = self._load_auto_model(model_path)\n\
          \nFile ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:840,\
          \ in SentenceTransformer._load_sbert_model(self, model_path)\n    838 for\
          \ module_config in modules_config:\n    839     module_class = import_from_string(module_config['type'])\n\
          --&gt; 840     module = module_class.load(os.path.join(model_path, module_config['path']))\n\
          ...\n    117 with open(os.path.join(input_path, 'config.json')) as fIn:\n\
          \    118     config = json.load(fIn)\n--&gt; 120 return Pooling(**config)\n\
          \nTypeError: Pooling.__init__() got an unexpected keyword argument 'pooling_mode_weightedmean_tokens'\n\
          </code></pre>\n<p>Here are the original code:</p>\n<pre><code>from sentence_transformers\
          \ import SentenceTransformer\ninput_texts = [\n    'query: how much protein\
          \ should a female eat',\n    'query: summit define',\n    \"passage: As\
          \ a general guideline, the CDC's average requirement of protein for women\
          \ ages 19 to 70 is 46 grams per day. But, as you can see from this chart,\
          \ you'll need to increase that if you're expecting or training for a marathon.\
          \ Check out the chart below to see how much protein you should be eating\
          \ each day.\",\n    \"passage: Definition of summit for English Language\
          \ Learners. : 1  the highest point of a mountain : the top of a mountain.\
          \ : 2  the highest level. : 3  a meeting or series of meetings between the\
          \ leaders of two or more governments.\"\n]\n\ntimes = 1\nrepos = ['hkunlp/instructor-large']\n\
          \nfor repo in repos:\n    model = SentenceTransformer(repo)\n    model_time\
          \ = 0\n    for _ in range(times):\n        time_start = time.time()\n  \
          \      embeddings = model.encode(input_texts, normalize_embeddings=True)\n\
          \        time_taken = time.time() - time_start\n        model_time += time_taken\n\
          \    print(f'{repo} time: {model_time}')\n</code></pre>\n<p>I am using Python\
          \ 3.10.12 on Linux OS.</p>\n"
        raw: "I tried to run the sentence transformer example but it encountered loading\
          \ error as follows:\r\n```\r\nTypeError                                \
          \ Traceback (most recent call last)\r\n/home/21zz42/temp/example.ipynb Cell\
          \ 3 line 1\r\n     10 repos = ['hkunlp/instructor-large', 'intfloat/e5-large']\r\
          \n     12 for repo in repos:\r\n---> 13     model = SentenceTransformer(repo)\r\
          \n     14     model_time = 0\r\n     15     for _ in range(times):\r\n\r\
          \nFile ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:95,\
          \ in SentenceTransformer.__init__(self, model_name_or_path, modules, device,\
          \ cache_folder, use_auth_token)\r\n     87         snapshot_download(model_name_or_path,\r\
          \n     88                             cache_dir=cache_folder,\r\n     89\
          \                             library_name='sentence-transformers',\r\n\
          \     90                             library_version=__version__,\r\n  \
          \   91                             ignore_files=['flax_model.msgpack', 'rust_model.ot',\
          \ 'tf_model.h5'],\r\n     92                             use_auth_token=use_auth_token)\r\
          \n     94 if os.path.exists(os.path.join(model_path, 'modules.json')): \
          \   #Load as SentenceTransformer model\r\n---> 95     modules = self._load_sbert_model(model_path)\r\
          \n     96 else:   #Load with AutoModel\r\n     97     modules = self._load_auto_model(model_path)\r\
          \n\r\nFile ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:840,\
          \ in SentenceTransformer._load_sbert_model(self, model_path)\r\n    838\
          \ for module_config in modules_config:\r\n    839     module_class = import_from_string(module_config['type'])\r\
          \n--> 840     module = module_class.load(os.path.join(model_path, module_config['path']))\r\
          \n...\r\n    117 with open(os.path.join(input_path, 'config.json')) as fIn:\r\
          \n    118     config = json.load(fIn)\r\n--> 120 return Pooling(**config)\r\
          \n\r\nTypeError: Pooling.__init__() got an unexpected keyword argument 'pooling_mode_weightedmean_tokens'\r\
          \n```\r\nHere are the original code:\r\n```\r\nfrom sentence_transformers\
          \ import SentenceTransformer\r\ninput_texts = [\r\n    'query: how much\
          \ protein should a female eat',\r\n    'query: summit define',\r\n    \"\
          passage: As a general guideline, the CDC's average requirement of protein\
          \ for women ages 19 to 70 is 46 grams per day. But, as you can see from\
          \ this chart, you'll need to increase that if you're expecting or training\
          \ for a marathon. Check out the chart below to see how much protein you\
          \ should be eating each day.\",\r\n    \"passage: Definition of summit for\
          \ English Language Learners. : 1  the highest point of a mountain : the\
          \ top of a mountain. : 2  the highest level. : 3  a meeting or series of\
          \ meetings between the leaders of two or more governments.\"\r\n]\r\n\r\n\
          times = 1\r\nrepos = ['hkunlp/instructor-large']\r\n\r\nfor repo in repos:\r\
          \n    model = SentenceTransformer(repo)\r\n    model_time = 0\r\n    for\
          \ _ in range(times):\r\n        time_start = time.time()\r\n        embeddings\
          \ = model.encode(input_texts, normalize_embeddings=True)\r\n        time_taken\
          \ = time.time() - time_start\r\n        model_time += time_taken\r\n   \
          \ print(f'{repo} time: {model_time}')\r\n```\r\nI am using Python 3.10.12\
          \ on Linux OS."
        updatedAt: '2023-10-18T00:13:39.313Z'
      numEdits: 0
      reactions: []
    id: 652f23336b9c8f1a454f8d88
    type: comment
  author: zhiminy
  content: "I tried to run the sentence transformer example but it encountered loading\
    \ error as follows:\r\n```\r\nTypeError                                 Traceback\
    \ (most recent call last)\r\n/home/21zz42/temp/example.ipynb Cell 3 line 1\r\n\
    \     10 repos = ['hkunlp/instructor-large', 'intfloat/e5-large']\r\n     12 for\
    \ repo in repos:\r\n---> 13     model = SentenceTransformer(repo)\r\n     14 \
    \    model_time = 0\r\n     15     for _ in range(times):\r\n\r\nFile ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:95,\
    \ in SentenceTransformer.__init__(self, model_name_or_path, modules, device, cache_folder,\
    \ use_auth_token)\r\n     87         snapshot_download(model_name_or_path,\r\n\
    \     88                             cache_dir=cache_folder,\r\n     89      \
    \                       library_name='sentence-transformers',\r\n     90     \
    \                        library_version=__version__,\r\n     91             \
    \                ignore_files=['flax_model.msgpack', 'rust_model.ot', 'tf_model.h5'],\r\
    \n     92                             use_auth_token=use_auth_token)\r\n     94\
    \ if os.path.exists(os.path.join(model_path, 'modules.json')):    #Load as SentenceTransformer\
    \ model\r\n---> 95     modules = self._load_sbert_model(model_path)\r\n     96\
    \ else:   #Load with AutoModel\r\n     97     modules = self._load_auto_model(model_path)\r\
    \n\r\nFile ~/temp/.venv/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py:840,\
    \ in SentenceTransformer._load_sbert_model(self, model_path)\r\n    838 for module_config\
    \ in modules_config:\r\n    839     module_class = import_from_string(module_config['type'])\r\
    \n--> 840     module = module_class.load(os.path.join(model_path, module_config['path']))\r\
    \n...\r\n    117 with open(os.path.join(input_path, 'config.json')) as fIn:\r\n\
    \    118     config = json.load(fIn)\r\n--> 120 return Pooling(**config)\r\n\r\
    \nTypeError: Pooling.__init__() got an unexpected keyword argument 'pooling_mode_weightedmean_tokens'\r\
    \n```\r\nHere are the original code:\r\n```\r\nfrom sentence_transformers import\
    \ SentenceTransformer\r\ninput_texts = [\r\n    'query: how much protein should\
    \ a female eat',\r\n    'query: summit define',\r\n    \"passage: As a general\
    \ guideline, the CDC's average requirement of protein for women ages 19 to 70\
    \ is 46 grams per day. But, as you can see from this chart, you'll need to increase\
    \ that if you're expecting or training for a marathon. Check out the chart below\
    \ to see how much protein you should be eating each day.\",\r\n    \"passage:\
    \ Definition of summit for English Language Learners. : 1  the highest point of\
    \ a mountain : the top of a mountain. : 2  the highest level. : 3  a meeting or\
    \ series of meetings between the leaders of two or more governments.\"\r\n]\r\n\
    \r\ntimes = 1\r\nrepos = ['hkunlp/instructor-large']\r\n\r\nfor repo in repos:\r\
    \n    model = SentenceTransformer(repo)\r\n    model_time = 0\r\n    for _ in\
    \ range(times):\r\n        time_start = time.time()\r\n        embeddings = model.encode(input_texts,\
    \ normalize_embeddings=True)\r\n        time_taken = time.time() - time_start\r\
    \n        model_time += time_taken\r\n    print(f'{repo} time: {model_time}')\r\
    \n```\r\nI am using Python 3.10.12 on Linux OS."
  created_at: 2023-10-17 23:13:39+00:00
  edited: false
  hidden: false
  id: 652f23336b9c8f1a454f8d88
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b7d0a895e669bcd1303c4716b5401c36.svg
      fullname: Hongjin SU
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: multi-train
      type: user
    createdAt: '2023-10-18T00:57:54.000Z'
    data:
      edited: false
      editors:
      - multi-train
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.846376895904541
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b7d0a895e669bcd1303c4716b5401c36.svg
          fullname: Hongjin SU
          isHf: false
          isPro: false
          name: multi-train
          type: user
        html: '<p>Hi, what is your sentence-transformer version? FYI, I install the
          version 2.2.2</p>

          '
        raw: Hi, what is your sentence-transformer version? FYI, I install the version
          2.2.2
        updatedAt: '2023-10-18T00:57:54.307Z'
      numEdits: 0
      reactions: []
    id: 652f2d923c2115904da3167a
    type: comment
  author: multi-train
  content: Hi, what is your sentence-transformer version? FYI, I install the version
    2.2.2
  created_at: 2023-10-17 23:57:54+00:00
  edited: false
  hidden: false
  id: 652f2d923c2115904da3167a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653468274869-628debe0ce274a882affe104.jpeg?w=200&h=200&f=face
      fullname: Zhimin Zhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zhiminy
      type: user
    createdAt: '2023-10-18T13:50:48.000Z'
    data:
      edited: false
      editors:
      - zhiminy
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.8964640498161316
      isReport: false
      latest:
        author:
          avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653468274869-628debe0ce274a882affe104.jpeg?w=200&h=200&f=face
          fullname: Zhimin Zhao
          isHf: false
          isPro: false
          name: zhiminy
          type: user
        html: '<blockquote>

          <p>Hi, what is your sentence-transformer version? FYI, I install the version
          2.2.2</p>

          </blockquote>

          <p>Same, I am using 2.2.2 as well</p>

          '
        raw: '> Hi, what is your sentence-transformer version? FYI, I install the
          version 2.2.2


          Same, I am using 2.2.2 as well'
        updatedAt: '2023-10-18T13:50:48.667Z'
      numEdits: 0
      reactions: []
    id: 652fe2b8e13118b6fbccb57a
    type: comment
  author: zhiminy
  content: '> Hi, what is your sentence-transformer version? FYI, I install the version
    2.2.2


    Same, I am using 2.2.2 as well'
  created_at: 2023-10-18 12:50:48+00:00
  edited: false
  hidden: false
  id: 652fe2b8e13118b6fbccb57a
  type: comment
- !!python/object:huggingface_hub.community.DiscussionComment
  _event:
    author:
      avatarUrl: /avatars/b7d0a895e669bcd1303c4716b5401c36.svg
      fullname: Hongjin SU
      isHf: false
      isOrgMember: true
      isOwner: false
      isPro: false
      name: multi-train
      type: user
    createdAt: '2023-10-18T13:53:09.000Z'
    data:
      edited: false
      editors:
      - multi-train
      hidden: false
      identifiedLanguage:
        language: en
        probability: 0.6962589621543884
      isReport: false
      latest:
        author:
          avatarUrl: /avatars/b7d0a895e669bcd1303c4716b5401c36.svg
          fullname: Hongjin SU
          isHf: false
          isPro: false
          name: multi-train
          type: user
        html: '<p>Oh, you should use <code>INSTRUCTOR</code> to load the model:</p>

          <pre><code>from InstructorEmbedding import INSTRUCTOR

          model = INSTRUCTOR(''hkunlp/instructor-large'')

          </code></pre>

          <p>For details, you may refer to <a rel="nofollow" href="https://github.com/xlang-ai/instructor-embedding#getting-started">https://github.com/xlang-ai/instructor-embedding#getting-started</a>.</p>

          '
        raw: 'Oh, you should use `INSTRUCTOR` to load the model:

          ```

          from InstructorEmbedding import INSTRUCTOR

          model = INSTRUCTOR(''hkunlp/instructor-large'')

          ```


          For details, you may refer to https://github.com/xlang-ai/instructor-embedding#getting-started.'
        updatedAt: '2023-10-18T13:53:09.813Z'
      numEdits: 0
      reactions: []
    id: 652fe345477041fda299975e
    type: comment
  author: multi-train
  content: 'Oh, you should use `INSTRUCTOR` to load the model:

    ```

    from InstructorEmbedding import INSTRUCTOR

    model = INSTRUCTOR(''hkunlp/instructor-large'')

    ```


    For details, you may refer to https://github.com/xlang-ai/instructor-embedding#getting-started.'
  created_at: 2023-10-18 12:53:09+00:00
  edited: false
  hidden: false
  id: 652fe345477041fda299975e
  type: comment
- !!python/object:huggingface_hub.community.DiscussionStatusChange
  _event:
    author:
      avatarUrl: https://aeiljuispo.cloudimg.io/v7/https://cdn-uploads.huggingface.co/production/uploads/1653468274869-628debe0ce274a882affe104.jpeg?w=200&h=200&f=face
      fullname: Zhimin Zhao
      isHf: false
      isOrgMember: false
      isOwner: false
      isPro: false
      name: zhiminy
      type: user
    createdAt: '2023-11-27T18:05:36.000Z'
    data:
      status: closed
    id: 6564da70067c82f463447967
    type: status-change
  author: zhiminy
  created_at: 2023-11-27 18:05:36+00:00
  id: 6564da70067c82f463447967
  new_status: closed
  type: status-change
is_pull_request: false
merge_commit_oid: null
num: 19
repo_id: hkunlp/instructor-large
repo_type: model
status: closed
target_branch: null
title: Sentence transformer gives loading error
